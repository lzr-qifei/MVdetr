logs/multiviewx/aug_deform_trans_w_dec_lr0.0001_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-11_11-57-24
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 100, 'lr': 0.0001, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX', 'two_stage': False}
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 117,
        127, 133, 137, 143, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 39, 36, 12, 24,  0,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(6.6015, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(29.1031, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(42.3061, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,
         86,  90, 106, 121, 126, 158, 159, 166, 178, 179, 195, 200, 203, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 261, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38, 30,  0,
         8, 16, 31, 36, 12, 22,  1, 39, 10, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(6.6050, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(27.3836, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(40.5936, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  49,  51,  60,  70,
         74,  86, 105, 106, 133, 137, 153, 156, 164, 166, 170, 179, 194, 195,
        210, 221, 234, 240, 245, 248, 249, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 40, 26, 39, 38, 13, 21,  0, 30,
        41, 24, 12, 10,  5, 37,  8, 22, 15,  1,  9, 28, 31, 17, 20, 16, 42,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(6.0924, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(24.2505, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(36.4353, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86,  91, 127, 133, 137, 149, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40,  5, 12, 24,  0, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(6.0839, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(26.2902, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(38.4579, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:4, loss: 9.614486, Time: 6.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 158, 159, 166, 178, 179, 195, 200, 203, 206,
        215, 221, 232, 238, 244, 249, 250, 255, 264, 270, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 16, 31, 36, 12, 22,  1, 39, 10, 23,  3, 32, 15, 17, 28, 40, 18, 29,
         2, 27, 24, 19,  9]))]
