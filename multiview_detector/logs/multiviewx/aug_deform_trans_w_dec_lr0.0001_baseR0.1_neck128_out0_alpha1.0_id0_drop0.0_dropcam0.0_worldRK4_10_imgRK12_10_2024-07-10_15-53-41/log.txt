logs/multiviewx/aug_deform_trans_w_dec_lr0.0001_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-10_15-53-41
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 100, 'lr': 0.0001, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX', 'two_stage': False}
Training...
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  36
gt_cnt:  42
gt_cnt:  37
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
before ref add :  tensor([[0., 0.],
        [0., 0.]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 0.1506, -1.4819],
        [ 0.9703,  0.6918]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
pred: torch.Size([39, 2])
target:  torch.Size([39, 2])
{'labels': tensor(1.8061, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0023, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(0.1853, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
before ref add :  tensor([[-4.2562e-05,  4.0414e-06],
        [-4.2978e-05,  1.2341e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 0.1507, -1.4820],
        [ 0.9704,  0.6917]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
pred: torch.Size([40, 2])
target:  torch.Size([40, 2])
{'labels': tensor(1.6971, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0025, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(0.1747, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
before ref add :  tensor([[-4.2557e-05,  6.2103e-05],
        [-2.0277e-05,  5.3326e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 0.1508, -1.4820],
        [ 0.9705,  0.6918]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
pred: torch.Size([39, 2])
target:  torch.Size([39, 2])
{'labels': tensor(1.7247, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0030, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(0.1784, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
before ref add :  tensor([[-3.5823e-05,  8.9725e-05],
        [-4.5432e-05,  8.7155e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 0.1509, -1.4820],
        [ 0.9706,  0.6918]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
pred: torch.Size([42, 2])
target:  torch.Size([42, 2])
{'labels': tensor(1.5305, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0027, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(0.1586, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
