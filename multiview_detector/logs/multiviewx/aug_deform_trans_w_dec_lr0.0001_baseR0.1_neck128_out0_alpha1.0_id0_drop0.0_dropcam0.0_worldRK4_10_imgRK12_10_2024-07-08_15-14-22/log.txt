logs/multiviewx/aug_deform_trans_w_dec_lr0.0001_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-08_15-14-22
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 100, 'lr': 0.0001, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX'}
rpts:  torch.Size([60000, 6, 4, 2])
pos_emb size:  [ 80 125]
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6729],
        [ 0.6167, -2.6265],
        [-0.7281,  1.4702],
        [-0.8537, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.8407, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4412, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.4038e-05, -6.1166e-05],
        [-6.0328e-05, -6.1744e-05],
        [-5.9068e-05, -5.9250e-05],
        [-6.6519e-05, -6.6349e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6728],
        [ 0.6167, -2.6265],
        [-0.7280,  1.4702],
        [-0.8538, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(8.3756, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.7543, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.1978e-05, -1.0213e-04],
        [-3.8519e-05, -1.2726e-04],
        [-3.9336e-05, -1.1376e-04],
        [-3.8947e-05, -1.2573e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6728],
        [ 0.6168, -2.6265],
        [-0.7279,  1.4701],
        [-0.8537, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.9346, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6680, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.8090e-06, -1.6753e-04],
        [-1.5797e-05, -1.5557e-04],
        [-1.0776e-05, -1.4998e-04],
        [-1.2007e-05, -1.6540e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6168, -2.6265],
        [-0.7278,  1.4700],
        [-0.8536, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.1446, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5028, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 9.4112e-06, -1.4677e-04],
        [ 1.5522e-05, -1.6634e-04],
        [ 2.1759e-05, -1.6001e-04],
        [ 1.5166e-05, -1.6490e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6168, -2.6266],
        [-0.7278,  1.4700],
        [-0.8535, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.2941, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5344, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.4470e-05, -1.8973e-04],
        [ 5.3588e-05, -2.0517e-04],
        [ 5.5847e-05, -1.9717e-04],
        [ 5.6641e-05, -2.2670e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6168, -2.6266],
        [-0.7278,  1.4699],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.4464, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5564, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.3416e-05, -1.8713e-04],
        [ 6.6246e-05, -2.2684e-04],
        [ 5.3021e-05, -1.7197e-04],
        [ 5.1128e-05, -1.8325e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.8891, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4505, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 8.5051e-05, -2.2093e-04],
        [ 8.5313e-05, -2.1610e-04],
        [ 8.8155e-05, -2.3340e-04],
        [ 9.1727e-05, -2.0288e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4699],
        [-0.8533, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.3646, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3565, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.5668e-05, -1.8803e-04],
        [ 7.4107e-05, -1.9924e-04],
        [ 7.8946e-05, -1.8725e-04],
        [ 7.6790e-05, -2.0079e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.2430, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3221, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.9364e-05, -1.6649e-04],
        [ 7.0134e-05, -1.5861e-04],
        [ 7.5613e-05, -1.7702e-04],
        [ 7.7950e-05, -1.6437e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.1857, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5120, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.5675e-05, -1.8491e-04],
        [ 7.5148e-05, -1.8123e-04],
        [ 7.6985e-05, -2.0308e-04],
        [ 7.8018e-05, -1.8138e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.9459, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2673, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.9108e-05, -1.9476e-04],
        [ 7.1895e-05, -1.8741e-04],
        [ 8.7287e-05, -2.3196e-04],
        [ 7.4296e-05, -1.9433e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.6709, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4117, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.7593e-05, -1.8102e-04],
        [ 5.7826e-05, -1.8960e-04],
        [ 5.6834e-05, -1.8299e-04],
        [ 5.3437e-05, -1.8069e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.5483, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5822, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0272e-04, -2.1690e-04],
        [ 9.0508e-05, -1.6743e-04],
        [ 9.2896e-05, -2.0477e-04],
        [ 9.7637e-05, -1.8636e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4701],
        [-0.8532, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(9.4179, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.9510, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.8859, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6531, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0969e-04, -1.8273e-04],
        [ 9.8910e-05, -1.9395e-04],
        [ 1.0189e-04, -1.8434e-04],
        [ 1.0055e-04, -1.8229e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.9912, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2790, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.5710, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5980, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4702],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.4642, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5760, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4219e-04, -1.3881e-04],
        [ 1.3298e-04, -1.0604e-04],
        [ 1.3642e-04, -1.1581e-04],
        [ 1.4022e-04, -9.9036e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6265],
        [-0.7279,  1.4702],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.0950, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5026, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7280,  1.4702],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1378, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3035, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6169, -2.6266],
        [-0.7280,  1.4702],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1192, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3031, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0002, -0.0001],
        [ 0.0002, -0.0001],
        [ 0.0002, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6170, -2.6266],
        [-0.7280,  1.4703],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1244, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3049, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0002, -0.0002],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6170, -2.6266],
        [-0.7280,  1.4702],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.9419, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4686, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.2700e-04, -8.7448e-05],
        [ 1.5135e-04, -1.0343e-04],
        [ 1.4150e-04, -5.3520e-05],
        [ 1.3390e-04, -4.1518e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6729],
        [ 0.6171, -2.6266],
        [-0.7281,  1.4704],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.6939, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4225, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.7112e-04, -7.6460e-05],
        [ 1.6308e-04, -3.7462e-05],
        [ 1.6379e-04, -8.0267e-05],
        [ 1.8640e-04, -7.9588e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6729],
        [ 0.6171, -2.6265],
        [-0.7281,  1.4703],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2481, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1288, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4282e-04, -8.4972e-05],
        [ 1.3660e-04, -8.5465e-05],
        [ 1.4147e-04, -4.7684e-05],
        [ 1.3233e-04, -8.0664e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6729],
        [ 0.6171, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7175, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2182, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4976e-04, -9.0256e-05],
        [ 1.3973e-04, -4.6116e-05],
        [ 1.4522e-04, -7.7439e-05],
        [ 1.4180e-04, -8.6641e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6172, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.2889, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0446, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3469, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5121e-04, -4.1513e-05],
        [ 1.2385e-04, -5.7968e-05],
        [ 1.5288e-04, -4.9093e-05],
        [ 1.6524e-04, -3.1352e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6172, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.6303, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3945, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5776e-04, -7.6588e-05],
        [ 1.7580e-04, -1.0488e-04],
        [ 1.5875e-04, -7.9730e-05],
        [ 1.6981e-04, -5.3631e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6173, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4584, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0422, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1762, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5657e-04, -8.7144e-05],
        [ 1.3762e-04, -7.8251e-05],
        [ 1.2945e-04, -8.2743e-05],
        [ 1.5423e-04, -6.7512e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6172, -2.6265],
        [-0.7282,  1.4704],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0118, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0427, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0878, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5168e-04, -8.9500e-05],
        [ 1.4966e-04, -9.7426e-05],
        [ 1.6188e-04, -6.6009e-05],
        [ 1.5947e-04, -7.6722e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7281,  1.4704],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7492, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2283, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.3455e-04, -1.2765e-04],
        [ 1.4321e-04, -9.7112e-05],
        [ 1.4233e-04, -1.0702e-04],
        [ 1.5024e-04, -1.1201e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7282,  1.4704],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4175, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1514, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0868e-04, -5.3504e-05],
        [ 1.2981e-04, -5.1445e-05],
        [ 1.0275e-04, -2.0735e-05],
        [ 9.7895e-05, -6.4505e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7282,  1.4705],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.4240, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3655, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4846e-04, -2.3995e-05],
        [ 1.3345e-04, -5.7633e-05],
        [ 1.4733e-04, -3.6669e-05],
        [ 1.5512e-04, -4.3606e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7233, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2138, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 9.4429e-05, -1.6221e-05],
        [ 8.4566e-05, -1.4230e-05],
        [ 9.4344e-05, -1.0440e-05],
        [ 1.3741e-04, -8.7990e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7282,  1.4705],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0698, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0848, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 8.1305e-05, -3.8822e-05],
        [ 8.1489e-05, -2.8191e-05],
        [ 9.7860e-05, -5.8692e-06],
        [ 1.1453e-04, -2.5685e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.0466, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2838, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[9.9298e-05, 2.6780e-05],
        [8.9950e-05, 4.8198e-05],
        [1.0085e-04, 1.4831e-05],
        [1.0810e-04, 2.5518e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6733],
        [ 0.6174, -2.6264],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1865, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1190, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.7162e-05, -1.5063e-05],
        [ 6.8354e-05, -1.4126e-06],
        [ 7.7006e-05, -2.4690e-05],
        [ 9.1994e-05,  1.3652e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7282,  1.4705],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7753, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2298, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.0052e-04, 4.1043e-05],
        [1.1101e-04, 3.9825e-05],
        [7.5868e-05, 9.6631e-06],
        [8.1758e-05, 2.7253e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6733],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4705],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1714, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3085, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.1391e-04, 4.1887e-05],
        [9.0211e-05, 7.3334e-05],
        [5.7989e-05, 4.3984e-05],
        [8.9627e-05, 9.2418e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6733],
        [ 0.6175, -2.6264],
        [-0.7282,  1.4706],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7879, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0301, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.0474e-05, 1.6018e-05],
        [6.2098e-05, 4.7073e-05],
        [5.0423e-05, 5.4773e-05],
        [7.0345e-05, 4.5670e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6733],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5006, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0304, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1609, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.2167e-04, 5.8286e-05],
        [4.8371e-05, 7.1693e-05],
        [5.4479e-05, 6.5938e-05],
        [6.4024e-05, 4.0134e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5396, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0434, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1946, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.3871e-05, 4.5708e-05],
        [1.8091e-05, 4.9063e-05],
        [8.9771e-06, 2.6272e-05],
        [1.8904e-05, 6.4339e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2606, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9313, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.8406e-05, 5.5722e-05],
        [6.3905e-05, 7.4323e-05],
        [6.0189e-05, 5.8724e-05],
        [5.5931e-05, 1.9061e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8534, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2853, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1360, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.7874e-05, 3.7762e-05],
        [1.7474e-05, 1.0427e-05],
        [3.9565e-05, 2.4918e-05],
        [7.8470e-06, 4.7532e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6735],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8534, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1503, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9083, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.7182e-05, 5.9737e-05],
        [4.8595e-05, 4.6703e-05],
        [1.8957e-05, 4.2581e-05],
        [2.5406e-05, 3.6533e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6735],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8534, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2818, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1369, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[8.6351e-05, 9.1736e-05],
        [6.5662e-05, 9.2641e-05],
        [5.2409e-05, 9.2409e-05],
        [7.2278e-05, 1.2269e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6736],
        [ 0.6176, -2.6265],
        [-0.7282,  1.4707],
        [-0.8533, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.6125, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1924, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.6472e-05, 1.2248e-05],
        [2.7291e-05, 4.6665e-05],
        [6.9065e-05, 1.8862e-05],
        [2.3761e-05, 3.4476e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6735],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3854, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0309, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9388, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[8.5393e-05, 1.9372e-05],
        [5.6121e-05, 1.8679e-05],
        [2.6203e-05, 1.1883e-05],
        [5.6814e-05, 1.7044e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6736],
        [ 0.6176, -2.6266],
        [-0.7282,  1.4706],
        [-0.8532, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3371, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1426, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 4.1072e-05,  2.7307e-05],
        [ 1.2987e-06,  2.5210e-05],
        [-4.4059e-06,  1.4593e-05],
        [-1.5016e-05,  3.4066e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6736],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4287, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1580, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.9299e-06,  2.7953e-05],
        [ 2.5581e-06, -3.2947e-05],
        [ 8.1300e-06,  1.6473e-05],
        [-1.0424e-05,  1.0513e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6736],
        [ 0.6176, -2.6267],
        [-0.7282,  1.4706],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7881, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0274, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.4368e-06,  3.6361e-05],
        [-3.8835e-05,  1.0637e-05],
        [-4.6720e-07,  3.5811e-05],
        [-2.4683e-05,  4.6322e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6736],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2848, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1393, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[6.4519e-05, 4.6498e-05],
        [2.5101e-05, 3.1328e-05],
        [5.4606e-05, 6.7548e-05],
        [4.3998e-05, 4.4741e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0866, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0857, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.8796e-05, 7.1496e-05],
        [3.5477e-05, 5.1520e-05],
        [2.7479e-05, 5.2851e-05],
        [1.3100e-05, 7.4039e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2503, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0432, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9364, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.3982e-05, 1.8790e-05],
        [1.4413e-05, 2.6133e-05],
        [2.0221e-05, 4.2654e-05],
        [6.5869e-06, 3.5257e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4099, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1518, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.0915e-05, 5.9727e-05],
        [4.3155e-05, 6.2341e-05],
        [5.4947e-05, 6.0180e-05],
        [5.6286e-05, 7.8168e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6738],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4575, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0471, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9858, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.5167e-05, 5.2311e-05],
        [3.9794e-06, 3.2301e-05],
        [1.5315e-05, 6.2957e-05],
        [2.5229e-05, 5.2504e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6738],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8529, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.0594, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2904, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.8755e-05, 7.9065e-05],
        [1.0309e-04, 4.5275e-05],
        [6.2603e-05, 5.1964e-05],
        [1.0320e-04, 1.0468e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6739],
        [ 0.6177, -2.6266],
        [-0.7281,  1.4706],
        [-0.8528, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7938, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0482, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2553, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.3836e-05, 1.0778e-04],
        [1.9349e-05, 1.5231e-04],
        [1.7726e-05, 9.7542e-05],
        [4.6940e-05, 1.4535e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6739],
        [ 0.6176, -2.6265],
        [-0.7281,  1.4707],
        [-0.8529, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.9963, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0744, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.2623e-05, -4.1183e-05],
        [ 6.7137e-05,  1.2945e-05],
        [ 4.6544e-05, -3.1502e-05],
        [ 4.4118e-05, -1.2978e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6738],
        [ 0.6177, -2.6267],
        [-0.7281,  1.4706],
        [-0.8529, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4195, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1566, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.3448e-05,  1.6960e-05],
        [ 2.4927e-05, -1.9914e-05],
        [ 3.0930e-05, -2.9423e-05],
        [ 7.8924e-06, -4.4317e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6739],
        [ 0.6176, -2.6267],
        [-0.7281,  1.4706],
        [-0.8529, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2152, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9214, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.6974e-05, 5.8105e-05],
        [5.5056e-05, 3.2761e-05],
        [4.1275e-05, 6.6467e-05],
        [5.2425e-05, 7.7024e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6740],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4707],
        [-0.8528, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1430, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0998, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 3.1424e-05,  1.2719e-05],
        [ 3.5213e-05, -1.4454e-05],
        [ 4.2315e-05, -4.9032e-07],
        [-2.9819e-06,  1.8995e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6740],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4706],
        [-0.8529, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0154, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8791, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.9176e-05, 2.7978e-05],
        [4.6310e-05, 5.3465e-05],
        [4.9715e-05, 3.8903e-05],
        [3.2385e-05, 3.7395e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6740],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2147, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9242, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.6555e-05, 6.6079e-05],
        [1.4532e-05, 6.9524e-05],
        [2.2786e-05, 3.2561e-05],
        [1.5300e-05, 1.3669e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6741],
        [ 0.6176, -2.6266],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3926, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9528, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.7557e-05, -1.0517e-05],
        [ 5.0270e-05,  4.1929e-06],
        [ 4.7633e-05, -9.2667e-06],
        [ 3.5859e-05,  3.7827e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6741],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5090, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9817, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.3907e-05, 1.1329e-04],
        [2.2882e-05, 9.9721e-05],
        [5.6646e-05, 8.8662e-05],
        [1.0596e-05, 7.7005e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6743],
        [ 0.6175, -2.6266],
        [-0.7279,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3659, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1541, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.9171e-05, 4.0528e-05],
        [3.6634e-05, 1.9158e-05],
        [7.2306e-05, 3.4576e-06],
        [3.7658e-05, 2.9807e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6742],
        [ 0.6175, -2.6267],
        [-0.7279,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.9802, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0821, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.4048e-05, -3.2332e-05],
        [-3.0138e-05, -3.6779e-06],
        [-3.4058e-05, -1.1594e-05],
        [-3.5830e-05,  1.8422e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6742],
        [ 0.6174, -2.6267],
        [-0.7280,  1.4708],
        [-0.8529, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9921, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8774, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.5299e-06,  2.4802e-05],
        [ 1.8582e-05,  5.2390e-06],
        [-1.4757e-05, -2.3106e-05],
        [ 1.5127e-05,  5.3508e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6743],
        [ 0.6175, -2.6267],
        [-0.7280,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3395, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0445, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9570, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.7627e-05, -8.5400e-06],
        [ 4.7568e-05,  1.9485e-05],
        [ 2.0423e-05, -1.5800e-05],
        [ 1.9107e-05,  1.5935e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6743],
        [ 0.6175, -2.6267],
        [-0.7279,  1.4708],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5595, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9877, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2199e-05,  9.6748e-05],
        [-4.5015e-06,  9.5695e-05],
        [-2.2809e-05,  6.4330e-05],
        [ 3.2533e-05,  6.0449e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6745],
        [ 0.6174, -2.6266],
        [-0.7280,  1.4709],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3576, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1491, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3230e-06,  5.1962e-05],
        [ 2.1602e-05,  2.5708e-05],
        [ 1.9300e-05,  4.3103e-05],
        [-3.7015e-06,  5.2685e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4709],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7491, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8261, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.9159e-05, 4.8868e-05],
        [2.8087e-05, 9.0515e-05],
        [4.5324e-05, 5.5380e-05],
        [3.8496e-06, 2.5898e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.9081, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0634, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7625e-06, -1.4513e-05],
        [ 1.8099e-05,  2.9104e-05],
        [-1.6194e-05,  1.1365e-06],
        [ 3.8010e-05,  2.1815e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7482, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2333, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.2292e-05, 6.3782e-05],
        [1.3386e-05, 4.9257e-05],
        [5.9259e-06, 2.1451e-05],
        [1.2179e-05, 7.8645e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6746],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5002, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9760, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.4100e-05, 7.8507e-05],
        [3.9374e-05, 1.6460e-05],
        [4.0934e-05, 6.1851e-05],
        [3.0528e-05, 5.6430e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6746],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.6197, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9996, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.0212e-05, 9.3403e-05],
        [3.2305e-05, 9.7801e-05],
        [6.9576e-05, 5.8845e-05],
        [3.8156e-05, 8.8354e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6747],
        [ 0.6174, -2.6267],
        [-0.7278,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5817, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9990, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.1483e-05, 8.3446e-05],
        [5.3314e-05, 7.7000e-05],
        [1.0135e-05, 6.2781e-05],
        [6.7924e-05, 9.2702e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6747],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7089, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0118, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.3211e-05, -2.6911e-05],
        [-5.9869e-06,  7.1276e-05],
        [ 7.2622e-06, -2.2008e-05],
        [ 2.9803e-06, -4.4669e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6747],
        [ 0.6173, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2141, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0286, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1001, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.5594e-05,  2.5579e-05],
        [-6.4128e-05,  3.5433e-05],
        [-5.0794e-05,  6.2903e-05],
        [-2.1510e-05,  5.0702e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6748],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.6783, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0030, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.6559e-05,  1.4978e-06],
        [-2.1978e-05,  4.6464e-05],
        [-5.0403e-05,  1.1971e-05],
        [-2.1934e-05,  4.0378e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6748],
        [ 0.6173, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5976, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9951, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.4378e-05, -2.6570e-05],
        [-1.5161e-05,  9.0722e-06],
        [-1.8231e-05, -1.9961e-05],
        [-2.2618e-05,  2.4910e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6748],
        [ 0.6173, -2.6268],
        [-0.7279,  1.4710],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6209, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8034, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.8799e-05,  3.7970e-05],
        [-4.0382e-06, -2.4925e-05],
        [ 1.4548e-05,  4.5573e-05],
        [ 2.7145e-06,  1.2890e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6749],
        [ 0.6173, -2.6268],
        [-0.7278,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1600, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9015, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.9189e-06,  4.5039e-05],
        [-4.5987e-05,  3.4406e-05],
        [-3.1058e-05,  4.0434e-05],
        [-1.5232e-05,  6.5668e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6749],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.8424, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0405, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1571e-05,  5.1558e-05],
        [-3.1309e-05,  2.4671e-05],
        [-2.2460e-05,  4.8055e-06],
        [-4.6005e-05,  1.1383e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6750],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3582, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9544, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.1464e-05,  5.2677e-05],
        [-7.8804e-05,  7.0305e-05],
        [-3.4351e-05,  8.6763e-05],
        [-2.9286e-05,  3.4977e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6750],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4712],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1590, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1099, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.8821e-05,  3.6889e-05],
        [-4.7499e-05,  3.7725e-05],
        [-6.0897e-05,  2.0507e-05],
        [-3.1140e-05,  7.1956e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6750],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5981, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1910, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 2.1246e-05, -3.4045e-05],
        [-5.2271e-06, -1.2688e-05],
        [-1.1602e-05,  2.1735e-05],
        [ 3.6081e-05,  2.6807e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6750],
        [ 0.6172, -2.6268],
        [-0.7278,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7154, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8189, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0736e-05,  1.8143e-06],
        [-2.0615e-05,  4.8900e-05],
        [ 2.4119e-05,  1.5975e-05],
        [-5.8196e-06,  1.5671e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6751],
        [ 0.6172, -2.6267],
        [-0.7277,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1567, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9020, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1853e-05, -1.3190e-05],
        [-4.5970e-05, -1.7828e-05],
        [-7.0348e-05, -2.1211e-05],
        [-2.8944e-05, -3.7782e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6751],
        [ 0.6172, -2.6268],
        [-0.7278,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3479, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9439, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4516e-04,  1.5871e-05],
        [-1.1404e-04,  2.5637e-05],
        [-1.2774e-04,  8.6196e-05],
        [-1.1180e-04,  4.1600e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6752],
        [ 0.6171, -2.6267],
        [-0.7278,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5673, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9879, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.6399e-05, -6.8907e-06],
        [-4.5546e-05,  6.9476e-06],
        [-6.2613e-05, -2.3700e-05],
        [-6.2510e-05,  1.1300e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6752],
        [ 0.6172, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5533, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9927, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.4858e-05, -1.9055e-05],
        [-3.5329e-05,  5.8667e-06],
        [-8.9839e-05, -8.9985e-05],
        [-6.9253e-05, -3.9618e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6752],
        [ 0.6172, -2.6267],
        [-0.7278,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1119, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8959, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1221e-04, -2.6756e-05],
        [-6.0426e-05, -1.3969e-05],
        [-5.2007e-05, -7.8087e-05],
        [-6.4161e-05, -2.8111e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6753],
        [ 0.6171, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.8919, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8603, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.1384e-05, -2.7165e-05],
        [-8.9648e-05, -6.5848e-05],
        [-3.0781e-05, -2.4770e-05],
        [-3.6445e-05, -4.5008e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6753],
        [ 0.6171, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1984, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9064, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1774e-04, -6.0295e-05],
        [-1.1505e-04, -7.7634e-05],
        [-1.6598e-04, -6.9055e-05],
        [-1.0317e-04, -1.4658e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6753],
        [ 0.6170, -2.6268],
        [-0.7278,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7579, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0275, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.6355e-05, -9.8530e-05],
        [-6.1070e-05, -6.5322e-05],
        [-1.0037e-04, -7.8411e-05],
        [-8.7842e-05, -8.7042e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6754],
        [ 0.6171, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2805, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9350, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.6501e-05, -2.1353e-05],
        [-5.5941e-05, -4.7139e-05],
        [-6.7276e-05, -5.5649e-05],
        [-8.9423e-05, -2.1422e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6755],
        [ 0.6171, -2.6267],
        [-0.7276,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1078, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0956, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.6699e-05, -6.5058e-05],
        [-5.2635e-05, -9.1258e-06],
        [-3.1804e-05, -2.5780e-05],
        [-1.6864e-05, -3.0778e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6755],
        [ 0.6171, -2.6267],
        [-0.7276,  1.4712],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2263, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1187, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:100, loss: 0.011187, Time: 40.5
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.4120e-05, -1.1033e-04],
        [-1.0664e-04, -4.2361e-05],
        [-1.1179e-04, -5.8959e-05],
        [-1.6348e-04, -2.2859e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6755],
        [ 0.6170, -2.6267],
        [-0.7276,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4026, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9542, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.2556e-05, -9.8337e-05],
        [-9.0018e-05, -1.1617e-04],
        [-7.3076e-05, -3.7239e-05],
        [-7.6537e-05, -1.0287e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6756],
        [ 0.6170, -2.6268],
        [-0.7275,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7860, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0252, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.7887e-05, -1.3263e-06],
        [-1.2987e-04,  2.5056e-05],
        [-7.4631e-05, -2.6831e-05],
        [-5.7721e-05, -1.7977e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6757],
        [ 0.6170, -2.6266],
        [-0.7275,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4649, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7668, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.2685e-05, -9.2554e-05],
        [-5.1225e-05, -3.1376e-05],
        [-5.2683e-05, -6.8419e-05],
        [-8.1654e-05, -7.1867e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6757],
        [ 0.6171, -2.6267],
        [-0.7275,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6425, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7989, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.0236e-05, -1.2104e-04],
        [-7.6452e-05, -8.2275e-05],
        [-2.3053e-05, -5.5117e-05],
        [-3.4466e-05, -8.7477e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6757],
        [ 0.6170, -2.6267],
        [-0.7274,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7392, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8219, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.8295e-05, -1.3560e-04],
        [-2.8719e-05, -1.2322e-04],
        [-2.4016e-05, -1.4147e-04],
        [-1.5320e-05, -1.5165e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6758],
        [ 0.6171, -2.6268],
        [-0.7274,  1.4711],
        [-0.8529, -2.7502]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5279, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1820, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.5194e-05, -6.1786e-05],
        [-6.2718e-07, -7.0512e-05],
        [-2.0735e-05, -3.7371e-05],
        [-4.3058e-05, -5.1511e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6759],
        [ 0.6172, -2.6267],
        [-0.7274,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7108, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8237, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.5413e-05, -1.0206e-04],
        [-8.2399e-05, -1.5860e-04],
        [-1.2045e-04, -1.2543e-04],
        [-1.0377e-04, -1.2851e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6759],
        [ 0.6171, -2.6268],
        [-0.7274,  1.4711],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3880, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7607, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0278e-04, -7.9762e-05],
        [-8.0597e-05, -1.3409e-04],
        [-7.4782e-05, -1.7662e-04],
        [-7.8372e-05, -1.4905e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6760],
        [ 0.6171, -2.6268],
        [-0.7274,  1.4711],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7577, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6323, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5612e-04, -1.2496e-04],
        [-1.4781e-04, -6.8880e-05],
        [-1.1527e-04, -1.2663e-04],
        [-1.3514e-04, -8.8610e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6760],
        [ 0.6171, -2.6267],
        [-0.7274,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.8164, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0455, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.8858e-05,  1.8205e-05],
        [-5.8044e-05, -1.5160e-05],
        [-4.5635e-05, -6.2210e-06],
        [-4.3242e-05, -3.3024e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6762],
        [ 0.6172, -2.6267],
        [-0.7273,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7971, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8331, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.2005e-05, -6.6937e-05],
        [-7.8270e-05, -3.9498e-05],
        [-9.1140e-05, -6.6897e-05],
        [-4.9540e-05, -4.4910e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6761],
        [ 0.6172, -2.6267],
        [-0.7273,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9100, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8543, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.0265e-05, -1.0489e-05],
        [-7.8946e-05, -3.7841e-05],
        [-1.0986e-04, -6.8988e-05],
        [-9.7700e-05, -3.2280e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6762],
        [ 0.6172, -2.6267],
        [-0.7274,  1.4712],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4972, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9780, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.9960e-05, -1.2250e-04],
        [-1.7737e-05, -7.1677e-05],
        [-3.5972e-06, -1.0627e-04],
        [-6.5649e-05, -1.3336e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6762],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0016, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8751, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2995e-04, -1.1189e-04],
        [-1.1913e-04, -5.0953e-05],
        [-9.7465e-05, -5.7712e-05],
        [-1.0720e-04, -6.9381e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6762],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4712],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.8263, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8354, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.9102e-05, -7.3550e-05],
        [-5.2196e-05, -3.1110e-05],
        [-5.4197e-05, -8.2321e-05],
        [-6.2106e-05, -1.3143e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6763],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.8179, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8352, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.0429e-05, -7.9823e-05],
        [-2.4579e-05, -9.0477e-05],
        [-1.4717e-05, -1.9171e-05],
        [-4.7516e-05, -5.6014e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6764],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2756, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9234, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1397e-04, -1.4356e-04],
        [-9.7222e-05, -1.0118e-04],
        [-1.0229e-04, -1.2844e-04],
        [-9.9012e-05, -1.7481e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6764],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0425, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8895, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.7237e-05, -5.9724e-05],
        [ 3.7753e-05, -3.3867e-05],
        [-1.9791e-05, -4.6898e-05],
        [-1.6119e-05, -6.7832e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6765],
        [ 0.6174, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0468, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8878, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.8385e-05, -8.9152e-05],
        [-1.8025e-05, -1.4977e-05],
        [-1.3573e-05, -4.9514e-05],
        [-5.8471e-06, -2.7965e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6765],
        [ 0.6173, -2.6268],
        [-0.7271,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5414, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9891, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.6360e-05, -7.1490e-05],
        [-1.0474e-04, -8.3160e-05],
        [-1.1899e-04, -6.6409e-05],
        [-8.8982e-05, -2.0073e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6766],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0969, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7012, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.2716e-05, -2.8654e-05],
        [-9.9352e-05, -4.4447e-05],
        [-8.5785e-05, -1.4619e-05],
        [-8.3863e-05, -7.4088e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6767],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3682, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0434, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9604, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1644e-04, -2.9333e-05],
        [-1.3433e-04, -5.8072e-05],
        [-1.2611e-04, -1.3260e-04],
        [-1.1978e-04, -1.2746e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6767],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4711],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7348, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8347, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5471e-04, -1.0277e-04],
        [-2.0983e-04, -1.3207e-04],
        [-2.1017e-04, -3.3738e-05],
        [-2.0592e-04, -1.0716e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6767],
        [ 0.6172, -2.6269],
        [-0.7273,  1.4712],
        [-0.8532, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7320, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8184, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.4255e-05, -6.9460e-05],
        [-1.6138e-04, -1.1792e-04],
        [-9.0597e-05, -8.3050e-05],
        [-1.2788e-04, -1.0289e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6767],
        [ 0.6173, -2.6269],
        [-0.7272,  1.4711],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2855, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0424, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7420, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1960e-04, -5.6167e-05],
        [-1.0748e-04, -2.5772e-06],
        [-1.1171e-04, -5.4155e-05],
        [-1.0127e-04, -9.3709e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6768],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4711],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7606, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0428, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6378, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6428e-04, -7.3466e-05],
        [-1.5642e-04, -1.4464e-04],
        [-1.8058e-04, -5.6045e-05],
        [-1.6971e-04, -9.1628e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6768],
        [ 0.6173, -2.6269],
        [-0.7273,  1.4712],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6100, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8044, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6776e-04, -5.1747e-05],
        [-2.1242e-04, -1.0965e-04],
        [-2.1020e-04, -6.2512e-05],
        [-1.2530e-04, -4.5039e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6769],
        [ 0.6172, -2.6269],
        [-0.7273,  1.4712],
        [-0.8530, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3277, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7424, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2090e-04, -9.6726e-05],
        [-1.2734e-04, -1.1007e-04],
        [-1.2610e-04, -7.7026e-05],
        [-1.3757e-04, -1.0983e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6768],
        [ 0.6173, -2.6269],
        [-0.7272,  1.4711],
        [-0.8530, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1456, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8997, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9145e-04, -9.1108e-05],
        [-2.0558e-04, -6.8692e-05],
        [-2.1541e-04, -7.1309e-05],
        [-2.0793e-04, -9.4553e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6769],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4712],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7196, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6178, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0499e-04, -1.2841e-04],
        [-1.7952e-04, -8.7122e-05],
        [-1.7401e-04, -4.5601e-05],
        [-1.4790e-04, -7.2029e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6769],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4712],
        [-0.8530, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7445, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0451, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8390, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7372e-04,  1.3602e-05],
        [-1.9528e-04,  3.2879e-05],
        [-1.4854e-04, -3.9963e-05],
        [-1.8201e-04,  1.4571e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6770],
        [ 0.6173, -2.6267],
        [-0.7272,  1.4712],
        [-0.8531, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2938, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7336, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5976e-04, -2.0656e-05],
        [-1.5283e-04,  8.7827e-05],
        [-1.9466e-04,  2.3197e-05],
        [-1.2775e-04,  1.5908e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6770],
        [ 0.6174, -2.6267],
        [-0.7273,  1.4713],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0665, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6891, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0542e-04,  1.6433e-05],
        [-7.5978e-05,  1.2658e-05],
        [-1.4505e-04,  1.9670e-05],
        [-8.2459e-05, -1.9972e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6771],
        [ 0.6175, -2.6267],
        [-0.7272,  1.4713],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5870, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8002, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4937e-04,  5.5464e-06],
        [-1.1822e-04,  6.0334e-06],
        [-1.1301e-04, -3.7607e-05],
        [-1.1974e-04, -1.9398e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6771],
        [ 0.6174, -2.6267],
        [-0.7272,  1.4712],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5942, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0005, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.0421e-04,  2.3174e-05],
        [-2.5072e-04,  4.5986e-05],
        [-2.2902e-04, -4.7527e-05],
        [-2.9578e-04,  4.2956e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6772],
        [ 0.6173, -2.6267],
        [-0.7273,  1.4712],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2836, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7275, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5960e-04, -5.6063e-05],
        [-1.6964e-04, -8.1547e-05],
        [-1.4133e-04, -9.5693e-05],
        [-1.3993e-04, -5.2235e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6771],
        [ 0.6174, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4379, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7594, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8944e-04, -4.0045e-05],
        [-1.7950e-04, -3.3617e-05],
        [-1.9700e-04, -6.7930e-05],
        [-1.4257e-04, -4.1300e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6772],
        [ 0.6174, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1315, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0315, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6893, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2646e-04, -3.9022e-05],
        [-2.5367e-04, -1.0008e-04],
        [-2.8522e-04, -6.2098e-05],
        [-2.3824e-04, -1.1050e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6772],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4712],
        [-0.8531, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0620, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6841, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1831e-04, -6.1335e-05],
        [-2.2753e-04, -5.2625e-05],
        [-2.3784e-04, -9.9633e-05],
        [-2.2364e-04, -6.3556e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6772],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4712],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9115, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6588, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9117e-04,  2.0154e-05],
        [-2.3784e-04,  1.1240e-05],
        [-1.8946e-04, -5.4990e-05],
        [-2.4891e-04, -1.3526e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6773],
        [ 0.6173, -2.6267],
        [-0.7272,  1.4713],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5879, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8004, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7956e-04, -8.1521e-05],
        [-2.2183e-04, -4.2380e-05],
        [-1.7156e-04, -1.3566e-04],
        [-2.0529e-04, -7.7829e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6772],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2401, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9295, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2117e-04, -3.0608e-05],
        [-3.3776e-04, -6.2090e-05],
        [-3.1934e-04,  1.4039e-05],
        [-2.1607e-04, -4.4184e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6773],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4713],
        [-0.8530, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3424, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7404, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5296e-04, -4.2693e-05],
        [-2.5779e-04, -2.9315e-05],
        [-2.7429e-04,  2.9126e-05],
        [-2.7807e-04, -9.1925e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6773],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4714],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5383, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5768, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.4816e-04, -7.8970e-05],
        [-2.6989e-04,  5.2134e-05],
        [-2.2437e-04, -6.3142e-05],
        [-1.8711e-04, -3.4675e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6773],
        [ 0.6173, -2.6267],
        [-0.7272,  1.4713],
        [-0.8530, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0472, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8765, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.6907e-04,  1.0218e-04],
        [-2.1958e-04,  5.4981e-05],
        [-1.6756e-04,  3.2620e-05],
        [-2.2495e-04,  6.5922e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6775],
        [ 0.6173, -2.6267],
        [-0.7272,  1.4714],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9639, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6740, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9016e-04,  4.7381e-05],
        [-2.4676e-04,  1.0615e-04],
        [-2.8797e-04,  6.5297e-05],
        [-2.2339e-04,  7.0979e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6775],
        [ 0.6173, -2.6266],
        [-0.7273,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0048, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8762, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.2240e-04, -3.7548e-05],
        [-3.7135e-04, -5.9285e-05],
        [-3.3437e-04, -3.8321e-05],
        [-3.3699e-04, -9.2466e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6775],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4713],
        [-0.8531, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3264, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7335, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9758e-04, -1.1370e-04],
        [-3.3796e-04, -6.3306e-05],
        [-2.7970e-04, -5.0100e-05],
        [-3.4574e-04, -1.9775e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6774],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4713],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9223, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6614, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9073e-04, -6.8646e-05],
        [-2.9804e-04, -6.9965e-05],
        [-3.1199e-04, -4.2842e-05],
        [-2.5303e-04, -3.8496e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6775],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4713],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  33
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1817, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7079, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2027e-04, -6.9914e-05],
        [-2.5949e-04, -4.1423e-05],
        [-2.4804e-04, -1.0045e-04],
        [-2.3576e-04, -1.0612e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6776],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4713],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9121, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0312, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6448, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5981e-04,  1.1138e-05],
        [-2.2879e-04,  2.2236e-05],
        [-2.5121e-04,  6.3318e-06],
        [-2.3742e-04, -9.8258e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6777],
        [ 0.6174, -2.6267],
        [-0.7272,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1578, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9061, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.5127e-04, -5.7106e-05],
        [-2.4977e-04,  4.5086e-06],
        [-3.5841e-04, -4.0861e-05],
        [-3.0977e-04, -2.6498e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6777],
        [ 0.6174, -2.6267],
        [-0.7273,  1.4713],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0593, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0482, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7083, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0003, -0.0001],
        [-0.0003, -0.0001],
        [-0.0003, -0.0002],
        [-0.0003, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6776],
        [ 0.6173, -2.6269],
        [-0.7273,  1.4712],
        [-0.8531, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2030, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7107, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1198e-04, -3.3598e-05],
        [-3.8920e-04, -1.5607e-04],
        [-4.1672e-04, -3.4990e-05],
        [-3.2241e-04, -8.0987e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6777],
        [ 0.6172, -2.6269],
        [-0.7274,  1.4714],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6994, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6134, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0003, -0.0002],
        [-0.0003, -0.0001],
        [-0.0003, -0.0002],
        [-0.0003, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6776],
        [ 0.6173, -2.6269],
        [-0.7273,  1.4713],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4477, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7622, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.0151e-04, -1.0172e-04],
        [-4.0371e-04, -9.0434e-05],
        [-3.9105e-04, -1.6674e-04],
        [-4.2648e-04, -1.0529e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6777],
        [ 0.6173, -2.6268],
        [-0.7274,  1.4713],
        [-0.8532, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.8457, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6492, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5226e-04, -5.5740e-05],
        [-3.1364e-04, -5.2424e-05],
        [-2.9703e-04, -1.1313e-04],
        [-2.6175e-04, -9.8489e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6778],
        [ 0.6174, -2.6268],
        [-0.7273,  1.4713],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2648, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7365, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.7563e-04, -1.2530e-04],
        [-4.1299e-04, -1.1997e-04],
        [-2.9162e-04, -7.2786e-05],
        [-3.7490e-04, -1.1699e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6778],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4714],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9824, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6755, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.9386e-04, -3.3556e-06],
        [-2.7684e-04, -1.0753e-04],
        [-3.5122e-04, -2.5354e-05],
        [-3.6606e-04, -5.7096e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6780],
        [ 0.6175, -2.6268],
        [-0.7273,  1.4715],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1030, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9026, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.2308e-04, -6.9616e-05],
        [-3.1928e-04, -5.7072e-05],
        [-2.6984e-04, -5.5428e-05],
        [-3.1653e-04, -1.9976e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6780],
        [ 0.6175, -2.6267],
        [-0.7272,  1.4715],
        [-0.8530, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5506, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7914, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0004, -0.0002],
        [-0.0004, -0.0002],
        [-0.0004, -0.0001],
        [-0.0003, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6779],
        [ 0.6174, -2.6268],
        [-0.7273,  1.4715],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7286, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6197, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.6915e-04, -1.3271e-04],
        [-2.3821e-04, -4.9345e-05],
        [-3.3049e-04, -6.8028e-05],
        [-3.3856e-04, -2.2663e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6780],
        [ 0.6176, -2.6267],
        [-0.7273,  1.4716],
        [-0.8531, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6936, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8246, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0004, -0.0002],
        [-0.0004, -0.0002],
        [-0.0004, -0.0002],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6781],
        [ 0.6175, -2.6268],
        [-0.7273,  1.4715],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9862, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6809, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.0053e-04, -3.4179e-05],
        [-4.9610e-04, -7.9435e-05],
        [-4.8190e-04, -4.3822e-05],
        [-4.7000e-04, -9.0289e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6783],
        [ 0.6174, -2.6267],
        [-0.7275,  1.4717],
        [-0.8532, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4548, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9630, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0005, -0.0002],
        [-0.0006, -0.0003],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6782],
        [ 0.6174, -2.6268],
        [-0.7276,  1.4715],
        [-0.8532, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9109, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4582, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2429e-04, -8.4314e-05],
        [-4.2666e-04, -8.5750e-05],
        [-4.9980e-04, -6.9233e-05],
        [-4.0944e-04, -7.7142e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6784],
        [ 0.6175, -2.6267],
        [-0.7275,  1.4718],
        [-0.8532, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5614, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5839, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.3042e-04, -1.1825e-04],
        [-4.6675e-04, -1.4272e-04],
        [-3.3717e-04, -8.2566e-05],
        [-4.1011e-04, -1.4993e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6784],
        [ 0.6175, -2.6267],
        [-0.7273,  1.4718],
        [-0.8532, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5946, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7910, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0001],
        [-0.0006, -0.0002],
        [-0.0006, -0.0001],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6785],
        [ 0.6174, -2.6267],
        [-0.7276,  1.4718],
        [-0.8533, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9915, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8713, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0001],
        [-0.0007, -0.0002],
        [-0.0006, -0.0002],
        [-0.0005, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6785],
        [ 0.6173, -2.6267],
        [-0.7276,  1.4718],
        [-0.8533, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4729, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5769, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0005, -0.0001],
        [-0.0005, -0.0002],
        [-0.0005, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6786],
        [ 0.6175, -2.6266],
        [-0.7275,  1.4719],
        [-0.8533, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2611, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7269, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0005, -0.0001],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6785],
        [ 0.6175, -2.6266],
        [-0.7275,  1.4719],
        [-0.8533, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1941, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7133, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6787],
        [ 0.6175, -2.6267],
        [-0.7275,  1.4720],
        [-0.8533, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4090, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0314, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7446, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0003],
        [-0.0005, -0.0002],
        [-0.0005, -0.0001],
        [-0.0005, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6787],
        [ 0.6175, -2.6267],
        [-0.7275,  1.4721],
        [-0.8533, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3880, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5523, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.8153e-04, -1.1610e-04],
        [-5.5559e-04, -1.0061e-04],
        [-5.8522e-04, -9.4719e-05],
        [-4.9188e-04, -8.6608e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6789],
        [ 0.6175, -2.6266],
        [-0.7276,  1.4721],
        [-0.8533, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4522, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5671, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0003],
        [-0.0007, -0.0003],
        [-0.0008, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6788],
        [ 0.6173, -2.6268],
        [-0.7277,  1.4720],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2384, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7193, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0006, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6789],
        [ 0.6174, -2.6267],
        [-0.7276,  1.4721],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1455, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7054, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0004, -0.0001],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6789],
        [ 0.6176, -2.6266],
        [-0.7275,  1.4722],
        [-0.8533, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3201, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5434, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0003],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6790],
        [ 0.6174, -2.6267],
        [-0.7276,  1.4721],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4262, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5659, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0008, -0.0002],
        [-0.0007, -0.0003],
        [-0.0008, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6791],
        [ 0.6173, -2.6267],
        [-0.7277,  1.4721],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0090, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6775, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0003],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6791],
        [ 0.6174, -2.6267],
        [-0.7276,  1.4722],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4100, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5579, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0007, -0.0002],
        [-0.0006, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6792],
        [ 0.6174, -2.6267],
        [-0.7275,  1.4723],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4394, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7690, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0003],
        [-0.0008, -0.0003],
        [-0.0008, -0.0003],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6791],
        [ 0.6173, -2.6268],
        [-0.7278,  1.4722],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6580, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0326, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5969, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0008, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6793],
        [ 0.6174, -2.6267],
        [-0.7277,  1.4723],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5394, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5894, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0006, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6793],
        [ 0.6175, -2.6267],
        [-0.7275,  1.4723],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1513, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5030, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0003],
        [-0.0007, -0.0003],
        [-0.0007, -0.0003],
        [-0.0008, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6793],
        [ 0.6175, -2.6269],
        [-0.7277,  1.4722],
        [-0.8536, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8422, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4483, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0003],
        [-0.0006, -0.0003],
        [-0.0007, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6794],
        [ 0.6177, -2.6268],
        [-0.7277,  1.4724],
        [-0.8534, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4502, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7714, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0006, -0.0001],
        [-0.0005, -0.0001],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6795],
        [ 0.6177, -2.6267],
        [-0.7275,  1.4725],
        [-0.8534, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5260, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5798, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0006, -0.0002],
        [-0.0006, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6795],
        [ 0.6177, -2.6267],
        [-0.7276,  1.4725],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2306, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5171, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0008, -0.0002],
        [-0.0008, -0.0003],
        [-0.0008, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6795],
        [ 0.6176, -2.6268],
        [-0.7278,  1.4724],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7320, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4134, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0009, -0.0002],
        [-0.0008, -0.0002],
        [-0.0010, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6796],
        [ 0.6175, -2.6268],
        [-0.7279,  1.4724],
        [-0.8538, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9211, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6620, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0008, -0.0002],
        [-0.0007, -0.0001],
        [-0.0008, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6797],
        [ 0.6176, -2.6268],
        [-0.7278,  1.4725],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9915, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6765, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0010, -0.0002],
        [-0.0010, -0.0002],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6796],
        [ 0.6174, -2.6267],
        [-0.7281,  1.4725],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3851, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5520, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0002],
        [-0.0011, -0.0002],
        [-0.0010, -0.0003],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6797],
        [ 0.6174, -2.6268],
        [-0.7281,  1.4725],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3458, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5520, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0003],
        [-0.0008, -0.0003],
        [-0.0009, -0.0004],
        [-0.0010, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6797],
        [ 0.6178, -2.6268],
        [-0.7280,  1.4724],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7725, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6235, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0001],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0008, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6799],
        [ 0.6179, -2.6267],
        [-0.7279,  1.4726],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6271, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6018, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0010, -0.0002],
        [-0.0009, -0.0001],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6799],
        [ 0.6176, -2.6267],
        [-0.7281,  1.4726],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7278, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6242, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.5402e-04, -7.8620e-05],
        [-8.2256e-04, -1.6183e-05],
        [-9.1816e-04, -6.1420e-05],
        [-9.7340e-04, -6.5988e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6800],
        [ 0.6178, -2.6266],
        [-0.7281,  1.4727],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7247, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6203, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0009, -0.0002],
        [-0.0009, -0.0002],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6799],
        [ 0.6177, -2.6267],
        [-0.7281,  1.4726],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6313, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6053, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0002],
        [-0.0008, -0.0002],
        [-0.0009, -0.0002],
        [-0.0008, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6799],
        [ 0.6179, -2.6267],
        [-0.7282,  1.4727],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2836, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5262, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:200, loss: 0.002631, Time: 77.7
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0003],
        [-0.0011, -0.0003],
        [-0.0009, -0.0003],
        [-0.0010, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6798],
        [ 0.6177, -2.6268],
        [-0.7282,  1.4726],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5492, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0432, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5962, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0001],
        [-0.0010, -0.0002],
        [-0.0011, -0.0002],
        [-0.0011, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6800],
        [ 0.6177, -2.6267],
        [-0.7283,  1.4726],
        [-0.8539, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0078, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4799, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0001],
        [-0.0009, -0.0003],
        [-0.0009, -0.0001],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6800],
        [ 0.6178, -2.6268],
        [-0.7282,  1.4727],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7591, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6304, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.0066e-04, -6.6182e-05],
        [-6.1382e-04, -2.0841e-04],
        [-7.4792e-04, -5.3729e-05],
        [-5.7022e-04, -1.3600e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6801],
        [ 0.6182, -2.6268],
        [-0.7281,  1.4728],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3010, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0332, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5266, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0008, -0.0001],
        [-0.0007, -0.0001],
        [-0.0009, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6799],
        [ 0.6180, -2.6267],
        [-0.7280,  1.4727],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6208, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5987, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0233e-03, -1.5919e-04],
        [-1.0819e-03, -1.2349e-04],
        [-1.1382e-03, -1.5860e-04],
        [-1.0815e-03, -8.4375e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6800],
        [ 0.6177, -2.6267],
        [-0.7285,  1.4727],
        [-0.8539, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2391, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0316, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5110, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0002],
        [-0.0010, -0.0002],
        [-0.0010, -0.0001],
        [-0.0010, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6799],
        [ 0.6178, -2.6268],
        [-0.7284,  1.4728],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4418, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5666, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0776e-03, -1.6904e-04],
        [-1.0581e-03, -8.7728e-05],
        [-1.1725e-03, -3.4655e-05],
        [-1.0237e-03, -7.8810e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6799],
        [ 0.6177, -2.6267],
        [-0.7286,  1.4729],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9181, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0475, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4787, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.0951e-04, -1.4044e-04],
        [-9.0660e-04, -1.0352e-04],
        [-9.1455e-04, -8.1205e-05],
        [-9.0939e-04, -9.0613e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6800],
        [ 0.6179, -2.6267],
        [-0.7284,  1.4729],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1114, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4973, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.5983e-04, -1.4452e-04],
        [-9.5722e-04, -1.6461e-04],
        [-9.5365e-04, -7.2018e-05],
        [-7.8658e-04, -8.9943e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6800],
        [ 0.6178, -2.6268],
        [-0.7284,  1.4729],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9135, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0447, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4720, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1155e-03, -6.1771e-05],
        [-1.2944e-03, -6.3834e-05],
        [-1.2780e-03, -1.5253e-05],
        [-1.2645e-03, -5.8891e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6800],
        [ 0.6175, -2.6267],
        [-0.7288,  1.4730],
        [-0.8539, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4233, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5661, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014, -0.0002],
        [-0.0014, -0.0001],
        [-0.0015, -0.0002],
        [-0.0014, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6799],
        [ 0.6173, -2.6267],
        [-0.7290,  1.4728],
        [-0.8540, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8591, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0313, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4345, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.2170e-04, -6.7428e-05],
        [-7.8642e-04, -1.7955e-05],
        [-7.6726e-04, -2.6185e-05],
        [-5.6749e-04, -4.3020e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6800],
        [ 0.6179, -2.6266],
        [-0.7283,  1.4730],
        [-0.8532, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6013, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5931, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1218e-03, -1.1511e-04],
        [-1.1389e-03, -1.0384e-04],
        [-1.0497e-03, -7.6996e-05],
        [-1.0793e-03, -6.2432e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6800],
        [ 0.6176, -2.6267],
        [-0.7286,  1.4729],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6417, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6057, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0484e-03, -1.3353e-04],
        [-9.0762e-04, -1.1091e-04],
        [-1.0623e-03, -1.1355e-04],
        [-8.2089e-04, -7.6682e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6799],
        [ 0.6178, -2.6267],
        [-0.7286,  1.4729],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4451, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5657, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013, -0.0003],
        [-0.0011, -0.0002],
        [-0.0012, -0.0003],
        [-0.0011, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6798],
        [ 0.6176, -2.6268],
        [-0.7288,  1.4727],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8126, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0428, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4481, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0055e-03, -1.0619e-04],
        [-9.4546e-04, -1.2382e-04],
        [-1.0861e-03, -9.3881e-05],
        [-9.9673e-04, -1.2015e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6800],
        [ 0.6178, -2.6268],
        [-0.7287,  1.4730],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7081, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6191, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0001],
        [-0.0011, -0.0002],
        [-0.0012, -0.0002],
        [-0.0012, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6799],
        [ 0.6176, -2.6269],
        [-0.7288,  1.4729],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4905, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3801, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0011, -0.0003],
        [-0.0012, -0.0003],
        [-0.0011, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6799],
        [ 0.6176, -2.6270],
        [-0.7288,  1.4728],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9672, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4676, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0741e-03, -1.0023e-04],
        [-1.0904e-03, -1.5079e-04],
        [-1.0221e-03, -9.5242e-05],
        [-1.0762e-03, -3.8492e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6800],
        [ 0.6176, -2.6268],
        [-0.7286,  1.4730],
        [-0.8536, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6609, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6047, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.9982e-04, -7.7607e-05],
        [-1.0492e-03, -1.2720e-04],
        [-1.0249e-03, -1.6279e-04],
        [-1.0255e-03, -2.0846e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6800],
        [ 0.6176, -2.6268],
        [-0.7286,  1.4730],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3559, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5479, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0003],
        [-0.0010, -0.0002],
        [-0.0008, -0.0003],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6799],
        [ 0.6177, -2.6269],
        [-0.7284,  1.4729],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9316, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6616, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1432e-03, -5.2485e-05],
        [-1.1033e-03, -1.1990e-05],
        [-1.1535e-03, -7.9857e-05],
        [-1.1508e-03, -3.3403e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6801],
        [ 0.6176, -2.6267],
        [-0.7287,  1.4731],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4810, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0451, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5864, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0009, -0.0002],
        [-0.0009, -0.0002],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6800],
        [ 0.6177, -2.6269],
        [-0.7285,  1.4730],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0298, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4771, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.0522e-04, -1.2357e-04],
        [-8.0954e-04, -1.8696e-04],
        [-8.3307e-04, -9.2113e-05],
        [-7.9298e-04, -1.2589e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6801],
        [ 0.6178, -2.6269],
        [-0.7284,  1.4732],
        [-0.8533, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6432, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0473, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6233, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0002],
        [-0.0013, -0.0002],
        [-0.0012, -0.0001],
        [-0.0012, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6800],
        [ 0.6173, -2.6269],
        [-0.7287,  1.4731],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8550, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0322, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4355, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2056e-03,  6.5249e-05],
        [-1.2672e-03, -2.6336e-05],
        [-1.1314e-03,  3.0098e-05],
        [-1.2086e-03,  1.1927e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6803],
        [ 0.6174, -2.6267],
        [-0.7287,  1.4733],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4585, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5600, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0002],
        [-0.0010, -0.0001],
        [-0.0011, -0.0001],
        [-0.0010, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6800],
        [ 0.6176, -2.6268],
        [-0.7286,  1.4732],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2800, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5354, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0102e-03, -1.9009e-04],
        [-1.0066e-03, -1.8200e-04],
        [-9.0337e-04, -8.7368e-05],
        [-9.6528e-04, -1.8181e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6800],
        [ 0.6176, -2.6269],
        [-0.7284,  1.4732],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4072, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5527, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.5311e-04, -5.1521e-05],
        [-8.9462e-04,  1.5502e-05],
        [-8.4439e-04, -2.0806e-05],
        [-8.9805e-04, -8.0601e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6802],
        [ 0.6177, -2.6267],
        [-0.7284,  1.4733],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9389, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4635, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013, -0.0002],
        [-0.0011, -0.0001],
        [-0.0010, -0.0001],
        [-0.0011, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6800],
        [ 0.6175, -2.6268],
        [-0.7286,  1.4732],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8178, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4429, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2133e-03, -4.8458e-05],
        [-1.1891e-03, -1.2374e-04],
        [-1.2957e-03, -4.6658e-05],
        [-1.2436e-03, -9.2313e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6802],
        [ 0.6173, -2.6268],
        [-0.7288,  1.4733],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6919, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4222, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0851e-03, -1.4059e-06],
        [-1.0328e-03, -1.3229e-05],
        [-1.1025e-03, -2.0968e-05],
        [-8.9470e-04, -1.5435e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6802],
        [ 0.6175, -2.6267],
        [-0.7286,  1.4733],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3074, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5370, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2202e-03, -6.7092e-05],
        [-1.0578e-03, -1.2340e-04],
        [-1.2938e-03, -7.8852e-05],
        [-1.1167e-03, -8.4096e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6802],
        [ 0.6174, -2.6268],
        [-0.7288,  1.4733],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3930, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5663, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1114e-03, -8.1369e-05],
        [-1.3318e-03, -8.3810e-05],
        [-1.1367e-03, -6.9292e-05],
        [-1.3169e-03, -2.2383e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6802],
        [ 0.6172, -2.6268],
        [-0.7286,  1.4733],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4716, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3693, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.5942e-04, -2.0124e-05],
        [-9.4363e-04, -4.4164e-06],
        [-9.2642e-04, -2.6840e-05],
        [-8.4691e-04, -1.9922e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6803],
        [ 0.6175, -2.6267],
        [-0.7284,  1.4733],
        [-0.8533, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9809, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4677, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3754e-03, -4.8363e-05],
        [-1.2150e-03, -5.9353e-05],
        [-1.1017e-03,  3.7993e-05],
        [-1.3208e-03, -7.1663e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6802],
        [ 0.6172, -2.6268],
        [-0.7286,  1.4734],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5706, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3810, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2007e-03, -1.4150e-05],
        [-1.1960e-03, -2.4805e-05],
        [-1.0035e-03, -6.1765e-05],
        [-1.0342e-03, -4.5478e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6803],
        [ 0.6173, -2.6267],
        [-0.7285,  1.4733],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6352, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6046, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3527e-03,  6.0204e-05],
        [-1.5361e-03,  1.2464e-04],
        [-1.4773e-03,  1.1075e-04],
        [-1.4435e-03,  6.3131e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6804],
        [ 0.6169, -2.6266],
        [-0.7289,  1.4735],
        [-0.8539, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1929, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5058, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0483e-03, -4.0107e-05],
        [-1.0703e-03, -8.5204e-05],
        [-1.1214e-03,  2.9089e-06],
        [-9.7907e-04, -8.3920e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6803],
        [ 0.6174, -2.6268],
        [-0.7286,  1.4734],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3027, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0441, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5487, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0001],
        [-0.0009, -0.0001],
        [-0.0010, -0.0001],
        [-0.0008, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6801],
        [ 0.6176, -2.6268],
        [-0.7284,  1.4733],
        [-0.8533, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7898, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6318, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0413e-03, -5.3313e-05],
        [-1.0858e-03, -8.4449e-05],
        [-9.3782e-04, -1.4344e-04],
        [-1.0696e-03, -5.2168e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6802],
        [ 0.6173, -2.6268],
        [-0.7284,  1.4732],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6953, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4139, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1444e-03,  2.0968e-05],
        [-1.1589e-03,  9.6598e-05],
        [-9.6146e-04,  6.8519e-05],
        [-9.9381e-04,  7.1561e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6803],
        [ 0.6172, -2.6266],
        [-0.7284,  1.4734],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7250, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0456, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6361, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2500e-03,  5.8723e-05],
        [-1.2985e-03,  2.4504e-05],
        [-1.2756e-03,  8.4285e-05],
        [-1.1420e-03, -2.0307e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6804],
        [ 0.6171, -2.6267],
        [-0.7287,  1.4735],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8641, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4587, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5218e-03,  7.5721e-06],
        [-1.3091e-03, -2.1262e-05],
        [-1.2266e-03, -3.4526e-05],
        [-1.3685e-03, -2.3709e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6803],
        [ 0.6170, -2.6268],
        [-0.7286,  1.4734],
        [-0.8539, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7042, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4112, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0010, -0.0001],
        [-0.0008, -0.0001],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6802],
        [ 0.6173, -2.6269],
        [-0.7282,  1.4733],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1879, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0323, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5022, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0315e-03, -2.9383e-05],
        [-1.1918e-03,  4.4060e-05],
        [-1.2461e-03, -1.2542e-06],
        [-1.0987e-03, -6.8101e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6803],
        [ 0.6171, -2.6267],
        [-0.7286,  1.4734],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6236, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4014, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2819e-03, -1.9638e-05],
        [-1.3715e-03, -7.9612e-05],
        [-1.3424e-03, -5.7587e-05],
        [-1.2243e-03, -8.9092e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6804],
        [ 0.6169, -2.6268],
        [-0.7287,  1.4734],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5277, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3832, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1544e-03,  7.5847e-06],
        [-1.0065e-03, -1.1088e-04],
        [-9.9318e-04,  2.8345e-06],
        [-1.0498e-03,  1.3503e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6805],
        [ 0.6173, -2.6268],
        [-0.7283,  1.4734],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7605, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4303, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2889e-03, -1.8735e-08],
        [-1.2897e-03, -9.7811e-05],
        [-1.2806e-03, -5.3087e-05],
        [-1.3854e-03, -7.7046e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6805],
        [ 0.6170, -2.6268],
        [-0.7286,  1.4734],
        [-0.8540, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9030, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4587, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.8965e-04,  7.9519e-05],
        [-9.9034e-04,  1.8504e-05],
        [-1.1776e-03,  8.2867e-05],
        [-9.1836e-04,  9.3182e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6806],
        [ 0.6173, -2.6267],
        [-0.7285,  1.4735],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9313, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0467, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6796, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.9751e-04, -4.0633e-05],
        [-1.0048e-03, -2.8661e-05],
        [-1.0633e-03, -1.9782e-05],
        [-1.0466e-03, -1.2500e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6805],
        [ 0.6172, -2.6268],
        [-0.7284,  1.4735],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9249, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4523, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.1458e-04,  2.2175e-05],
        [-1.0024e-03,  9.3751e-05],
        [-1.1171e-03, -1.6795e-05],
        [-1.1432e-03,  1.6402e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6806],
        [ 0.6172, -2.6266],
        [-0.7284,  1.4735],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8567, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4502, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3882e-03, -5.7552e-05],
        [-1.1997e-03, -1.0527e-04],
        [-1.1771e-03, -1.2510e-04],
        [-1.3224e-03, -5.1873e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6806],
        [ 0.6170, -2.6268],
        [-0.7285,  1.4734],
        [-0.8539, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5662, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0421, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3975, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0001],
        [-0.0012,  0.0001],
        [-0.0012,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6808],
        [ 0.6170, -2.6266],
        [-0.7285,  1.4737],
        [-0.8539, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7074, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6185, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0298e-03,  1.0178e-04],
        [-1.1277e-03,  4.7429e-05],
        [-1.1432e-03,  1.0129e-04],
        [-1.0527e-03,  8.8358e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6808],
        [ 0.6171, -2.6267],
        [-0.7285,  1.4737],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1505, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5104, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0001],
        [-0.0012,  0.0002],
        [-0.0010,  0.0002],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6809],
        [ 0.6170, -2.6266],
        [-0.7283,  1.4737],
        [-0.8539, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5287, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3872, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0001],
        [-0.0012,  0.0002],
        [-0.0012,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6809],
        [ 0.6170, -2.6265],
        [-0.7286,  1.4738],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3232, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0320, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5287, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0002],
        [-0.0012,  0.0002],
        [-0.0013,  0.0002],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6810],
        [ 0.6170, -2.6265],
        [-0.7286,  1.4739],
        [-0.8537, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0868, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4962, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1319e-03,  1.4068e-04],
        [-1.0215e-03,  7.3001e-05],
        [-1.1446e-03,  1.2939e-04],
        [-1.3010e-03,  2.0082e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6810],
        [ 0.6171, -2.6266],
        [-0.7285,  1.4738],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9902, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4670, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1711e-03,  7.2918e-05],
        [-1.2343e-03,  1.0747e-04],
        [-1.0454e-03,  5.8264e-05],
        [-1.1412e-03,  4.9408e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6810],
        [ 0.6169, -2.6266],
        [-0.7284,  1.4737],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8837, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4554, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0001],
        [-0.0011,  0.0002],
        [-0.0011,  0.0003],
        [-0.0011,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6810],
        [ 0.6171, -2.6265],
        [-0.7285,  1.4740],
        [-0.8536, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6548, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4041, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.8610e-04, -1.6814e-05],
        [-1.0722e-03,  7.7852e-05],
        [-9.8106e-04,  6.9976e-05],
        [-1.0034e-03,  7.2689e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6810],
        [ 0.6171, -2.6266],
        [-0.7283,  1.4738],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9347, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4653, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0013,  0.0003],
        [-0.0013,  0.0004],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6813],
        [ 0.6168, -2.6264],
        [-0.7287,  1.4741],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2466, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3311, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0011,  0.0002],
        [-0.0012,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6813],
        [ 0.6170, -2.6265],
        [-0.7286,  1.4739],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0668, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4809, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0637e-03,  1.2887e-04],
        [-1.1423e-03,  1.4681e-04],
        [-1.1089e-03,  9.0047e-05],
        [-1.1645e-03,  1.3905e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6812],
        [ 0.6170, -2.6265],
        [-0.7285,  1.4739],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1052, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0296, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4803, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0015,  0.0002],
        [-0.0014,  0.0003],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6813],
        [ 0.6167, -2.6265],
        [-0.7288,  1.4741],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4743, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3705, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0012,  0.0001],
        [-0.0013,  0.0001],
        [-0.0010,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6814],
        [ 0.6169, -2.6266],
        [-0.7287,  1.4739],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9575, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0460, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4835, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2395e-03,  1.3305e-04],
        [-1.0708e-03,  1.0830e-04],
        [-9.5464e-04,  4.8932e-05],
        [-1.1927e-03,  1.6036e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6814],
        [ 0.6170, -2.6266],
        [-0.7283,  1.4739],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2744, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0452, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5452, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0001],
        [-0.0010,  0.0002],
        [-0.0011,  0.0001],
        [-0.0010,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6814],
        [ 0.6171, -2.6265],
        [-0.7285,  1.4740],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3877, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3451, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0014,  0.0003],
        [-0.0015,  0.0003],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6816],
        [ 0.6167, -2.6264],
        [-0.7289,  1.4742],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4104, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3529, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0002],
        [-0.0012,  0.0002],
        [-0.0013,  0.0001],
        [-0.0011,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6815],
        [ 0.6169, -2.6265],
        [-0.7287,  1.4741],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0579, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4855, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009,  0.0002],
        [-0.0010,  0.0002],
        [-0.0010,  0.0002],
        [-0.0010,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6816],
        [ 0.6171, -2.6264],
        [-0.7284,  1.4742],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5209, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3805, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0003],
        [-0.0012,  0.0003],
        [-0.0011,  0.0002],
        [-0.0011,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6817],
        [ 0.6169, -2.6264],
        [-0.7286,  1.4742],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6181, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3997, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0014,  0.0002],
        [-0.0014,  0.0004],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6817],
        [ 0.6166, -2.6264],
        [-0.7288,  1.4743],
        [-0.8537, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5623, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3845, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0013,  0.0002],
        [-0.0013,  0.0002],
        [-0.0011,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6817],
        [ 0.6168, -2.6265],
        [-0.7288,  1.4742],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5744, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3887, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0003],
        [-0.0012,  0.0003],
        [-0.0010,  0.0003],
        [-0.0012,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6818],
        [ 0.6169, -2.6264],
        [-0.7284,  1.4743],
        [-0.8537, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4974, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3821, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0013,  0.0003],
        [-0.0016,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6818],
        [ 0.6168, -2.6263],
        [-0.7290,  1.4744],
        [-0.8538, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5065, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0473, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3959, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0003],
        [-0.0011,  0.0002],
        [-0.0013,  0.0002],
        [-0.0010,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6818],
        [ 0.6170, -2.6265],
        [-0.7286,  1.4743],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6678, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0415, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4165, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0017,  0.0004],
        [-0.0015,  0.0004],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6164, -2.6262],
        [-0.7289,  1.4744],
        [-0.8541, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6051, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3908, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0016,  0.0004],
        [-0.0017,  0.0004],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6820],
        [ 0.6165, -2.6262],
        [-0.7291,  1.4745],
        [-0.8540, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0447, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2832, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0004],
        [-0.0015,  0.0005],
        [-0.0014,  0.0005],
        [-0.0015,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6820],
        [ 0.6166, -2.6261],
        [-0.7288,  1.4746],
        [-0.8539, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2320, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5130, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0002],
        [-0.0013,  0.0002],
        [-0.0013,  0.0002],
        [-0.0012,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6817],
        [ 0.6168, -2.6264],
        [-0.7287,  1.4743],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6271, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3980, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0012,  0.0002],
        [-0.0014,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6819],
        [ 0.6169, -2.6264],
        [-0.7288,  1.4744],
        [-0.8537, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7526, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4297, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0014,  0.0002],
        [-0.0015,  0.0002],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6819],
        [ 0.6167, -2.6264],
        [-0.7289,  1.4743],
        [-0.8540, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5299, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0422, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5903, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0365e-03,  7.4006e-05],
        [-1.1199e-03,  2.7532e-05],
        [-1.0536e-03,  6.3496e-05],
        [-1.3297e-03,  5.1938e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6817],
        [ 0.6170, -2.6265],
        [-0.7284,  1.4742],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1236, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7045, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0014,  0.0004],
        [-0.0013,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6167, -2.6262],
        [-0.7287,  1.4745],
        [-0.8538, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8784, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4501, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0015,  0.0004],
        [-0.0014,  0.0002],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6819],
        [ 0.6166, -2.6262],
        [-0.7288,  1.4744],
        [-0.8537, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2967, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3352, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1671e-03,  1.3278e-04],
        [-1.1063e-03,  3.9714e-05],
        [-1.3139e-03,  1.8333e-04],
        [-1.2218e-03,  1.6161e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6818],
        [ 0.6170, -2.6265],
        [-0.7287,  1.4743],
        [-0.8536, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8281, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4333, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0017,  0.0002],
        [-0.0018,  0.0002],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6819],
        [ 0.6164, -2.6264],
        [-0.7292,  1.4744],
        [-0.8539, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2397, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0315, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3108, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0013,  0.0003],
        [-0.0014,  0.0003],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6819],
        [ 0.6168, -2.6263],
        [-0.7288,  1.4745],
        [-0.8538, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0588, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2798, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0017,  0.0005],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6821],
        [ 0.6163, -2.6261],
        [-0.7291,  1.4747],
        [-0.8541, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8748, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0322, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4394, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0002],
        [-0.0013,  0.0001],
        [-0.0012,  0.0001],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6818],
        [ 0.6168, -2.6264],
        [-0.7285,  1.4743],
        [-0.8537, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4545, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3669, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2406e-03,  6.9744e-05],
        [-1.1525e-03,  4.2493e-05],
        [-1.3625e-03,  4.8306e-05],
        [-1.1852e-03,  1.0324e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6818],
        [ 0.6170, -2.6265],
        [-0.7287,  1.4742],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0296, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4918, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0002],
        [-0.0014,  0.0002],
        [-0.0012,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6819],
        [ 0.6168, -2.6264],
        [-0.7285,  1.4743],
        [-0.8536, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9719, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0461, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4866, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0015,  0.0003],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6167, -2.6263],
        [-0.7286,  1.4744],
        [-0.8536, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9780, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4680, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1285e-03,  1.1623e-04],
        [-1.1389e-03,  1.6335e-04],
        [-1.3288e-03,  7.2853e-05],
        [-1.2744e-03,  1.3722e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6818],
        [ 0.6171, -2.6264],
        [-0.7286,  1.4743],
        [-0.8535, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8629, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4549, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0015,  0.0002],
        [-0.0016,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6819],
        [ 0.6167, -2.6263],
        [-0.7290,  1.4744],
        [-0.8537, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4036, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0330, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3466, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0001],
        [-0.0013,  0.0002],
        [-0.0015,  0.0001],
        [-0.0015,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6818],
        [ 0.6170, -2.6264],
        [-0.7288,  1.4744],
        [-0.8537, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0892, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0467, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3113, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0014,  0.0002],
        [-0.0017,  0.0003],
        [-0.0017,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6820],
        [ 0.6169, -2.6263],
        [-0.7290,  1.4746],
        [-0.8539, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6518, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4031, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:300, loss: 0.001344, Time: 113.3
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4471e-03,  8.3926e-05],
        [-1.1900e-03,  8.5186e-05],
        [-1.3479e-03,  6.8816e-05],
        [-1.4103e-03,  1.9758e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6818],
        [ 0.6171, -2.6264],
        [-0.7286,  1.4743],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7802, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4267, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0002],
        [-0.0018,  0.0002],
        [-0.0015,  0.0003],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6820],
        [ 0.6165, -2.6262],
        [-0.7288,  1.4745],
        [-0.8536, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0792, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2956, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4894e-03,  1.7309e-04],
        [-1.3178e-03,  1.0117e-04],
        [-1.3769e-03,  9.5379e-05],
        [-1.2152e-03,  9.2920e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6819],
        [ 0.6171, -2.6264],
        [-0.7286,  1.4744],
        [-0.8533, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7340, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4238, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4791e-03,  9.7210e-05],
        [-1.5762e-03,  9.9582e-05],
        [-1.5289e-03,  8.0885e-05],
        [-1.5097e-03,  1.2621e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6819],
        [ 0.6168, -2.6264],
        [-0.7288,  1.4744],
        [-0.8536, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4131, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3535, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0016,  0.0002],
        [-0.0014,  0.0001],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6169, -2.6263],
        [-0.7286,  1.4744],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2951, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0313, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3216, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6787e-03,  1.7576e-04],
        [-1.5764e-03,  1.5847e-04],
        [-1.6486e-03,  1.3703e-04],
        [-1.4202e-03,  6.9803e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6820],
        [ 0.6169, -2.6263],
        [-0.7289,  1.4744],
        [-0.8535, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5075, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0456, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3926, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6275e-03,  1.6916e-04],
        [-1.3920e-03, -2.8256e-05],
        [-1.6868e-03,  1.3050e-04],
        [-1.4498e-03,  1.0024e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6820],
        [ 0.6171, -2.6265],
        [-0.7289,  1.4744],
        [-0.8535, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6977, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0415, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4225, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0012,  0.0002],
        [-0.0013,  0.0002],
        [-0.0012,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6820],
        [ 0.6172, -2.6262],
        [-0.7285,  1.4745],
        [-0.8532, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2038, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3286, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3493e-03,  1.3640e-04],
        [-1.0851e-03,  4.2903e-06],
        [-1.3057e-03,  1.5297e-04],
        [-1.1648e-03,  1.0330e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6819],
        [ 0.6174, -2.6264],
        [-0.7285,  1.4745],
        [-0.8532, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3184, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3335, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002],
        [-0.0014,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6171, -2.6262],
        [-0.7286,  1.4745],
        [-0.8534, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3062, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3331, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4334e-03,  7.1694e-05],
        [-1.5306e-03,  1.4452e-04],
        [-1.5298e-03,  1.3115e-04],
        [-1.5745e-03,  1.0663e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6170, -2.6262],
        [-0.7287,  1.4745],
        [-0.8536, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2328, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3172, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4666e-03,  5.2880e-05],
        [-1.4188e-03,  8.0308e-05],
        [-1.3906e-03,  7.5860e-05],
        [-1.2301e-03,  1.1344e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6171, -2.6263],
        [-0.7286,  1.4744],
        [-0.8532, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2561, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3302, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0001],
        [-0.0013,  0.0001],
        [-0.0012,  0.0002],
        [-0.0012,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6820],
        [ 0.6173, -2.6262],
        [-0.7284,  1.4745],
        [-0.8532, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3195, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0426, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5491, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0018,  0.0002],
        [-0.0016,  0.0003],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6821],
        [ 0.6167, -2.6261],
        [-0.7287,  1.4746],
        [-0.8537, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7843, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0309, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2187, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0001],
        [-0.0015,  0.0002],
        [-0.0015,  0.0001],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6820],
        [ 0.6170, -2.6262],
        [-0.7286,  1.4745],
        [-0.8534, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2054, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3174, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4498e-03,  8.3784e-05],
        [-1.2214e-03,  1.2102e-04],
        [-1.4425e-03,  1.0624e-04],
        [-1.4387e-03,  1.4601e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6173, -2.6262],
        [-0.7286,  1.4745],
        [-0.8534, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0607, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2944, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6821],
        [ 0.6170, -2.6261],
        [-0.7288,  1.4746],
        [-0.8536, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9833, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2740, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6172, -2.6261],
        [-0.7285,  1.4746],
        [-0.8535, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3778, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3545, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0002],
        [-0.0015,  0.0002],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6820],
        [ 0.6171, -2.6261],
        [-0.7284,  1.4745],
        [-0.8534, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6589, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0426, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4170, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0014,  0.0003],
        [-0.0013,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6821],
        [ 0.6171, -2.6259],
        [-0.7283,  1.4746],
        [-0.8531, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7765, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4326, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0013,  0.0002],
        [-0.0011,  0.0002],
        [-0.0010,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6821],
        [ 0.6173, -2.6260],
        [-0.7282,  1.4746],
        [-0.8530, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4820, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3725, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0016,  0.0002],
        [-0.0014,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6169, -2.6260],
        [-0.7285,  1.4746],
        [-0.8534, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4096, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3603, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0001],
        [-0.0011,  0.0002],
        [-0.0011,  0.0002],
        [-0.0011,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6820],
        [ 0.6174, -2.6260],
        [-0.7282,  1.4746],
        [-0.8530, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0890, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2972, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010,  0.0002],
        [-0.0010,  0.0002],
        [-0.0011,  0.0002],
        [-0.0011,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6820],
        [ 0.6176, -2.6261],
        [-0.7282,  1.4746],
        [-0.8530, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2819, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3384, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0013,  0.0002],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6822],
        [ 0.6173, -2.6260],
        [-0.7285,  1.4747],
        [-0.8533, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3605, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3469, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0019,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6822],
        [ 0.6167, -2.6258],
        [-0.7287,  1.4748],
        [-0.8535, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2220, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0332, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3109, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0014,  0.0002],
        [-0.0014,  0.0003],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6821],
        [ 0.6172, -2.6260],
        [-0.7285,  1.4748],
        [-0.8535, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9247, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2633, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0013,  0.0003],
        [-0.0012,  0.0003],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6821],
        [ 0.6173, -2.6259],
        [-0.7282,  1.4747],
        [-0.8533, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5264, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3913, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0015,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6821],
        [ 0.6171, -2.6259],
        [-0.7286,  1.4748],
        [-0.8535, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7582, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4345, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0014,  0.0002],
        [-0.0013,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6821],
        [ 0.6172, -2.6260],
        [-0.7283,  1.4747],
        [-0.8532, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6460, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4051, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0015,  0.0003],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6821],
        [ 0.6172, -2.6259],
        [-0.7284,  1.4748],
        [-0.8532, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5398, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3836, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0013,  0.0003],
        [-0.0014,  0.0003],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6823],
        [ 0.6174, -2.6259],
        [-0.7284,  1.4748],
        [-0.8533, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5577, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3852, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0013,  0.0002],
        [-0.0014,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6822],
        [ 0.6174, -2.6260],
        [-0.7284,  1.4748],
        [-0.8531, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6084, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3996, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0015,  0.0003],
        [-0.0016,  0.0003],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6821],
        [ 0.6172, -2.6259],
        [-0.7286,  1.4748],
        [-0.8533, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3546, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3513, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0017,  0.0003],
        [-0.0017,  0.0003],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6821],
        [ 0.6170, -2.6258],
        [-0.7286,  1.4748],
        [-0.8532, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1413, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3053, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0012,  0.0004],
        [-0.0012,  0.0004],
        [-0.0012,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6822],
        [ 0.6175, -2.6258],
        [-0.7282,  1.4749],
        [-0.8530, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2417, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3179, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0015,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6823],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8534, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1299, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2978, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6822],
        [ 0.6173, -2.6258],
        [-0.7284,  1.4748],
        [-0.8532, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4324, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3600, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0004],
        [-0.0016,  0.0004],
        [-0.0013,  0.0003],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6824],
        [ 0.6172, -2.6257],
        [-0.7283,  1.4748],
        [-0.8535, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1181, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0437, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3110, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0014,  0.0004],
        [-0.0015,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6824],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4749],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4647, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3691, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0013,  0.0004],
        [-0.0015,  0.0004],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6824],
        [ 0.6174, -2.6257],
        [-0.7284,  1.4749],
        [-0.8534, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1430, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3034, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0001],
        [-0.0011,  0.0002],
        [-0.0013,  0.0003],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6822],
        [ 0.6177, -2.6259],
        [-0.7282,  1.4748],
        [-0.8531, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8627, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4502, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0015,  0.0004],
        [-0.0012,  0.0003],
        [-0.0014,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6824],
        [ 0.6173, -2.6257],
        [-0.7282,  1.4748],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2016, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3241, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0005],
        [-0.0015,  0.0004],
        [-0.0014,  0.0004],
        [-0.0016,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6825],
        [ 0.6173, -2.6257],
        [-0.7284,  1.4749],
        [-0.8535, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1441, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3088, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0015,  0.0004],
        [-0.0017,  0.0004],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6824],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8535, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3457, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3498, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0019,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6824],
        [ 0.6170, -2.6257],
        [-0.7287,  1.4748],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9754, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2675, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0012,  0.0002],
        [-0.0016,  0.0003],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6823],
        [ 0.6175, -2.6259],
        [-0.7286,  1.4748],
        [-0.8535, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1207, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0420, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3081, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0012,  0.0003],
        [-0.0012,  0.0003],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6824],
        [ 0.6176, -2.6257],
        [-0.7282,  1.4748],
        [-0.8531, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5170, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0323, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3680, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0003],
        [-0.0012,  0.0002],
        [-0.0013,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6823],
        [ 0.6176, -2.6259],
        [-0.7283,  1.4748],
        [-0.8532, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7236, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4171, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0003],
        [-0.0012,  0.0002],
        [-0.0011,  0.0003],
        [-0.0011,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6824],
        [ 0.6176, -2.6259],
        [-0.7281,  1.4748],
        [-0.8530, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1668, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3122, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0014,  0.0004],
        [-0.0015,  0.0004],
        [-0.0015,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6825],
        [ 0.6174, -2.6257],
        [-0.7284,  1.4749],
        [-0.8534, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0320, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4770, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0017,  0.0004],
        [-0.0018,  0.0005],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6824],
        [ 0.6172, -2.6257],
        [-0.7288,  1.4749],
        [-0.8535, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5354, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3815, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0018,  0.0005],
        [-0.0017,  0.0005],
        [-0.0016,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6171, -2.6256],
        [-0.7287,  1.4750],
        [-0.8535, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7976, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2343, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0013,  0.0004],
        [-0.0011,  0.0003],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6825],
        [ 0.6175, -2.6257],
        [-0.7280,  1.4748],
        [-0.8532, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  42
gt_cnt:  40
gt_cnt:  35
gt_cnt:  41
gt_cnt:  42
gt_cnt:  42
gt_cnt:  38
gt_cnt:  38
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  40
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  35
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  43
gt_cnt:  35
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  42
gt_cnt:  42
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  39
gt_cnt:  35
gt_cnt:  38
gt_cnt:  34
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  36
gt_cnt:  43
gt_cnt:  41
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  42
gt_cnt:  39
gt_cnt:  35
gt_cnt:  41
gt_cnt:  42
gt_cnt:  42
gt_cnt:  40
gt_cnt:  42
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  40
gt_cnt:  35
gt_cnt:  42
gt_cnt:  38
gt_cnt:  37
gt_cnt:  40
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  42
gt_cnt:  41
gt_cnt:  40
gt_cnt:  41
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  41
gt_cnt:  42
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  35
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  37
gt_cnt:  36
gt_cnt:  37
gt_cnt:  39
gt_cnt:  36
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  41
gt_cnt:  36
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  39
gt_cnt:  36
gt_cnt:  44
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  40
gt_cnt:  36
gt_cnt:  37
gt_cnt:  39
gt_cnt:  37
gt_cnt:  44
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  35
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  34
gt_cnt:  37
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  35
gt_cnt:  38
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  36
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  42
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  36
gt_cnt:  35
gt_cnt:  39
gt_cnt:  36
gt_cnt:  35
gt_cnt:  42
gt_cnt:  37
gt_cnt:  42
gt_cnt:  40
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  43
gt_cnt:  33
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  36
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  41
gt_cnt:  36
gt_cnt:  44
gt_cnt:  40
gt_cnt:  35
gt_cnt:  44
gt_cnt:  40
gt_cnt:  42
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  35
gt_cnt:  36
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  41
gt_cnt:  38
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  43
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  37
gt_cnt:  43
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  35
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  36
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  43
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  35
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  41
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  42
gt_cnt:  38
gt_cnt:  37
gt_cnt:  44
gt_cnt:  41
gt_cnt:  41
gt_cnt:  37
gt_cnt:  35
gt_cnt:  42
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  41
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  40
gt_cnt:  36
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  38
gt_cnt:  41
gt_cnt:  40
gt_cnt:  40
{'loss_ce': tensor(1.4952, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3816, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0016,  0.0004],
        [-0.0018,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6173, -2.6257],
        [-0.7288,  1.4750],
        [-0.8537, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0032, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2790, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0018,  0.0004],
        [-0.0017,  0.0003],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6825],
        [ 0.6171, -2.6258],
        [-0.7286,  1.4748],
        [-0.8535, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1869, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3063, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0004],
        [-0.0014,  0.0004],
        [-0.0014,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6825],
        [ 0.6175, -2.6257],
        [-0.7283,  1.4748],
        [-0.8532, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2971, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3333, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010,  0.0003],
        [-0.0012,  0.0004],
        [-0.0011,  0.0004],
        [-0.0010,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6825],
        [ 0.6177, -2.6258],
        [-0.7280,  1.4749],
        [-0.8529, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0517, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0458, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3019, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0014,  0.0004],
        [-0.0015,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6826],
        [ 0.6175, -2.6257],
        [-0.7284,  1.4749],
        [-0.8536, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9955, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2798, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0013,  0.0003],
        [-0.0012,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6824],
        [ 0.6176, -2.6258],
        [-0.7281,  1.4747],
        [-0.8532, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1342, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5050, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:360, loss: 0.001403, Time: 135.4
Testing...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4035, device='cuda:0'), 'loss_center': tensor(0.0363, device='cuda:0')}
loss: tensor(0.1533, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263,
         0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263,
         0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263,
         0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263,
         0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263, 0.5263,
         0.5263, 0.5263, 0.5263, 0.5263, 0.5263]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3098,  0.6826],
        [ 0.6174, -2.6257],
        [-0.7285,  1.4749],
        [-0.8535, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4071, device='cuda:0'), 'loss_center': tensor(0.0382, device='cuda:0')}
loss: tensor(0.1579, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7287,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3879, device='cuda:0'), 'loss_center': tensor(0.0378, device='cuda:0')}
loss: tensor(0.1531, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402,
         0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402,
         0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402,
         0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402,
         0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402, 0.5402,
         0.5402, 0.5402, 0.5402, 0.5402, 0.5402]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3815, device='cuda:0'), 'loss_center': tensor(0.0381, device='cuda:0')}
loss: tensor(0.1526, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
         0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
         0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
         0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
         0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
         0.5573, 0.5573, 0.5573, 0.5573, 0.5573]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3951, device='cuda:0'), 'loss_center': tensor(0.0329, device='cuda:0')}
loss: tensor(0.1448, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528,
         0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528,
         0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528,
         0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528,
         0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528, 0.5528,
         0.5528, 0.5528, 0.5528, 0.5528, 0.5528]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7287,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3947, device='cuda:0'), 'loss_center': tensor(0.0337, device='cuda:0')}
loss: tensor(0.1463, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4135, device='cuda:0'), 'loss_center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.1595, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335,
         0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335,
         0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335,
         0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335,
         0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335, 0.5335,
         0.5335, 0.5335, 0.5335, 0.5335, 0.5335]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4749],
        [-0.8536, -2.7481]], device='cuda:0')
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4299, device='cuda:0'), 'loss_center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.1628, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242,
         0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242,
         0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242,
         0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242,
         0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242, 0.5242,
         0.5242, 0.5242, 0.5242, 0.5242, 0.5242]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4004, device='cuda:0'), 'loss_center': tensor(0.0415, device='cuda:0')}
loss: tensor(0.1631, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306,
         0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306,
         0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306,
         0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306,
         0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306, 0.5306,
         0.5306, 0.5306, 0.5306, 0.5306, 0.5306]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3950, device='cuda:0'), 'loss_center': tensor(0.0392, device='cuda:0')}
loss: tensor(0.1574, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392,
         0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392,
         0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392,
         0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392,
         0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392,
         0.5392, 0.5392, 0.5392, 0.5392, 0.5392]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8536, -2.7481]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4135, device='cuda:0'), 'loss_center': tensor(0.0419, device='cuda:0')}
loss: tensor(0.1665, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145,
         0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145,
         0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145,
         0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145,
         0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145, 0.5145,
         0.5145, 0.5145, 0.5145, 0.5145, 0.5145]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7287,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4063, device='cuda:0'), 'loss_center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.1579, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327,
         0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327,
         0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327,
         0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327,
         0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327, 0.5327,
         0.5327, 0.5327, 0.5327, 0.5327, 0.5327]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4001, device='cuda:0'), 'loss_center': tensor(0.0386, device='cuda:0')}
loss: tensor(0.1571, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211,
         0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211,
         0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211,
         0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211,
         0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211, 0.5211,
         0.5211, 0.5211, 0.5211, 0.5211, 0.5211]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4749],
        [-0.8536, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4062, device='cuda:0'), 'loss_center': tensor(0.0374, device='cuda:0')}
loss: tensor(0.1561, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138,
         0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138,
         0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138,
         0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138,
         0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138, 0.5138,
         0.5138, 0.5138, 0.5138, 0.5138, 0.5138]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4301, device='cuda:0'), 'loss_center': tensor(0.0378, device='cuda:0')}
loss: tensor(0.1615, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912,
         0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912,
         0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912,
         0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912,
         0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912, 0.4912,
         0.4912, 0.4912, 0.4912, 0.4912, 0.4912]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7287,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3993, device='cuda:0'), 'loss_center': tensor(0.0362, device='cuda:0')}
loss: tensor(0.1523, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130,
         0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130,
         0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130,
         0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130,
         0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130,
         0.5130, 0.5130, 0.5130, 0.5130, 0.5130]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3857, device='cuda:0'), 'loss_center': tensor(0.0343, device='cuda:0')}
loss: tensor(0.1457, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3852, device='cuda:0'), 'loss_center': tensor(0.0409, device='cuda:0')}
loss: tensor(0.1589, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460,
         0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460,
         0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460,
         0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460,
         0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460, 0.5460,
         0.5460, 0.5460, 0.5460, 0.5460, 0.5460]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4023, device='cuda:0'), 'loss_center': tensor(0.0360, device='cuda:0')}
loss: tensor(0.1525, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279,
         0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279,
         0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279,
         0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279,
         0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279,
         0.5279, 0.5279, 0.5279, 0.5279, 0.5279]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4749],
        [-0.8536, -2.7482]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3919, device='cuda:0'), 'loss_center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.1549, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225,
         0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225,
         0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225,
         0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225,
         0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225, 0.5225,
         0.5225, 0.5225, 0.5225, 0.5225, 0.5225]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6173, -2.6257],
        [-0.7286,  1.4749],
        [-0.8536, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3929, device='cuda:0'), 'loss_center': tensor(0.0337, device='cuda:0')}
loss: tensor(0.1461, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313,
         0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313,
         0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313,
         0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313,
         0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313, 0.5313,
         0.5313, 0.5313, 0.5313, 0.5313, 0.5313]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7287,  1.4749],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3944, device='cuda:0'), 'loss_center': tensor(0.0333, device='cuda:0')}
loss: tensor(0.1454, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545,
         0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545,
         0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545,
         0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545,
         0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545,
         0.5545, 0.5545, 0.5545, 0.5545, 0.5545]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6171, -2.6257],
        [-0.7287,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4064, device='cuda:0'), 'loss_center': tensor(0.0314, device='cuda:0')}
loss: tensor(0.1441, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439,
         0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439,
         0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439,
         0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439,
         0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439,
         0.5439, 0.5439, 0.5439, 0.5439, 0.5439]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7287,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4415, device='cuda:0'), 'loss_center': tensor(0.0370, device='cuda:0')}
loss: tensor(0.1622, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131,
         0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131,
         0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131,
         0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131,
         0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131, 0.5131,
         0.5131, 0.5131, 0.5131, 0.5131, 0.5131]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4382, device='cuda:0'), 'loss_center': tensor(0.0399, device='cuda:0')}
loss: tensor(0.1674, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077,
         0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077,
         0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077,
         0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077,
         0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077, 0.5077,
         0.5077, 0.5077, 0.5077, 0.5077, 0.5077]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6171, -2.6256],
        [-0.7287,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4317, device='cuda:0'), 'loss_center': tensor(0.0351, device='cuda:0')}
loss: tensor(0.1565, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6171, -2.6256],
        [-0.7287,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4051, device='cuda:0'), 'loss_center': tensor(0.0398, device='cuda:0')}
loss: tensor(0.1606, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344,
         0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344,
         0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344,
         0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344,
         0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344, 0.5344,
         0.5344, 0.5344, 0.5344, 0.5344, 0.5344]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0005],
        [-0.0016,  0.0005],
        [-0.0016,  0.0005],
        [-0.0016,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4749],
        [-0.8536, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4089, device='cuda:0'), 'loss_center': tensor(0.0381, device='cuda:0')}
loss: tensor(0.1580, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291,
         0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291,
         0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291,
         0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291,
         0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291, 0.5291,
         0.5291, 0.5291, 0.5291, 0.5291, 0.5291]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4050, device='cuda:0'), 'loss_center': tensor(0.0434, device='cuda:0')}
loss: tensor(0.1678, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346,
         0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346,
         0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346,
         0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346,
         0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346,
         0.5346, 0.5346, 0.5346, 0.5346, 0.5346]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4263, device='cuda:0'), 'loss_center': tensor(0.0452, device='cuda:0')}
loss: tensor(0.1756, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188,
         0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188,
         0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188,
         0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188,
         0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188, 0.5188,
         0.5188, 0.5188, 0.5188, 0.5188, 0.5188]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4440, device='cuda:0'), 'loss_center': tensor(0.0343, device='cuda:0')}
loss: tensor(0.1574, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195,
         0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195,
         0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195,
         0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195,
         0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195, 0.5195,
         0.5195, 0.5195, 0.5195, 0.5195, 0.5195]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4042, device='cuda:0'), 'loss_center': tensor(0.0370, device='cuda:0')}
loss: tensor(0.1549, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479,
         0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479,
         0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479,
         0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479,
         0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479, 0.5479,
         0.5479, 0.5479, 0.5479, 0.5479, 0.5479]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6171, -2.6256],
        [-0.7287,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3983, device='cuda:0'), 'loss_center': tensor(0.0394, device='cuda:0')}
loss: tensor(0.1585, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6171, -2.6257],
        [-0.7287,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3961, device='cuda:0'), 'loss_center': tensor(0.0388, device='cuda:0')}
loss: tensor(0.1569, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504,
         0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504,
         0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504,
         0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504,
         0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504, 0.5504,
         0.5504, 0.5504, 0.5504, 0.5504, 0.5504]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4058, device='cuda:0'), 'loss_center': tensor(0.0420, device='cuda:0')}
loss: tensor(0.1652, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4026, device='cuda:0'), 'loss_center': tensor(0.0449, device='cuda:0')}
loss: tensor(0.1703, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510,
         0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510,
         0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510,
         0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510,
         0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510,
         0.5510, 0.5510, 0.5510, 0.5510, 0.5510]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4281, device='cuda:0'), 'loss_center': tensor(0.0360, device='cuda:0')}
loss: tensor(0.1577, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359,
         0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359,
         0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359,
         0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359,
         0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359, 0.5359,
         0.5359, 0.5359, 0.5359, 0.5359, 0.5359]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0005],
        [-0.0016,  0.0005],
        [-0.0016,  0.0005],
        [-0.0016,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4750],
        [-0.8536, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4136, device='cuda:0'), 'loss_center': tensor(0.0380, device='cuda:0')}
loss: tensor(0.1588, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3832, device='cuda:0'), 'loss_center': tensor(0.0397, device='cuda:0')}
loss: tensor(0.1561, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515,
         0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515,
         0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515,
         0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515,
         0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515, 0.5515,
         0.5515, 0.5515, 0.5515, 0.5515, 0.5515]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6171, -2.6256],
        [-0.7287,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3816, device='cuda:0'), 'loss_center': tensor(0.0420, device='cuda:0')}
loss: tensor(0.1603, device='cuda:0', dtype=torch.float64)
top10 scores:  gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  37
gt_cnt:  36
gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  36
gt_cnt:  37
gt_cnt:  36
gt_cnt:  34
gt_cnt:  39
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  35
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  40
gt_cnt:  39
gt_cnt:  36
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  36
gt_cnt:  37
gt_cnt:  34
gt_cnt:  36
gt_cnt:  39
tensor([[0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403,
         0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403,
         0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403,
         0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403,
         0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403, 0.5403,
         0.5403, 0.5403, 0.5403, 0.5403, 0.5403]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
moda: 0.0%, modp: 35.2%, prec: 7.6%, recall: 10.2%
Test, loss: 0.157357, Time: 15.143
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0014,  0.0004],
        [-0.0014,  0.0004],
        [-0.0013,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6176, -2.6257],
        [-0.7283,  1.4749],
        [-0.8533, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1689, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3121, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6826],
        [ 0.6176, -2.6258],
        [-0.7283,  1.4748],
        [-0.8534, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1748, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3107, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0003],
        [-0.0015,  0.0004],
        [-0.0016,  0.0004],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6826],
        [ 0.6175, -2.6257],
        [-0.7285,  1.4749],
        [-0.8535, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3645, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3464, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0015,  0.0004],
        [-0.0015,  0.0004],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6826],
        [ 0.6174, -2.6257],
        [-0.7284,  1.4749],
        [-0.8535, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6785, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0423, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2203, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6826],
        [ 0.6175, -2.6259],
        [-0.7283,  1.4748],
        [-0.8535, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4790, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3629, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0014,  0.0002],
        [-0.0012,  0.0002],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6825],
        [ 0.6176, -2.6260],
        [-0.7280,  1.4747],
        [-0.8532, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2958, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3355, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0012,  0.0004],
        [-0.0011,  0.0004],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6827],
        [ 0.6177, -2.6258],
        [-0.7280,  1.4748],
        [-0.8533, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8409, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0425, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2531, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0013,  0.0003],
        [-0.0012,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6826],
        [ 0.6177, -2.6259],
        [-0.7280,  1.4747],
        [-0.8534, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2068, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3164, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0005],
        [-0.0015,  0.0004],
        [-0.0017,  0.0004],
        [-0.0016,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6828],
        [ 0.6175, -2.6258],
        [-0.7285,  1.4749],
        [-0.8536, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2219, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3115, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0005],
        [-0.0013,  0.0004],
        [-0.0015,  0.0005],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6828],
        [ 0.6177, -2.6258],
        [-0.7283,  1.4750],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0462, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2829, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0018,  0.0004],
        [-0.0016,  0.0003],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6172, -2.6258],
        [-0.7285,  1.4747],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0638, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0440, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3008, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0017,  0.0003],
        [-0.0018,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6826],
        [ 0.6173, -2.6258],
        [-0.7287,  1.4748],
        [-0.8537, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6119, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1992, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0001],
        [-0.0012,  0.0001],
        [-0.0011,  0.0001],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6825],
        [ 0.6178, -2.6261],
        [-0.7279,  1.4746],
        [-0.8535, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0958, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2976, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6828],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4748],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8577, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2446, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0013,  0.0002],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6827],
        [ 0.6176, -2.6259],
        [-0.7282,  1.4747],
        [-0.8534, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9891, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2696, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0016,  0.0004],
        [-0.0014,  0.0003],
        [-0.0018,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6174, -2.6257],
        [-0.7283,  1.4748],
        [-0.8538, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9958, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2712, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0005],
        [-0.0015,  0.0004],
        [-0.0013,  0.0004],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6829],
        [ 0.6176, -2.6258],
        [-0.7281,  1.4748],
        [-0.8534, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8448, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2449, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0018,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6172, -2.6258],
        [-0.7286,  1.4748],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8615, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2517, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0017,  0.0004],
        [-0.0015,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6827],
        [ 0.6174, -2.6258],
        [-0.7284,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4342, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3585, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0015,  0.0004],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6827],
        [ 0.6176, -2.6258],
        [-0.7283,  1.4748],
        [-0.8534, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2519, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3207, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0016,  0.0004],
        [-0.0018,  0.0005],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6175, -2.6258],
        [-0.7286,  1.4750],
        [-0.8536, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3895, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3559, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0013,  0.0003],
        [-0.0013,  0.0002],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6828],
        [ 0.6178, -2.6259],
        [-0.7282,  1.4747],
        [-0.8534, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7559, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4325, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0005],
        [-0.0018,  0.0005],
        [-0.0021,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6829],
        [ 0.6173, -2.6258],
        [-0.7290,  1.4750],
        [-0.8539, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9065, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0330, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2473, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0017,  0.0004],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6828],
        [ 0.6174, -2.6258],
        [-0.7283,  1.4748],
        [-0.8534, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9824, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2658, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0018,  0.0004],
        [-0.0021,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6828],
        [ 0.6176, -2.6258],
        [-0.7287,  1.4749],
        [-0.8542, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3529, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3418, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0016,  0.0004],
        [-0.0018,  0.0005],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6829],
        [ 0.6176, -2.6258],
        [-0.7288,  1.4750],
        [-0.8535, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0382, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0322, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2721, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0004],
        [-0.0014,  0.0004],
        [-0.0014,  0.0003],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6828],
        [ 0.6178, -2.6258],
        [-0.7283,  1.4748],
        [-0.8537, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9214, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2590, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0016,  0.0005],
        [-0.0020,  0.0005],
        [-0.0020,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6175, -2.6258],
        [-0.7290,  1.4750],
        [-0.8541, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9350, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2653, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0004],
        [-0.0014,  0.0002],
        [-0.0014,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6828],
        [ 0.6177, -2.6260],
        [-0.7284,  1.4747],
        [-0.8533, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3034, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3432, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6828],
        [ 0.6175, -2.6259],
        [-0.7287,  1.4749],
        [-0.8537, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2533, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3312, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0002],
        [-0.0013,  0.0002],
        [-0.0013,  0.0002],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6827],
        [ 0.6179, -2.6260],
        [-0.7284,  1.4748],
        [-0.8534, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8646, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2535, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0019,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6830],
        [ 0.6173, -2.6258],
        [-0.7288,  1.4750],
        [-0.8540, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9746, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2744, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0017,  0.0004],
        [-0.0018,  0.0004],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6828],
        [ 0.6175, -2.6259],
        [-0.7289,  1.4749],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0696, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0438, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3015, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0016,  0.0003],
        [-0.0019,  0.0005],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6176, -2.6260],
        [-0.7290,  1.4751],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7454, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2203, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0018,  0.0004],
        [-0.0017,  0.0003],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6829],
        [ 0.6174, -2.6258],
        [-0.7288,  1.4749],
        [-0.8539, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2715, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3365, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0018,  0.0005],
        [-0.0020,  0.0006],
        [-0.0018,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6830],
        [ 0.6174, -2.6258],
        [-0.7291,  1.4751],
        [-0.8540, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3054, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3318, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0016,  0.0003],
        [-0.0018,  0.0004],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6176, -2.6260],
        [-0.7289,  1.4751],
        [-0.8538, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1941, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3151, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021,  0.0006],
        [-0.0020,  0.0005],
        [-0.0021,  0.0005],
        [-0.0021,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6831],
        [ 0.6172, -2.6258],
        [-0.7292,  1.4751],
        [-0.8544, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8366, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2370, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0016,  0.0003],
        [-0.0014,  0.0003],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6176, -2.6260],
        [-0.7286,  1.4749],
        [-0.8540, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7425, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4235, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0015,  0.0003],
        [-0.0018,  0.0004],
        [-0.0020,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6828],
        [ 0.6177, -2.6260],
        [-0.7289,  1.4751],
        [-0.8542, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8689, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0476, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2689, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0014,  0.0003],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6828],
        [ 0.6177, -2.6260],
        [-0.7286,  1.4749],
        [-0.8538, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9719, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2729, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0018,  0.0005],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6830],
        [ 0.6174, -2.6257],
        [-0.7290,  1.4752],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2031, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0327, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3059, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0003],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6829],
        [ 0.6176, -2.6260],
        [-0.7288,  1.4750],
        [-0.8539, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6479, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2116, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0017,  0.0004],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6829],
        [ 0.6178, -2.6260],
        [-0.7289,  1.4751],
        [-0.8540, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1211, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2998, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0018,  0.0004],
        [-0.0016,  0.0004],
        [-0.0018,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6830],
        [ 0.6175, -2.6259],
        [-0.7288,  1.4751],
        [-0.8541, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7566, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2248, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6829],
        [ 0.6177, -2.6259],
        [-0.7288,  1.4752],
        [-0.8539, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8156, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0326, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2283, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0016,  0.0004],
        [-0.0016,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6831],
        [ 0.6175, -2.6258],
        [-0.7289,  1.4752],
        [-0.8540, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9690, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2699, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0016,  0.0005],
        [-0.0016,  0.0004],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6829],
        [ 0.6176, -2.6258],
        [-0.7288,  1.4752],
        [-0.8538, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8986, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2551, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0005],
        [-0.0015,  0.0004],
        [-0.0017,  0.0004],
        [-0.0015,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6831],
        [ 0.6178, -2.6259],
        [-0.7289,  1.4753],
        [-0.8539, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2107, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3221, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0006],
        [-0.0018,  0.0004],
        [-0.0017,  0.0005],
        [-0.0019,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6833],
        [ 0.6175, -2.6258],
        [-0.7290,  1.4753],
        [-0.8543, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8918, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2557, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6831],
        [ 0.6174, -2.6258],
        [-0.7291,  1.4754],
        [-0.8542, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9074, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2605, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0002],
        [-0.0012,  0.0002],
        [-0.0011,  0.0002],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6829],
        [ 0.6181, -2.6261],
        [-0.7284,  1.4751],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2762, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3357, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0005],
        [-0.0017,  0.0004],
        [-0.0016,  0.0004],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6831],
        [ 0.6176, -2.6259],
        [-0.7289,  1.4753],
        [-0.8539, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8444, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0330, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2349, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0015,  0.0003],
        [-0.0013,  0.0003],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6829],
        [ 0.6178, -2.6259],
        [-0.7286,  1.4752],
        [-0.8539, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5874, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4003, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0015,  0.0003],
        [-0.0016,  0.0004],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6830],
        [ 0.6178, -2.6259],
        [-0.7289,  1.4753],
        [-0.8539, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0827, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2870, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6830],
        [ 0.6179, -2.6260],
        [-0.7287,  1.4752],
        [-0.8541, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6516, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2053, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0014,  0.0003],
        [-0.0013,  0.0002],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6829],
        [ 0.6179, -2.6259],
        [-0.7286,  1.4752],
        [-0.8539, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8451, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2522, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0018,  0.0005],
        [-0.0021,  0.0005],
        [-0.0018,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6831],
        [ 0.6175, -2.6257],
        [-0.7294,  1.4755],
        [-0.8543, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8050, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2367, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0014,  0.0003],
        [-0.0019,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6831],
        [ 0.6179, -2.6259],
        [-0.7292,  1.4755],
        [-0.8541, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9163, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2537, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0015,  0.0004],
        [-0.0016,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6830],
        [ 0.6178, -2.6258],
        [-0.7289,  1.4754],
        [-0.8541, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6474, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2039, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0015,  0.0003],
        [-0.0015,  0.0004],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6831],
        [ 0.6178, -2.6259],
        [-0.7288,  1.4754],
        [-0.8539, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9958, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2815, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0003],
        [-0.0018,  0.0004],
        [-0.0016,  0.0003],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6830],
        [ 0.6175, -2.6259],
        [-0.7289,  1.4754],
        [-0.8541, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8081, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0421, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2458, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0003],
        [-0.0022,  0.0006],
        [-0.0017,  0.0003],
        [-0.0021,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6830],
        [ 0.6171, -2.6257],
        [-0.7290,  1.4754],
        [-0.8546, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1214, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2998, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0014,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6830],
        [ 0.6177, -2.6259],
        [-0.7289,  1.4754],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7891, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2384, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0012,  0.0001],
        [-0.0013,  0.0002],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6830],
        [ 0.6181, -2.6261],
        [-0.7285,  1.4753],
        [-0.8538, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9492, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2624, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0015,  0.0003],
        [-0.0017,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6830],
        [ 0.6178, -2.6259],
        [-0.7290,  1.4754],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9309, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2619, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0015,  0.0003],
        [-0.0016,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6830],
        [ 0.6179, -2.6259],
        [-0.7288,  1.4754],
        [-0.8538, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5147, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0426, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1881, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0002],
        [-0.0017,  0.0002],
        [-0.0016,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6829],
        [ 0.6176, -2.6260],
        [-0.7289,  1.4753],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8963, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0344, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2481, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0002],
        [-0.0017,  0.0002],
        [-0.0015,  0.0002],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6829],
        [ 0.6176, -2.6261],
        [-0.7288,  1.4753],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2610, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3380, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0019,  0.0003],
        [-0.0015,  0.0003],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6830],
        [ 0.6174, -2.6259],
        [-0.7288,  1.4755],
        [-0.8541, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1886, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0318, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3014, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0003],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6830],
        [ 0.6178, -2.6259],
        [-0.7289,  1.4754],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8666, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2494, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0002],
        [-0.0018,  0.0002],
        [-0.0018,  0.0003],
        [-0.0017,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6829],
        [ 0.6176, -2.6260],
        [-0.7291,  1.4754],
        [-0.8540, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5638, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1845, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0002],
        [-0.0015,  0.0003],
        [-0.0018,  0.0003],
        [-0.0019,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6829],
        [ 0.6178, -2.6259],
        [-0.7291,  1.4755],
        [-0.8542, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7933, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2286, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0002],
        [-0.0018,  0.0001],
        [-0.0019,  0.0004],
        [-0.0017,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6829],
        [ 0.6176, -2.6261],
        [-0.7292,  1.4755],
        [-0.8541, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8663, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2426, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0004],
        [-0.0018,  0.0004],
        [-0.0017,  0.0003],
        [-0.0019,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6831],
        [ 0.6176, -2.6258],
        [-0.7289,  1.4754],
        [-0.8542, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5669, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1855, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0004],
        [-0.0017,  0.0003],
        [-0.0016,  0.0002],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6831],
        [ 0.6177, -2.6259],
        [-0.7288,  1.4754],
        [-0.8539, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8489, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2514, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0004],
        [-0.0017,  0.0003],
        [-0.0018,  0.0003],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6830],
        [ 0.6177, -2.6259],
        [-0.7291,  1.4755],
        [-0.8542, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9326, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2558, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0019,  0.0003],
        [-0.0018,  0.0003],
        [-0.0018,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6830],
        [ 0.6175, -2.6259],
        [-0.7291,  1.4755],
        [-0.8541, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0346, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2877, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0019,  0.0004],
        [-0.0017,  0.0002],
        [-0.0018,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6830],
        [ 0.6175, -2.6258],
        [-0.7290,  1.4754],
        [-0.8542, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1098, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2940, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020,  0.0004],
        [-0.0019,  0.0004],
        [-0.0019,  0.0004],
        [-0.0019,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6831],
        [ 0.6175, -2.6258],
        [-0.7291,  1.4756],
        [-0.8542, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8797, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2485, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020,  0.0001],
        [-0.0017,  0.0001],
        [-0.0020,  0.0002],
        [-0.0020,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6828],
        [ 0.6177, -2.6260],
        [-0.7293,  1.4755],
        [-0.8543, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6111, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1959, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0016,  0.0003],
        [-0.0020,  0.0003],
        [-0.0017,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6829],
        [ 0.6178, -2.6259],
        [-0.7293,  1.4755],
        [-0.8540, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7525, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0311, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2127, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0002],
        [-0.0015,  0.0002],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6828],
        [ 0.6179, -2.6260],
        [-0.7286,  1.4754],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7129, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2235, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5581e-03,  2.2341e-04],
        [-1.4137e-03,  7.8644e-05],
        [-1.2287e-03,  3.2701e-05],
        [-1.5620e-03,  1.7385e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6829],
        [ 0.6180, -2.6261],
        [-0.7286,  1.4753],
        [-0.8539, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7453, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2276, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0002],
        [-0.0019,  0.0002],
        [-0.0017,  0.0003],
        [-0.0019,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6828],
        [ 0.6176, -2.6259],
        [-0.7291,  1.4755],
        [-0.8542, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6611, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2117, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5218e-03,  5.1387e-05],
        [-1.6779e-03,  1.6164e-04],
        [-1.6063e-03,  8.4721e-05],
        [-1.8035e-03,  1.7763e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6827],
        [ 0.6178, -2.6260],
        [-0.7289,  1.4754],
        [-0.8541, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8628, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2463, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0001],
        [-0.0015,  0.0002],
        [-0.0017,  0.0001],
        [-0.0018,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6827],
        [ 0.6179, -2.6260],
        [-0.7290,  1.4754],
        [-0.8541, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1843, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0328, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3024, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026,  0.0004],
        [-0.0022,  0.0003],
        [-0.0022,  0.0003],
        [-0.0022,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6830],
        [ 0.6173, -2.6259],
        [-0.7295,  1.4756],
        [-0.8544, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7061, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2159, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022,  0.0001],
        [-0.0021,  0.0002],
        [-0.0019,  0.0001],
        [-0.0017,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6827],
        [ 0.6174, -2.6260],
        [-0.7293,  1.4754],
        [-0.8540, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7429, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2226, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8649e-03,  8.9454e-05],
        [-2.0486e-03,  6.8166e-05],
        [-1.8157e-03,  8.2143e-05],
        [-1.9696e-03,  1.0918e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6175, -2.6261],
        [-0.7292,  1.4754],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5870, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0420, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2014, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020,  0.0003],
        [-0.0018,  0.0003],
        [-0.0017,  0.0003],
        [-0.0019,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6177, -2.6259],
        [-0.7291,  1.4757],
        [-0.8542, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9757, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2762, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0001],
        [-0.0019,  0.0002],
        [-0.0018,  0.0002],
        [-0.0019,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6827],
        [ 0.6176, -2.6261],
        [-0.7292,  1.4755],
        [-0.8542, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1422, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0417, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3118, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0001],
        [-0.0018,  0.0001],
        [-0.0018,  0.0002],
        [-0.0019,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6178, -2.6261],
        [-0.7292,  1.4755],
        [-0.8541, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7979, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2397, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021,  0.0002],
        [-0.0023,  0.0002],
        [-0.0023,  0.0001],
        [-0.0023,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6827],
        [ 0.6173, -2.6260],
        [-0.7297,  1.4755],
        [-0.8545, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0210, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2812, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6448e-03,  9.2657e-05],
        [-1.5070e-03,  7.6965e-05],
        [-1.9045e-03,  1.6825e-04],
        [-1.6843e-03,  1.9794e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6826],
        [ 0.6181, -2.6262],
        [-0.7293,  1.4755],
        [-0.8539, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8690, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2438, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5229e-03,  6.0269e-05],
        [-1.7773e-03,  1.1411e-04],
        [-1.8421e-03,  1.4877e-04],
        [-1.5770e-03,  4.8412e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6826],
        [ 0.6178, -2.6261],
        [-0.7293,  1.4755],
        [-0.8538, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6775, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2134, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9697e-03,  1.1042e-04],
        [-1.9012e-03,  6.7866e-05],
        [-2.4379e-03,  3.2404e-04],
        [-1.9976e-03,  2.0560e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6177, -2.6262],
        [-0.7299,  1.4757],
        [-0.8543, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8000, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2380, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022,  0.0002],
        [-0.0022,  0.0001],
        [-0.0020,  0.0002],
        [-0.0020,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6827],
        [ 0.6174, -2.6261],
        [-0.7295,  1.4756],
        [-0.8542, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6419, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2027, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9192e-03,  1.0871e-04],
        [-1.8547e-03,  5.5477e-05],
        [-1.5991e-03,  3.6906e-05],
        [-1.6237e-03, -2.8780e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6178, -2.6262],
        [-0.7291,  1.4755],
        [-0.8539, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8257, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2402, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8967e-03,  1.1225e-04],
        [-1.6085e-03, -1.1435e-05],
        [-1.8885e-03,  1.9374e-05],
        [-1.8678e-03,  9.5962e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6180, -2.6263],
        [-0.7294,  1.4754],
        [-0.8541, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7060, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2109, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 2, Batch:100, loss: 0.002109, Time: 36.8
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024,  0.0001],
        [-0.0027,  0.0002],
        [-0.0025,  0.0002],
        [-0.0025,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6826],
        [ 0.6170, -2.6261],
        [-0.7300,  1.4757],
        [-0.8547, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5832, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1860, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.0338e-03,  1.7830e-04],
        [-1.8512e-03,  1.3893e-04],
        [-1.9190e-03,  1.1856e-04],
        [-1.8611e-03,  9.4035e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6178, -2.6261],
        [-0.7294,  1.4756],
        [-0.8541, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8930, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0343, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2473, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.3192e-03,  9.6306e-06],
        [-2.3058e-03,  3.6178e-05],
        [-2.5594e-03,  6.0211e-05],
        [-2.4068e-03,  9.7119e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6825],
        [ 0.6173, -2.6262],
        [-0.7300,  1.4755],
        [-0.8547, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0859, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2996, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.0317e-03,  1.0488e-05],
        [-1.9000e-03, -4.1005e-05],
        [-1.9314e-03,  3.3356e-05],
        [-1.9990e-03,  5.5468e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6825],
        [ 0.6177, -2.6263],
        [-0.7294,  1.4755],
        [-0.8543, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0818, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0467, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3097, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6171e-03,  1.0390e-04],
        [-1.7865e-03, -4.0751e-05],
        [-1.9194e-03,  1.4921e-04],
        [-1.8853e-03,  8.6191e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6825],
        [ 0.6179, -2.6263],
        [-0.7294,  1.4756],
        [-0.8541, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7609, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2286, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9150e-03,  7.6699e-06],
        [-1.9979e-03,  5.6240e-05],
        [-1.9577e-03,  3.0007e-05],
        [-2.0996e-03, -6.5459e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6824],
        [ 0.6177, -2.6262],
        [-0.7295,  1.4755],
        [-0.8543, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5137, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1776, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.0251e-03,  2.0108e-05],
        [-1.9628e-03,  1.1738e-04],
        [-1.9419e-03,  3.4304e-05],
        [-1.9505e-03, -7.7907e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6824],
        [ 0.6177, -2.6262],
        [-0.7294,  1.4755],
        [-0.8542, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9536, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2673, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1271e-03,  6.9860e-05],
        [-2.2566e-03,  8.0518e-05],
        [-1.9400e-03,  3.1638e-05],
        [-1.8630e-03,  5.2099e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6174, -2.6262],
        [-0.7294,  1.4755],
        [-0.8541, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7691, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2359, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2176e-03, -8.2381e-06],
        [-2.1337e-03,  1.0749e-05],
        [-2.0688e-03, -2.8166e-05],
        [-2.1916e-03,  1.6772e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6824],
        [ 0.6175, -2.6263],
        [-0.7296,  1.4754],
        [-0.8544, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6309, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2043, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.0305e-03,  8.7787e-05],
        [-2.4313e-03,  2.5265e-04],
        [-2.2302e-03,  2.3436e-05],
        [-2.4370e-03,  1.3857e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6825],
        [ 0.6173, -2.6261],
        [-0.7297,  1.4755],
        [-0.8547, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7192, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2181, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8622e-03,  1.2598e-05],
        [-1.5580e-03, -8.1347e-05],
        [-1.6584e-03, -6.0578e-05],
        [-2.0100e-03, -7.3696e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6824],
        [ 0.6181, -2.6264],
        [-0.7292,  1.4754],
        [-0.8542, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9141, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0315, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2457, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2283e-03,  1.5011e-04],
        [-2.6033e-03,  1.1243e-04],
        [-2.4463e-03,  1.2392e-05],
        [-2.0897e-03,  1.3526e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6171, -2.6262],
        [-0.7300,  1.4754],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6759, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2163, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6974e-03, -9.2481e-05],
        [-1.5549e-03, -1.9037e-04],
        [-1.4721e-03, -7.6998e-05],
        [-1.5283e-03, -1.3133e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6823],
        [ 0.6181, -2.6265],
        [-0.7290,  1.4754],
        [-0.8537, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7272, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2247, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5075e-03, -7.4402e-05],
        [-1.9767e-03, -1.7787e-04],
        [-2.1392e-03, -6.6184e-05],
        [-2.1102e-03, -1.6852e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6823],
        [ 0.6177, -2.6265],
        [-0.7296,  1.4754],
        [-0.8543, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8676, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2406, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0020, -0.0001],
        [-0.0023, -0.0002],
        [-0.0020, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6822],
        [ 0.6176, -2.6265],
        [-0.7298,  1.4752],
        [-0.8542, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7399, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2183, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1445e-03, -4.9357e-05],
        [-1.9371e-03, -1.1114e-04],
        [-2.1420e-03, -6.2713e-05],
        [-2.0958e-03, -1.3246e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6823],
        [ 0.6177, -2.6265],
        [-0.7297,  1.4754],
        [-0.8543, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5698, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1963, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8058e-03, -7.9487e-05],
        [-1.8838e-03, -2.0780e-04],
        [-1.6326e-03, -7.9824e-05],
        [-1.9133e-03, -8.5225e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6823],
        [ 0.6178, -2.6266],
        [-0.7291,  1.4753],
        [-0.8541, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4672, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3625, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0024, -0.0002],
        [-0.0024, -0.0002],
        [-0.0024, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6822],
        [ 0.6173, -2.6265],
        [-0.7299,  1.4752],
        [-0.8546, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6572, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0451, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2217, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2490e-03, -7.7189e-05],
        [-2.2289e-03, -3.9802e-05],
        [-2.4623e-03, -4.3312e-05],
        [-2.4467e-03,  6.6044e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6823],
        [ 0.6174, -2.6264],
        [-0.7300,  1.4754],
        [-0.8547, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5329, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0323, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1712, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1007e-03, -4.9855e-05],
        [-1.8374e-03, -1.1047e-04],
        [-2.1365e-03, -2.3658e-05],
        [-2.0352e-03, -1.1630e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6824],
        [ 0.6178, -2.6265],
        [-0.7297,  1.4754],
        [-0.8543, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6847, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2153, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1980e-03, -9.2057e-05],
        [-2.1356e-03, -1.6058e-04],
        [-2.1746e-03, -1.9647e-04],
        [-2.3838e-03, -1.8327e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6823],
        [ 0.6175, -2.6266],
        [-0.7297,  1.4752],
        [-0.8546, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7906, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2378, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6797e-03, -2.0614e-04],
        [-2.0729e-03, -1.3179e-04],
        [-1.9746e-03, -1.8929e-04],
        [-1.8589e-03, -9.6476e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6822],
        [ 0.6176, -2.6265],
        [-0.7295,  1.4752],
        [-0.8541, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6505, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2100, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0019, -0.0002],
        [-0.0022, -0.0001],
        [-0.0020, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6822],
        [ 0.6177, -2.6266],
        [-0.7298,  1.4753],
        [-0.8542, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7307, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2180, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018, -0.0002],
        [-0.0019, -0.0003],
        [-0.0017, -0.0003],
        [-0.0019, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6822],
        [ 0.6177, -2.6267],
        [-0.7293,  1.4752],
        [-0.8541, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8177, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2403, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019, -0.0002],
        [-0.0022, -0.0002],
        [-0.0021, -0.0002],
        [-0.0019, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6822],
        [ 0.6174, -2.6266],
        [-0.7296,  1.4752],
        [-0.8541, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8109, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2403, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0021, -0.0002],
        [-0.0021, -0.0003],
        [-0.0020, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6822],
        [ 0.6175, -2.6266],
        [-0.7296,  1.4752],
        [-0.8542, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5253, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1734, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0002],
        [-0.0020, -0.0002],
        [-0.0023, -0.0003],
        [-0.0020, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6822],
        [ 0.6176, -2.6267],
        [-0.7298,  1.4751],
        [-0.8542, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7198, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2205, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0018, -0.0003],
        [-0.0019, -0.0003],
        [-0.0021, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6822],
        [ 0.6177, -2.6267],
        [-0.7295,  1.4752],
        [-0.8543, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6751, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2109, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0025, -0.0004],
        [-0.0021, -0.0002],
        [-0.0024, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6822],
        [ 0.6170, -2.6268],
        [-0.7297,  1.4753],
        [-0.8546, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5596, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1817, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0003],
        [-0.0025, -0.0002],
        [-0.0022, -0.0002],
        [-0.0024, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6822],
        [ 0.6171, -2.6267],
        [-0.7297,  1.4753],
        [-0.8546, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6818, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2143, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0004],
        [-0.0021, -0.0003],
        [-0.0022, -0.0003],
        [-0.0022, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6820],
        [ 0.6174, -2.6267],
        [-0.7297,  1.4752],
        [-0.8544, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6058, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1950, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0004],
        [-0.0018, -0.0003],
        [-0.0017, -0.0002],
        [-0.0020, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6821],
        [ 0.6178, -2.6268],
        [-0.7293,  1.4753],
        [-0.8542, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3152, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0461, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3553, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019, -0.0004],
        [-0.0020, -0.0004],
        [-0.0021, -0.0004],
        [-0.0021, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6821],
        [ 0.6175, -2.6268],
        [-0.7296,  1.4751],
        [-0.8542, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8215, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0469, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2581, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0020, -0.0003],
        [-0.0020, -0.0003],
        [-0.0023, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6822],
        [ 0.6176, -2.6267],
        [-0.7296,  1.4752],
        [-0.8545, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7174, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2202, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0004],
        [-0.0021, -0.0003],
        [-0.0020, -0.0004],
        [-0.0020, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6821],
        [ 0.6175, -2.6267],
        [-0.7295,  1.4751],
        [-0.8541, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7267, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2210, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016, -0.0003],
        [-0.0020, -0.0004],
        [-0.0017, -0.0004],
        [-0.0016, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6822],
        [ 0.6175, -2.6268],
        [-0.7292,  1.4751],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7492, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2240, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0004],
        [-0.0021, -0.0004],
        [-0.0021, -0.0003],
        [-0.0022, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6821],
        [ 0.6174, -2.6268],
        [-0.7296,  1.4752],
        [-0.8544, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7456, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2225, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0004],
        [-0.0024, -0.0005],
        [-0.0024, -0.0004],
        [-0.0021, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6821],
        [ 0.6172, -2.6269],
        [-0.7299,  1.4751],
        [-0.8543, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5721, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1914, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0005],
        [-0.0023, -0.0005],
        [-0.0023, -0.0005],
        [-0.0026, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6820],
        [ 0.6172, -2.6269],
        [-0.7298,  1.4750],
        [-0.8547, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8195, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2394, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0004],
        [-0.0024, -0.0004],
        [-0.0026, -0.0003],
        [-0.0023, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6821],
        [ 0.6172, -2.6268],
        [-0.7300,  1.4752],
        [-0.8544, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7855, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0339, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2249, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028, -0.0004],
        [-0.0029, -0.0003],
        [-0.0029, -0.0004],
        [-0.0027, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6821],
        [ 0.6166, -2.6267],
        [-0.7304,  1.4752],
        [-0.8548, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9130, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2526, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0020, -0.0003],
        [-0.0024, -0.0003],
        [-0.0022, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6822],
        [ 0.6175, -2.6266],
        [-0.7299,  1.4753],
        [-0.8543, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2921, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3284, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020, -0.0003],
        [-0.0020, -0.0005],
        [-0.0022, -0.0004],
        [-0.0021, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6822],
        [ 0.6175, -2.6268],
        [-0.7297,  1.4752],
        [-0.8542, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6462, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2108, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018, -0.0003],
        [-0.0017, -0.0004],
        [-0.0017, -0.0005],
        [-0.0020, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6822],
        [ 0.6178, -2.6267],
        [-0.7292,  1.4751],
        [-0.8541, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9949, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2702, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019, -0.0004],
        [-0.0019, -0.0003],
        [-0.0021, -0.0006],
        [-0.0023, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6821],
        [ 0.6176, -2.6267],
        [-0.7296,  1.4750],
        [-0.8544, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1385, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3106, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020, -0.0004],
        [-0.0018, -0.0004],
        [-0.0017, -0.0004],
        [-0.0015, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6821],
        [ 0.6177, -2.6268],
        [-0.7292,  1.4752],
        [-0.8536, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7593, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2185, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0004],
        [-0.0022, -0.0003],
        [-0.0024, -0.0005],
        [-0.0025, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6821],
        [ 0.6173, -2.6266],
        [-0.7299,  1.4751],
        [-0.8546, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7263, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2248, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0003],
        [-0.0026, -0.0002],
        [-0.0026, -0.0003],
        [-0.0027, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6822],
        [ 0.6169, -2.6266],
        [-0.7301,  1.4753],
        [-0.8548, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8814, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2471, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0003],
        [-0.0018, -0.0003],
        [-0.0019, -0.0003],
        [-0.0019, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6822],
        [ 0.6177, -2.6266],
        [-0.7294,  1.4753],
        [-0.8540, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6873, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2057, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0004],
        [-0.0018, -0.0004],
        [-0.0019, -0.0003],
        [-0.0018, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6821],
        [ 0.6177, -2.6267],
        [-0.7294,  1.4753],
        [-0.8539, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0881, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0424, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3025, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0020, -0.0003],
        [-0.0023, -0.0002],
        [-0.0021, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6822],
        [ 0.6175, -2.6266],
        [-0.7298,  1.4754],
        [-0.8542, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0982, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2984, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0002],
        [-0.0020, -0.0002],
        [-0.0018, -0.0002],
        [-0.0020, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6823],
        [ 0.6175, -2.6265],
        [-0.7293,  1.4754],
        [-0.8541, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6707, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2144, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0004],
        [-0.0021, -0.0003],
        [-0.0017, -0.0003],
        [-0.0019, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6821],
        [ 0.6174, -2.6266],
        [-0.7292,  1.4753],
        [-0.8540, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6360, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1985, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0003],
        [-0.0023, -0.0002],
        [-0.0022, -0.0003],
        [-0.0026, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6822],
        [ 0.6172, -2.6265],
        [-0.7297,  1.4754],
        [-0.8547, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8353, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2506, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0004],
        [-0.0022, -0.0004],
        [-0.0023, -0.0004],
        [-0.0023, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6821],
        [ 0.6173, -2.6266],
        [-0.7297,  1.4752],
        [-0.8544, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5633, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1901, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0003],
        [-0.0023, -0.0002],
        [-0.0025, -0.0003],
        [-0.0024, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6822],
        [ 0.6172, -2.6264],
        [-0.7300,  1.4753],
        [-0.8545, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2027, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0325, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3056, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028, -0.0003],
        [-0.0026, -0.0002],
        [-0.0026, -0.0003],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6823],
        [ 0.6169, -2.6265],
        [-0.7301,  1.4754],
        [-0.8547, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5757, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1923, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1830e-03, -9.7916e-05],
        [-2.2261e-03, -1.1616e-04],
        [-2.2653e-03, -1.4100e-04],
        [-1.9629e-03, -1.6508e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6824],
        [ 0.6173, -2.6263],
        [-0.7298,  1.4755],
        [-0.8540, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6747, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2103, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0004],
        [-0.0022, -0.0004],
        [-0.0020, -0.0003],
        [-0.0020, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6822],
        [ 0.6173, -2.6266],
        [-0.7295,  1.4753],
        [-0.8541, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7630, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2279, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031, -0.0003],
        [-0.0028, -0.0003],
        [-0.0028, -0.0003],
        [-0.0029, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6822],
        [ 0.6167, -2.6265],
        [-0.7303,  1.4753],
        [-0.8550, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6074, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1981, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0003],
        [-0.0024, -0.0003],
        [-0.0026, -0.0003],
        [-0.0023, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6822],
        [ 0.6171, -2.6265],
        [-0.7301,  1.4754],
        [-0.8543, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7826, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2314, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0004],
        [-0.0024, -0.0003],
        [-0.0024, -0.0003],
        [-0.0023, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6822],
        [ 0.6171, -2.6264],
        [-0.7299,  1.4754],
        [-0.8543, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7090, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2222, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0004],
        [-0.0023, -0.0003],
        [-0.0024, -0.0004],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6822],
        [ 0.6172, -2.6265],
        [-0.7299,  1.4753],
        [-0.8547, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4907, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1802, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0023, -0.0003],
        [-0.0023, -0.0004],
        [-0.0024, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6823],
        [ 0.6172, -2.6265],
        [-0.7298,  1.4753],
        [-0.8544, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5385, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1753, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0004],
        [-0.0021, -0.0003],
        [-0.0025, -0.0003],
        [-0.0025, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6822],
        [ 0.6175, -2.6265],
        [-0.7300,  1.4754],
        [-0.8545, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7708, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2266, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018, -0.0004],
        [-0.0020, -0.0003],
        [-0.0016, -0.0003],
        [-0.0019, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6822],
        [ 0.6176, -2.6265],
        [-0.7291,  1.4754],
        [-0.8540, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8444, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2470, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020, -0.0004],
        [-0.0021, -0.0004],
        [-0.0018, -0.0004],
        [-0.0021, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6821],
        [ 0.6175, -2.6266],
        [-0.7293,  1.4752],
        [-0.8541, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5913, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1920, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0003],
        [-0.0027, -0.0004],
        [-0.0024, -0.0003],
        [-0.0025, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6822],
        [ 0.6168, -2.6266],
        [-0.7299,  1.4753],
        [-0.8545, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8932, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0458, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2702, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018, -0.0003],
        [-0.0022, -0.0004],
        [-0.0022, -0.0003],
        [-0.0021, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6822],
        [ 0.6173, -2.6266],
        [-0.7297,  1.4754],
        [-0.8542, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7451, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0302, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2094, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0005],
        [-0.0019, -0.0004],
        [-0.0022, -0.0005],
        [-0.0022, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6820],
        [ 0.6176, -2.6265],
        [-0.7298,  1.4752],
        [-0.8542, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5448, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0339, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1767, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0003],
        [-0.0022, -0.0003],
        [-0.0022, -0.0004],
        [-0.0023, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6822],
        [ 0.6173, -2.6264],
        [-0.7297,  1.4753],
        [-0.8543, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5626, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1912, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0002],
        [-0.0024, -0.0004],
        [-0.0024, -0.0003],
        [-0.0023, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6823],
        [ 0.6171, -2.6266],
        [-0.7299,  1.4754],
        [-0.8544, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6720, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0319, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1981, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0003],
        [-0.0023, -0.0004],
        [-0.0024, -0.0002],
        [-0.0023, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6822],
        [ 0.6172, -2.6265],
        [-0.7300,  1.4754],
        [-0.8544, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6911, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2149, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0003],
        [-0.0023, -0.0002],
        [-0.0027, -0.0001],
        [-0.0025, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6822],
        [ 0.6172, -2.6264],
        [-0.7302,  1.4756],
        [-0.8545, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8506, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2496, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0003],
        [-0.0027, -0.0003],
        [-0.0026, -0.0003],
        [-0.0025, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6822],
        [ 0.6168, -2.6265],
        [-0.7302,  1.4754],
        [-0.8546, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7542, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2224, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0003],
        [-0.0020, -0.0003],
        [-0.0021, -0.0003],
        [-0.0021, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6822],
        [ 0.6175, -2.6264],
        [-0.7296,  1.4754],
        [-0.8542, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7595, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2379, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0003],
        [-0.0027, -0.0003],
        [-0.0022, -0.0004],
        [-0.0023, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6822],
        [ 0.6168, -2.6264],
        [-0.7298,  1.4753],
        [-0.8544, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5842, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0286, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1740, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0003],
        [-0.0021, -0.0002],
        [-0.0022, -0.0002],
        [-0.0023, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6822],
        [ 0.6174, -2.6264],
        [-0.7298,  1.4755],
        [-0.8544, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9885, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2734, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0004],
        [-0.0021, -0.0004],
        [-0.0023, -0.0003],
        [-0.0026, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6821],
        [ 0.6174, -2.6266],
        [-0.7298,  1.4754],
        [-0.8547, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5397, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1886, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0023, -0.0005],
        [-0.0025, -0.0005],
        [-0.0025, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6822],
        [ 0.6172, -2.6266],
        [-0.7301,  1.4752],
        [-0.8546, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5464, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1870, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0002],
        [-0.0020, -0.0003],
        [-0.0023, -0.0003],
        [-0.0020, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6823],
        [ 0.6175, -2.6264],
        [-0.7299,  1.4754],
        [-0.8541, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4682, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1648, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0004],
        [-0.0026, -0.0003],
        [-0.0026, -0.0003],
        [-0.0022, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6821],
        [ 0.6169, -2.6265],
        [-0.7302,  1.4754],
        [-0.8543, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6447, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2073, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020, -0.0002],
        [-0.0023, -0.0003],
        [-0.0021, -0.0003],
        [-0.0019, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6823],
        [ 0.6172, -2.6264],
        [-0.7297,  1.4754],
        [-0.8540, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7743, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2259, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0003],
        [-0.0025, -0.0003],
        [-0.0029, -0.0003],
        [-0.0024, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6823],
        [ 0.6170, -2.6265],
        [-0.7305,  1.4754],
        [-0.8545, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5433, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1806, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0003],
        [-0.0024, -0.0003],
        [-0.0021, -0.0002],
        [-0.0023, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6822],
        [ 0.6172, -2.6265],
        [-0.7298,  1.4755],
        [-0.8544, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7499, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2322, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0030, -0.0003],
        [-0.0026, -0.0003],
        [-0.0025, -0.0003],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6822],
        [ 0.6169, -2.6265],
        [-0.7302,  1.4754],
        [-0.8547, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5469, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1873, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0002],
        [-0.0025, -0.0003],
        [-0.0028, -0.0002],
        [-0.0023, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6823],
        [ 0.6170, -2.6265],
        [-0.7305,  1.4755],
        [-0.8544, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8334, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2454, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020, -0.0002],
        [-0.0021, -0.0003],
        [-0.0023, -0.0002],
        [-0.0021, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6823],
        [ 0.6175, -2.6264],
        [-0.7300,  1.4755],
        [-0.8542, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6238, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2035, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019, -0.0002],
        [-0.0019, -0.0003],
        [-0.0021, -0.0002],
        [-0.0019, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6823],
        [ 0.6176, -2.6265],
        [-0.7297,  1.4755],
        [-0.8540, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7202, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2242, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020, -0.0004],
        [-0.0020, -0.0004],
        [-0.0019, -0.0004],
        [-0.0020, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6820],
        [ 0.6175, -2.6266],
        [-0.7296,  1.4753],
        [-0.8541, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6062, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0423, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2058, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0003],
        [-0.0022, -0.0005],
        [-0.0020, -0.0004],
        [-0.0024, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6822],
        [ 0.6173, -2.6267],
        [-0.7296,  1.4753],
        [-0.8546, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6625, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0329, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1983, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0002],
        [-0.0022, -0.0002],
        [-0.0022, -0.0003],
        [-0.0023, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6823],
        [ 0.6173, -2.6264],
        [-0.7299,  1.4754],
        [-0.8544, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6009, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1945, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0002],
        [-0.0025, -0.0002],
        [-0.0024, -0.0002],
        [-0.0025, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6822],
        [ 0.6170, -2.6264],
        [-0.7301,  1.4755],
        [-0.8547, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5340, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1861, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0021, -0.0002],
        [-0.0021, -0.0004],
        [-0.0020, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6822],
        [ 0.6174, -2.6264],
        [-0.7297,  1.4753],
        [-0.8542, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6120, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1958, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016, -0.0001],
        [-0.0019, -0.0002],
        [-0.0020, -0.0002],
        [-0.0017, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6823],
        [ 0.6176, -2.6264],
        [-0.7296,  1.4755],
        [-0.8539, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7511, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2226, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0002],
        [-0.0024, -0.0002],
        [-0.0027, -0.0003],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6822],
        [ 0.6171, -2.6264],
        [-0.7304,  1.4754],
        [-0.8547, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9535, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2650, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017, -0.0002],
        [-0.0020, -0.0003],
        [-0.0021, -0.0004],
        [-0.0018, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6822],
        [ 0.6175, -2.6266],
        [-0.7297,  1.4753],
        [-0.8539, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6980, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2114, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0003],
        [-0.0023, -0.0003],
        [-0.0028, -0.0003],
        [-0.0025, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6822],
        [ 0.6172, -2.6266],
        [-0.7304,  1.4754],
        [-0.8547, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6215, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2049, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0003],
        [-0.0025, -0.0003],
        [-0.0023, -0.0003],
        [-0.0024, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6821],
        [ 0.6170, -2.6265],
        [-0.7299,  1.4754],
        [-0.8546, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4651, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1638, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0003],
        [-0.0024, -0.0004],
        [-0.0022, -0.0003],
        [-0.0026, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6821],
        [ 0.6171, -2.6266],
        [-0.7298,  1.4754],
        [-0.8548, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5126, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1761, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 2, Batch:200, loss: 0.000880, Time: 71.8
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019, -0.0003],
        [-0.0019, -0.0003],
        [-0.0023, -0.0003],
        [-0.0021, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6821],
        [ 0.6176, -2.6266],
        [-0.7299,  1.4754],
        [-0.8543, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6364, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2021, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.4289e-03, -1.4523e-04],
        [-2.1845e-03, -1.6878e-04],
        [-2.0972e-03, -1.0008e-04],
        [-1.9171e-03, -1.8717e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6823],
        [ 0.6173, -2.6264],
        [-0.7297,  1.4756],
        [-0.8541, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7072, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2135, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7073e-03, -1.7499e-04],
        [-2.6438e-03, -1.9187e-04],
        [-2.4634e-03, -3.6986e-05],
        [-2.5015e-03, -9.4188e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6822],
        [ 0.6169, -2.6264],
        [-0.7301,  1.4756],
        [-0.8546, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7973, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0313, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2221, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0002],
        [-0.0021, -0.0002],
        [-0.0024, -0.0001],
        [-0.0022, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6822],
        [ 0.6174, -2.6264],
        [-0.7300,  1.4755],
        [-0.8544, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5395, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1891, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0001],
        [-0.0025, -0.0002],
        [-0.0023, -0.0002],
        [-0.0024, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6823],
        [ 0.6170, -2.6264],
        [-0.7299,  1.4755],
        [-0.8545, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6181, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1937, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0001],
        [-0.0023, -0.0002],
        [-0.0021, -0.0002],
        [-0.0019, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6822],
        [ 0.6172, -2.6264],
        [-0.7297,  1.4755],
        [-0.8541, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5181, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1835, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020, -0.0002],
        [-0.0019, -0.0002],
        [-0.0019, -0.0001],
        [-0.0019, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6822],
        [ 0.6176, -2.6264],
        [-0.7295,  1.4755],
        [-0.8540, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6284, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2018, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0002],
        [-0.0021, -0.0003],
        [-0.0019, -0.0003],
        [-0.0020, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6821],
        [ 0.6174, -2.6265],
        [-0.7295,  1.4754],
        [-0.8542, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7081, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2206, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0002],
        [-0.0022, -0.0001],
        [-0.0020, -0.0003],
        [-0.0018, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6821],
        [ 0.6172, -2.6263],
        [-0.7296,  1.4754],
        [-0.8540, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6892, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2187, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0002],
        [-0.0019, -0.0003],
        [-0.0023, -0.0002],
        [-0.0021, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6821],
        [ 0.6175, -2.6265],
        [-0.7299,  1.4755],
        [-0.8542, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7655, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0462, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2455, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0001],
        [-0.0025, -0.0001],
        [-0.0020, -0.0002],
        [-0.0026, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6822],
        [ 0.6170, -2.6263],
        [-0.7296,  1.4755],
        [-0.8547, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6670, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0432, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2197, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0002],
        [-0.0021, -0.0002],
        [-0.0026, -0.0001],
        [-0.0024, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6822],
        [ 0.6173, -2.6264],
        [-0.7302,  1.4755],
        [-0.8546, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8992, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2554, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5397e-03, -6.5324e-05],
        [-2.8322e-03, -8.2174e-05],
        [-2.8626e-03, -3.7384e-05],
        [-2.6567e-03, -1.6477e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6823],
        [ 0.6166, -2.6263],
        [-0.7305,  1.4756],
        [-0.8548, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5785, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1873, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.4903e-03, -1.0144e-04],
        [-2.4095e-03, -1.2221e-04],
        [-2.6356e-03,  2.2663e-05],
        [-2.4751e-03, -4.6922e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6822],
        [ 0.6171, -2.6263],
        [-0.7302,  1.4757],
        [-0.8546, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4854, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1745, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018, -0.0002],
        [-0.0018, -0.0002],
        [-0.0018, -0.0002],
        [-0.0019, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6821],
        [ 0.6176, -2.6263],
        [-0.7294,  1.4755],
        [-0.8540, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6325, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2043, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9314e-03, -1.8563e-04],
        [-2.1727e-03, -9.5733e-05],
        [-2.0828e-03, -2.7320e-04],
        [-2.4633e-03, -2.2930e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6821],
        [ 0.6173, -2.6263],
        [-0.7297,  1.4754],
        [-0.8546, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4994, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1876, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0020, -0.0002],
        [-0.0023, -0.0002],
        [-0.0022, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6822],
        [ 0.6174, -2.6263],
        [-0.7299,  1.4755],
        [-0.8543, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6228, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1968, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1987e-03, -1.9453e-04],
        [-2.3859e-03, -9.2653e-05],
        [-2.6504e-03, -1.2953e-04],
        [-2.5120e-03, -2.1931e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6821],
        [ 0.6171, -2.6263],
        [-0.7302,  1.4756],
        [-0.8546, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5368, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0318, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1709, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.8709e-03, -4.9533e-05],
        [-3.0361e-03, -6.8278e-05],
        [-3.0102e-03,  2.1022e-05],
        [-3.0732e-03,  3.6235e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6823],
        [ 0.6164, -2.6262],
        [-0.7306,  1.4757],
        [-0.8552, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6813, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2087, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2428e-03,  1.7198e-05],
        [-2.5080e-03, -1.7959e-05],
        [-2.3687e-03, -1.2719e-04],
        [-2.0101e-03, -3.5098e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6823],
        [ 0.6170, -2.6262],
        [-0.7299,  1.4756],
        [-0.8541, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6086, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2000, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.8334e-03, -1.0289e-04],
        [-2.8677e-03,  2.5753e-05],
        [-2.9299e-03, -1.2607e-05],
        [-3.1581e-03,  9.0367e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6822],
        [ 0.6166, -2.6261],
        [-0.7305,  1.4757],
        [-0.8552, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5365, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0474, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2022, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8990e-03, -9.0769e-05],
        [-2.0161e-03, -8.2553e-05],
        [-2.0769e-03, -4.1709e-05],
        [-1.9201e-03, -1.0203e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6822],
        [ 0.6175, -2.6262],
        [-0.7296,  1.4757],
        [-0.8540, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6173, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2019, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.3025e-03, -4.1090e-05],
        [-2.2241e-03, -7.0724e-06],
        [-1.9983e-03, -1.3798e-04],
        [-2.2193e-03, -5.3615e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6823],
        [ 0.6172, -2.6261],
        [-0.7295,  1.4756],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7903, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2314, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2556e-03, -3.4270e-05],
        [-2.5163e-03, -1.0064e-04],
        [-2.0772e-03, -9.5721e-05],
        [-2.2838e-03, -8.9859e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6823],
        [ 0.6170, -2.6262],
        [-0.7296,  1.4756],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0644, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2915, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0003],
        [-0.0024, -0.0002],
        [-0.0023, -0.0002],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6820],
        [ 0.6171, -2.6264],
        [-0.7298,  1.4755],
        [-0.8546, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6188, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2012, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0002],
        [-0.0022, -0.0002],
        [-0.0022, -0.0002],
        [-0.0023, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6821],
        [ 0.6173, -2.6263],
        [-0.7297,  1.4755],
        [-0.8544, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6012, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1906, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2157e-03, -9.4761e-05],
        [-2.8853e-03, -6.6263e-05],
        [-2.5315e-03, -3.6780e-05],
        [-2.6757e-03, -9.6871e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6822],
        [ 0.6166, -2.6262],
        [-0.7300,  1.4757],
        [-0.8547, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7665, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2393, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9177e-03, -6.3172e-05],
        [-2.2024e-03, -1.9731e-04],
        [-2.3355e-03, -1.3243e-04],
        [-2.1907e-03, -1.5822e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6822],
        [ 0.6173, -2.6263],
        [-0.7298,  1.4756],
        [-0.8542, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6392, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2033, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.3399e-03, -4.9352e-05],
        [-2.1083e-03, -6.8558e-05],
        [-2.4758e-03, -6.3024e-05],
        [-2.4781e-03, -7.3606e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6822],
        [ 0.6174, -2.6262],
        [-0.7300,  1.4756],
        [-0.8545, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7204, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2255, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.4803e-03, -5.4426e-05],
        [-2.4742e-03, -1.0217e-04],
        [-2.2811e-03, -8.9689e-05],
        [-2.5059e-03,  3.0485e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6822],
        [ 0.6170, -2.6262],
        [-0.7298,  1.4756],
        [-0.8545, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5729, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1812, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.8686e-03, -8.5277e-05],
        [-2.5405e-03, -8.3901e-05],
        [-2.7386e-03, -8.8825e-06],
        [-2.7640e-03, -1.1979e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6822],
        [ 0.6169, -2.6262],
        [-0.7302,  1.4757],
        [-0.8548, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0243, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2721, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.6655e-03, -2.0419e-04],
        [-2.8225e-03, -8.4748e-05],
        [-2.5166e-03, -1.6520e-04],
        [-2.6760e-03, -1.3114e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6821],
        [ 0.6167, -2.6262],
        [-0.7300,  1.4755],
        [-0.8547, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6182, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1968, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7844e-03, -6.7471e-05],
        [-2.4358e-03, -6.2828e-05],
        [-2.1423e-03, -8.6617e-05],
        [-2.5964e-03, -4.1340e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6822],
        [ 0.6171, -2.6262],
        [-0.7296,  1.4756],
        [-0.8546, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5940, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1964, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0022, -0.0002],
        [-0.0027, -0.0002],
        [-0.0025, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6821],
        [ 0.6173, -2.6264],
        [-0.7301,  1.4755],
        [-0.8545, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6629, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2020, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0001],
        [-0.0023, -0.0002],
        [-0.0027, -0.0001],
        [-0.0022, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6822],
        [ 0.6172, -2.6263],
        [-0.7301,  1.4756],
        [-0.8542, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6420, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2066, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.3626e-03, -1.2892e-04],
        [-2.2742e-03, -7.9619e-05],
        [-2.6059e-03, -1.3817e-04],
        [-2.5661e-03, -1.1211e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6821],
        [ 0.6172, -2.6262],
        [-0.7300,  1.4756],
        [-0.8545, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5038, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1762, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0028, -0.0002],
        [-0.0025, -0.0002],
        [-0.0025, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6821],
        [ 0.6167, -2.6263],
        [-0.7299,  1.4756],
        [-0.8545, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5694, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0328, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1796, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0002],
        [-0.0022, -0.0002],
        [-0.0024, -0.0002],
        [-0.0025, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6821],
        [ 0.6173, -2.6263],
        [-0.7298,  1.4756],
        [-0.8544, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8629, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0428, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2582, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0002],
        [-0.0023, -0.0002],
        [-0.0023, -0.0002],
        [-0.0023, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6821],
        [ 0.6173, -2.6264],
        [-0.7297,  1.4756],
        [-0.8542, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4953, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0298, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1587, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0002],
        [-0.0024, -0.0002],
        [-0.0025, -0.0002],
        [-0.0022, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6821],
        [ 0.6171, -2.6264],
        [-0.7299,  1.4756],
        [-0.8542, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6418, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2112, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0002],
        [-0.0026, -0.0002],
        [-0.0026, -0.0003],
        [-0.0025, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6821],
        [ 0.6169, -2.6264],
        [-0.7300,  1.4755],
        [-0.8544, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5380, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0449, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1974, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027, -0.0003],
        [-0.0027, -0.0002],
        [-0.0029, -0.0003],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6820],
        [ 0.6169, -2.6264],
        [-0.7303,  1.4754],
        [-0.8545, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9412, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2645, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0003],
        [-0.0026, -0.0003],
        [-0.0027, -0.0003],
        [-0.0028, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6820],
        [ 0.6170, -2.6265],
        [-0.7301,  1.4755],
        [-0.8547, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4703, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1656, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0024, -0.0001],
        [-0.0024, -0.0001],
        [-0.0028, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6821],
        [ 0.6172, -2.6263],
        [-0.7298,  1.4756],
        [-0.8547, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8399, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2447, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0020, -0.0003],
        [-0.0021, -0.0003],
        [-0.0020, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6819],
        [ 0.6175, -2.6265],
        [-0.7295,  1.4755],
        [-0.8539, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9167, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2547, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0024, -0.0002],
        [-0.0025, -0.0001],
        [-0.0027, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6820],
        [ 0.6171, -2.6264],
        [-0.7298,  1.4756],
        [-0.8546, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5981, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1992, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0030, -0.0003],
        [-0.0026, -0.0003],
        [-0.0029, -0.0003],
        [-0.0027, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6819],
        [ 0.6170, -2.6264],
        [-0.7302,  1.4755],
        [-0.8546, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4658, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1635, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032, -0.0003],
        [-0.0033, -0.0004],
        [-0.0032, -0.0002],
        [-0.0033, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6819],
        [ 0.6163, -2.6265],
        [-0.7305,  1.4755],
        [-0.8552, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5015, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1688, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0003],
        [-0.0030, -0.0004],
        [-0.0026, -0.0005],
        [-0.0027, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6819],
        [ 0.6166, -2.6266],
        [-0.7299,  1.4753],
        [-0.8545, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6479, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2034, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0003],
        [-0.0027, -0.0003],
        [-0.0028, -0.0004],
        [-0.0025, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6819],
        [ 0.6169, -2.6265],
        [-0.7301,  1.4753],
        [-0.8544, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5531, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0420, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1947, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031, -0.0004],
        [-0.0036, -0.0004],
        [-0.0030, -0.0003],
        [-0.0031, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6818],
        [ 0.6160, -2.6266],
        [-0.7303,  1.4754],
        [-0.8549, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7636, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2260, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031, -0.0004],
        [-0.0032, -0.0004],
        [-0.0034, -0.0003],
        [-0.0032, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6818],
        [ 0.6164, -2.6266],
        [-0.7306,  1.4754],
        [-0.8550, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4684, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0456, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1848, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028, -0.0003],
        [-0.0025, -0.0002],
        [-0.0026, -0.0003],
        [-0.0025, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6819],
        [ 0.6171, -2.6264],
        [-0.7298,  1.4754],
        [-0.8544, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4645, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1609, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028, -0.0002],
        [-0.0026, -0.0004],
        [-0.0028, -0.0003],
        [-0.0030, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6819],
        [ 0.6171, -2.6266],
        [-0.7300,  1.4754],
        [-0.8549, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5091, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1752, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0004],
        [-0.0026, -0.0003],
        [-0.0027, -0.0003],
        [-0.0024, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6818],
        [ 0.6170, -2.6265],
        [-0.7299,  1.4755],
        [-0.8543, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6096, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1973, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029, -0.0003],
        [-0.0027, -0.0003],
        [-0.0026, -0.0003],
        [-0.0029, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6819],
        [ 0.6169, -2.6265],
        [-0.7299,  1.4755],
        [-0.8547, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5835, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1911, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0004],
        [-0.0024, -0.0003],
        [-0.0023, -0.0004],
        [-0.0026, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6818],
        [ 0.6173, -2.6265],
        [-0.7295,  1.4754],
        [-0.8544, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4902, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1674, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027, -0.0003],
        [-0.0026, -0.0003],
        [-0.0031, -0.0004],
        [-0.0029, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6818],
        [ 0.6171, -2.6265],
        [-0.7303,  1.4753],
        [-0.8547, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5349, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0453, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1975, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0003],
        [-0.0024, -0.0004],
        [-0.0025, -0.0004],
        [-0.0029, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6818],
        [ 0.6173, -2.6266],
        [-0.7297,  1.4754],
        [-0.8548, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8777, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2537, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027, -0.0003],
        [-0.0021, -0.0002],
        [-0.0024, -0.0003],
        [-0.0026, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6818],
        [ 0.6176, -2.6264],
        [-0.7296,  1.4755],
        [-0.8545, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7290, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2221, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032, -0.0003],
        [-0.0028, -0.0002],
        [-0.0030, -0.0003],
        [-0.0030, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6818],
        [ 0.6169, -2.6264],
        [-0.7302,  1.4755],
        [-0.8548, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7702, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2350, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0003],
        [-0.0026, -0.0003],
        [-0.0029, -0.0003],
        [-0.0025, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6818],
        [ 0.6171, -2.6265],
        [-0.7301,  1.4754],
        [-0.8544, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7010, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2218, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032, -0.0002],
        [-0.0031, -0.0002],
        [-0.0028, -0.0001],
        [-0.0029, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6819],
        [ 0.6166, -2.6264],
        [-0.7300,  1.4757],
        [-0.8547, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5465, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0455, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2004, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027, -0.0003],
        [-0.0023, -0.0002],
        [-0.0026, -0.0003],
        [-0.0025, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6818],
        [ 0.6174, -2.6264],
        [-0.7298,  1.4755],
        [-0.8543, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5933, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1916, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.6949e-03, -7.3735e-05],
        [-2.4454e-03, -1.3777e-04],
        [-3.0900e-03, -9.7407e-05],
        [-2.6579e-03, -1.6779e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6820],
        [ 0.6173, -2.6264],
        [-0.7303,  1.4757],
        [-0.8545, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5835, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0318, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1803, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027, -0.0002],
        [-0.0027, -0.0002],
        [-0.0031, -0.0002],
        [-0.0028, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6818],
        [ 0.6170, -2.6264],
        [-0.7303,  1.4755],
        [-0.8547, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7243, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2189, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031, -0.0002],
        [-0.0025, -0.0002],
        [-0.0030, -0.0002],
        [-0.0030, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6818],
        [ 0.6172, -2.6264],
        [-0.7301,  1.4756],
        [-0.8549, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5258, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0314, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1680, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0029, -0.0001],
        [-0.0025, -0.0001],
        [-0.0027, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6817],
        [ 0.6169, -2.6264],
        [-0.7296,  1.4757],
        [-0.8546, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5488, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1823, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029, -0.0003],
        [-0.0031, -0.0003],
        [-0.0032, -0.0003],
        [-0.0032, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6817],
        [ 0.6166, -2.6265],
        [-0.7303,  1.4755],
        [-0.8551, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4829, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1717, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029, -0.0002],
        [-0.0028, -0.0002],
        [-0.0030, -0.0001],
        [-0.0033, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6817],
        [ 0.6169, -2.6265],
        [-0.7301,  1.4757],
        [-0.8551, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9515, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2649, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.4713e-03, -2.1982e-04],
        [-2.5575e-03, -7.1143e-05],
        [-2.6447e-03, -9.5986e-05],
        [-2.3972e-03, -1.6054e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6817],
        [ 0.6172, -2.6263],
        [-0.7298,  1.4757],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8077, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2475, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0030, -0.0001],
        [-0.0027, -0.0001],
        [-0.0032, -0.0001],
        [-0.0032, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6818],
        [ 0.6171, -2.6264],
        [-0.7303,  1.4757],
        [-0.8551, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5781, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1932, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.0763e-03, -1.1437e-04],
        [-2.9610e-03, -1.2956e-04],
        [-3.0602e-03, -7.9857e-05],
        [-3.3541e-03, -7.8913e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6818],
        [ 0.6168, -2.6264],
        [-0.7302,  1.4757],
        [-0.8553, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4597, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1735, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.0301e-03, -5.2216e-05],
        [-2.5635e-03, -8.2517e-05],
        [-3.0007e-03, -6.7072e-05],
        [-3.0953e-03, -5.4428e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6818],
        [ 0.6172, -2.6263],
        [-0.7301,  1.4758],
        [-0.8550, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6778, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2093, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.3896e-03, -1.0163e-05],
        [-2.9518e-03, -6.7400e-05],
        [-2.6839e-03, -5.3675e-05],
        [-2.8936e-03, -2.4767e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6819],
        [ 0.6168, -2.6263],
        [-0.7298,  1.4758],
        [-0.8548, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4549, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1608, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.0088e-03, -3.8312e-05],
        [-2.9523e-03, -2.1578e-05],
        [-3.1004e-03, -6.8234e-05],
        [-2.6769e-03, -4.7130e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6818],
        [ 0.6168, -2.6263],
        [-0.7302,  1.4758],
        [-0.8546, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4821, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1712, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.8758e-03, -1.1993e-04],
        [-2.7816e-03, -1.2225e-04],
        [-2.9680e-03, -4.0273e-05],
        [-2.8578e-03, -1.3653e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6817],
        [ 0.6170, -2.6264],
        [-0.7300,  1.4758],
        [-0.8548, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4946, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1849, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0001],
        [-0.0022, -0.0002],
        [-0.0022, -0.0002],
        [-0.0026, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6817],
        [ 0.6176, -2.6264],
        [-0.7293,  1.4756],
        [-0.8545, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7479, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2213, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7111e-03, -7.9164e-05],
        [-2.5330e-03, -1.3612e-04],
        [-2.5951e-03, -1.3042e-04],
        [-2.5661e-03, -4.6099e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6817],
        [ 0.6172, -2.6264],
        [-0.7297,  1.4757],
        [-0.8545, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4688, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1633, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.6541e-03,  6.5420e-06],
        [-3.0418e-03, -9.4095e-06],
        [-3.2888e-03,  2.0901e-04],
        [-3.2422e-03,  1.3934e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6818],
        [ 0.6167, -2.6263],
        [-0.7303,  1.4760],
        [-0.8552, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4019, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1590, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9170e-03, -8.1532e-05],
        [-3.1781e-03, -3.0596e-05],
        [-2.7970e-03, -6.3864e-06],
        [-2.7057e-03, -4.8234e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6817],
        [ 0.6166, -2.6263],
        [-0.7298,  1.4758],
        [-0.8546, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5970, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1935, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.4858e-03, -9.8044e-05],
        [-2.6153e-03, -1.8764e-04],
        [-2.5898e-03, -1.2931e-04],
        [-2.7511e-03, -6.3518e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6817],
        [ 0.6171, -2.6265],
        [-0.7296,  1.4757],
        [-0.8547, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5982, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1886, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7703e-03, -7.7114e-05],
        [-2.8750e-03,  1.9965e-05],
        [-2.6963e-03, -1.7314e-05],
        [-2.6169e-03,  6.8643e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6817],
        [ 0.6169, -2.6263],
        [-0.7297,  1.4758],
        [-0.8545, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6258, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0443, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2138, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.1415e-03,  2.9173e-05],
        [-2.9336e-03,  8.2699e-05],
        [-2.9816e-03,  1.8409e-05],
        [-3.1200e-03,  4.5721e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6818],
        [ 0.6168, -2.6262],
        [-0.7300,  1.4759],
        [-0.8550, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5177, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1783, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7906e-03, -8.3388e-05],
        [-2.8476e-03,  2.5281e-05],
        [-2.8576e-03, -5.9972e-05],
        [-2.4518e-03,  3.7538e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6816],
        [ 0.6169, -2.6263],
        [-0.7299,  1.4758],
        [-0.8544, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4942, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1746, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7725e-03,  9.5129e-05],
        [-2.4985e-03,  1.4186e-04],
        [-2.8209e-03,  1.2401e-04],
        [-2.5853e-03,  3.8744e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6818],
        [ 0.6172, -2.6262],
        [-0.7299,  1.4760],
        [-0.8545, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6527, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0441, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2188, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0003],
        [-0.0029,  0.0002],
        [-0.0033,  0.0001],
        [-0.0032,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6820],
        [ 0.6168, -2.6261],
        [-0.7304,  1.4759],
        [-0.8551, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5175, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1819, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9995e-03,  1.6141e-04],
        [-2.3549e-03, -4.2176e-05],
        [-2.3850e-03,  7.5738e-05],
        [-2.3728e-03,  3.5210e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6819],
        [ 0.6174, -2.6264],
        [-0.7294,  1.4759],
        [-0.8543, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6669, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2143, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0002],
        [-0.0032,  0.0002],
        [-0.0032,  0.0001],
        [-0.0032,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6819],
        [ 0.6165, -2.6261],
        [-0.7303,  1.4760],
        [-0.8551, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5912, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1944, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028,  0.0002],
        [-0.0032,  0.0003],
        [-0.0031,  0.0002],
        [-0.0032,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6819],
        [ 0.6165, -2.6260],
        [-0.7301,  1.4761],
        [-0.8551, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5100, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1806, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0002],
        [-0.0029,  0.0003],
        [-0.0027,  0.0002],
        [-0.0027,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6819],
        [ 0.6168, -2.6260],
        [-0.7297,  1.4760],
        [-0.8546, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4895, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1775, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0003],
        [-0.0035,  0.0004],
        [-0.0033,  0.0002],
        [-0.0032,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6819],
        [ 0.6162, -2.6260],
        [-0.7303,  1.4761],
        [-0.8552, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5354, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1859, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029,  0.0002],
        [-0.0031,  0.0002],
        [-0.0029,  0.0002],
        [-0.0030,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6819],
        [ 0.6166, -2.6261],
        [-0.7300,  1.4760],
        [-0.8550, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6741, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2108, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0004],
        [-0.0037,  0.0003],
        [-0.0033,  0.0003],
        [-0.0037,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6820],
        [ 0.6160, -2.6260],
        [-0.7303,  1.4761],
        [-0.8557, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5282, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1848, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0004],
        [-0.0031,  0.0002],
        [-0.0030,  0.0003],
        [-0.0033,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6820],
        [ 0.6166, -2.6261],
        [-0.7300,  1.4761],
        [-0.8552, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6307, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1954, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0003],
        [-0.0030,  0.0004],
        [-0.0031,  0.0004],
        [-0.0033,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6819],
        [ 0.6167, -2.6259],
        [-0.7302,  1.4762],
        [-0.8552, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5802, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1892, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0003],
        [-0.0034,  0.0003],
        [-0.0036,  0.0004],
        [-0.0033,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6819],
        [ 0.6162, -2.6260],
        [-0.7306,  1.4762],
        [-0.8552, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3876, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1590, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.6227e-03,  1.8842e-04],
        [-2.8187e-03,  2.0236e-04],
        [-2.5307e-03,  9.8134e-05],
        [-2.5452e-03,  1.5531e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6817],
        [ 0.6168, -2.6261],
        [-0.7296,  1.4759],
        [-0.8545, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5562, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1936, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026,  0.0004],
        [-0.0026,  0.0003],
        [-0.0024,  0.0002],
        [-0.0027,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6819],
        [ 0.6171, -2.6261],
        [-0.7294,  1.4761],
        [-0.8546, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6924, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0466, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2316, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0003],
        [-0.0036,  0.0003],
        [-0.0036,  0.0003],
        [-0.0034,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6819],
        [ 0.6161, -2.6261],
        [-0.7306,  1.4761],
        [-0.8553, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6438, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2070, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 2, Batch:300, loss: 0.000690, Time: 107.2
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0004],
        [-0.0031,  0.0004],
        [-0.0033,  0.0004],
        [-0.0036,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6819],
        [ 0.6165, -2.6259],
        [-0.7303,  1.4762],
        [-0.8556, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4644, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0421, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1771, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028,  0.0002],
        [-0.0030,  0.0003],
        [-0.0029,  0.0003],
        [-0.0027,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6817],
        [ 0.6166, -2.6260],
        [-0.7299,  1.4761],
        [-0.8547, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4771, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1682, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0004],
        [-0.0034,  0.0004],
        [-0.0033,  0.0005],
        [-0.0032,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6819],
        [ 0.6162, -2.6259],
        [-0.7303,  1.4763],
        [-0.8551, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5650, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1883, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0004],
        [-0.0031,  0.0003],
        [-0.0033,  0.0004],
        [-0.0032,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6818],
        [ 0.6165, -2.6260],
        [-0.7303,  1.4762],
        [-0.8551, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5791, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1980, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029,  0.0003],
        [-0.0028,  0.0004],
        [-0.0029,  0.0003],
        [-0.0030,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6818],
        [ 0.6168, -2.6260],
        [-0.7299,  1.4762],
        [-0.8549, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6584, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0462, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2241, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0003],
        [-0.0032,  0.0004],
        [-0.0033,  0.0004],
        [-0.0032,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6818],
        [ 0.6163, -2.6260],
        [-0.7303,  1.4762],
        [-0.8551, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  33
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4960, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1705, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0006],
        [-0.0035,  0.0006],
        [-0.0038,  0.0005],
        [-0.0034,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6821],
        [ 0.6161, -2.6258],
        [-0.7308,  1.4764],
        [-0.8553, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6552, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2096, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028,  0.0004],
        [-0.0031,  0.0004],
        [-0.0029,  0.0004],
        [-0.0027,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6818],
        [ 0.6164, -2.6259],
        [-0.7299,  1.4763],
        [-0.8546, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5864, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1930, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0004],
        [-0.0033,  0.0005],
        [-0.0033,  0.0004],
        [-0.0032,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6818],
        [ 0.6163, -2.6259],
        [-0.7303,  1.4763],
        [-0.8551, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4341, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0437, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1743, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0005],
        [-0.0033,  0.0006],
        [-0.0031,  0.0004],
        [-0.0034,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6820],
        [ 0.6162, -2.6257],
        [-0.7301,  1.4763],
        [-0.8553, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5773, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1954, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0005],
        [-0.0032,  0.0004],
        [-0.0029,  0.0004],
        [-0.0033,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6819],
        [ 0.6163, -2.6260],
        [-0.7299,  1.4763],
        [-0.8552, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6700, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2125, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027,  0.0004],
        [-0.0030,  0.0005],
        [-0.0032,  0.0005],
        [-0.0028,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6819],
        [ 0.6166, -2.6259],
        [-0.7302,  1.4764],
        [-0.8547, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6039, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1947, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025,  0.0004],
        [-0.0029,  0.0005],
        [-0.0028,  0.0005],
        [-0.0025,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6818],
        [ 0.6167, -2.6258],
        [-0.7298,  1.4764],
        [-0.8544, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4612, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1682, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0005],
        [-0.0033,  0.0005],
        [-0.0033,  0.0005],
        [-0.0028,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6819],
        [ 0.6162, -2.6258],
        [-0.7303,  1.4765],
        [-0.8547, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4149, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0477, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1783, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0030,  0.0003],
        [-0.0030,  0.0004],
        [-0.0030,  0.0004],
        [-0.0029,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6818],
        [ 0.6165, -2.6259],
        [-0.7300,  1.4763],
        [-0.8548, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4304, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1564, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0005],
        [-0.0038,  0.0005],
        [-0.0032,  0.0004],
        [-0.0036,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3078,  0.6820],
        [ 0.6157, -2.6258],
        [-0.7302,  1.4764],
        [-0.8555, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5438, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1833, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0005],
        [-0.0034,  0.0006],
        [-0.0035,  0.0007],
        [-0.0034,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6820],
        [ 0.6161, -2.6257],
        [-0.7305,  1.4767],
        [-0.8553, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5188, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0317, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1672, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0004],
        [-0.0033,  0.0005],
        [-0.0031,  0.0005],
        [-0.0030,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6819],
        [ 0.6162, -2.6258],
        [-0.7300,  1.4765],
        [-0.8549, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4747, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1639, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028,  0.0005],
        [-0.0028,  0.0003],
        [-0.0029,  0.0006],
        [-0.0029,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6820],
        [ 0.6167, -2.6259],
        [-0.7299,  1.4766],
        [-0.8548, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8847, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2563, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0006],
        [-0.0029,  0.0007],
        [-0.0032,  0.0006],
        [-0.0032,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6822],
        [ 0.6166, -2.6256],
        [-0.7302,  1.4766],
        [-0.8551, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7423, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2262, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028,  0.0005],
        [-0.0029,  0.0005],
        [-0.0028,  0.0005],
        [-0.0030,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6821],
        [ 0.6166, -2.6258],
        [-0.7298,  1.4766],
        [-0.8549, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5042, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1810, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0005],
        [-0.0034,  0.0005],
        [-0.0032,  0.0006],
        [-0.0032,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6820],
        [ 0.6160, -2.6257],
        [-0.7302,  1.4767],
        [-0.8551, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4902, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1736, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0008],
        [-0.0037,  0.0007],
        [-0.0037,  0.0008],
        [-0.0036,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6824],
        [ 0.6158, -2.6255],
        [-0.7307,  1.4768],
        [-0.8555, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4742, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1777, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0007],
        [-0.0026,  0.0005],
        [-0.0030,  0.0006],
        [-0.0030,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6823],
        [ 0.6168, -2.6258],
        [-0.7300,  1.4766],
        [-0.8549, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5460, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1808, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029,  0.0004],
        [-0.0026,  0.0004],
        [-0.0032,  0.0003],
        [-0.0028,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6820],
        [ 0.6168, -2.6258],
        [-0.7301,  1.4764],
        [-0.8547, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4382, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0329, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1534, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0008],
        [-0.0034,  0.0009],
        [-0.0037,  0.0009],
        [-0.0033,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6824],
        [ 0.6160, -2.6254],
        [-0.7306,  1.4770],
        [-0.8552, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5624, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0423, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1971, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0005],
        [-0.0033,  0.0004],
        [-0.0035,  0.0006],
        [-0.0039,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6822],
        [ 0.6161, -2.6258],
        [-0.7304,  1.4767],
        [-0.8558, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4868, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1688, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028,  0.0005],
        [-0.0031,  0.0006],
        [-0.0030,  0.0005],
        [-0.0029,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6821],
        [ 0.6163, -2.6256],
        [-0.7299,  1.4766],
        [-0.8548, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4942, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1707, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026,  0.0005],
        [-0.0027,  0.0005],
        [-0.0029,  0.0006],
        [-0.0030,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6821],
        [ 0.6167, -2.6257],
        [-0.7298,  1.4767],
        [-0.8549, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6244, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1962, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0007],
        [-0.0032,  0.0006],
        [-0.0035,  0.0007],
        [-0.0030,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6824],
        [ 0.6162, -2.6256],
        [-0.7304,  1.4769],
        [-0.8549, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5550, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1938, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0007],
        [-0.0036,  0.0008],
        [-0.0035,  0.0008],
        [-0.0033,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6824],
        [ 0.6157, -2.6254],
        [-0.7303,  1.4769],
        [-0.8552, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4250, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1642, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028,  0.0005],
        [-0.0028,  0.0006],
        [-0.0028,  0.0006],
        [-0.0028,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6822],
        [ 0.6165, -2.6256],
        [-0.7296,  1.4767],
        [-0.8548, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6214, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2011, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0030,  0.0007],
        [-0.0034,  0.0009],
        [-0.0030,  0.0006],
        [-0.0031,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6824],
        [ 0.6160, -2.6253],
        [-0.7299,  1.4768],
        [-0.8550, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5528, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1804, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029,  0.0006],
        [-0.0029,  0.0007],
        [-0.0031,  0.0007],
        [-0.0031,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6823],
        [ 0.6164, -2.6255],
        [-0.7299,  1.4768],
        [-0.8550, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4425, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1669, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0008],
        [-0.0031,  0.0007],
        [-0.0032,  0.0008],
        [-0.0032,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6825],
        [ 0.6162, -2.6255],
        [-0.7301,  1.4770],
        [-0.8552, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5901, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1891, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0008],
        [-0.0038,  0.0009],
        [-0.0036,  0.0009],
        [-0.0031,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6825],
        [ 0.6155, -2.6252],
        [-0.7305,  1.4770],
        [-0.8550, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4568, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0427, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1767, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0007],
        [-0.0032,  0.0006],
        [-0.0030,  0.0005],
        [-0.0035,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6824],
        [ 0.6161, -2.6255],
        [-0.7298,  1.4767],
        [-0.8554, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4428, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1683, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0009],
        [-0.0036,  0.0010],
        [-0.0037,  0.0010],
        [-0.0041,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6826],
        [ 0.6157, -2.6251],
        [-0.7305,  1.4772],
        [-0.8561, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5016, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0417, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1838, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0008],
        [-0.0036,  0.0008],
        [-0.0040,  0.0009],
        [-0.0033,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6825],
        [ 0.6157, -2.6253],
        [-0.7308,  1.4771],
        [-0.8553, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5053, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0339, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1689, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0009],
        [-0.0037,  0.0010],
        [-0.0035,  0.0007],
        [-0.0034,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6826],
        [ 0.6156, -2.6251],
        [-0.7303,  1.4769],
        [-0.8554, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5141, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1697, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0010],
        [-0.0036,  0.0009],
        [-0.0033,  0.0009],
        [-0.0039,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6827],
        [ 0.6157, -2.6251],
        [-0.7301,  1.4771],
        [-0.8559, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5503, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0417, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1935, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0008],
        [-0.0034,  0.0008],
        [-0.0036,  0.0009],
        [-0.0035,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6826],
        [ 0.6159, -2.6252],
        [-0.7304,  1.4771],
        [-0.8555, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5083, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1766, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0007],
        [-0.0027,  0.0006],
        [-0.0028,  0.0006],
        [-0.0030,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6824],
        [ 0.6166, -2.6255],
        [-0.7295,  1.4768],
        [-0.8550, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4278, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0433, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1721, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027,  0.0005],
        [-0.0025,  0.0004],
        [-0.0029,  0.0005],
        [-0.0027,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6822],
        [ 0.6167, -2.6256],
        [-0.7296,  1.4767],
        [-0.8547, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4640, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1684, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0008],
        [-0.0033,  0.0007],
        [-0.0036,  0.0009],
        [-0.0033,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6826],
        [ 0.6159, -2.6254],
        [-0.7304,  1.4771],
        [-0.8553, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5094, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1790, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0009],
        [-0.0033,  0.0009],
        [-0.0033,  0.0008],
        [-0.0030,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6827],
        [ 0.6159, -2.6252],
        [-0.7301,  1.4770],
        [-0.8550, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5213, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1765, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029,  0.0007],
        [-0.0032,  0.0009],
        [-0.0028,  0.0008],
        [-0.0029,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6825],
        [ 0.6160, -2.6252],
        [-0.7295,  1.4771],
        [-0.8549, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6988, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0431, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2260, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021,  0.0004],
        [-0.0024,  0.0005],
        [-0.0028,  0.0006],
        [-0.0022,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6822],
        [ 0.6167, -2.6255],
        [-0.7295,  1.4769],
        [-0.8542, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7201, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2257, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0010],
        [-0.0036,  0.0010],
        [-0.0035,  0.0010],
        [-0.0039,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6828],
        [ 0.6155, -2.6251],
        [-0.7303,  1.4772],
        [-0.8560, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5208, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1779, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0010],
        [-0.0039,  0.0012],
        [-0.0033,  0.0010],
        [-0.0035,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6828],
        [ 0.6153, -2.6249],
        [-0.7300,  1.4772],
        [-0.8555, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5076, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0306, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1627, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0009],
        [-0.0033,  0.0009],
        [-0.0031,  0.0009],
        [-0.0035,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6827],
        [ 0.6157, -2.6252],
        [-0.7299,  1.4772],
        [-0.8555, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5317, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0315, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1693, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0008],
        [-0.0035,  0.0009],
        [-0.0029,  0.0008],
        [-0.0028,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6826],
        [ 0.6156, -2.6251],
        [-0.7296,  1.4770],
        [-0.8549, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5131, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1761, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027,  0.0006],
        [-0.0024,  0.0006],
        [-0.0027,  0.0006],
        [-0.0029,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6824],
        [ 0.6166, -2.6255],
        [-0.7294,  1.4769],
        [-0.8549, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5822, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1920, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025,  0.0006],
        [-0.0028,  0.0008],
        [-0.0025,  0.0008],
        [-0.0025,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6824],
        [ 0.6162, -2.6253],
        [-0.7293,  1.4771],
        [-0.8546, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6667, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2157, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0010],
        [-0.0031,  0.0007],
        [-0.0032,  0.0009],
        [-0.0032,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6828],
        [ 0.6160, -2.6254],
        [-0.7299,  1.4772],
        [-0.8553, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4244, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1633, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0009],
        [-0.0034,  0.0009],
        [-0.0038,  0.0010],
        [-0.0038,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6827],
        [ 0.6156, -2.6252],
        [-0.7305,  1.4773],
        [-0.8559, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4289, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0339, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1537, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0030,  0.0009],
        [-0.0029,  0.0008],
        [-0.0030,  0.0008],
        [-0.0029,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6827],
        [ 0.6161, -2.6253],
        [-0.7297,  1.4771],
        [-0.8549, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4743, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1715, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028,  0.0008],
        [-0.0035,  0.0011],
        [-0.0037,  0.0010],
        [-0.0032,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6826],
        [ 0.6155, -2.6250],
        [-0.7305,  1.4774],
        [-0.8552, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5408, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1907, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0009],
        [-0.0035,  0.0011],
        [-0.0028,  0.0008],
        [-0.0028,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6827],
        [ 0.6154, -2.6250],
        [-0.7295,  1.4772],
        [-0.8549, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  43
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  43
gt_cnt:  35
gt_cnt:  38
gt_cnt:  41
gt_cnt:  35
gt_cnt:  43
gt_cnt:  38
gt_cnt:  39
gt_cnt:  34
gt_cnt:  41
gt_cnt:  35
gt_cnt:  38
gt_cnt:  40
gt_cnt:  43
gt_cnt:  37
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  35
gt_cnt:  37
gt_cnt:  37
gt_cnt:  35
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  36
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  38
gt_cnt:  37
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  42
gt_cnt:  37
gt_cnt:  36
gt_cnt:  37
gt_cnt:  37
gt_cnt:  38
gt_cnt:  36
gt_cnt:  39
gt_cnt:  41
gt_cnt:  38
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  40
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  38
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  39
gt_cnt:  36
gt_cnt:  38
gt_cnt:  40
gt_cnt:  41
gt_cnt:  36
gt_cnt:  42
gt_cnt:  38
gt_cnt:  37
gt_cnt:  42
gt_cnt:  36
gt_cnt:  41
gt_cnt:  40
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  36
gt_cnt:  42
gt_cnt:  36
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  36
gt_cnt:  38
gt_cnt:  42
gt_cnt:  43
gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  44
gt_cnt:  38
gt_cnt:  40
gt_cnt:  42
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  42
gt_cnt:  39
gt_cnt:  38
gt_cnt:  41
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  38
gt_cnt:  42
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  39
gt_cnt:  38
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  42
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  41
gt_cnt:  35
gt_cnt:  39
gt_cnt:  39
gt_cnt:  44
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  35
gt_cnt:  41
gt_cnt:  40
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  40
gt_cnt:  33
gt_cnt:  40
gt_cnt:  41
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  42
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  36
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  36
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  39
gt_cnt:  38
gt_cnt:  40
gt_cnt:  42
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  41
gt_cnt:  37
gt_cnt:  42
gt_cnt:  38
gt_cnt:  37
gt_cnt:  37
gt_cnt:  41
gt_cnt:  42
gt_cnt:  37
gt_cnt:  42
gt_cnt:  40
gt_cnt:  38
gt_cnt:  41
gt_cnt:  42
gt_cnt:  37
gt_cnt:  41
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  42
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  34
gt_cnt:  41
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  38
gt_cnt:  44
gt_cnt:  37
gt_cnt:  39
gt_cnt:  35
gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  40
gt_cnt:  44
gt_cnt:  39
gt_cnt:  42
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  36
gt_cnt:  44
gt_cnt:  42
gt_cnt:  37
gt_cnt:  35
gt_cnt:  41
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  36
gt_cnt:  40
gt_cnt:  39
gt_cnt:  42
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  36
gt_cnt:  37
gt_cnt:  35
gt_cnt:  41
gt_cnt:  36
gt_cnt:  39
gt_cnt:  37
gt_cnt:  41
gt_cnt:  39
gt_cnt:  38
gt_cnt:  43
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  37
gt_cnt:  38
gt_cnt:  35
gt_cnt:  40
gt_cnt:  35
gt_cnt:  43
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  38
gt_cnt:  35
gt_cnt:  36
gt_cnt:  35
gt_cnt:  35
gt_cnt:  36
gt_cnt:  41
gt_cnt:  38
gt_cnt:  35
gt_cnt:  41
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  42
gt_cnt:  37
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  40
gt_cnt:  36
gt_cnt:  39
gt_cnt:  41
gt_cnt:  40
gt_cnt:  41
gt_cnt:  38
gt_cnt:  35
gt_cnt:  40
gt_cnt:  40
gt_cnt:  37
gt_cnt:  36
gt_cnt:  42
gt_cnt:  36
gt_cnt:  40
gt_cnt:  38
gt_cnt:  40
gt_cnt:  41
gt_cnt:  39
gt_cnt:  37
{'loss_ce': tensor(0.4228, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0425, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1696, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0011],
        [-0.0035,  0.0012],
        [-0.0032,  0.0010],
        [-0.0033,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6829],
        [ 0.6154, -2.6249],
        [-0.7299,  1.4774],
        [-0.8554, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5858, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0474, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2120, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 2, Batch:360, loss: 0.000589, Time: 127.5
Testing...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6250],
        [-0.7304,  1.4775],
        [-0.8558, -2.7470]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5052, device='cuda:0'), 'loss_center': tensor(0.0362, device='cuda:0')}
loss: tensor(0.1735, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039,
         0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039,
         0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039,
         0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039,
         0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039, 0.7039,
         0.7039, 0.7039, 0.7039, 0.7039, 0.7039]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0011],
        [-0.0036,  0.0011],
        [-0.0036,  0.0011],
        [-0.0036,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3079,  0.6829],
        [ 0.6153, -2.6250],
        [-0.7303,  1.4775],
        [-0.8557, -2.7471]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5040, device='cuda:0'), 'loss_center': tensor(0.0382, device='cuda:0')}
loss: tensor(0.1772, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040,
         0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040,
         0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040,
         0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040,
         0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040, 0.7040,
         0.7040, 0.7040, 0.7040, 0.7040, 0.7040]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0013],
        [-0.0038,  0.0013],
        [-0.0038,  0.0013],
        [-0.0038,  0.0013]], device='cuda:0')
after ref add :  tensor([[ 2.3077,  0.6831],
        [ 0.6151, -2.6248],
        [-0.7306,  1.4776],
        [-0.8559, -2.7469]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5214, device='cuda:0'), 'loss_center': tensor(0.0376, device='cuda:0')}
loss: tensor(0.1795, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124,
         0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124,
         0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124,
         0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124,
         0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124, 0.7124,
         0.7124, 0.7124, 0.7124, 0.7124, 0.7124]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0012],
        [-0.0037,  0.0012],
        [-0.0037,  0.0012],
        [-0.0037,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6249],
        [-0.7304,  1.4775],
        [-0.8558, -2.7470]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5264, device='cuda:0'), 'loss_center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.1818, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148,
         0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148,
         0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148,
         0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148,
         0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148, 0.7148,
         0.7148, 0.7148, 0.7148, 0.7148, 0.7148]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6151, -2.6249],
        [-0.7305,  1.4775],
        [-0.8559, -2.7470]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5521, device='cuda:0'), 'loss_center': tensor(0.0328, device='cuda:0')}
loss: tensor(0.1760, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250,
         0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250,
         0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250,
         0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250,
         0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250, 0.7250,
         0.7250, 0.7250, 0.7250, 0.7250, 0.7250]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3077,  0.6830],
        [ 0.6151, -2.6249],
        [-0.7305,  1.4776],
        [-0.8559, -2.7470]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5126, device='cuda:0'), 'loss_center': tensor(0.0338, device='cuda:0')}
loss: tensor(0.1701, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068,
         0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068,
         0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068,
         0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068,
         0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068, 0.7068,
         0.7068, 0.7068, 0.7068, 0.7068, 0.7068]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0012],
        [-0.0037,  0.0012],
        [-0.0037,  0.0012],
        [-0.0037,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6249],
        [-0.7304,  1.4775],
        [-0.8558, -2.7470]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4851, device='cuda:0'), 'loss_center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.1738, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909,
         0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909,
         0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909,
         0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909,
         0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909, 0.6909,
         0.6909, 0.6909, 0.6909, 0.6909, 0.6909]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0012],
        [-0.0036,  0.0012],
        [-0.0036,  0.0012],
        [-0.0036,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3079,  0.6830],
        [ 0.6153, -2.6249],
        [-0.7303,  1.4775],
        [-0.8557, -2.7470]], device='cuda:0')
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5204, device='cuda:0'), 'loss_center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.1809, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089,
         0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089,
         0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089,
         0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089,
         0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089,
         0.7089, 0.7089, 0.7089, 0.7089, 0.7089]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6249],
        [-0.7304,  1.4775],
        [-0.8558, -2.7470]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4827, device='cuda:0'), 'loss_center': tensor(0.0415, device='cuda:0')}
loss: tensor(0.1795, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917,
         0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917,
         0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917,
         0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917,
         0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917, 0.6917,
         0.6917, 0.6917, 0.6917, 0.6917, 0.6917]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0011],
        [-0.0038,  0.0011],
        [-0.0038,  0.0011],
        [-0.0038,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6829],
        [ 0.6152, -2.6250],
        [-0.7305,  1.4775],
        [-0.8558, -2.7471]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4851, device='cuda:0'), 'loss_center': tensor(0.0390, device='cuda:0')}
loss: tensor(0.1751, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931,
         0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931,
         0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931,
         0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931,
         0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931, 0.6931,
         0.6931, 0.6931, 0.6931, 0.6931, 0.6931]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3079,  0.6829],
        [ 0.6153, -2.6250],
        [-0.7304,  1.4774],
        [-0.8558, -2.7471]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4764, device='cuda:0'), 'loss_center': tensor(0.0418, device='cuda:0')}
loss: tensor(0.1789, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881,
         0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881,
         0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881,
         0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881,
         0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881, 0.6881,
         0.6881, 0.6881, 0.6881, 0.6881, 0.6881]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6249],
        [-0.7305,  1.4775],
        [-0.8559, -2.7470]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4814, device='cuda:0'), 'loss_center': tensor(0.0381, device='cuda:0')}
loss: tensor(0.1725, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899,
         0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899,
         0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899,
         0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899,
         0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899, 0.6899,
         0.6899, 0.6899, 0.6899, 0.6899, 0.6899]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3079,  0.6830],
        [ 0.6153, -2.6250],
        [-0.7304,  1.4775],
        [-0.8558, -2.7471]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4698, device='cuda:0'), 'loss_center': tensor(0.0385, device='cuda:0')}
loss: tensor(0.1709, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853,
         0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853,
         0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853,
         0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853,
         0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853, 0.6853,
         0.6853, 0.6853, 0.6853, 0.6853, 0.6853]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3079,  0.6829],
        [ 0.6153, -2.6250],
        [-0.7304,  1.4774],
        [-0.8558, -2.7471]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4572, device='cuda:0'), 'loss_center': tensor(0.0374, device='cuda:0')}
loss: tensor(0.1662, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774,
         0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774,
         0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774,
         0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774,
         0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774, 0.6774,
         0.6774, 0.6774, 0.6774, 0.6774, 0.6774]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0011],
        [-0.0038,  0.0011],
        [-0.0038,  0.0011],
        [-0.0038,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6151, -2.6250],
        [-0.7305,  1.4775],
        [-0.8559, -2.7470]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4477, device='cuda:0'), 'loss_center': tensor(0.0378, device='cuda:0')}
loss: tensor(0.1652, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710,
         0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710,
         0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710,
         0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710,
         0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710, 0.6710,
         0.6710, 0.6710, 0.6710, 0.6710, 0.6710]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0011],
        [-0.0038,  0.0011],
        [-0.0038,  0.0011],
        [-0.0038,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6151, -2.6250],
        [-0.7305,  1.4775],
        [-0.8559, -2.7471]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4640, device='cuda:0'), 'loss_center': tensor(0.0363, device='cuda:0')}
loss: tensor(0.1655, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829,
         0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829,
         0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829,
         0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829,
         0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829, 0.6829,
         0.6829, 0.6829, 0.6829, 0.6829, 0.6829]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0011],
        [-0.0038,  0.0011],
        [-0.0038,  0.0011],
        [-0.0038,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6249],
        [-0.7305,  1.4775],
        [-0.8559, -2.7470]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5205, device='cuda:0'), 'loss_center': tensor(0.0344, device='cuda:0')}
loss: tensor(0.1730, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120,
         0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120,
         0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120,
         0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120,
         0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120, 0.7120,
         0.7120, 0.7120, 0.7120, 0.7120, 0.7120]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0012],
        [-0.0037,  0.0012],
        [-0.0037,  0.0012],
        [-0.0037,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3079,  0.6830],
        [ 0.6153, -2.6249],
        [-0.7304,  1.4775],
        [-0.8557, -2.7470]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5146, device='cuda:0'), 'loss_center': tensor(0.0409, device='cuda:0')}
loss: tensor(0.1847, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092,
         0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092,
         0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092,
         0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092,
         0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092, 0.7092,
         0.7092, 0.7092, 0.7092, 0.7092, 0.7092]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0012],
        [-0.0039,  0.0012],
        [-0.0039,  0.0012],
        [-0.0039,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3077,  0.6830],
        [ 0.6151, -2.6249],
        [-0.7306,  1.4775],
        [-0.8559, -2.7470]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5120, device='cuda:0'), 'loss_center': tensor(0.0360, device='cuda:0')}
loss: tensor(0.1744, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072,
         0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072,
         0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072,
         0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072,
         0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072, 0.7072,
         0.7072, 0.7072, 0.7072, 0.7072, 0.7072]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6829],
        [ 0.6152, -2.6250],
        [-0.7304,  1.4775],
        [-0.8558, -2.7471]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5030, device='cuda:0'), 'loss_center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.1773, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043,
         0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043,
         0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043,
         0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043,
         0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043, 0.7043,
         0.7043, 0.7043, 0.7043, 0.7043, 0.7043]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0012],
        [-0.0037,  0.0012],
        [-0.0037,  0.0012],
        [-0.0037,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6249],
        [-0.7305,  1.4775],
        [-0.8558, -2.7470]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5036, device='cuda:0'), 'loss_center': tensor(0.0336, device='cuda:0')}
loss: tensor(0.1679, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038,
         0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038,
         0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038,
         0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038,
         0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038, 0.7038,
         0.7038, 0.7038, 0.7038, 0.7038, 0.7038]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0011],
        [-0.0038,  0.0011],
        [-0.0038,  0.0011],
        [-0.0038,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3077,  0.6830],
        [ 0.6151, -2.6249],
        [-0.7305,  1.4775],
        [-0.8559, -2.7470]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5279, device='cuda:0'), 'loss_center': tensor(0.0332, device='cuda:0')}
loss: tensor(0.1719, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142,
         0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142,
         0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142,
         0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142,
         0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142, 0.7142,
         0.7142, 0.7142, 0.7142, 0.7142, 0.7142]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0012],
        [-0.0039,  0.0012],
        [-0.0039,  0.0012],
        [-0.0039,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3077,  0.6830],
        [ 0.6151, -2.6249],
        [-0.7306,  1.4775],
        [-0.8559, -2.7470]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4992, device='cuda:0'), 'loss_center': tensor(0.0314, device='cuda:0')}
loss: tensor(0.1626, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989,
         0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989,
         0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989,
         0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989,
         0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989, 0.6989,
         0.6989, 0.6989, 0.6989, 0.6989, 0.6989]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0011],
        [-0.0038,  0.0011],
        [-0.0038,  0.0011],
        [-0.0038,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6250],
        [-0.7305,  1.4775],
        [-0.8559, -2.7470]], device='cuda:0')
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4692, device='cuda:0'), 'loss_center': tensor(0.0369, device='cuda:0')}
loss: tensor(0.1676, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795,
         0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795,
         0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795,
         0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795,
         0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795, 0.6795,
         0.6795, 0.6795, 0.6795, 0.6795, 0.6795]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3079,  0.6830],
        [ 0.6153, -2.6250],
        [-0.7304,  1.4775],
        [-0.8558, -2.7471]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4622, device='cuda:0'), 'loss_center': tensor(0.0399, device='cuda:0')}
loss: tensor(0.1723, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764,
         0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764,
         0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764,
         0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764,
         0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764, 0.6764,
         0.6764, 0.6764, 0.6764, 0.6764, 0.6764]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6249],
        [-0.7305,  1.4775],
        [-0.8558, -2.7470]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4526, device='cuda:0'), 'loss_center': tensor(0.0351, device='cuda:0')}
loss: tensor(0.1608, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695,
         0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695,
         0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695,
         0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695,
         0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695, 0.6695,
         0.6695, 0.6695, 0.6695, 0.6695, 0.6695]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0012],
        [-0.0039,  0.0012],
        [-0.0039,  0.0012],
        [-0.0039,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3077,  0.6831],
        [ 0.6151, -2.6249],
        [-0.7306,  1.4776],
        [-0.8559, -2.7470]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4916, device='cuda:0'), 'loss_center': tensor(0.0397, device='cuda:0')}
loss: tensor(0.1778, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957,
         0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957,
         0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957,
         0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957,
         0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957, 0.6957,
         0.6957, 0.6957, 0.6957, 0.6957, 0.6957]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3079,  0.6830],
        [ 0.6153, -2.6250],
        [-0.7304,  1.4775],
        [-0.8558, -2.7471]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4793, device='cuda:0'), 'loss_center': tensor(0.0381, device='cuda:0')}
loss: tensor(0.1720, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886,
         0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886,
         0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886,
         0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886,
         0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886, 0.6886,
         0.6886, 0.6886, 0.6886, 0.6886, 0.6886]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0011],
        [-0.0036,  0.0011],
        [-0.0036,  0.0011],
        [-0.0036,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3079,  0.6829],
        [ 0.6153, -2.6250],
        [-0.7304,  1.4774],
        [-0.8557, -2.7471]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4727, device='cuda:0'), 'loss_center': tensor(0.0434, device='cuda:0')}
loss: tensor(0.1814, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847,
         0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847,
         0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847,
         0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847,
         0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847, 0.6847,
         0.6847, 0.6847, 0.6847, 0.6847, 0.6847]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6249],
        [-0.7305,  1.4775],
        [-0.8558, -2.7470]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4629, device='cuda:0'), 'loss_center': tensor(0.0452, device='cuda:0')}
loss: tensor(0.1830, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769,
         0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769,
         0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769,
         0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769,
         0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769, 0.6769,
         0.6769, 0.6769, 0.6769, 0.6769, 0.6769]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6250],
        [-0.7304,  1.4775],
        [-0.8558, -2.7470]], device='cuda:0')
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4774, device='cuda:0'), 'loss_center': tensor(0.0343, device='cuda:0')}
loss: tensor(0.1641, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834,
         0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834,
         0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834,
         0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834,
         0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834, 0.6834,
         0.6834, 0.6834, 0.6834, 0.6834, 0.6834]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0012],
        [-0.0037,  0.0012],
        [-0.0037,  0.0012],
        [-0.0037,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6249],
        [-0.7304,  1.4775],
        [-0.8558, -2.7470]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5012, device='cuda:0'), 'loss_center': tensor(0.0371, device='cuda:0')}
loss: tensor(0.1745, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999,
         0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999,
         0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999,
         0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999,
         0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999, 0.6999,
         0.6999, 0.6999, 0.6999, 0.6999, 0.6999]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0012],
        [-0.0039,  0.0012],
        [-0.0039,  0.0012],
        [-0.0039,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3077,  0.6831],
        [ 0.6151, -2.6249],
        [-0.7306,  1.4776],
        [-0.8560, -2.7470]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5225, device='cuda:0'), 'loss_center': tensor(0.0395, device='cuda:0')}
loss: tensor(0.1834, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108,
         0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108,
         0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108,
         0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108,
         0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108, 0.7108,
         0.7108, 0.7108, 0.7108, 0.7108, 0.7108]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3077,  0.6830],
        [ 0.6151, -2.6249],
        [-0.7306,  1.4775],
        [-0.8559, -2.7470]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4984, device='cuda:0'), 'loss_center': tensor(0.0390, device='cuda:0')}
loss: tensor(0.1778, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994,
         0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994,
         0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994,
         0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994,
         0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994, 0.6994,
         0.6994, 0.6994, 0.6994, 0.6994, 0.6994]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6250],
        [-0.7304,  1.4775],
        [-0.8558, -2.7471]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4843, device='cuda:0'), 'loss_center': tensor(0.0421, device='cuda:0')}
loss: tensor(0.1810, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904,
         0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904,
         0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904,
         0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904,
         0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904, 0.6904,
         0.6904, 0.6904, 0.6904, 0.6904, 0.6904]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6249],
        [-0.7305,  1.4775],
        [-0.8559, -2.7470]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5186, device='cuda:0'), 'loss_center': tensor(0.0448, device='cuda:0')}
loss: tensor(0.1934, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089,
         0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089,
         0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089,
         0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089,
         0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089, 0.7089,
         0.7089, 0.7089, 0.7089, 0.7089, 0.7089]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6249],
        [-0.7305,  1.4775],
        [-0.8559, -2.7470]], device='cuda:0')
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4870, device='cuda:0'), 'loss_center': tensor(0.0361, device='cuda:0')}
loss: tensor(0.1696, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894,
         0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894,
         0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894,
         0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894,
         0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894, 0.6894,
         0.6894, 0.6894, 0.6894, 0.6894, 0.6894]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011],
        [-0.0037,  0.0011]], device='cuda:0')
after ref add :  tensor([[ 2.3079,  0.6830],
        [ 0.6153, -2.6250],
        [-0.7304,  1.4775],
        [-0.8558, -2.7470]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5015, device='cuda:0'), 'loss_center': tensor(0.0379, device='cuda:0')}
loss: tensor(0.1761, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001,
         0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001,
         0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001,
         0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001,
         0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001, 0.7001,
         0.7001, 0.7001, 0.7001, 0.7001, 0.7001]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012],
        [-0.0038,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6152, -2.6249],
        [-0.7305,  1.4775],
        [-0.8559, -2.7470]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5165, device='cuda:0'), 'loss_center': tensor(0.0397, device='cuda:0')}
loss: tensor(0.1826, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101,
         0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101,
         0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101,
         0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101,
         0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101, 0.7101,
         0.7101, 0.7101, 0.7101, 0.7101, 0.7101]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0012],
        [-0.0039,  0.0012],
        [-0.0039,  0.0012],
        [-0.0039,  0.0012]], device='cuda:0')
after ref add :  tensor([[ 2.3077,  0.6831],
        [ 0.6151, -2.6249],
        [-0.7306,  1.4776],
        [-0.8560, -2.7469]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4831, device='cuda:0'), 'loss_center': tensor(0.0420, device='cuda:0')}
loss: tensor(0.1805, device='cuda:0', dtype=torch.float64)
top10 scores:  gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  36
gt_cnt:  37
gt_cnt:  36
gt_cnt:  34
gt_cnt:  39
gt_cnt:  36
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  36
gt_cnt:  37
gt_cnt:  34
gt_cnt:  36
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  35
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  37
gt_cnt:  36
tensor([[0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938,
         0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938,
         0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938,
         0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938,
         0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938, 0.6938,
         0.6938, 0.6938, 0.6938, 0.6938, 0.6938]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
moda: 0.0%, modp: 33.6%, prec: 6.1%, recall: 8.2%
Test, loss: 0.174901, Time: 14.929
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0012],
        [-0.0030,  0.0009],
        [-0.0032,  0.0011],
        [-0.0031,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6830],
        [ 0.6160, -2.6251],
        [-0.7299,  1.4774],
        [-0.8552, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7595, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2239, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029,  0.0008],
        [-0.0029,  0.0009],
        [-0.0025,  0.0007],
        [-0.0028,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6827],
        [ 0.6161, -2.6252],
        [-0.7292,  1.4771],
        [-0.8549, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4932, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1736, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0030,  0.0009],
        [-0.0030,  0.0010],
        [-0.0031,  0.0009],
        [-0.0027,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6828],
        [ 0.6159, -2.6251],
        [-0.7298,  1.4773],
        [-0.8548, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5384, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0316, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1710, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0030,  0.0010],
        [-0.0031,  0.0009],
        [-0.0031,  0.0011],
        [-0.0032,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6829],
        [ 0.6158, -2.6252],
        [-0.7298,  1.4774],
        [-0.8553, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4610, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1737, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0014],
        [-0.0037,  0.0012],
        [-0.0032,  0.0010],
        [-0.0036,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6832],
        [ 0.6152, -2.6249],
        [-0.7300,  1.4774],
        [-0.8557, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4237, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0466, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1779, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0012],
        [-0.0033,  0.0011],
        [-0.0032,  0.0012],
        [-0.0031,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6830],
        [ 0.6156, -2.6251],
        [-0.7299,  1.4775],
        [-0.8552, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4432, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1655, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0011],
        [-0.0038,  0.0013],
        [-0.0036,  0.0012],
        [-0.0038,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6829],
        [ 0.6151, -2.6249],
        [-0.7303,  1.4776],
        [-0.8560, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4352, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1654, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0012],
        [-0.0031,  0.0010],
        [-0.0031,  0.0010],
        [-0.0034,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6830],
        [ 0.6158, -2.6252],
        [-0.7298,  1.4773],
        [-0.8556, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4079, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0467, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1750, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0010],
        [-0.0033,  0.0009],
        [-0.0032,  0.0010],
        [-0.0035,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6828],
        [ 0.6156, -2.6252],
        [-0.7299,  1.4774],
        [-0.8556, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5254, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1795, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0010],
        [-0.0036,  0.0011],
        [-0.0039,  0.0012],
        [-0.0035,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6828],
        [ 0.6153, -2.6251],
        [-0.7306,  1.4776],
        [-0.8556, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5514, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0320, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1743, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0011],
        [-0.0028,  0.0009],
        [-0.0032,  0.0011],
        [-0.0035,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6829],
        [ 0.6161, -2.6252],
        [-0.7299,  1.4775],
        [-0.8556, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4041, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1633, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0009],
        [-0.0032,  0.0011],
        [-0.0031,  0.0009],
        [-0.0032,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6827],
        [ 0.6157, -2.6251],
        [-0.7298,  1.4773],
        [-0.8554, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4254, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0472, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1795, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0010],
        [-0.0033,  0.0011],
        [-0.0035,  0.0012],
        [-0.0030,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6828],
        [ 0.6155, -2.6251],
        [-0.7302,  1.4776],
        [-0.8551, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5819, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1952, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0012],
        [-0.0039,  0.0014],
        [-0.0033,  0.0011],
        [-0.0034,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6829],
        [ 0.6149, -2.6248],
        [-0.7300,  1.4775],
        [-0.8556, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4221, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1517, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0011],
        [-0.0035,  0.0011],
        [-0.0035,  0.0010],
        [-0.0037,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6829],
        [ 0.6154, -2.6251],
        [-0.7302,  1.4774],
        [-0.8559, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5481, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1886, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0011],
        [-0.0038,  0.0013],
        [-0.0038,  0.0013],
        [-0.0037,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6828],
        [ 0.6150, -2.6249],
        [-0.7305,  1.4777],
        [-0.8559, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4406, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1641, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0008],
        [-0.0029,  0.0009],
        [-0.0028,  0.0009],
        [-0.0027,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6826],
        [ 0.6159, -2.6253],
        [-0.7295,  1.4774],
        [-0.8548, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6545, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1999, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0011],
        [-0.0038,  0.0013],
        [-0.0039,  0.0012],
        [-0.0039,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6828],
        [ 0.6150, -2.6250],
        [-0.7306,  1.4776],
        [-0.8561, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6312, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0435, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2133, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0012],
        [-0.0037,  0.0012],
        [-0.0034,  0.0011],
        [-0.0035,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6829],
        [ 0.6151, -2.6251],
        [-0.7302,  1.4775],
        [-0.8556, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4972, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1739, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0011],
        [-0.0031,  0.0009],
        [-0.0032,  0.0010],
        [-0.0034,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6829],
        [ 0.6158, -2.6253],
        [-0.7300,  1.4774],
        [-0.8556, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4509, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1662, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0010],
        [-0.0034,  0.0011],
        [-0.0033,  0.0010],
        [-0.0033,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6827],
        [ 0.6154, -2.6252],
        [-0.7301,  1.4774],
        [-0.8555, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4823, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0344, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1652, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0015],
        [-0.0040,  0.0014],
        [-0.0037,  0.0013],
        [-0.0035,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3074,  0.6832],
        [ 0.6148, -2.6249],
        [-0.7305,  1.4778],
        [-0.8557, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5871, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1982, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029,  0.0007],
        [-0.0029,  0.0008],
        [-0.0030,  0.0008],
        [-0.0029,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6825],
        [ 0.6159, -2.6255],
        [-0.7297,  1.4772],
        [-0.8551, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6150, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2030, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0011],
        [-0.0040,  0.0015],
        [-0.0034,  0.0012],
        [-0.0034,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6828],
        [ 0.6148, -2.6247],
        [-0.7301,  1.4776],
        [-0.8555, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4803, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1694, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0010],
        [-0.0029,  0.0008],
        [-0.0030,  0.0008],
        [-0.0032,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6828],
        [ 0.6159, -2.6255],
        [-0.7297,  1.4772],
        [-0.8554, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5454, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1879, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029,  0.0011],
        [-0.0029,  0.0010],
        [-0.0030,  0.0010],
        [-0.0030,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6828],
        [ 0.6159, -2.6253],
        [-0.7297,  1.4775],
        [-0.8552, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6793, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0433, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2225, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0013],
        [-0.0040,  0.0013],
        [-0.0035,  0.0012],
        [-0.0038,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3076,  0.6831],
        [ 0.6147, -2.6250],
        [-0.7302,  1.4776],
        [-0.8559, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4437, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0468, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1824, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0011],
        [-0.0026,  0.0010],
        [-0.0032,  0.0012],
        [-0.0030,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6829],
        [ 0.6161, -2.6253],
        [-0.7299,  1.4777],
        [-0.8552, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5081, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1713, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0030,  0.0010],
        [-0.0030,  0.0010],
        [-0.0033,  0.0011],
        [-0.0030,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6828],
        [ 0.6157, -2.6253],
        [-0.7301,  1.4775],
        [-0.8552, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4157, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0431, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1693, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0011],
        [-0.0035,  0.0011],
        [-0.0033,  0.0010],
        [-0.0030,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6829],
        [ 0.6153, -2.6252],
        [-0.7300,  1.4774],
        [-0.8552, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4807, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0344, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1649, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0011],
        [-0.0035,  0.0011],
        [-0.0035,  0.0012],
        [-0.0035,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6828],
        [ 0.6153, -2.6252],
        [-0.7303,  1.4776],
        [-0.8557, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4619, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1700, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0016],
        [-0.0039,  0.0015],
        [-0.0043,  0.0015],
        [-0.0038,  0.0014]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3074,  0.6834],
        [ 0.6149, -2.6248],
        [-0.7310,  1.4779],
        [-0.8560, -2.7468]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4059, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1516, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0011],
        [-0.0040,  0.0014],
        [-0.0030,  0.0009],
        [-0.0038,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6829],
        [ 0.6148, -2.6249],
        [-0.7298,  1.4773],
        [-0.8561, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5086, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0462, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1942, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0010],
        [-0.0032,  0.0011],
        [-0.0036,  0.0013],
        [-0.0035,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6829],
        [ 0.6155, -2.6252],
        [-0.7303,  1.4777],
        [-0.8557, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3974, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1559, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0012],
        [-0.0028,  0.0009],
        [-0.0031,  0.0011],
        [-0.0031,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6830],
        [ 0.6159, -2.6254],
        [-0.7298,  1.4775],
        [-0.8553, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4480, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1696, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0014],
        [-0.0038,  0.0013],
        [-0.0038,  0.0013],
        [-0.0037,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3076,  0.6832],
        [ 0.6149, -2.6250],
        [-0.7306,  1.4778],
        [-0.8559, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4004, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1598, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0011],
        [-0.0035,  0.0012],
        [-0.0036,  0.0012],
        [-0.0030,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6829],
        [ 0.6152, -2.6251],
        [-0.7303,  1.4776],
        [-0.8552, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4762, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1658, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0012],
        [-0.0037,  0.0011],
        [-0.0037,  0.0014],
        [-0.0031,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6830],
        [ 0.6151, -2.6252],
        [-0.7304,  1.4778],
        [-0.8554, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4782, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1717, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0030,  0.0010],
        [-0.0034,  0.0010],
        [-0.0033,  0.0011],
        [-0.0033,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6828],
        [ 0.6154, -2.6253],
        [-0.7300,  1.4776],
        [-0.8555, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5040, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0287, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1581, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0014],
        [-0.0035,  0.0013],
        [-0.0034,  0.0011],
        [-0.0031,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3076,  0.6832],
        [ 0.6152, -2.6250],
        [-0.7301,  1.4776],
        [-0.8554, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4467, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1639, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0011],
        [-0.0034,  0.0010],
        [-0.0033,  0.0010],
        [-0.0032,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6829],
        [ 0.6153, -2.6253],
        [-0.7301,  1.4774],
        [-0.8554, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4491, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0442, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1782, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0010],
        [-0.0034,  0.0012],
        [-0.0032,  0.0013],
        [-0.0039,  0.0015]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6828],
        [ 0.6153, -2.6251],
        [-0.7300,  1.4778],
        [-0.8562, -2.7467]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4374, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1686, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0012],
        [-0.0035,  0.0012],
        [-0.0034,  0.0012],
        [-0.0034,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6830],
        [ 0.6152, -2.6251],
        [-0.7301,  1.4776],
        [-0.8557, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4121, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1607, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0012],
        [-0.0037,  0.0012],
        [-0.0037,  0.0012],
        [-0.0040,  0.0014]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6830],
        [ 0.6150, -2.6251],
        [-0.7304,  1.4777],
        [-0.8563, -2.7468]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4001, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1546, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0013],
        [-0.0033,  0.0012],
        [-0.0036,  0.0014],
        [-0.0036,  0.0014]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6831],
        [ 0.6154, -2.6252],
        [-0.7303,  1.4778],
        [-0.8558, -2.7468]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4247, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1662, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0011],
        [-0.0033,  0.0011],
        [-0.0037,  0.0014],
        [-0.0033,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6829],
        [ 0.6154, -2.6253],
        [-0.7304,  1.4778],
        [-0.8556, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5015, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1816, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0014],
        [-0.0034,  0.0012],
        [-0.0038,  0.0013],
        [-0.0035,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3074,  0.6833],
        [ 0.6154, -2.6251],
        [-0.7305,  1.4778],
        [-0.8558, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6616, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2017, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0013],
        [-0.0033,  0.0012],
        [-0.0032,  0.0011],
        [-0.0030,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6831],
        [ 0.6154, -2.6252],
        [-0.7299,  1.4775],
        [-0.8553, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4192, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1675, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0011],
        [-0.0036,  0.0014],
        [-0.0034,  0.0013],
        [-0.0035,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6829],
        [ 0.6151, -2.6250],
        [-0.7301,  1.4777],
        [-0.8558, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4820, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1777, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0040,  0.0015],
        [-0.0035,  0.0013],
        [-0.0035,  0.0013],
        [-0.0039,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3075,  0.6833],
        [ 0.6152, -2.6251],
        [-0.7303,  1.4778],
        [-0.8562, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4827, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1727, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0012],
        [-0.0034,  0.0010],
        [-0.0033,  0.0009],
        [-0.0031,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6830],
        [ 0.6153, -2.6254],
        [-0.7300,  1.4773],
        [-0.8553, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5582, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1786, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0040,  0.0014],
        [-0.0042,  0.0016],
        [-0.0041,  0.0014],
        [-0.0042,  0.0015]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3075,  0.6832],
        [ 0.6144, -2.6248],
        [-0.7309,  1.4778],
        [-0.8565, -2.7467]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4193, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1629, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0011],
        [-0.0031,  0.0010],
        [-0.0032,  0.0010],
        [-0.0030,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6829],
        [ 0.6156, -2.6254],
        [-0.7299,  1.4774],
        [-0.8553, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4287, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1606, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0014],
        [-0.0036,  0.0013],
        [-0.0034,  0.0011],
        [-0.0040,  0.0014]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6832],
        [ 0.6151, -2.6251],
        [-0.7302,  1.4775],
        [-0.8563, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6320, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1965, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0012],
        [-0.0036,  0.0013],
        [-0.0032,  0.0011],
        [-0.0030,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6830],
        [ 0.6151, -2.6251],
        [-0.7300,  1.4775],
        [-0.8553, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4668, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1605, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0011],
        [-0.0042,  0.0013],
        [-0.0038,  0.0013],
        [-0.0036,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6829],
        [ 0.6145, -2.6251],
        [-0.7305,  1.4777],
        [-0.8559, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5311, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0428, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1918, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0009],
        [-0.0035,  0.0010],
        [-0.0037,  0.0011],
        [-0.0036,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6827],
        [ 0.6152, -2.6254],
        [-0.7304,  1.4775],
        [-0.8559, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5966, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1971, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0012],
        [-0.0039,  0.0014],
        [-0.0038,  0.0013],
        [-0.0036,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6830],
        [ 0.6148, -2.6251],
        [-0.7305,  1.4777],
        [-0.8559, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4751, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1766, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0012],
        [-0.0033,  0.0011],
        [-0.0037,  0.0012],
        [-0.0036,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3078,  0.6830],
        [ 0.6153, -2.6253],
        [-0.7305,  1.4777],
        [-0.8559, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4039, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1555, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0011],
        [-0.0037,  0.0012],
        [-0.0035,  0.0011],
        [-0.0036,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6828],
        [ 0.6150, -2.6252],
        [-0.7303,  1.4775],
        [-0.8560, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4050, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1627, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0009],
        [-0.0038,  0.0012],
        [-0.0035,  0.0010],
        [-0.0035,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3078,  0.6827],
        [ 0.6149, -2.6252],
        [-0.7303,  1.4774],
        [-0.8558, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4195, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1543, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0010],
        [-0.0033,  0.0008],
        [-0.0032,  0.0007],
        [-0.0032,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6828],
        [ 0.6153, -2.6256],
        [-0.7299,  1.4772],
        [-0.8555, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5389, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1849, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0011],
        [-0.0031,  0.0010],
        [-0.0038,  0.0013],
        [-0.0036,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6829],
        [ 0.6155, -2.6255],
        [-0.7306,  1.4777],
        [-0.8559, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4622, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0443, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1811, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0011],
        [-0.0036,  0.0009],
        [-0.0041,  0.0012],
        [-0.0036,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6828],
        [ 0.6151, -2.6255],
        [-0.7308,  1.4776],
        [-0.8560, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4550, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1672, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0010],
        [-0.0041,  0.0011],
        [-0.0042,  0.0011],
        [-0.0037,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6828],
        [ 0.6145, -2.6254],
        [-0.7309,  1.4775],
        [-0.8561, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5206, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0320, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1681, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0011],
        [-0.0038,  0.0011],
        [-0.0039,  0.0012],
        [-0.0038,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3076,  0.6829],
        [ 0.6149, -2.6253],
        [-0.7307,  1.4776],
        [-0.8561, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4727, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0438, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1822, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0008],
        [-0.0034,  0.0008],
        [-0.0031,  0.0009],
        [-0.0030,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6826],
        [ 0.6153, -2.6256],
        [-0.7299,  1.4773],
        [-0.8554, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4983, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0313, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1622, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0011],
        [-0.0040,  0.0012],
        [-0.0041,  0.0012],
        [-0.0035,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6828],
        [ 0.6146, -2.6252],
        [-0.7309,  1.4776],
        [-0.8559, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4784, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1700, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0008],
        [-0.0033,  0.0008],
        [-0.0033,  0.0008],
        [-0.0033,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6825],
        [ 0.6153, -2.6256],
        [-0.7301,  1.4773],
        [-0.8556, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4312, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1604, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0013],
        [-0.0040,  0.0012],
        [-0.0042,  0.0012],
        [-0.0043,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6831],
        [ 0.6146, -2.6253],
        [-0.7310,  1.4777],
        [-0.8567, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5201, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1830, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0008],
        [-0.0039,  0.0011],
        [-0.0035,  0.0007],
        [-0.0036,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3078,  0.6826],
        [ 0.6147, -2.6253],
        [-0.7303,  1.4772],
        [-0.8560, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4010, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1506, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029,  0.0009],
        [-0.0033,  0.0008],
        [-0.0037,  0.0010],
        [-0.0033,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6826],
        [ 0.6153, -2.6256],
        [-0.7305,  1.4774],
        [-0.8557, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4707, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0420, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1782, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0008],
        [-0.0036,  0.0009],
        [-0.0036,  0.0009],
        [-0.0045,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6826],
        [ 0.6151, -2.6256],
        [-0.7304,  1.4774],
        [-0.8568, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4460, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1608, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0009],
        [-0.0036,  0.0009],
        [-0.0036,  0.0009],
        [-0.0038,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3078,  0.6827],
        [ 0.6151, -2.6256],
        [-0.7304,  1.4774],
        [-0.8562, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5338, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1835, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0006],
        [-0.0032,  0.0005],
        [-0.0033,  0.0006],
        [-0.0033,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6823],
        [ 0.6154, -2.6259],
        [-0.7301,  1.4771],
        [-0.8556, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7039, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2286, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0009],
        [-0.0038,  0.0009],
        [-0.0033,  0.0007],
        [-0.0034,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6827],
        [ 0.6149, -2.6256],
        [-0.7301,  1.4772],
        [-0.8557, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6020, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1957, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0009],
        [-0.0036,  0.0008],
        [-0.0037,  0.0008],
        [-0.0036,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6826],
        [ 0.6151, -2.6257],
        [-0.7305,  1.4773],
        [-0.8560, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4792, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1685, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0008],
        [-0.0033,  0.0006],
        [-0.0029,  0.0006],
        [-0.0025,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6825],
        [ 0.6153, -2.6258],
        [-0.7297,  1.4771],
        [-0.8548, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5958, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1928, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0007],
        [-0.0033,  0.0009],
        [-0.0032,  0.0007],
        [-0.0037,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6825],
        [ 0.6153, -2.6255],
        [-0.7300,  1.4772],
        [-0.8561, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4849, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1645, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0007],
        [-0.0029,  0.0004],
        [-0.0032,  0.0005],
        [-0.0037,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6824],
        [ 0.6157, -2.6260],
        [-0.7300,  1.4771],
        [-0.8560, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4914, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1698, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0030,  0.0006],
        [-0.0028,  0.0005],
        [-0.0034,  0.0008],
        [-0.0033,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6823],
        [ 0.6158, -2.6260],
        [-0.7302,  1.4773],
        [-0.8557, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4844, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1641, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0007],
        [-0.0037,  0.0009],
        [-0.0035,  0.0009],
        [-0.0031,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6824],
        [ 0.6149, -2.6256],
        [-0.7303,  1.4774],
        [-0.8555, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4682, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1671, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0008],
        [-0.0039,  0.0009],
        [-0.0035,  0.0009],
        [-0.0037,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3078,  0.6825],
        [ 0.6146, -2.6256],
        [-0.7303,  1.4774],
        [-0.8561, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5866, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1929, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0007],
        [-0.0034,  0.0008],
        [-0.0035,  0.0007],
        [-0.0033,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6824],
        [ 0.6152, -2.6257],
        [-0.7303,  1.4773],
        [-0.8557, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6090, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0417, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2053, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0008],
        [-0.0036,  0.0008],
        [-0.0034,  0.0006],
        [-0.0035,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3076,  0.6825],
        [ 0.6149, -2.6257],
        [-0.7301,  1.4772],
        [-0.8559, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4998, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1762, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0005],
        [-0.0036,  0.0006],
        [-0.0034,  0.0005],
        [-0.0033,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6822],
        [ 0.6150, -2.6259],
        [-0.7302,  1.4771],
        [-0.8557, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4505, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1669, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0007],
        [-0.0038,  0.0008],
        [-0.0037,  0.0007],
        [-0.0037,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3078,  0.6824],
        [ 0.6147, -2.6257],
        [-0.7304,  1.4772],
        [-0.8561, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4364, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1578, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0005],
        [-0.0034,  0.0005],
        [-0.0031,  0.0004],
        [-0.0034,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3078,  0.6822],
        [ 0.6151, -2.6259],
        [-0.7298,  1.4770],
        [-0.8558, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5648, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1829, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0005],
        [-0.0032,  0.0005],
        [-0.0034,  0.0006],
        [-0.0036,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3078,  0.6822],
        [ 0.6153, -2.6259],
        [-0.7301,  1.4771],
        [-0.8560, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4218, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1600, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0004],
        [-0.0035,  0.0006],
        [-0.0036,  0.0007],
        [-0.0033,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6822],
        [ 0.6151, -2.6259],
        [-0.7303,  1.4772],
        [-0.8557, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4784, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1708, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028,  0.0002],
        [-0.0027,  0.0003],
        [-0.0028,  0.0004],
        [-0.0028,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6819],
        [ 0.6158, -2.6262],
        [-0.7295,  1.4769],
        [-0.8552, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5189, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0343, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1723, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0005],
        [-0.0036,  0.0006],
        [-0.0034,  0.0005],
        [-0.0033,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3076,  0.6823],
        [ 0.6149, -2.6258],
        [-0.7301,  1.4771],
        [-0.8558, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3933, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1514, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0004],
        [-0.0042,  0.0007],
        [-0.0036,  0.0005],
        [-0.0036,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6821],
        [ 0.6143, -2.6258],
        [-0.7303,  1.4771],
        [-0.8561, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4323, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1558, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0003],
        [-0.0036,  0.0004],
        [-0.0031,  0.0003],
        [-0.0036,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6820],
        [ 0.6149, -2.6260],
        [-0.7298,  1.4769],
        [-0.8561, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3981, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1550, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0040,  0.0005],
        [-0.0044,  0.0008],
        [-0.0037,  0.0005],
        [-0.0042,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6822],
        [ 0.6141, -2.6257],
        [-0.7304,  1.4770],
        [-0.8567, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4546, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1767, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0003],
        [-0.0034,  0.0004],
        [-0.0037,  0.0005],
        [-0.0032,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6820],
        [ 0.6151, -2.6260],
        [-0.7304,  1.4771],
        [-0.8556, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4931, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0328, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1643, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0006],
        [-0.0038,  0.0004],
        [-0.0035,  0.0005],
        [-0.0043,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6823],
        [ 0.6147, -2.6260],
        [-0.7302,  1.4771],
        [-0.8567, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4882, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1688, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0005],
        [-0.0030,  0.0005],
        [-0.0036,  0.0004],
        [-0.0035,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6822],
        [ 0.6155, -2.6259],
        [-0.7303,  1.4770],
        [-0.8559, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4417, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1712, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0007],
        [-0.0045,  0.0008],
        [-0.0038,  0.0005],
        [-0.0042,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3072,  0.6824],
        [ 0.6140, -2.6256],
        [-0.7305,  1.4770],
        [-0.8566, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4180, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1568, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0005],
        [-0.0039,  0.0005],
        [-0.0045,  0.0007],
        [-0.0043,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3071,  0.6822],
        [ 0.6146, -2.6259],
        [-0.7312,  1.4773],
        [-0.8568, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5472, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0326, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1747, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 3, Batch:100, loss: 0.001747, Time: 37.0
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0003],
        [-0.0029,  0.0002],
        [-0.0033,  0.0003],
        [-0.0039,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6820],
        [ 0.6156, -2.6262],
        [-0.7300,  1.4769],
        [-0.8564, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4240, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1583, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0004],
        [-0.0036,  0.0004],
        [-0.0042,  0.0005],
        [-0.0041,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3072,  0.6821],
        [ 0.6149, -2.6260],
        [-0.7309,  1.4771],
        [-0.8565, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4233, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1629, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.6929e-03,  4.7993e-05],
        [-3.6408e-03, -4.7935e-05],
        [-3.5176e-03, -2.4890e-05],
        [-3.0728e-03, -2.6775e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6817],
        [ 0.6149, -2.6265],
        [-0.7302,  1.4766],
        [-0.8556, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4209, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1599, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0004],
        [-0.0049,  0.0006],
        [-0.0054,  0.0008],
        [-0.0044,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3071,  0.6820],
        [ 0.6136, -2.6259],
        [-0.7321,  1.4774],
        [-0.8569, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5206, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1793, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0004],
        [-0.0038,  0.0004],
        [-0.0038,  0.0004],
        [-0.0037,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6821],
        [ 0.6147, -2.6260],
        [-0.7304,  1.4770],
        [-0.8562, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4208, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0433, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1708, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0040,  0.0005],
        [-0.0040,  0.0004],
        [-0.0040,  0.0005],
        [-0.0039,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3074,  0.6821],
        [ 0.6145, -2.6261],
        [-0.7307,  1.4771],
        [-0.8564, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5200, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1787, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0005],
        [-0.0040,  0.0004],
        [-0.0043,  0.0004],
        [-0.0046,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3071,  0.6822],
        [ 0.6145, -2.6260],
        [-0.7310,  1.4770],
        [-0.8571, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4261, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1605, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0004],
        [-0.0035,  0.0004],
        [-0.0039,  0.0004],
        [-0.0038,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6821],
        [ 0.6149, -2.6261],
        [-0.7306,  1.4770],
        [-0.8563, -2.7476]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4324, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1633, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0040,  0.0005],
        [-0.0039,  0.0003],
        [-0.0038,  0.0003],
        [-0.0038,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6822],
        [ 0.6146, -2.6261],
        [-0.7305,  1.4769],
        [-0.8564, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5086, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1768, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031,  0.0002],
        [-0.0037,  0.0001],
        [-0.0038,  0.0002],
        [-0.0034,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6818],
        [ 0.6148, -2.6263],
        [-0.7304,  1.4768],
        [-0.8560, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4402, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1564, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0004],
        [-0.0045,  0.0003],
        [-0.0042,  0.0003],
        [-0.0042,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6820],
        [ 0.6139, -2.6262],
        [-0.7309,  1.4769],
        [-0.8568, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5003, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1790, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0005],
        [-0.0034,  0.0002],
        [-0.0036,  0.0002],
        [-0.0033,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3072,  0.6822],
        [ 0.6151, -2.6263],
        [-0.7303,  1.4768],
        [-0.8558, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4507, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1663, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0002],
        [-0.0041,  0.0003],
        [-0.0041,  0.0002],
        [-0.0037,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3072,  0.6818],
        [ 0.6144, -2.6262],
        [-0.7308,  1.4768],
        [-0.8563, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4122, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1612, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0004],
        [-0.0039,  0.0004],
        [-0.0042,  0.0005],
        [-0.0041,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3072,  0.6821],
        [ 0.6146, -2.6260],
        [-0.7309,  1.4771],
        [-0.8566, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3979, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1526, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0002],
        [-0.0036,  0.0002],
        [-0.0037,  0.0002],
        [-0.0040,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3078,  0.6818],
        [ 0.6149, -2.6263],
        [-0.7304,  1.4768],
        [-0.8566, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4621, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1690, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0003],
        [-0.0037,  0.0004],
        [-0.0036,  0.0003],
        [-0.0040,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3074,  0.6819],
        [ 0.6147, -2.6260],
        [-0.7303,  1.4769],
        [-0.8566, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7204, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2268, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0004],
        [-0.0037,  0.0004],
        [-0.0041,  0.0003],
        [-0.0038,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3072,  0.6821],
        [ 0.6147, -2.6261],
        [-0.7308,  1.4769],
        [-0.8563, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4466, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0421, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1735, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0040,  0.0003],
        [-0.0046,  0.0004],
        [-0.0039,  0.0004],
        [-0.0039,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6819],
        [ 0.6138, -2.6261],
        [-0.7306,  1.4770],
        [-0.8564, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4016, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0313, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1429, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.0038e-03,  7.1283e-05],
        [-3.0895e-03,  4.0681e-06],
        [-3.3600e-03,  1.3292e-04],
        [-3.6751e-03,  1.4919e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6817],
        [ 0.6154, -2.6264],
        [-0.7300,  1.4768],
        [-0.8563, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5113, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1772, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0003],
        [-0.0036,  0.0002],
        [-0.0035,  0.0003],
        [-0.0039,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3076,  0.6820],
        [ 0.6148, -2.6262],
        [-0.7301,  1.4769],
        [-0.8565, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4917, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1790, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0002],
        [-0.0037,  0.0002],
        [-0.0036,  0.0003],
        [-0.0037,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3074,  0.6819],
        [ 0.6148, -2.6263],
        [-0.7302,  1.4769],
        [-0.8563, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4677, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1649, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0006],
        [-0.0044,  0.0005],
        [-0.0045,  0.0006],
        [-0.0049,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6823],
        [ 0.6141, -2.6259],
        [-0.7312,  1.4773],
        [-0.8575, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4545, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1619, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0003],
        [-0.0046,  0.0003],
        [-0.0042,  0.0003],
        [-0.0042,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6820],
        [ 0.6139, -2.6261],
        [-0.7309,  1.4769],
        [-0.8568, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4129, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1703, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.5636e-03,  1.1223e-04],
        [-3.5735e-03, -1.6848e-05],
        [-4.2306e-03,  2.6677e-04],
        [-3.3900e-03,  6.3599e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6818],
        [ 0.6149, -2.6264],
        [-0.7309,  1.4769],
        [-0.8560, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4324, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1676, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0003],
        [-0.0045,  0.0003],
        [-0.0048,  0.0004],
        [-0.0046,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6820],
        [ 0.6139, -2.6261],
        [-0.7315,  1.4770],
        [-0.8572, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4467, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1617, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0003],
        [-0.0042,  0.0003],
        [-0.0038,  0.0004],
        [-0.0041,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3074,  0.6820],
        [ 0.6143, -2.6261],
        [-0.7304,  1.4771],
        [-0.8567, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4118, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0443, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1710, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.4712e-03,  4.1720e-05],
        [-3.5041e-03,  1.3012e-04],
        [-3.3563e-03,  1.0651e-04],
        [-3.9388e-03,  1.4424e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3078,  0.6817],
        [ 0.6149, -2.6263],
        [-0.7300,  1.4768],
        [-0.8566, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5495, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1813, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.5454e-03,  2.7739e-05],
        [-3.2230e-03,  8.9260e-05],
        [-3.7710e-03,  2.8941e-04],
        [-3.5622e-03,  1.7424e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6817],
        [ 0.6152, -2.6263],
        [-0.7304,  1.4770],
        [-0.8562, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5680, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0332, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1799, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.0064e-03,  9.7244e-05],
        [-3.7845e-03,  1.5141e-06],
        [-4.3122e-03,  1.1937e-04],
        [-3.9483e-03, -1.5459e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6818],
        [ 0.6147, -2.6264],
        [-0.7310,  1.4768],
        [-0.8566, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3866, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0431, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1634, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.7487e-03,  2.1959e-04],
        [-4.3465e-03,  1.7564e-04],
        [-3.9025e-03, -4.6657e-06],
        [-3.6912e-03,  2.1887e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3075,  0.6819],
        [ 0.6141, -2.6262],
        [-0.7305,  1.4767],
        [-0.8563, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4277, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1642, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0002],
        [-0.0043,  0.0002],
        [-0.0037,  0.0001],
        [-0.0036,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3076,  0.6819],
        [ 0.6141, -2.6262],
        [-0.7303,  1.4768],
        [-0.8563, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4729, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1693, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0004],
        [-0.0033,  0.0003],
        [-0.0040,  0.0003],
        [-0.0037,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3076,  0.6821],
        [ 0.6152, -2.6261],
        [-0.7306,  1.4771],
        [-0.8564, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  33
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5584, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1820, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.3607e-03, -2.5772e-05],
        [-4.0991e-03,  2.0291e-04],
        [-3.5572e-03,  5.0118e-06],
        [-3.4955e-03, -9.2067e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6817],
        [ 0.6143, -2.6262],
        [-0.7302,  1.4767],
        [-0.8562, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5115, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1700, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.9474e-03,  1.6812e-05],
        [-3.5833e-03, -4.2854e-05],
        [-4.0756e-03,  1.3179e-04],
        [-3.4695e-03,  3.4053e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6817],
        [ 0.6149, -2.6264],
        [-0.7307,  1.4769],
        [-0.8561, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4771, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1731, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.4187e-03, -3.0438e-05],
        [-4.0354e-03, -9.5482e-05],
        [-3.6856e-03,  3.6912e-05],
        [-4.0852e-03,  5.3651e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6817],
        [ 0.6144, -2.6265],
        [-0.7303,  1.4768],
        [-0.8568, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5116, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1839, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.8478e-03,  1.9634e-04],
        [-3.7625e-03,  9.9497e-05],
        [-4.0814e-03,  2.1726e-04],
        [-3.5560e-03,  1.9129e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3074,  0.6819],
        [ 0.6147, -2.6263],
        [-0.7307,  1.4770],
        [-0.8562, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6396, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2092, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0040,  0.0003],
        [-0.0042,  0.0004],
        [-0.0042,  0.0004],
        [-0.0039,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3072,  0.6819],
        [ 0.6143, -2.6260],
        [-0.7308,  1.4772],
        [-0.8566, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4888, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1703, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2720e-03, -4.3862e-05],
        [-3.6281e-03, -2.0666e-04],
        [-3.3320e-03, -1.9808e-04],
        [-3.7298e-03, -1.0150e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6816],
        [ 0.6148, -2.6266],
        [-0.7300,  1.4766],
        [-0.8564, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4624, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1618, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0002],
        [-0.0049,  0.0003],
        [-0.0046,  0.0003],
        [-0.0044,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6819],
        [ 0.6136, -2.6261],
        [-0.7313,  1.4771],
        [-0.8571, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4511, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1663, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.4143e-03, -1.2529e-04],
        [-3.2160e-03, -3.8071e-05],
        [-3.1054e-03, -1.8814e-05],
        [-3.2784e-03,  1.8183e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6815],
        [ 0.6152, -2.6264],
        [-0.7298,  1.4767],
        [-0.8560, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5270, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0321, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1696, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0003],
        [-0.0042,  0.0001],
        [-0.0036,  0.0001],
        [-0.0035,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3071,  0.6820],
        [ 0.6143, -2.6263],
        [-0.7302,  1.4769],
        [-0.8562, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4929, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1787, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.4753e-03,  1.9358e-04],
        [-4.4441e-03,  8.9628e-05],
        [-3.8674e-03,  3.9019e-05],
        [-3.9699e-03, -4.0985e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6819],
        [ 0.6140, -2.6263],
        [-0.7305,  1.4768],
        [-0.8567, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5066, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1810, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.9532e-03,  9.4494e-05],
        [-4.1627e-03,  1.1339e-04],
        [-3.6836e-03,  1.8415e-04],
        [-3.9377e-03,  1.4393e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6818],
        [ 0.6143, -2.6263],
        [-0.7303,  1.4770],
        [-0.8566, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6822, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2171, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.5717e-03,  1.6090e-04],
        [-3.7549e-03,  2.1178e-05],
        [-3.8896e-03,  7.2358e-06],
        [-3.7912e-03, -2.4512e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6818],
        [ 0.6147, -2.6263],
        [-0.7306,  1.4768],
        [-0.8565, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4190, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1572, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.9012e-03,  6.7324e-05],
        [-4.6341e-03,  3.6238e-04],
        [-4.2031e-03,  2.4029e-04],
        [-4.2464e-03,  2.5487e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3074,  0.6817],
        [ 0.6138, -2.6260],
        [-0.7309,  1.4770],
        [-0.8569, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4079, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1633, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.9526e-03, -1.0202e-04],
        [-3.8591e-03, -4.8099e-05],
        [-4.1463e-03,  2.1584e-04],
        [-3.9153e-03,  1.3931e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6816],
        [ 0.6146, -2.6264],
        [-0.7308,  1.4770],
        [-0.8566, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4334, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1615, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.3461e-03,  7.3446e-05],
        [-4.3579e-03, -1.3586e-06],
        [-4.1559e-03,  1.7562e-05],
        [-4.0074e-03, -4.9271e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6817],
        [ 0.6141, -2.6264],
        [-0.7308,  1.4768],
        [-0.8567, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4298, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1606, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.8143e-03, -9.3676e-05],
        [-3.9748e-03,  1.0102e-04],
        [-3.5522e-03,  3.7133e-05],
        [-3.9188e-03, -3.7409e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3074,  0.6816],
        [ 0.6144, -2.6263],
        [-0.7302,  1.4768],
        [-0.8566, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4141, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1556, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0001],
        [-0.0046,  0.0003],
        [-0.0041,  0.0004],
        [-0.0048,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6818],
        [ 0.6138, -2.6261],
        [-0.7308,  1.4772],
        [-0.8575, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4101, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1632, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1177e-03, -5.6938e-05],
        [-4.1067e-03,  2.1690e-04],
        [-4.3153e-03, -6.9638e-05],
        [-4.2861e-03, -9.0948e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3071,  0.6816],
        [ 0.6143, -2.6261],
        [-0.7310,  1.4767],
        [-0.8570, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4303, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1596, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.8805e-03,  1.5138e-04],
        [-4.8392e-03,  3.3756e-05],
        [-5.0388e-03,  2.3866e-04],
        [-5.0541e-03,  3.5759e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6818],
        [ 0.6136, -2.6263],
        [-0.7317,  1.4771],
        [-0.8578, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4456, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0331, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1553, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.7381e-03, -5.9848e-05],
        [-3.6932e-03, -2.5928e-05],
        [-4.3235e-03,  3.8160e-05],
        [-3.9360e-03, -6.3710e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3075,  0.6816],
        [ 0.6147, -2.6264],
        [-0.7310,  1.4769],
        [-0.8567, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4240, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1613, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.4365e-03,  1.4761e-04],
        [-4.3770e-03, -6.7311e-05],
        [-4.4323e-03,  1.2022e-04],
        [-4.1503e-03,  3.1518e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6818],
        [ 0.6140, -2.6264],
        [-0.7311,  1.4769],
        [-0.8569, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3976, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1602, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0002],
        [-0.0039,  0.0003],
        [-0.0039,  0.0003],
        [-0.0037,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6818],
        [ 0.6145, -2.6260],
        [-0.7306,  1.4771],
        [-0.8564, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5099, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1734, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2438e-03, -3.6880e-05],
        [-4.0834e-03, -4.4803e-05],
        [-3.5679e-03, -6.4620e-05],
        [-4.1596e-03, -5.3922e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6816],
        [ 0.6143, -2.6264],
        [-0.7302,  1.4768],
        [-0.8569, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4027, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1529, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2868e-03, -1.4609e-05],
        [-4.7249e-03,  3.3511e-05],
        [-4.3195e-03, -9.6572e-06],
        [-4.5830e-03, -7.3233e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6816],
        [ 0.6137, -2.6263],
        [-0.7310,  1.4768],
        [-0.8573, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4110, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1597, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.8746e-03, -9.1476e-05],
        [-4.2960e-03,  2.6125e-05],
        [-5.1147e-03, -2.8955e-05],
        [-4.6147e-03, -1.6747e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6816],
        [ 0.6141, -2.6263],
        [-0.7318,  1.4768],
        [-0.8573, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7016, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2125, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2472e-03, -1.6451e-04],
        [-4.6229e-03, -1.0450e-04],
        [-4.0983e-03, -3.9759e-05],
        [-4.1140e-03, -1.9808e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6815],
        [ 0.6138, -2.6264],
        [-0.7308,  1.4768],
        [-0.8568, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4648, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1747, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.3675e-03,  8.2682e-05],
        [-4.4222e-03, -1.4462e-04],
        [-4.3281e-03,  7.3173e-05],
        [-3.9279e-03, -2.8874e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6817],
        [ 0.6140, -2.6264],
        [-0.7310,  1.4769],
        [-0.8567, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3972, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1546, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.6730e-03,  6.0280e-05],
        [-4.4723e-03,  1.9188e-04],
        [-4.4899e-03, -1.6429e-05],
        [-4.8166e-03,  3.5945e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6817],
        [ 0.6139, -2.6261],
        [-0.7312,  1.4768],
        [-0.8575, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3996, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1657, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.8855e-03,  1.8951e-04],
        [-4.8939e-03,  1.4762e-05],
        [-4.7156e-03,  1.3282e-04],
        [-4.6795e-03,  1.3319e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6819],
        [ 0.6135, -2.6263],
        [-0.7314,  1.4770],
        [-0.8574, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4115, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0313, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1449, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.6898e-03,  1.1319e-04],
        [-4.2519e-03, -3.2386e-05],
        [-4.7090e-03,  4.0641e-05],
        [-4.7216e-03,  5.9865e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6818],
        [ 0.6141, -2.6263],
        [-0.7314,  1.4769],
        [-0.8574, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4234, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1579, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.5892e-03, -1.5022e-05],
        [-4.1526e-03,  3.4137e-05],
        [-4.1155e-03, -1.8381e-04],
        [-4.0989e-03,  8.6429e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3076,  0.6817],
        [ 0.6142, -2.6262],
        [-0.7308,  1.4767],
        [-0.8568, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3998, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1637, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.9235e-03,  6.7648e-05],
        [-4.3197e-03, -2.0956e-05],
        [-4.3293e-03,  6.2396e-05],
        [-3.9604e-03, -1.0123e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6818],
        [ 0.6141, -2.6263],
        [-0.7310,  1.4769],
        [-0.8567, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6548, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0344, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1997, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.5203e-03, -9.6656e-05],
        [-4.4289e-03,  4.0986e-05],
        [-4.1522e-03, -1.2524e-05],
        [-4.4324e-03,  1.2498e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3067,  0.6816],
        [ 0.6140, -2.6262],
        [-0.7308,  1.4769],
        [-0.8572, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6049, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2007, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0040, -0.0002],
        [-0.0041, -0.0003],
        [-0.0043, -0.0003],
        [-0.0035, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3072,  0.6815],
        [ 0.6143, -2.6266],
        [-0.7310,  1.4765],
        [-0.8562, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4148, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1531, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.4089e-03,  2.0216e-05],
        [-4.7256e-03,  2.8559e-04],
        [-4.7694e-03,  2.0610e-04],
        [-4.6538e-03,  1.0249e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6817],
        [ 0.6137, -2.6260],
        [-0.7315,  1.4771],
        [-0.8574, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6173, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2022, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.8884e-03, -1.4936e-04],
        [-4.1556e-03, -5.6812e-05],
        [-4.8268e-03, -9.3731e-06],
        [-4.5094e-03,  4.3139e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6816],
        [ 0.6142, -2.6263],
        [-0.7315,  1.4769],
        [-0.8572, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3955, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1549, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.9038e-03, -1.3274e-05],
        [-3.6080e-03, -1.2354e-04],
        [-3.3986e-03,  2.9797e-05],
        [-3.7633e-03,  1.5996e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6817],
        [ 0.6148, -2.6264],
        [-0.7301,  1.4769],
        [-0.8565, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4010, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0339, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1479, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1056e-03, -2.0451e-04],
        [-4.3505e-03, -6.2479e-05],
        [-4.0483e-03, -9.5258e-05],
        [-3.9932e-03, -9.5548e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3071,  0.6815],
        [ 0.6140, -2.6263],
        [-0.7308,  1.4768],
        [-0.8567, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4222, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1553, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.5326e-03,  3.5983e-05],
        [-3.9396e-03, -6.0119e-05],
        [-4.1005e-03, -8.8897e-06],
        [-4.1710e-03, -5.3646e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6818],
        [ 0.6144, -2.6263],
        [-0.7308,  1.4769],
        [-0.8569, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4028, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1549, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0003],
        [-0.0050,  0.0002],
        [-0.0046,  0.0002],
        [-0.0043,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6821],
        [ 0.6134, -2.6261],
        [-0.7313,  1.4770],
        [-0.8570, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7693, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0323, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2184, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.3110e-03,  1.6410e-04],
        [-4.8910e-03,  1.2427e-04],
        [-5.2156e-03,  2.9814e-04],
        [-4.0926e-03,  3.2275e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6819],
        [ 0.6135, -2.6261],
        [-0.7319,  1.4772],
        [-0.8568, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4049, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1582, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.4267e-03,  2.4581e-04],
        [-4.3038e-03,  1.2224e-04],
        [-4.1023e-03,  5.6062e-05],
        [-4.3491e-03,  1.3417e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6820],
        [ 0.6141, -2.6261],
        [-0.7308,  1.4769],
        [-0.8570, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4510, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1696, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.1059e-03, -3.0171e-04],
        [-2.9622e-03, -6.2719e-05],
        [-3.2315e-03, -2.5453e-05],
        [-3.6272e-03, -3.1242e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6814],
        [ 0.6154, -2.6263],
        [-0.7300,  1.4769],
        [-0.8563, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4265, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0425, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1702, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.3237e-03,  1.2358e-04],
        [-4.4799e-03,  1.2236e-04],
        [-4.9583e-03,  1.4896e-04],
        [-4.3725e-03, -6.0469e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6819],
        [ 0.6139, -2.6261],
        [-0.7317,  1.4770],
        [-0.8571, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4143, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0425, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1679, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.7394e-03,  1.6149e-04],
        [-4.2947e-03,  9.4826e-05],
        [-5.1724e-03,  2.9052e-04],
        [-4.6253e-03,  1.2083e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6819],
        [ 0.6141, -2.6262],
        [-0.7319,  1.4772],
        [-0.8573, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4076, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1558, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2963e-03,  1.3191e-06],
        [-4.0617e-03, -6.4799e-05],
        [-4.2578e-03, -3.9236e-05],
        [-3.9680e-03,  1.5952e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6817],
        [ 0.6143, -2.6263],
        [-0.7310,  1.4769],
        [-0.8566, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4369, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1669, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.3521e-03,  2.2822e-05],
        [-3.7645e-03, -8.2530e-05],
        [-3.8812e-03, -3.4920e-05],
        [-4.1154e-03,  4.2915e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6817],
        [ 0.6146, -2.6263],
        [-0.7306,  1.4769],
        [-0.8568, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5728, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1855, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0002],
        [-0.0053,  0.0004],
        [-0.0048,  0.0004],
        [-0.0053,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6819],
        [ 0.6131, -2.6259],
        [-0.7315,  1.4773],
        [-0.8580, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4805, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1678, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.5588e-03,  9.2428e-05],
        [-3.8767e-03,  1.1534e-04],
        [-4.0669e-03, -2.2659e-06],
        [-3.5545e-03,  9.8322e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3076,  0.6818],
        [ 0.6145, -2.6261],
        [-0.7308,  1.4769],
        [-0.8562, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4418, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1744, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2644e-03, -9.7228e-06],
        [-4.6952e-03, -3.3719e-05],
        [-4.5407e-03,  1.4217e-05],
        [-4.6391e-03, -2.6848e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6817],
        [ 0.6137, -2.6263],
        [-0.7313,  1.4769],
        [-0.8573, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4114, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1636, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.8177e-03,  2.1992e-04],
        [-4.2568e-03, -9.6418e-05],
        [-4.1972e-03, -8.9165e-05],
        [-4.2494e-03, -1.8150e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6819],
        [ 0.6141, -2.6264],
        [-0.7310,  1.4768],
        [-0.8569, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5073, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1749, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.8013e-03, -4.9415e-05],
        [-4.5191e-03,  6.1868e-06],
        [-4.7368e-03,  2.2659e-05],
        [-4.2404e-03, -8.7669e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6817],
        [ 0.6139, -2.6263],
        [-0.7315,  1.4769],
        [-0.8569, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3818, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1559, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.7978e-03, -3.7022e-05],
        [-4.1113e-03,  3.5974e-05],
        [-4.1111e-03, -4.4045e-05],
        [-4.1675e-03,  6.6001e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3074,  0.6817],
        [ 0.6143, -2.6262],
        [-0.7309,  1.4768],
        [-0.8568, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4668, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0306, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1546, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.6961e-03,  9.8874e-06],
        [-4.3709e-03, -5.1646e-05],
        [-4.0130e-03, -1.5050e-05],
        [-4.4101e-03,  1.2826e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6817],
        [ 0.6140, -2.6263],
        [-0.7308,  1.4769],
        [-0.8570, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4150, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0343, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1516, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.0871e-03,  7.8053e-05],
        [-4.5817e-03, -2.0764e-05],
        [-4.1162e-03, -7.4729e-05],
        [-4.1351e-03, -2.4090e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3071,  0.6818],
        [ 0.6138, -2.6263],
        [-0.7309,  1.4768],
        [-0.8568, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4210, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1596, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0002],
        [-0.0041,  0.0001],
        [-0.0046,  0.0002],
        [-0.0045,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6820],
        [ 0.6143, -2.6261],
        [-0.7314,  1.4770],
        [-0.8571, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3939, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1584, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.9324e-03, -2.4448e-04],
        [-4.3841e-03,  1.1322e-04],
        [-5.2701e-03,  5.6969e-05],
        [-4.6956e-03,  1.1764e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6815],
        [ 0.6140, -2.6262],
        [-0.7321,  1.4769],
        [-0.8573, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3822, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1460, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.8838e-03,  2.6816e-04],
        [-3.9489e-03,  1.2904e-04],
        [-4.0471e-03,  4.4066e-05],
        [-4.0929e-03,  1.6546e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6820],
        [ 0.6145, -2.6261],
        [-0.7308,  1.4769],
        [-0.8567, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4301, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1641, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2022e-03, -1.0663e-04],
        [-3.9680e-03, -1.3607e-04],
        [-4.0266e-03, -1.8883e-05],
        [-4.2298e-03,  7.3023e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6816],
        [ 0.6145, -2.6264],
        [-0.7308,  1.4769],
        [-0.8568, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3844, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1507, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.6170e-03,  4.8300e-05],
        [-4.7578e-03,  1.7481e-04],
        [-4.7417e-03,  1.1068e-04],
        [-4.4300e-03,  1.5302e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6818],
        [ 0.6137, -2.6261],
        [-0.7316,  1.4770],
        [-0.8570, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4521, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1645, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.9469e-03,  1.8590e-04],
        [-4.0757e-03,  5.3521e-05],
        [-3.8182e-03,  1.5609e-04],
        [-4.3318e-03,  1.2792e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6819],
        [ 0.6144, -2.6262],
        [-0.7306,  1.4770],
        [-0.8569, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4797, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1730, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0001],
        [-0.0047,  0.0002],
        [-0.0053,  0.0004],
        [-0.0048,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3067,  0.6818],
        [ 0.6138, -2.6261],
        [-0.7321,  1.4772],
        [-0.8574, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4103, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1625, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.8296e-03,  4.9198e-05],
        [-4.9565e-03,  3.2535e-04],
        [-4.1214e-03, -1.2393e-05],
        [-4.8701e-03,  2.0421e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6818],
        [ 0.6135, -2.6260],
        [-0.7309,  1.4769],
        [-0.8575, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4869, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1701, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041, -0.0002],
        [-0.0040, -0.0001],
        [-0.0038, -0.0002],
        [-0.0042, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3071,  0.6815],
        [ 0.6144, -2.6264],
        [-0.7307,  1.4767],
        [-0.8568, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4278, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0452, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1760, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0002],
        [-0.0042,  0.0001],
        [-0.0043,  0.0003],
        [-0.0044,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6819],
        [ 0.6143, -2.6261],
        [-0.7312,  1.4772],
        [-0.8570, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4871, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1711, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1767e-03,  1.0408e-04],
        [-4.4650e-03,  1.6163e-04],
        [-4.6626e-03,  2.0402e-04],
        [-4.1627e-03,  4.1307e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6818],
        [ 0.6140, -2.6261],
        [-0.7315,  1.4771],
        [-0.8568, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4159, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1580, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.4302e-03, -2.4220e-05],
        [-4.0867e-03,  1.9439e-04],
        [-4.1936e-03,  8.6268e-05],
        [-4.5451e-03,  2.3310e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6817],
        [ 0.6144, -2.6261],
        [-0.7310,  1.4769],
        [-0.8571, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4434, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1601, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.7410e-03, -1.1473e-04],
        [-4.6305e-03, -1.5614e-05],
        [-5.0033e-03, -3.2248e-05],
        [-5.4875e-03, -1.6568e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6816],
        [ 0.6138, -2.6263],
        [-0.7319,  1.4768],
        [-0.8581, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3946, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0334, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1458, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 3, Batch:200, loss: 0.000729, Time: 72.6
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0003],
        [-0.0051,  0.0002],
        [-0.0054,  0.0004],
        [-0.0051,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6820],
        [ 0.6134, -2.6261],
        [-0.7322,  1.4772],
        [-0.8577, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4472, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1701, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0003],
        [-0.0052,  0.0003],
        [-0.0051,  0.0002],
        [-0.0049,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6820],
        [ 0.6133, -2.6260],
        [-0.7320,  1.4770],
        [-0.8575, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4118, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0420, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1664, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0004],
        [-0.0043,  0.0003],
        [-0.0043,  0.0001],
        [-0.0045,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3071,  0.6821],
        [ 0.6142, -2.6260],
        [-0.7312,  1.4770],
        [-0.8571, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5375, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1891, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0003],
        [-0.0044,  0.0001],
        [-0.0048,  0.0004],
        [-0.0044,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6821],
        [ 0.6140, -2.6262],
        [-0.7317,  1.4772],
        [-0.8570, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4097, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1610, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0006],
        [-0.0057,  0.0005],
        [-0.0051,  0.0004],
        [-0.0057,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6823],
        [ 0.6128, -2.6258],
        [-0.7320,  1.4772],
        [-0.8583, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3774, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1464, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0002],
        [-0.0052,  0.0001],
        [-0.0046,  0.0001],
        [-0.0053,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6819],
        [ 0.6133, -2.6262],
        [-0.7314,  1.4770],
        [-0.8578, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4567, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1695, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.6332e-03,  5.9953e-05],
        [-4.8741e-03,  1.0696e-04],
        [-4.1847e-03,  1.4209e-04],
        [-4.5893e-03,  1.8800e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6818],
        [ 0.6137, -2.6262],
        [-0.7310,  1.4770],
        [-0.8572, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6303, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0417, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2096, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0005],
        [-0.0053,  0.0003],
        [-0.0053,  0.0004],
        [-0.0051,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6822],
        [ 0.6132, -2.6260],
        [-0.7321,  1.4772],
        [-0.8577, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4445, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1686, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0004],
        [-0.0044,  0.0004],
        [-0.0045,  0.0004],
        [-0.0054,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6822],
        [ 0.6141, -2.6259],
        [-0.7314,  1.4772],
        [-0.8579, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4216, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1601, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0007],
        [-0.0058,  0.0007],
        [-0.0050,  0.0005],
        [-0.0053,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6824],
        [ 0.6127, -2.6256],
        [-0.7319,  1.4774],
        [-0.8578, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4908, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0334, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1649, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0003],
        [-0.0044,  0.0002],
        [-0.0046,  0.0003],
        [-0.0047,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6821],
        [ 0.6142, -2.6261],
        [-0.7315,  1.4771],
        [-0.8573, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4120, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0454, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1732, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0005],
        [-0.0051,  0.0005],
        [-0.0050,  0.0005],
        [-0.0053,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6823],
        [ 0.6135, -2.6258],
        [-0.7318,  1.4773],
        [-0.8579, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3909, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0307, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1395, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0007],
        [-0.0046,  0.0008],
        [-0.0047,  0.0008],
        [-0.0055,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6825],
        [ 0.6140, -2.6256],
        [-0.7315,  1.4776],
        [-0.8581, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4536, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1620, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0004],
        [-0.0050,  0.0005],
        [-0.0049,  0.0005],
        [-0.0054,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6822],
        [ 0.6136, -2.6258],
        [-0.7317,  1.4774],
        [-0.8579, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4447, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1631, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0005],
        [-0.0042,  0.0006],
        [-0.0042,  0.0003],
        [-0.0038,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6823],
        [ 0.6144, -2.6257],
        [-0.7311,  1.4772],
        [-0.8564, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4516, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1677, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0003],
        [-0.0052,  0.0003],
        [-0.0051,  0.0003],
        [-0.0040,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6821],
        [ 0.6134, -2.6260],
        [-0.7319,  1.4771],
        [-0.8565, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6155, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1905, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0060,  0.0007],
        [-0.0053,  0.0006],
        [-0.0050,  0.0004],
        [-0.0054,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3051,  0.6825],
        [ 0.6133, -2.6257],
        [-0.7319,  1.4773],
        [-0.8579, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3999, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0480, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1759, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0005],
        [-0.0039,  0.0005],
        [-0.0044,  0.0006],
        [-0.0041,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6823],
        [ 0.6147, -2.6259],
        [-0.7312,  1.4774],
        [-0.8567, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4163, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1566, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0009],
        [-0.0052,  0.0007],
        [-0.0055,  0.0008],
        [-0.0054,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6827],
        [ 0.6135, -2.6256],
        [-0.7324,  1.4777],
        [-0.8580, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4405, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1621, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0008],
        [-0.0055,  0.0009],
        [-0.0046,  0.0006],
        [-0.0054,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6826],
        [ 0.6132, -2.6255],
        [-0.7314,  1.4775],
        [-0.8579, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4006, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1585, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0007],
        [-0.0048,  0.0008],
        [-0.0054,  0.0009],
        [-0.0051,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6825],
        [ 0.6138, -2.6255],
        [-0.7322,  1.4778],
        [-0.8576, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4265, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1589, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0007],
        [-0.0054,  0.0007],
        [-0.0055,  0.0008],
        [-0.0060,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6825],
        [ 0.6133, -2.6256],
        [-0.7323,  1.4776],
        [-0.8585, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3941, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1481, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0006],
        [-0.0053,  0.0006],
        [-0.0047,  0.0004],
        [-0.0049,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6825],
        [ 0.6134, -2.6257],
        [-0.7316,  1.4773],
        [-0.8574, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4124, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1643, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0003],
        [-0.0058,  0.0006],
        [-0.0050,  0.0006],
        [-0.0050,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6821],
        [ 0.6129, -2.6257],
        [-0.7319,  1.4775],
        [-0.8575, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3926, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1572, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0007],
        [-0.0047,  0.0006],
        [-0.0044,  0.0004],
        [-0.0042,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6825],
        [ 0.6139, -2.6257],
        [-0.7312,  1.4773],
        [-0.8568, -2.7475]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4231, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1637, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0007],
        [-0.0052,  0.0009],
        [-0.0050,  0.0006],
        [-0.0053,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6825],
        [ 0.6134, -2.6254],
        [-0.7318,  1.4775],
        [-0.8578, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4430, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1633, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0010],
        [-0.0049,  0.0007],
        [-0.0057,  0.0010],
        [-0.0057,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3053,  0.6828],
        [ 0.6137, -2.6256],
        [-0.7325,  1.4779],
        [-0.8582, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6527, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2036, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0007],
        [-0.0058,  0.0009],
        [-0.0050,  0.0006],
        [-0.0049,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6825],
        [ 0.6128, -2.6255],
        [-0.7318,  1.4775],
        [-0.8574, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3981, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1513, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0006],
        [-0.0043,  0.0005],
        [-0.0045,  0.0007],
        [-0.0048,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6824],
        [ 0.6144, -2.6258],
        [-0.7314,  1.4775],
        [-0.8573, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4653, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1646, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0008],
        [-0.0045,  0.0005],
        [-0.0048,  0.0007],
        [-0.0051,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6826],
        [ 0.6142, -2.6258],
        [-0.7317,  1.4775],
        [-0.8576, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4366, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0319, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1511, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0008],
        [-0.0055,  0.0008],
        [-0.0051,  0.0008],
        [-0.0041,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6826],
        [ 0.6132, -2.6255],
        [-0.7320,  1.4777],
        [-0.8567, -2.7474]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5042, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1830, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0008],
        [-0.0043,  0.0010],
        [-0.0043,  0.0008],
        [-0.0047,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6826],
        [ 0.6143, -2.6253],
        [-0.7311,  1.4777],
        [-0.8572, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4252, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0425, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1701, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0009],
        [-0.0047,  0.0007],
        [-0.0052,  0.0010],
        [-0.0047,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6827],
        [ 0.6139, -2.6256],
        [-0.7321,  1.4779],
        [-0.8573, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3790, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0457, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1672, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0007],
        [-0.0044,  0.0006],
        [-0.0045,  0.0007],
        [-0.0045,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3067,  0.6825],
        [ 0.6143, -2.6257],
        [-0.7314,  1.4776],
        [-0.8570, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4152, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1619, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0012],
        [-0.0046,  0.0007],
        [-0.0052,  0.0010],
        [-0.0054,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6830],
        [ 0.6140, -2.6256],
        [-0.7320,  1.4779],
        [-0.8579, -2.7468]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4010, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1500, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0011],
        [-0.0049,  0.0010],
        [-0.0058,  0.0011],
        [-0.0051,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6829],
        [ 0.6137, -2.6253],
        [-0.7326,  1.4780],
        [-0.8576, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4268, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0421, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1695, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0011],
        [-0.0056,  0.0009],
        [-0.0055,  0.0010],
        [-0.0053,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3053,  0.6829],
        [ 0.6131, -2.6254],
        [-0.7324,  1.4779],
        [-0.8578, -2.7472]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3921, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1525, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0009],
        [-0.0056,  0.0011],
        [-0.0056,  0.0011],
        [-0.0055,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6827],
        [ 0.6131, -2.6253],
        [-0.7325,  1.4780],
        [-0.8580, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4006, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1581, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0007],
        [-0.0054,  0.0010],
        [-0.0056,  0.0010],
        [-0.0060,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6825],
        [ 0.6132, -2.6253],
        [-0.7325,  1.4780],
        [-0.8585, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4066, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1486, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0010],
        [-0.0053,  0.0009],
        [-0.0048,  0.0008],
        [-0.0054,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6828],
        [ 0.6134, -2.6254],
        [-0.7317,  1.4777],
        [-0.8580, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4193, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1657, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0011],
        [-0.0051,  0.0010],
        [-0.0062,  0.0013],
        [-0.0053,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6829],
        [ 0.6136, -2.6253],
        [-0.7331,  1.4782],
        [-0.8579, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4268, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0425, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1703, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0013],
        [-0.0049,  0.0012],
        [-0.0045,  0.0010],
        [-0.0047,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6831],
        [ 0.6138, -2.6251],
        [-0.7314,  1.4779],
        [-0.8573, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4163, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0325, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1483, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0011],
        [-0.0050,  0.0010],
        [-0.0051,  0.0011],
        [-0.0050,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6829],
        [ 0.6137, -2.6254],
        [-0.7320,  1.4781],
        [-0.8576, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4444, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1563, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0010],
        [-0.0049,  0.0010],
        [-0.0044,  0.0009],
        [-0.0049,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6827],
        [ 0.6138, -2.6254],
        [-0.7313,  1.4778],
        [-0.8574, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3892, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1523, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0060,  0.0014],
        [-0.0054,  0.0012],
        [-0.0054,  0.0013],
        [-0.0060,  0.0014]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3052,  0.6832],
        [ 0.6133, -2.6251],
        [-0.7323,  1.4782],
        [-0.8586, -2.7466]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5862, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0456, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2085, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0012],
        [-0.0050,  0.0009],
        [-0.0052,  0.0011],
        [-0.0053,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6829],
        [ 0.6137, -2.6255],
        [-0.7322,  1.4780],
        [-0.8578, -2.7467]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4116, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1539, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0008],
        [-0.0049,  0.0006],
        [-0.0051,  0.0007],
        [-0.0048,  0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6825],
        [ 0.6138, -2.6257],
        [-0.7321,  1.4777],
        [-0.8574, -2.7473]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3848, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1520, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0008],
        [-0.0045,  0.0007],
        [-0.0052,  0.0012],
        [-0.0051,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6826],
        [ 0.6142, -2.6257],
        [-0.7321,  1.4782],
        [-0.8576, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4235, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1620, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0013],
        [-0.0055,  0.0012],
        [-0.0052,  0.0011],
        [-0.0061,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6830],
        [ 0.6132, -2.6252],
        [-0.7322,  1.4781],
        [-0.8587, -2.7466]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4171, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1658, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0011],
        [-0.0051,  0.0012],
        [-0.0052,  0.0012],
        [-0.0050,  0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6829],
        [ 0.6136, -2.6251],
        [-0.7322,  1.4781],
        [-0.8575, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4152, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1667, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0058,  0.0013],
        [-0.0054,  0.0012],
        [-0.0054,  0.0014],
        [-0.0052,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6830],
        [ 0.6133, -2.6252],
        [-0.7324,  1.4784],
        [-0.8577, -2.7468]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4201, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0421, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1682, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0012],
        [-0.0047,  0.0008],
        [-0.0047,  0.0009],
        [-0.0049,  0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6830],
        [ 0.6140, -2.6255],
        [-0.7317,  1.4779],
        [-0.8575, -2.7471]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4780, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1705, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0011],
        [-0.0059,  0.0014],
        [-0.0056,  0.0011],
        [-0.0052,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6828],
        [ 0.6128, -2.6249],
        [-0.7326,  1.4781],
        [-0.8578, -2.7468]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3864, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1509, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0012],
        [-0.0057,  0.0013],
        [-0.0050,  0.0010],
        [-0.0055,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6830],
        [ 0.6130, -2.6251],
        [-0.7319,  1.4780],
        [-0.8580, -2.7467]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4438, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1711, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0011],
        [-0.0054,  0.0013],
        [-0.0055,  0.0012],
        [-0.0058,  0.0014]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6828],
        [ 0.6134, -2.6251],
        [-0.7324,  1.4782],
        [-0.8584, -2.7466]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4134, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1659, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0013],
        [-0.0056,  0.0013],
        [-0.0054,  0.0011],
        [-0.0052,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6830],
        [ 0.6131, -2.6250],
        [-0.7324,  1.4781],
        [-0.8578, -2.7468]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4493, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1688, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0014],
        [-0.0051,  0.0011],
        [-0.0047,  0.0011],
        [-0.0051,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6831],
        [ 0.6136, -2.6253],
        [-0.7317,  1.4781],
        [-0.8577, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4353, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1645, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0011],
        [-0.0047,  0.0011],
        [-0.0055,  0.0012],
        [-0.0061,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6829],
        [ 0.6140, -2.6253],
        [-0.7325,  1.4783],
        [-0.8586, -2.7466]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4151, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1593, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0010],
        [-0.0045,  0.0009],
        [-0.0042,  0.0010],
        [-0.0046,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6828],
        [ 0.6142, -2.6255],
        [-0.7312,  1.4780],
        [-0.8571, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4854, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1666, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0010],
        [-0.0053,  0.0010],
        [-0.0056,  0.0011],
        [-0.0057,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6827],
        [ 0.6135, -2.6254],
        [-0.7326,  1.4781],
        [-0.8582, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3940, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1490, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0010],
        [-0.0046,  0.0009],
        [-0.0043,  0.0010],
        [-0.0044,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6828],
        [ 0.6141, -2.6255],
        [-0.7313,  1.4781],
        [-0.8569, -2.7468]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4116, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1640, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0010],
        [-0.0054,  0.0013],
        [-0.0053,  0.0011],
        [-0.0052,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6828],
        [ 0.6134, -2.6251],
        [-0.7323,  1.4782],
        [-0.8577, -2.7470]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3750, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1555, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0010],
        [-0.0054,  0.0013],
        [-0.0051,  0.0010],
        [-0.0050,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6828],
        [ 0.6134, -2.6251],
        [-0.7321,  1.4781],
        [-0.8576, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4351, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1664, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0014],
        [-0.0053,  0.0014],
        [-0.0054,  0.0011],
        [-0.0059,  0.0016]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6831],
        [ 0.6135, -2.6250],
        [-0.7324,  1.4782],
        [-0.8584, -2.7463]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3996, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1562, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0011],
        [-0.0054,  0.0011],
        [-0.0050,  0.0009],
        [-0.0056,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6829],
        [ 0.6134, -2.6252],
        [-0.7320,  1.4780],
        [-0.8581, -2.7468]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4474, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1627, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0010],
        [-0.0054,  0.0011],
        [-0.0056,  0.0013],
        [-0.0052,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6828],
        [ 0.6134, -2.6253],
        [-0.7326,  1.4784],
        [-0.8577, -2.7467]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4947, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1772, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0009],
        [-0.0044,  0.0008],
        [-0.0043,  0.0009],
        [-0.0051,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3067,  0.6827],
        [ 0.6144, -2.6255],
        [-0.7314,  1.4780],
        [-0.8577, -2.7468]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4070, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1614, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0011],
        [-0.0056,  0.0013],
        [-0.0063,  0.0014],
        [-0.0064,  0.0016]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6829],
        [ 0.6133, -2.6251],
        [-0.7334,  1.4785],
        [-0.8590, -2.7464]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4116, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1575, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0012],
        [-0.0058,  0.0013],
        [-0.0054,  0.0011],
        [-0.0049,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6830],
        [ 0.6130, -2.6251],
        [-0.7324,  1.4783],
        [-0.8574, -2.7468]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3938, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0461, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1709, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0013],
        [-0.0060,  0.0014],
        [-0.0062,  0.0014],
        [-0.0055,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6831],
        [ 0.6129, -2.6250],
        [-0.7332,  1.4785],
        [-0.8580, -2.7467]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3832, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0470, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1706, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0060,  0.0014],
        [-0.0064,  0.0015],
        [-0.0053,  0.0013],
        [-0.0058,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3051,  0.6832],
        [ 0.6125, -2.6249],
        [-0.7323,  1.4785],
        [-0.8584, -2.7466]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4130, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1582, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0012],
        [-0.0056,  0.0013],
        [-0.0059,  0.0014],
        [-0.0056,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6830],
        [ 0.6132, -2.6251],
        [-0.7329,  1.4785],
        [-0.8581, -2.7466]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4421, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1675, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0012],
        [-0.0048,  0.0012],
        [-0.0051,  0.0014],
        [-0.0055,  0.0014]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6830],
        [ 0.6141, -2.6252],
        [-0.7321,  1.4785],
        [-0.8580, -2.7465]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4333, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1575, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0014],
        [-0.0053,  0.0014],
        [-0.0044,  0.0012],
        [-0.0046,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6832],
        [ 0.6136, -2.6250],
        [-0.7315,  1.4783],
        [-0.8572, -2.7467]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4817, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1731, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0011],
        [-0.0049,  0.0012],
        [-0.0051,  0.0012],
        [-0.0051,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6829],
        [ 0.6140, -2.6252],
        [-0.7321,  1.4784],
        [-0.8577, -2.7467]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4494, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1597, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0013],
        [-0.0057,  0.0014],
        [-0.0056,  0.0012],
        [-0.0054,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3053,  0.6831],
        [ 0.6132, -2.6250],
        [-0.7326,  1.4784],
        [-0.8579, -2.7467]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4124, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1548, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0015],
        [-0.0056,  0.0015],
        [-0.0054,  0.0013],
        [-0.0053,  0.0013]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6833],
        [ 0.6134, -2.6249],
        [-0.7324,  1.4785],
        [-0.8578, -2.7466]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6319, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2017, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0015],
        [-0.0054,  0.0016],
        [-0.0055,  0.0016],
        [-0.0050,  0.0015]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6833],
        [ 0.6135, -2.6248],
        [-0.7326,  1.4788],
        [-0.8575, -2.7464]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5135, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1737, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0015],
        [-0.0050,  0.0013],
        [-0.0046,  0.0012],
        [-0.0052,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6833],
        [ 0.6139, -2.6251],
        [-0.7316,  1.4784],
        [-0.8577, -2.7467]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3963, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1559, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0011],
        [-0.0055,  0.0012],
        [-0.0050,  0.0012],
        [-0.0050,  0.0011]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6829],
        [ 0.6135, -2.6253],
        [-0.7320,  1.4785],
        [-0.8576, -2.7468]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4357, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1678, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0013],
        [-0.0050,  0.0012],
        [-0.0050,  0.0014],
        [-0.0050,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6831],
        [ 0.6140, -2.6252],
        [-0.7321,  1.4786],
        [-0.8575, -2.7467]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3933, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1532, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0011],
        [-0.0046,  0.0011],
        [-0.0050,  0.0012],
        [-0.0044,  0.0012]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6829],
        [ 0.6144, -2.6254],
        [-0.7321,  1.4784],
        [-0.8569, -2.7468]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4231, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1632, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0015],
        [-0.0043,  0.0013],
        [-0.0052,  0.0015],
        [-0.0043,  0.0010]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6833],
        [ 0.6146, -2.6251],
        [-0.7322,  1.4787],
        [-0.8568, -2.7469]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4698, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1768, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0013],
        [-0.0051,  0.0015],
        [-0.0047,  0.0016],
        [-0.0050,  0.0016]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6831],
        [ 0.6139, -2.6249],
        [-0.7317,  1.4788],
        [-0.8575, -2.7463]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4233, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1543, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0016],
        [-0.0050,  0.0015],
        [-0.0056,  0.0018],
        [-0.0056,  0.0018]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6834],
        [ 0.6140, -2.6249],
        [-0.7326,  1.4791],
        [-0.8581, -2.7461]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3897, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1580, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0014],
        [-0.0049,  0.0015],
        [-0.0049,  0.0017],
        [-0.0046,  0.0014]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6832],
        [ 0.6141, -2.6249],
        [-0.7320,  1.4789],
        [-0.8572, -2.7465]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3959, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0415, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1622, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0019],
        [-0.0053,  0.0016],
        [-0.0048,  0.0017],
        [-0.0048,  0.0017]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6838],
        [ 0.6137, -2.6248],
        [-0.7318,  1.4789],
        [-0.8573, -2.7462]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4133, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1526, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0016],
        [-0.0046,  0.0015],
        [-0.0048,  0.0016],
        [-0.0051,  0.0018]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6835],
        [ 0.6144, -2.6250],
        [-0.7319,  1.4789],
        [-0.8576, -2.7461]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4131, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1534, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0016],
        [-0.0056,  0.0019],
        [-0.0053,  0.0017],
        [-0.0049,  0.0016]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6835],
        [ 0.6135, -2.6246],
        [-0.7324,  1.4790],
        [-0.8574, -2.7463]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4106, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1557, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0017],
        [-0.0045,  0.0016],
        [-0.0052,  0.0018],
        [-0.0044,  0.0014]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6835],
        [ 0.6145, -2.6248],
        [-0.7323,  1.4791],
        [-0.8569, -2.7465]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5324, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0318, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1701, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0017],
        [-0.0050,  0.0017],
        [-0.0054,  0.0019],
        [-0.0042,  0.0014]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6836],
        [ 0.6141, -2.6248],
        [-0.7324,  1.4792],
        [-0.8567, -2.7465]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3902, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1571, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0021],
        [-0.0051,  0.0019],
        [-0.0045,  0.0015],
        [-0.0056,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6840],
        [ 0.6139, -2.6246],
        [-0.7316,  1.4788],
        [-0.8581, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3872, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1439, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0016],
        [-0.0056,  0.0020],
        [-0.0056,  0.0020],
        [-0.0050,  0.0017]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6835],
        [ 0.6135, -2.6244],
        [-0.7327,  1.4792],
        [-0.8575, -2.7461]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4003, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1540, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0020],
        [-0.0048,  0.0017],
        [-0.0047,  0.0017],
        [-0.0048,  0.0016]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6839],
        [ 0.6143, -2.6248],
        [-0.7318,  1.4790],
        [-0.8573, -2.7462]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4144, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0344, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1517, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0018],
        [-0.0054,  0.0018],
        [-0.0054,  0.0017],
        [-0.0049,  0.0014]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6837],
        [ 0.6136, -2.6247],
        [-0.7325,  1.4790],
        [-0.8574, -2.7464]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4504, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1663, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0062,  0.0023],
        [-0.0060,  0.0022],
        [-0.0053,  0.0018],
        [-0.0056,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3049,  0.6842],
        [ 0.6131, -2.6242],
        [-0.7324,  1.4791],
        [-0.8581, -2.7458]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3889, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1613, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0019],
        [-0.0057,  0.0023],
        [-0.0051,  0.0019],
        [-0.0052,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6838],
        [ 0.6134, -2.6242],
        [-0.7322,  1.4792],
        [-0.8577, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4127, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1543, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0021],
        [-0.0059,  0.0023],
        [-0.0052,  0.0020],
        [-0.0053,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6840],
        [ 0.6131, -2.6242],
        [-0.7323,  1.4793],
        [-0.8578, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4527, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1658, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0018],
        [-0.0050,  0.0019],
        [-0.0044,  0.0018],
        [-0.0049,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6837],
        [ 0.6140, -2.6246],
        [-0.7315,  1.4791],
        [-0.8574, -2.7459]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4111, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0344, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1511, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0018],
        [-0.0050,  0.0021],
        [-0.0048,  0.0019],
        [-0.0049,  0.0019]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6837],
        [ 0.6140, -2.6244],
        [-0.7318,  1.4792],
        [-0.8574, -2.7460]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4181, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1644, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 3, Batch:300, loss: 0.000548, Time: 108.4
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0022],
        [-0.0045,  0.0020],
        [-0.0049,  0.0020],
        [-0.0049,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6841],
        [ 0.6146, -2.6245],
        [-0.7320,  1.4793],
        [-0.8574, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4506, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0470, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1841, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0020],
        [-0.0050,  0.0020],
        [-0.0056,  0.0023],
        [-0.0048,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6839],
        [ 0.6140, -2.6245],
        [-0.7327,  1.4797],
        [-0.8573, -2.7459]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4305, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1624, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0020],
        [-0.0047,  0.0018],
        [-0.0043,  0.0018],
        [-0.0040,  0.0015]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6839],
        [ 0.6144, -2.6247],
        [-0.7314,  1.4791],
        [-0.8565, -2.7463]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5593, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1867, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0022],
        [-0.0057,  0.0022],
        [-0.0048,  0.0018],
        [-0.0055,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6841],
        [ 0.6133, -2.6243],
        [-0.7319,  1.4792],
        [-0.8580, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3758, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1531, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0021],
        [-0.0051,  0.0023],
        [-0.0050,  0.0022],
        [-0.0052,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6840],
        [ 0.6140, -2.6242],
        [-0.7321,  1.4796],
        [-0.8577, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4007, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1589, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0020],
        [-0.0043,  0.0019],
        [-0.0046,  0.0018],
        [-0.0053,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6839],
        [ 0.6148, -2.6246],
        [-0.7317,  1.4792],
        [-0.8578, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4025, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1570, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0025],
        [-0.0054,  0.0025],
        [-0.0050,  0.0025],
        [-0.0054,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6844],
        [ 0.6136, -2.6240],
        [-0.7321,  1.4798],
        [-0.8579, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5422, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1862, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0015],
        [-0.0040,  0.0016],
        [-0.0047,  0.0015],
        [-0.0047,  0.0018]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6835],
        [ 0.6150, -2.6249],
        [-0.7318,  1.4789],
        [-0.8572, -2.7460]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4958, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1759, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0020],
        [-0.0052,  0.0023],
        [-0.0051,  0.0023],
        [-0.0049,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6839],
        [ 0.6138, -2.6242],
        [-0.7322,  1.4797],
        [-0.8574, -2.7458]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4063, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1541, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0017],
        [-0.0044,  0.0017],
        [-0.0043,  0.0016],
        [-0.0039,  0.0014]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6836],
        [ 0.6147, -2.6247],
        [-0.7314,  1.4790],
        [-0.8564, -2.7464]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4177, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1552, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0022],
        [-0.0050,  0.0020],
        [-0.0043,  0.0016],
        [-0.0047,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6841],
        [ 0.6141, -2.6245],
        [-0.7314,  1.4790],
        [-0.8571, -2.7459]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4127, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0415, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1655, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0016],
        [-0.0044,  0.0016],
        [-0.0049,  0.0020],
        [-0.0043,  0.0017]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6835],
        [ 0.6147, -2.6248],
        [-0.7320,  1.4794],
        [-0.8568, -2.7461]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3842, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1547, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0016],
        [-0.0044,  0.0019],
        [-0.0039,  0.0015],
        [-0.0046,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6835],
        [ 0.6147, -2.6246],
        [-0.7310,  1.4789],
        [-0.8571, -2.7458]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4137, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1619, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0014],
        [-0.0045,  0.0017],
        [-0.0046,  0.0018],
        [-0.0047,  0.0017]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3071,  0.6834],
        [ 0.6146, -2.6248],
        [-0.7317,  1.4792],
        [-0.8571, -2.7461]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4120, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1539, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0021],
        [-0.0046,  0.0019],
        [-0.0046,  0.0020],
        [-0.0048,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6840],
        [ 0.6144, -2.6245],
        [-0.7317,  1.4794],
        [-0.8573, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3744, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1562, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0016],
        [-0.0043,  0.0018],
        [-0.0042,  0.0016],
        [-0.0043,  0.0016]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6836],
        [ 0.6148, -2.6247],
        [-0.7313,  1.4790],
        [-0.8567, -2.7462]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4616, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1682, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0021],
        [-0.0051,  0.0019],
        [-0.0047,  0.0018],
        [-0.0045,  0.0016]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6840],
        [ 0.6139, -2.6245],
        [-0.7318,  1.4792],
        [-0.8570, -2.7462]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3832, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1531, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0018],
        [-0.0047,  0.0019],
        [-0.0044,  0.0017],
        [-0.0050,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6838],
        [ 0.6144, -2.6245],
        [-0.7315,  1.4791],
        [-0.8575, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4155, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0316, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1464, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0020],
        [-0.0048,  0.0020],
        [-0.0048,  0.0021],
        [-0.0045,  0.0019]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6840],
        [ 0.6143, -2.6244],
        [-0.7319,  1.4795],
        [-0.8569, -2.7459]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3833, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1561, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0014],
        [-0.0040,  0.0016],
        [-0.0047,  0.0018],
        [-0.0045,  0.0016]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6833],
        [ 0.6151, -2.6248],
        [-0.7318,  1.4792],
        [-0.8569, -2.7461]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4064, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1528, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0019],
        [-0.0044,  0.0017],
        [-0.0044,  0.0017],
        [-0.0045,  0.0017]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6838],
        [ 0.6147, -2.6248],
        [-0.7316,  1.4791],
        [-0.8570, -2.7460]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3894, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1568, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0018],
        [-0.0048,  0.0018],
        [-0.0045,  0.0016],
        [-0.0050,  0.0019]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6837],
        [ 0.6142, -2.6246],
        [-0.7317,  1.4791],
        [-0.8574, -2.7459]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4283, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1636, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0023],
        [-0.0055,  0.0024],
        [-0.0053,  0.0024],
        [-0.0047,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6842],
        [ 0.6135, -2.6241],
        [-0.7325,  1.4798],
        [-0.8572, -2.7458]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4136, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1540, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0020],
        [-0.0048,  0.0019],
        [-0.0051,  0.0021],
        [-0.0052,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6839],
        [ 0.6142, -2.6245],
        [-0.7323,  1.4796],
        [-0.8577, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4048, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1548, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0018],
        [-0.0047,  0.0018],
        [-0.0048,  0.0018],
        [-0.0046,  0.0019]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3067,  0.6838],
        [ 0.6144, -2.6246],
        [-0.7319,  1.4793],
        [-0.8570, -2.7459]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3998, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0459, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1717, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0017],
        [-0.0048,  0.0020],
        [-0.0042,  0.0016],
        [-0.0045,  0.0019]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6836],
        [ 0.6143, -2.6244],
        [-0.7314,  1.4791],
        [-0.8569, -2.7459]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3836, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0339, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1445, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0017],
        [-0.0044,  0.0017],
        [-0.0039,  0.0016],
        [-0.0050,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6837],
        [ 0.6146, -2.6248],
        [-0.7311,  1.4790],
        [-0.8574, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3925, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1557, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0017],
        [-0.0045,  0.0019],
        [-0.0048,  0.0022],
        [-0.0046,  0.0019]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6837],
        [ 0.6146, -2.6245],
        [-0.7320,  1.4797],
        [-0.8570, -2.7458]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3922, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1595, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0020],
        [-0.0045,  0.0021],
        [-0.0043,  0.0020],
        [-0.0048,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6840],
        [ 0.6146, -2.6243],
        [-0.7315,  1.4795],
        [-0.8572, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3867, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1546, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0016],
        [-0.0045,  0.0019],
        [-0.0043,  0.0019],
        [-0.0037,  0.0016]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3075,  0.6836],
        [ 0.6146, -2.6245],
        [-0.7315,  1.4794],
        [-0.8561, -2.7461]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4596, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1702, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0016],
        [-0.0051,  0.0021],
        [-0.0044,  0.0018],
        [-0.0041,  0.0018]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6835],
        [ 0.6140, -2.6243],
        [-0.7316,  1.4793],
        [-0.8565, -2.7460]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3839, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1583, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0018],
        [-0.0044,  0.0020],
        [-0.0046,  0.0021],
        [-0.0050,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6837],
        [ 0.6146, -2.6244],
        [-0.7318,  1.4796],
        [-0.8574, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4710, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1690, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0021],
        [-0.0048,  0.0024],
        [-0.0047,  0.0023],
        [-0.0044,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6841],
        [ 0.6142, -2.6240],
        [-0.7319,  1.4798],
        [-0.8568, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3918, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1568, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0020],
        [-0.0048,  0.0022],
        [-0.0047,  0.0022],
        [-0.0047,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6840],
        [ 0.6142, -2.6242],
        [-0.7319,  1.4797],
        [-0.8571, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4034, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1629, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0020],
        [-0.0044,  0.0019],
        [-0.0047,  0.0020],
        [-0.0045,  0.0019]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6840],
        [ 0.6147, -2.6245],
        [-0.7319,  1.4796],
        [-0.8569, -2.7459]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4048, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0324, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1457, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0020],
        [-0.0049,  0.0021],
        [-0.0044,  0.0020],
        [-0.0044,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6840],
        [ 0.6142, -2.6243],
        [-0.7316,  1.4795],
        [-0.8568, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4114, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1651, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0020],
        [-0.0047,  0.0017],
        [-0.0047,  0.0019],
        [-0.0044,  0.0017]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6840],
        [ 0.6144, -2.6247],
        [-0.7319,  1.4794],
        [-0.8568, -2.7460]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4308, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1698, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0020],
        [-0.0043,  0.0018],
        [-0.0049,  0.0019],
        [-0.0043,  0.0018]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6840],
        [ 0.6147, -2.6246],
        [-0.7322,  1.4794],
        [-0.8566, -2.7459]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4020, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1520, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0016],
        [-0.0039,  0.0016],
        [-0.0040,  0.0015],
        [-0.0045,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6836],
        [ 0.6152, -2.6248],
        [-0.7313,  1.4790],
        [-0.8568, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4289, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1602, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0018],
        [-0.0035,  0.0014],
        [-0.0047,  0.0020],
        [-0.0038,  0.0015]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6838],
        [ 0.6156, -2.6249],
        [-0.7319,  1.4796],
        [-0.8561, -2.7462]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4076, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1544, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0017],
        [-0.0043,  0.0017],
        [-0.0044,  0.0019],
        [-0.0044,  0.0018]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3072,  0.6837],
        [ 0.6148, -2.6247],
        [-0.7317,  1.4795],
        [-0.8568, -2.7459]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3896, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0427, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1633, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0021],
        [-0.0045,  0.0020],
        [-0.0048,  0.0023],
        [-0.0044,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6841],
        [ 0.6146, -2.6244],
        [-0.7321,  1.4799],
        [-0.8568, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4074, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1626, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0021],
        [-0.0049,  0.0022],
        [-0.0049,  0.0023],
        [-0.0047,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6842],
        [ 0.6142, -2.6241],
        [-0.7322,  1.4799],
        [-0.8571, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4474, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1705, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0020],
        [-0.0046,  0.0020],
        [-0.0050,  0.0022],
        [-0.0041,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6841],
        [ 0.6145, -2.6244],
        [-0.7322,  1.4798],
        [-0.8564, -2.7458]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4082, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1579, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0017],
        [-0.0041,  0.0018],
        [-0.0042,  0.0017],
        [-0.0041,  0.0018]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6838],
        [ 0.6150, -2.6246],
        [-0.7314,  1.4793],
        [-0.8564, -2.7459]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4469, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0432, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1757, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0022],
        [-0.0044,  0.0020],
        [-0.0045,  0.0021],
        [-0.0043,  0.0019]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6843],
        [ 0.6147, -2.6243],
        [-0.7318,  1.4797],
        [-0.8566, -2.7458]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4111, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0332, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1486, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0021],
        [-0.0041,  0.0023],
        [-0.0040,  0.0019],
        [-0.0042,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6842],
        [ 0.6150, -2.6241],
        [-0.7313,  1.4795],
        [-0.8565, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3958, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0461, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1714, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0022],
        [-0.0049,  0.0021],
        [-0.0047,  0.0021],
        [-0.0045,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6842],
        [ 0.6142, -2.6242],
        [-0.7320,  1.4797],
        [-0.8569, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4046, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1505, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0027],
        [-0.0052,  0.0030],
        [-0.0048,  0.0026],
        [-0.0045,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6848],
        [ 0.6139, -2.6234],
        [-0.7321,  1.4802],
        [-0.8569, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4023, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1585, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0023],
        [-0.0052,  0.0025],
        [-0.0046,  0.0022],
        [-0.0045,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6844],
        [ 0.6138, -2.6238],
        [-0.7319,  1.4798],
        [-0.8568, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4067, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0344, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1502, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0020],
        [-0.0048,  0.0021],
        [-0.0046,  0.0022],
        [-0.0044,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6841],
        [ 0.6143, -2.6242],
        [-0.7319,  1.4798],
        [-0.8567, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3840, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0456, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1680, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0019],
        [-0.0038,  0.0016],
        [-0.0039,  0.0015],
        [-0.0046,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6840],
        [ 0.6153, -2.6248],
        [-0.7312,  1.4792],
        [-0.8569, -2.7458]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4207, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1580, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0024],
        [-0.0047,  0.0020],
        [-0.0048,  0.0020],
        [-0.0047,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6845],
        [ 0.6144, -2.6243],
        [-0.7322,  1.4796],
        [-0.8570, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4006, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1536, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0021],
        [-0.0044,  0.0019],
        [-0.0045,  0.0021],
        [-0.0046,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6842],
        [ 0.6147, -2.6245],
        [-0.7318,  1.4797],
        [-0.8570, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4073, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1594, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0026],
        [-0.0043,  0.0023],
        [-0.0044,  0.0023],
        [-0.0045,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6848],
        [ 0.6148, -2.6241],
        [-0.7317,  1.4799],
        [-0.8568, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4332, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1685, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0021],
        [-0.0039,  0.0019],
        [-0.0047,  0.0024],
        [-0.0044,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6842],
        [ 0.6152, -2.6245],
        [-0.7320,  1.4800],
        [-0.8567, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5105, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1732, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0024],
        [-0.0047,  0.0024],
        [-0.0049,  0.0024],
        [-0.0053,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6846],
        [ 0.6144, -2.6240],
        [-0.7322,  1.4800],
        [-0.8576, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3958, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1590, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0024],
        [-0.0050,  0.0025],
        [-0.0049,  0.0024],
        [-0.0046,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6845],
        [ 0.6141, -2.6238],
        [-0.7322,  1.4800],
        [-0.8569, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4000, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0317, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1434, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0020],
        [-0.0042,  0.0019],
        [-0.0042,  0.0020],
        [-0.0046,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6841],
        [ 0.6149, -2.6245],
        [-0.7315,  1.4796],
        [-0.8569, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
gt_cnt:  40
gt_cnt:  41
gt_cnt:  37
gt_cnt:  35
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  38
gt_cnt:  42
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  42
gt_cnt:  41
gt_cnt:  44
gt_cnt:  40
gt_cnt:  36
gt_cnt:  38
gt_cnt:  39
gt_cnt:  37
gt_cnt:  41
gt_cnt:  37
gt_cnt:  41
gt_cnt:  35
gt_cnt:  38
gt_cnt:  37
gt_cnt:  41
gt_cnt:  35
gt_cnt:  37
gt_cnt:  39
gt_cnt:  43
gt_cnt:  37
gt_cnt:  33
gt_cnt:  39
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  42
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  41
gt_cnt:  40
gt_cnt:  44
gt_cnt:  40
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  40
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  42
gt_cnt:  41
gt_cnt:  38
gt_cnt:  43
gt_cnt:  36
gt_cnt:  35
gt_cnt:  38
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  36
gt_cnt:  40
gt_cnt:  42
gt_cnt:  42
gt_cnt:  34
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  41
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  39
gt_cnt:  42
gt_cnt:  37
gt_cnt:  38
gt_cnt:  37
gt_cnt:  41
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  41
gt_cnt:  41
gt_cnt:  35
gt_cnt:  39
gt_cnt:  37
gt_cnt:  35
gt_cnt:  44
gt_cnt:  43
gt_cnt:  39
gt_cnt:  36
gt_cnt:  41
gt_cnt:  39
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  39
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  44
gt_cnt:  39
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  37
gt_cnt:  36
gt_cnt:  41
gt_cnt:  36
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  37
gt_cnt:  38
gt_cnt:  41
gt_cnt:  38
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  35
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  35
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  36
gt_cnt:  43
gt_cnt:  42
gt_cnt:  38
gt_cnt:  40
gt_cnt:  41
gt_cnt:  36
gt_cnt:  41
gt_cnt:  38
gt_cnt:  43
gt_cnt:  39
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  40
gt_cnt:  37
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  42
gt_cnt:  36
gt_cnt:  37
gt_cnt:  44
gt_cnt:  35
gt_cnt:  39
gt_cnt:  42
gt_cnt:  36
gt_cnt:  38
gt_cnt:  38
gt_cnt:  41
gt_cnt:  40
gt_cnt:  36
gt_cnt:  36
gt_cnt:  39
gt_cnt:  40
gt_cnt:  41
gt_cnt:  38
gt_cnt:  39
gt_cnt:  42
gt_cnt:  39
gt_cnt:  42
gt_cnt:  35
gt_cnt:  36
gt_cnt:  40
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  34
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  35
gt_cnt:  37
gt_cnt:  35
gt_cnt:  42
gt_cnt:  38
gt_cnt:  37
gt_cnt:  41
gt_cnt:  36
gt_cnt:  40
gt_cnt:  42
gt_cnt:  35
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  41
gt_cnt:  37
gt_cnt:  40
gt_cnt:  38
gt_cnt:  43
gt_cnt:  41
gt_cnt:  36
gt_cnt:  40
gt_cnt:  42
gt_cnt:  41
gt_cnt:  39
gt_cnt:  42
gt_cnt:  37
gt_cnt:  40
gt_cnt:  38
gt_cnt:  36
gt_cnt:  40
gt_cnt:  41
gt_cnt:  36
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  40
gt_cnt:  41
gt_cnt:  38
gt_cnt:  41
gt_cnt:  36
gt_cnt:  38
gt_cnt:  37
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  35
gt_cnt:  40
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  38
gt_cnt:  40
gt_cnt:  42
gt_cnt:  43
gt_cnt:  39
gt_cnt:  37
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  40
gt_cnt:  42
gt_cnt:  41
gt_cnt:  38
gt_cnt:  38
gt_cnt:  41
gt_cnt:  37
gt_cnt:  40
gt_cnt:  35
gt_cnt:  42
gt_cnt:  38
gt_cnt:  37
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  36
gt_cnt:  37
gt_cnt:  38
gt_cnt:  37
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  39
gt_cnt:  37
gt_cnt:  41
gt_cnt:  39
gt_cnt:  42
gt_cnt:  36
gt_cnt:  38
gt_cnt:  42
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  38
gt_cnt:  35
gt_cnt:  39
gt_cnt:  42
gt_cnt:  39
gt_cnt:  41
gt_cnt:  40
gt_cnt:  38
gt_cnt:  40
gt_cnt:  41
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  41
gt_cnt:  36
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
{'loss_ce': tensor(0.4582, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1652, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0019],
        [-0.0052,  0.0022],
        [-0.0046,  0.0021],
        [-0.0048,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6840],
        [ 0.6139, -2.6242],
        [-0.7319,  1.4797],
        [-0.8571, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4091, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0303, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1423, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 3, Batch:360, loss: 0.000395, Time: 130.3
Testing...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6848],
        [ 0.6136, -2.6237],
        [-0.7328,  1.4802],
        [-0.8578, -2.7451]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6637, device='cuda:0'), 'loss_center': tensor(0.0362, device='cuda:0')}
loss: tensor(0.2051, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658,
         0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658,
         0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658,
         0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658,
         0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658, 0.7658,
         0.7658, 0.7658, 0.7658, 0.7658, 0.7658]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6847],
        [ 0.6136, -2.6238],
        [-0.7328,  1.4802],
        [-0.8577, -2.7452]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6683, device='cuda:0'), 'loss_center': tensor(0.0380, device='cuda:0')}
loss: tensor(0.2097, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675,
         0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675,
         0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675,
         0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675,
         0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675, 0.7675,
         0.7675, 0.7675, 0.7675, 0.7675, 0.7675]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0028],
        [-0.0056,  0.0028],
        [-0.0056,  0.0028],
        [-0.0056,  0.0028]], device='cuda:0')
after ref add :  tensor([[ 2.3054,  0.6849],
        [ 0.6135, -2.6236],
        [-0.7330,  1.4804],
        [-0.8579, -2.7450]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6737, device='cuda:0'), 'loss_center': tensor(0.0374, device='cuda:0')}
loss: tensor(0.2096, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0027],
        [-0.0055,  0.0027],
        [-0.0055,  0.0027],
        [-0.0055,  0.0027]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6848],
        [ 0.6136, -2.6237],
        [-0.7328,  1.4803],
        [-0.8578, -2.7451]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6777, device='cuda:0'), 'loss_center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.2123, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703,
         0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703,
         0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703,
         0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703,
         0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703, 0.7703,
         0.7703, 0.7703, 0.7703, 0.7703, 0.7703]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0027],
        [-0.0055,  0.0027],
        [-0.0055,  0.0027],
        [-0.0055,  0.0027]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6848],
        [ 0.6136, -2.6236],
        [-0.7329,  1.4803],
        [-0.8578, -2.7450]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7065, device='cuda:0'), 'loss_center': tensor(0.0327, device='cuda:0')}
loss: tensor(0.2068, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784,
         0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784,
         0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784,
         0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784,
         0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784, 0.7784,
         0.7784, 0.7784, 0.7784, 0.7784, 0.7784]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0027],
        [-0.0055,  0.0027],
        [-0.0055,  0.0027],
        [-0.0055,  0.0027]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6848],
        [ 0.6136, -2.6237],
        [-0.7329,  1.4803],
        [-0.8578, -2.7451]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6674, device='cuda:0'), 'loss_center': tensor(0.0339, device='cuda:0')}
loss: tensor(0.2012, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667,
         0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667,
         0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667,
         0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667,
         0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667, 0.7667,
         0.7667, 0.7667, 0.7667, 0.7667, 0.7667]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6847],
        [ 0.6136, -2.6237],
        [-0.7328,  1.4802],
        [-0.8578, -2.7451]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6382, device='cuda:0'), 'loss_center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.2043, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570,
         0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570,
         0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570,
         0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570,
         0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570, 0.7570,
         0.7570, 0.7570, 0.7570, 0.7570, 0.7570]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6847],
        [ 0.6137, -2.6237],
        [-0.7328,  1.4802],
        [-0.8577, -2.7451]], device='cuda:0')
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6686, device='cuda:0'), 'loss_center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.2104, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666,
         0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666,
         0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666,
         0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666,
         0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666, 0.7666,
         0.7666, 0.7666, 0.7666, 0.7666, 0.7666]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6847],
        [ 0.6136, -2.6237],
        [-0.7328,  1.4802],
        [-0.8578, -2.7451]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6323, device='cuda:0'), 'loss_center': tensor(0.0414, device='cuda:0')}
loss: tensor(0.2093, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556,
         0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556,
         0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556,
         0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556,
         0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556, 0.7556,
         0.7556, 0.7556, 0.7556, 0.7556, 0.7556]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6847],
        [ 0.6136, -2.6238],
        [-0.7328,  1.4802],
        [-0.8578, -2.7452]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6413, device='cuda:0'), 'loss_center': tensor(0.0388, device='cuda:0')}
loss: tensor(0.2059, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586,
         0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586,
         0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586,
         0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586,
         0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586,
         0.7586, 0.7586, 0.7586, 0.7586, 0.7586]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0025],
        [-0.0054,  0.0025],
        [-0.0054,  0.0025],
        [-0.0054,  0.0025]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6846],
        [ 0.6137, -2.6239],
        [-0.7328,  1.4801],
        [-0.8577, -2.7453]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6384, device='cuda:0'), 'loss_center': tensor(0.0417, device='cuda:0')}
loss: tensor(0.2111, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577,
         0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577,
         0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577,
         0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577,
         0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577,
         0.7577, 0.7577, 0.7577, 0.7577, 0.7577]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0027],
        [-0.0055,  0.0027],
        [-0.0055,  0.0027],
        [-0.0055,  0.0027]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6848],
        [ 0.6136, -2.6237],
        [-0.7328,  1.4803],
        [-0.8578, -2.7451]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6394, device='cuda:0'), 'loss_center': tensor(0.0379, device='cuda:0')}
loss: tensor(0.2038, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577,
         0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577,
         0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577,
         0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577,
         0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577, 0.7577,
         0.7577, 0.7577, 0.7577, 0.7577, 0.7577]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6847],
        [ 0.6136, -2.6237],
        [-0.7328,  1.4802],
        [-0.8577, -2.7451]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6333, device='cuda:0'), 'loss_center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.2034, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563,
         0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563,
         0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563,
         0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563,
         0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563, 0.7563,
         0.7563, 0.7563, 0.7563, 0.7563, 0.7563]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0025],
        [-0.0055,  0.0025],
        [-0.0055,  0.0025],
        [-0.0055,  0.0025]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6846],
        [ 0.6136, -2.6238],
        [-0.7328,  1.4801],
        [-0.8578, -2.7452]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6189, device='cuda:0'), 'loss_center': tensor(0.0373, device='cuda:0')}
loss: tensor(0.1984, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514,
         0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514,
         0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514,
         0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514,
         0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514, 0.7514,
         0.7514, 0.7514, 0.7514, 0.7514, 0.7514]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0026],
        [-0.0056,  0.0026],
        [-0.0056,  0.0026],
        [-0.0056,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6847],
        [ 0.6135, -2.6237],
        [-0.7329,  1.4802],
        [-0.8579, -2.7451]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6078, device='cuda:0'), 'loss_center': tensor(0.0378, device='cuda:0')}
loss: tensor(0.1972, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475,
         0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475,
         0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475,
         0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475,
         0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475, 0.7475,
         0.7475, 0.7475, 0.7475, 0.7475, 0.7475]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0026],
        [-0.0056,  0.0026],
        [-0.0056,  0.0026],
        [-0.0056,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3054,  0.6847],
        [ 0.6135, -2.6238],
        [-0.7329,  1.4802],
        [-0.8579, -2.7452]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6224, device='cuda:0'), 'loss_center': tensor(0.0364, device='cuda:0')}
loss: tensor(0.1972, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529,
         0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529,
         0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529,
         0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529,
         0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529, 0.7529,
         0.7529, 0.7529, 0.7529, 0.7529, 0.7529]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6847],
        [ 0.6135, -2.6237],
        [-0.7329,  1.4802],
        [-0.8578, -2.7451]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6826, device='cuda:0'), 'loss_center': tensor(0.0345, device='cuda:0')}
loss: tensor(0.2055, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718,
         0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718,
         0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718,
         0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718,
         0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718, 0.7718,
         0.7718, 0.7718, 0.7718, 0.7718, 0.7718]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6847],
        [ 0.6137, -2.6237],
        [-0.7328,  1.4802],
        [-0.8577, -2.7451]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6718, device='cuda:0'), 'loss_center': tensor(0.0408, device='cuda:0')}
loss: tensor(0.2159, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685,
         0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685,
         0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685,
         0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685,
         0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685, 0.7685,
         0.7685, 0.7685, 0.7685, 0.7685, 0.7685]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0026],
        [-0.0056,  0.0026],
        [-0.0056,  0.0026],
        [-0.0056,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3054,  0.6848],
        [ 0.6134, -2.6237],
        [-0.7330,  1.4802],
        [-0.8579, -2.7451]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6612, device='cuda:0'), 'loss_center': tensor(0.0358, device='cuda:0')}
loss: tensor(0.2039, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650,
         0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650,
         0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650,
         0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650,
         0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650, 0.7650,
         0.7650, 0.7650, 0.7650, 0.7650, 0.7650]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6847],
        [ 0.6136, -2.6238],
        [-0.7328,  1.4801],
        [-0.8578, -2.7452]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6636, device='cuda:0'), 'loss_center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.2095, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662,
         0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662,
         0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662,
         0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662,
         0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662, 0.7662,
         0.7662, 0.7662, 0.7662, 0.7662, 0.7662]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6848],
        [ 0.6135, -2.6237],
        [-0.7329,  1.4802],
        [-0.8578, -2.7451]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6681, device='cuda:0'), 'loss_center': tensor(0.0334, device='cuda:0')}
loss: tensor(0.2004, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674,
         0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674,
         0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674,
         0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674,
         0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674, 0.7674,
         0.7674, 0.7674, 0.7674, 0.7674, 0.7674]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6847],
        [ 0.6136, -2.6237],
        [-0.7329,  1.4802],
        [-0.8578, -2.7451]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6828, device='cuda:0'), 'loss_center': tensor(0.0330, device='cuda:0')}
loss: tensor(0.2026, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714,
         0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714,
         0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714,
         0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714,
         0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714, 0.7714,
         0.7714, 0.7714, 0.7714, 0.7714, 0.7714]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0027],
        [-0.0056,  0.0027],
        [-0.0056,  0.0027],
        [-0.0056,  0.0027]], device='cuda:0')
after ref add :  tensor([[ 2.3054,  0.6848],
        [ 0.6135, -2.6237],
        [-0.7330,  1.4803],
        [-0.8579, -2.7451]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6492, device='cuda:0'), 'loss_center': tensor(0.0314, device='cuda:0')}
loss: tensor(0.1927, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606,
         0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606,
         0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606,
         0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606,
         0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606, 0.7606,
         0.7606, 0.7606, 0.7606, 0.7606, 0.7606]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6847],
        [ 0.6136, -2.6237],
        [-0.7329,  1.4802],
        [-0.8578, -2.7452]], device='cuda:0')
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6146, device='cuda:0'), 'loss_center': tensor(0.0368, device='cuda:0')}
loss: tensor(0.1965, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485,
         0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485,
         0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485,
         0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485,
         0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485, 0.7485,
         0.7485, 0.7485, 0.7485, 0.7485, 0.7485]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6847],
        [ 0.6136, -2.6237],
        [-0.7328,  1.4802],
        [-0.8577, -2.7451]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6156, device='cuda:0'), 'loss_center': tensor(0.0398, device='cuda:0')}
loss: tensor(0.2028, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492,
         0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492,
         0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492,
         0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492,
         0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492, 0.7492,
         0.7492, 0.7492, 0.7492, 0.7492, 0.7492]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6847],
        [ 0.6136, -2.6237],
        [-0.7328,  1.4802],
        [-0.8578, -2.7451]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6026, device='cuda:0'), 'loss_center': tensor(0.0352, device='cuda:0')}
loss: tensor(0.1909, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445,
         0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445,
         0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445,
         0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445,
         0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445, 0.7445,
         0.7445, 0.7445, 0.7445, 0.7445, 0.7445]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0027],
        [-0.0057,  0.0027],
        [-0.0057,  0.0027],
        [-0.0057,  0.0027]], device='cuda:0')
after ref add :  tensor([[ 2.3054,  0.6849],
        [ 0.6134, -2.6236],
        [-0.7330,  1.4803],
        [-0.8580, -2.7450]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6419, device='cuda:0'), 'loss_center': tensor(0.0396, device='cuda:0')}
loss: tensor(0.2076, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586,
         0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586,
         0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586,
         0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586,
         0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586, 0.7586,
         0.7586, 0.7586, 0.7586, 0.7586, 0.7586]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6847],
        [ 0.6137, -2.6238],
        [-0.7328,  1.4802],
        [-0.8577, -2.7452]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6383, device='cuda:0'), 'loss_center': tensor(0.0380, device='cuda:0')}
loss: tensor(0.2037, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574,
         0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574,
         0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574,
         0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574,
         0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574, 0.7574,
         0.7574, 0.7574, 0.7574, 0.7574, 0.7574]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0025],
        [-0.0054,  0.0025],
        [-0.0054,  0.0025],
        [-0.0054,  0.0025]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6846],
        [ 0.6137, -2.6238],
        [-0.7327,  1.4801],
        [-0.8577, -2.7452]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6254, device='cuda:0'), 'loss_center': tensor(0.0435, device='cuda:0')}
loss: tensor(0.2120, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530,
         0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530,
         0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530,
         0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530,
         0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530, 0.7530,
         0.7530, 0.7530, 0.7530, 0.7530, 0.7530]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0026],
        [-0.0056,  0.0026],
        [-0.0056,  0.0026],
        [-0.0056,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6847],
        [ 0.6135, -2.6238],
        [-0.7329,  1.4802],
        [-0.8578, -2.7452]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6172, device='cuda:0'), 'loss_center': tensor(0.0452, device='cuda:0')}
loss: tensor(0.2139, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498,
         0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498,
         0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498,
         0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498,
         0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498, 0.7498,
         0.7498, 0.7498, 0.7498, 0.7498, 0.7498]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0026],
        [-0.0056,  0.0026],
        [-0.0056,  0.0026],
        [-0.0056,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6847],
        [ 0.6135, -2.6238],
        [-0.7329,  1.4802],
        [-0.8579, -2.7452]], device='cuda:0')
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6280, device='cuda:0'), 'loss_center': tensor(0.0342, device='cuda:0')}
loss: tensor(0.1940, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528,
         0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528,
         0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528,
         0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528,
         0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528, 0.7528,
         0.7528, 0.7528, 0.7528, 0.7528, 0.7528]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6847],
        [ 0.6136, -2.6237],
        [-0.7329,  1.4802],
        [-0.8578, -2.7451]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6465, device='cuda:0'), 'loss_center': tensor(0.0371, device='cuda:0')}
loss: tensor(0.2034, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598,
         0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598,
         0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598,
         0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598,
         0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598, 0.7598,
         0.7598, 0.7598, 0.7598, 0.7598, 0.7598]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0027],
        [-0.0056,  0.0027],
        [-0.0056,  0.0027],
        [-0.0056,  0.0027]], device='cuda:0')
after ref add :  tensor([[ 2.3054,  0.6849],
        [ 0.6135, -2.6236],
        [-0.7330,  1.4803],
        [-0.8579, -2.7450]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6730, device='cuda:0'), 'loss_center': tensor(0.0394, device='cuda:0')}
loss: tensor(0.2135, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682,
         0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682,
         0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682,
         0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682,
         0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682, 0.7682,
         0.7682, 0.7682, 0.7682, 0.7682, 0.7682]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0027],
        [-0.0055,  0.0027],
        [-0.0055,  0.0027],
        [-0.0055,  0.0027]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6848],
        [ 0.6136, -2.6236],
        [-0.7329,  1.4803],
        [-0.8578, -2.7450]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6550, device='cuda:0'), 'loss_center': tensor(0.0392, device='cuda:0')}
loss: tensor(0.2094, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628,
         0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628,
         0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628,
         0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628,
         0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628, 0.7628,
         0.7628, 0.7628, 0.7628, 0.7628, 0.7628]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6847],
        [ 0.6137, -2.6237],
        [-0.7328,  1.4802],
        [-0.8577, -2.7451]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6338, device='cuda:0'), 'loss_center': tensor(0.0419, device='cuda:0')}
loss: tensor(0.2106, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555,
         0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555,
         0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555,
         0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555,
         0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555, 0.7555,
         0.7555, 0.7555, 0.7555, 0.7555, 0.7555]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026],
        [-0.0055,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6847],
        [ 0.6135, -2.6237],
        [-0.7329,  1.4802],
        [-0.8578, -2.7451]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6759, device='cuda:0'), 'loss_center': tensor(0.0447, device='cuda:0')}
loss: tensor(0.2245, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0027],
        [-0.0055,  0.0027],
        [-0.0055,  0.0027],
        [-0.0055,  0.0027]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6848],
        [ 0.6136, -2.6237],
        [-0.7328,  1.4803],
        [-0.8578, -2.7451]], device='cuda:0')
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6388, device='cuda:0'), 'loss_center': tensor(0.0361, device='cuda:0')}
loss: tensor(0.1999, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566,
         0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566,
         0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566,
         0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566,
         0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566, 0.7566,
         0.7566, 0.7566, 0.7566, 0.7566, 0.7566]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026],
        [-0.0054,  0.0026]], device='cuda:0')
after ref add :  tensor([[ 2.3056,  0.6847],
        [ 0.6137, -2.6237],
        [-0.7328,  1.4802],
        [-0.8577, -2.7451]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6629, device='cuda:0'), 'loss_center': tensor(0.0377, device='cuda:0')}
loss: tensor(0.2081, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651,
         0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651,
         0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651,
         0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651,
         0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651, 0.7651,
         0.7651, 0.7651, 0.7651, 0.7651, 0.7651]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0027],
        [-0.0056,  0.0027],
        [-0.0056,  0.0027],
        [-0.0056,  0.0027]], device='cuda:0')
after ref add :  tensor([[ 2.3055,  0.6848],
        [ 0.6135, -2.6237],
        [-0.7329,  1.4803],
        [-0.8579, -2.7451]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6805, device='cuda:0'), 'loss_center': tensor(0.0395, device='cuda:0')}
loss: tensor(0.2152, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711,
         0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711,
         0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711,
         0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711,
         0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711, 0.7711,
         0.7711, 0.7711, 0.7711, 0.7711, 0.7711]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0028],
        [-0.0057,  0.0028],
        [-0.0057,  0.0028],
        [-0.0057,  0.0028]], device='cuda:0')
after ref add :  tensor([[ 2.3054,  0.6849],
        [ 0.6134, -2.6236],
        [-0.7330,  1.4803],
        [-0.8580, -2.7450]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6382, device='cuda:0'), 'loss_center': tensor(0.0419, device='cuda:0')}
loss: tensor(0.2114, device='cuda:0', dtype=torch.float64)
top10 scores:  gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  36
gt_cnt:  37
gt_cnt:  36
gt_cnt:  34
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  37
gt_cnt:  36
gt_cnt:  39
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  35
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  40
gt_cnt:  39
gt_cnt:  36
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  36
gt_cnt:  37
gt_cnt:  34
gt_cnt:  36
gt_cnt:  39
tensor([[0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581,
         0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581,
         0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581,
         0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581,
         0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581, 0.7581,
         0.7581, 0.7581, 0.7581, 0.7581, 0.7581]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
moda: 0.0%, modp: 33.7%, prec: 6.5%, recall: 8.7%
Test, loss: 0.205835, Time: 15.156
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0023],
        [-0.0045,  0.0026],
        [-0.0045,  0.0025],
        [-0.0044,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3071,  0.6844],
        [ 0.6146, -2.6237],
        [-0.7318,  1.4801],
        [-0.8567, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4008, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1598, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0026],
        [-0.0053,  0.0025],
        [-0.0052,  0.0025],
        [-0.0043,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6847],
        [ 0.6137, -2.6238],
        [-0.7326,  1.4801],
        [-0.8565, -2.7458]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3948, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1529, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0022],
        [-0.0045,  0.0019],
        [-0.0050,  0.0024],
        [-0.0050,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6843],
        [ 0.6146, -2.6244],
        [-0.7324,  1.4800],
        [-0.8573, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3978, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1536, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0022],
        [-0.0044,  0.0022],
        [-0.0045,  0.0023],
        [-0.0046,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6843],
        [ 0.6147, -2.6242],
        [-0.7319,  1.4799],
        [-0.8569, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4031, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1593, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0022],
        [-0.0047,  0.0021],
        [-0.0047,  0.0022],
        [-0.0049,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6843],
        [ 0.6143, -2.6242],
        [-0.7321,  1.4798],
        [-0.8572, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4981, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1834, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0017],
        [-0.0043,  0.0021],
        [-0.0043,  0.0018],
        [-0.0044,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6839],
        [ 0.6148, -2.6242],
        [-0.7316,  1.4794],
        [-0.8567, -2.7458]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3888, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1580, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0022],
        [-0.0041,  0.0022],
        [-0.0039,  0.0020],
        [-0.0043,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6843],
        [ 0.6150, -2.6241],
        [-0.7312,  1.4796],
        [-0.8566, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4422, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1604, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0026],
        [-0.0050,  0.0025],
        [-0.0055,  0.0027],
        [-0.0052,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6847],
        [ 0.6141, -2.6239],
        [-0.7329,  1.4803],
        [-0.8574, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3949, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0344, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1479, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0025],
        [-0.0050,  0.0026],
        [-0.0053,  0.0026],
        [-0.0047,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6846],
        [ 0.6141, -2.6237],
        [-0.7327,  1.4802],
        [-0.8569, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3897, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1525, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0029],
        [-0.0052,  0.0027],
        [-0.0058,  0.0030],
        [-0.0055,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6850],
        [ 0.6139, -2.6237],
        [-0.7331,  1.4806],
        [-0.8578, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4138, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1550, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0026],
        [-0.0047,  0.0026],
        [-0.0045,  0.0026],
        [-0.0045,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6847],
        [ 0.6143, -2.6237],
        [-0.7318,  1.4802],
        [-0.8568, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4037, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1488, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0028],
        [-0.0055,  0.0030],
        [-0.0056,  0.0032],
        [-0.0051,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6849],
        [ 0.6136, -2.6233],
        [-0.7330,  1.4808],
        [-0.8574, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4114, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1624, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0023],
        [-0.0043,  0.0022],
        [-0.0049,  0.0027],
        [-0.0050,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6844],
        [ 0.6147, -2.6241],
        [-0.7322,  1.4803],
        [-0.8572, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4202, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0415, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1670, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0027],
        [-0.0052,  0.0027],
        [-0.0046,  0.0027],
        [-0.0048,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6849],
        [ 0.6139, -2.6236],
        [-0.7319,  1.4803],
        [-0.8570, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4146, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1601, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0040,  0.0019],
        [-0.0037,  0.0020],
        [-0.0039,  0.0021],
        [-0.0037,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6840],
        [ 0.6153, -2.6243],
        [-0.7312,  1.4797],
        [-0.8560, -2.7458]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5319, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1800, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0021],
        [-0.0045,  0.0022],
        [-0.0037,  0.0020],
        [-0.0045,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3067,  0.6843],
        [ 0.6145, -2.6241],
        [-0.7310,  1.4796],
        [-0.8568, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3908, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1570, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0022],
        [-0.0049,  0.0022],
        [-0.0041,  0.0021],
        [-0.0050,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6844],
        [ 0.6141, -2.6241],
        [-0.7315,  1.4797],
        [-0.8573, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4038, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1519, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0040,  0.0020],
        [-0.0041,  0.0019],
        [-0.0043,  0.0021],
        [-0.0046,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6842],
        [ 0.6149, -2.6244],
        [-0.7316,  1.4797],
        [-0.8568, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4314, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1594, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0025],
        [-0.0045,  0.0023],
        [-0.0048,  0.0026],
        [-0.0048,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6847],
        [ 0.6145, -2.6240],
        [-0.7322,  1.4802],
        [-0.8570, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4432, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1635, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0028],
        [-0.0045,  0.0023],
        [-0.0044,  0.0022],
        [-0.0048,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6850],
        [ 0.6146, -2.6240],
        [-0.7317,  1.4798],
        [-0.8570, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4103, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1514, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0027],
        [-0.0047,  0.0026],
        [-0.0045,  0.0025],
        [-0.0042,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6849],
        [ 0.6143, -2.6237],
        [-0.7319,  1.4801],
        [-0.8565, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3954, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1539, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0022],
        [-0.0047,  0.0021],
        [-0.0053,  0.0024],
        [-0.0050,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6844],
        [ 0.6143, -2.6242],
        [-0.7327,  1.4800],
        [-0.8573, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4378, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1621, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0020],
        [-0.0047,  0.0023],
        [-0.0048,  0.0023],
        [-0.0046,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3067,  0.6841],
        [ 0.6143, -2.6240],
        [-0.7321,  1.4799],
        [-0.8569, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4505, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1639, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0026],
        [-0.0049,  0.0029],
        [-0.0046,  0.0026],
        [-0.0049,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6847],
        [ 0.6141, -2.6234],
        [-0.7320,  1.4802],
        [-0.8571, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4357, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1668, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0024],
        [-0.0043,  0.0022],
        [-0.0047,  0.0022],
        [-0.0044,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6845],
        [ 0.6147, -2.6241],
        [-0.7320,  1.4798],
        [-0.8566, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4311, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1590, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0026],
        [-0.0047,  0.0027],
        [-0.0050,  0.0027],
        [-0.0046,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6848],
        [ 0.6143, -2.6237],
        [-0.7323,  1.4803],
        [-0.8569, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4080, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1614, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0018],
        [-0.0046,  0.0022],
        [-0.0042,  0.0021],
        [-0.0042,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6840],
        [ 0.6144, -2.6242],
        [-0.7316,  1.4797],
        [-0.8565, -2.7458]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4160, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0310, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1451, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0028],
        [-0.0049,  0.0027],
        [-0.0043,  0.0024],
        [-0.0047,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6849],
        [ 0.6141, -2.6237],
        [-0.7317,  1.4800],
        [-0.8569, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4372, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1636, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0025],
        [-0.0048,  0.0027],
        [-0.0047,  0.0024],
        [-0.0048,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6846],
        [ 0.6142, -2.6237],
        [-0.7321,  1.4800],
        [-0.8571, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4165, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1711, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0030],
        [-0.0054,  0.0031],
        [-0.0047,  0.0026],
        [-0.0048,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6852],
        [ 0.6135, -2.6233],
        [-0.7320,  1.4802],
        [-0.8571, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4325, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1665, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0029],
        [-0.0053,  0.0031],
        [-0.0055,  0.0033],
        [-0.0054,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6850],
        [ 0.6137, -2.6232],
        [-0.7328,  1.4809],
        [-0.8577, -2.7443]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4433, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1654, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0034],
        [-0.0055,  0.0031],
        [-0.0054,  0.0032],
        [-0.0054,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3053,  0.6855],
        [ 0.6135, -2.6233],
        [-0.7327,  1.4809],
        [-0.8577, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4191, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0319, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1476, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0031],
        [-0.0049,  0.0030],
        [-0.0051,  0.0030],
        [-0.0052,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6852],
        [ 0.6140, -2.6234],
        [-0.7325,  1.4806],
        [-0.8575, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4005, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1589, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0031],
        [-0.0045,  0.0027],
        [-0.0043,  0.0026],
        [-0.0047,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6852],
        [ 0.6144, -2.6237],
        [-0.7317,  1.4803],
        [-0.8569, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4238, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1568, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0030],
        [-0.0056,  0.0035],
        [-0.0059,  0.0035],
        [-0.0048,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6851],
        [ 0.6134, -2.6229],
        [-0.7333,  1.4811],
        [-0.8571, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3815, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1455, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0027],
        [-0.0046,  0.0027],
        [-0.0043,  0.0026],
        [-0.0051,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6848],
        [ 0.6143, -2.6236],
        [-0.7317,  1.4803],
        [-0.8574, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4316, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1671, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0028],
        [-0.0047,  0.0029],
        [-0.0049,  0.0033],
        [-0.0049,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6848],
        [ 0.6143, -2.6235],
        [-0.7323,  1.4809],
        [-0.8572, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4169, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1621, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0026],
        [-0.0040,  0.0022],
        [-0.0041,  0.0023],
        [-0.0043,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6847],
        [ 0.6149, -2.6242],
        [-0.7315,  1.4800],
        [-0.8566, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4646, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1694, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0032],
        [-0.0052,  0.0032],
        [-0.0050,  0.0032],
        [-0.0052,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6853],
        [ 0.6138, -2.6231],
        [-0.7323,  1.4808],
        [-0.8575, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4044, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1595, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0027],
        [-0.0047,  0.0029],
        [-0.0045,  0.0025],
        [-0.0044,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6848],
        [ 0.6142, -2.6235],
        [-0.7319,  1.4802],
        [-0.8567, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3789, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1518, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0028],
        [-0.0046,  0.0026],
        [-0.0050,  0.0030],
        [-0.0051,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6849],
        [ 0.6144, -2.6237],
        [-0.7324,  1.4807],
        [-0.8574, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4044, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1583, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0034],
        [-0.0052,  0.0034],
        [-0.0051,  0.0033],
        [-0.0051,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6854],
        [ 0.6138, -2.6230],
        [-0.7325,  1.4810],
        [-0.8574, -2.7443]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4111, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1514, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0026],
        [-0.0044,  0.0025],
        [-0.0048,  0.0029],
        [-0.0045,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6847],
        [ 0.6146, -2.6238],
        [-0.7322,  1.4806],
        [-0.8568, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3983, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1535, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0027],
        [-0.0052,  0.0033],
        [-0.0048,  0.0030],
        [-0.0050,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6848],
        [ 0.6137, -2.6231],
        [-0.7322,  1.4807],
        [-0.8573, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4025, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1642, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0028],
        [-0.0046,  0.0028],
        [-0.0052,  0.0031],
        [-0.0049,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6848],
        [ 0.6144, -2.6236],
        [-0.7326,  1.4807],
        [-0.8572, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4254, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1629, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0032],
        [-0.0047,  0.0030],
        [-0.0050,  0.0034],
        [-0.0049,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6852],
        [ 0.6142, -2.6234],
        [-0.7324,  1.4811],
        [-0.8573, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4304, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1630, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0036],
        [-0.0051,  0.0030],
        [-0.0053,  0.0030],
        [-0.0056,  0.0036]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3051,  0.6856],
        [ 0.6139, -2.6233],
        [-0.7327,  1.4807],
        [-0.8580, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3996, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1626, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0031],
        [-0.0044,  0.0028],
        [-0.0048,  0.0027],
        [-0.0044,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6851],
        [ 0.6145, -2.6236],
        [-0.7322,  1.4804],
        [-0.8567, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3953, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0415, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1621, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0028],
        [-0.0044,  0.0026],
        [-0.0048,  0.0029],
        [-0.0043,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6848],
        [ 0.6145, -2.6238],
        [-0.7323,  1.4806],
        [-0.8567, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4068, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0421, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1656, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0032],
        [-0.0046,  0.0028],
        [-0.0048,  0.0031],
        [-0.0049,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6852],
        [ 0.6144, -2.6236],
        [-0.7322,  1.4808],
        [-0.8573, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5404, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1808, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0025],
        [-0.0042,  0.0026],
        [-0.0041,  0.0023],
        [-0.0046,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6845],
        [ 0.6147, -2.6238],
        [-0.7315,  1.4800],
        [-0.8570, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4075, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1654, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0039],
        [-0.0053,  0.0034],
        [-0.0058,  0.0039],
        [-0.0053,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3052,  0.6859],
        [ 0.6136, -2.6229],
        [-0.7332,  1.4816],
        [-0.8577, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3722, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1494, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0033],
        [-0.0050,  0.0032],
        [-0.0048,  0.0030],
        [-0.0058,  0.0036]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6852],
        [ 0.6139, -2.6232],
        [-0.7322,  1.4807],
        [-0.8582, -2.7440]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4040, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1503, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0026],
        [-0.0047,  0.0026],
        [-0.0048,  0.0027],
        [-0.0048,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6845],
        [ 0.6143, -2.6238],
        [-0.7323,  1.4804],
        [-0.8572, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4076, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0305, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1426, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0030],
        [-0.0049,  0.0031],
        [-0.0049,  0.0032],
        [-0.0053,  0.0035]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6849],
        [ 0.6140, -2.6232],
        [-0.7324,  1.4810],
        [-0.8577, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4259, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1644, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0034],
        [-0.0049,  0.0032],
        [-0.0049,  0.0031],
        [-0.0052,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6853],
        [ 0.6141, -2.6232],
        [-0.7323,  1.4808],
        [-0.8576, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4156, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1664, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0028],
        [-0.0049,  0.0029],
        [-0.0053,  0.0029],
        [-0.0049,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6847],
        [ 0.6141, -2.6235],
        [-0.7327,  1.4807],
        [-0.8573, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4450, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1618, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0026],
        [-0.0045,  0.0026],
        [-0.0044,  0.0026],
        [-0.0044,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3067,  0.6845],
        [ 0.6145, -2.6238],
        [-0.7318,  1.4804],
        [-0.8567, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4067, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1613, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0024],
        [-0.0045,  0.0031],
        [-0.0038,  0.0025],
        [-0.0046,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6843],
        [ 0.6144, -2.6233],
        [-0.7313,  1.4803],
        [-0.8570, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4152, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1563, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0032],
        [-0.0044,  0.0028],
        [-0.0045,  0.0029],
        [-0.0050,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6850],
        [ 0.6146, -2.6235],
        [-0.7320,  1.4807],
        [-0.8574, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3955, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1497, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0032],
        [-0.0049,  0.0032],
        [-0.0051,  0.0029],
        [-0.0048,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6851],
        [ 0.6141, -2.6232],
        [-0.7325,  1.4807],
        [-0.8572, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3970, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1581, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0032],
        [-0.0051,  0.0030],
        [-0.0049,  0.0029],
        [-0.0052,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6851],
        [ 0.6139, -2.6233],
        [-0.7323,  1.4807],
        [-0.8576, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3804, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0425, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1611, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0026],
        [-0.0046,  0.0026],
        [-0.0053,  0.0028],
        [-0.0051,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6845],
        [ 0.6144, -2.6238],
        [-0.7327,  1.4806],
        [-0.8575, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3843, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0470, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1708, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0029],
        [-0.0052,  0.0031],
        [-0.0051,  0.0032],
        [-0.0046,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6848],
        [ 0.6138, -2.6232],
        [-0.7325,  1.4810],
        [-0.8570, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4012, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1562, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0026],
        [-0.0046,  0.0026],
        [-0.0045,  0.0027],
        [-0.0045,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6845],
        [ 0.6144, -2.6237],
        [-0.7319,  1.4805],
        [-0.8569, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4172, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1568, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0029],
        [-0.0052,  0.0032],
        [-0.0054,  0.0034],
        [-0.0054,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6848],
        [ 0.6138, -2.6232],
        [-0.7328,  1.4812],
        [-0.8578, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4201, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0473, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1786, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0032],
        [-0.0050,  0.0029],
        [-0.0049,  0.0031],
        [-0.0053,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6850],
        [ 0.6139, -2.6234],
        [-0.7323,  1.4809],
        [-0.8577, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4488, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0321, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1540, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0029],
        [-0.0046,  0.0022],
        [-0.0044,  0.0025],
        [-0.0048,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6847],
        [ 0.6144, -2.6242],
        [-0.7318,  1.4803],
        [-0.8572, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4276, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1549, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0024],
        [-0.0046,  0.0023],
        [-0.0046,  0.0024],
        [-0.0046,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6842],
        [ 0.6143, -2.6240],
        [-0.7320,  1.4803],
        [-0.8570, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4252, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1676, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0026],
        [-0.0044,  0.0023],
        [-0.0050,  0.0026],
        [-0.0053,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6844],
        [ 0.6146, -2.6241],
        [-0.7324,  1.4804],
        [-0.8577, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3943, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1519, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0027],
        [-0.0044,  0.0024],
        [-0.0045,  0.0025],
        [-0.0046,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6844],
        [ 0.6145, -2.6240],
        [-0.7319,  1.4803],
        [-0.8571, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3946, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1545, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0023],
        [-0.0035,  0.0017],
        [-0.0043,  0.0023],
        [-0.0039,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6840],
        [ 0.6154, -2.6247],
        [-0.7317,  1.4802],
        [-0.8563, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4195, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1547, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0061,  0.0034],
        [-0.0060,  0.0032],
        [-0.0051,  0.0028],
        [-0.0059,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3048,  0.6851],
        [ 0.6130, -2.6231],
        [-0.7324,  1.4806],
        [-0.8583, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3793, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1619, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0026],
        [-0.0054,  0.0030],
        [-0.0051,  0.0029],
        [-0.0049,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6843],
        [ 0.6135, -2.6234],
        [-0.7325,  1.4807],
        [-0.8574, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4011, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1571, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0025],
        [-0.0050,  0.0027],
        [-0.0046,  0.0024],
        [-0.0054,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6842],
        [ 0.6140, -2.6236],
        [-0.7319,  1.4802],
        [-0.8578, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4922, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1734, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0024],
        [-0.0050,  0.0028],
        [-0.0047,  0.0026],
        [-0.0048,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6841],
        [ 0.6140, -2.6236],
        [-0.7321,  1.4804],
        [-0.8572, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3760, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1492, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0029],
        [-0.0050,  0.0026],
        [-0.0058,  0.0031],
        [-0.0052,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6846],
        [ 0.6139, -2.6237],
        [-0.7332,  1.4809],
        [-0.8576, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4135, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1512, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0033],
        [-0.0056,  0.0031],
        [-0.0050,  0.0028],
        [-0.0054,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3052,  0.6849],
        [ 0.6134, -2.6233],
        [-0.7324,  1.4807],
        [-0.8579, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3862, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1500, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0030],
        [-0.0054,  0.0030],
        [-0.0058,  0.0033],
        [-0.0054,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6847],
        [ 0.6136, -2.6234],
        [-0.7331,  1.4812],
        [-0.8578, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4060, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1628, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0029],
        [-0.0053,  0.0029],
        [-0.0055,  0.0030],
        [-0.0053,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6845],
        [ 0.6136, -2.6235],
        [-0.7329,  1.4808],
        [-0.8578, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4612, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1717, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0025],
        [-0.0045,  0.0021],
        [-0.0050,  0.0026],
        [-0.0054,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6841],
        [ 0.6144, -2.6243],
        [-0.7324,  1.4804],
        [-0.8578, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4190, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1566, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0020],
        [-0.0042,  0.0022],
        [-0.0043,  0.0022],
        [-0.0044,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3071,  0.6836],
        [ 0.6147, -2.6242],
        [-0.7316,  1.4800],
        [-0.8569, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4993, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1738, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0025],
        [-0.0046,  0.0024],
        [-0.0048,  0.0025],
        [-0.0050,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6841],
        [ 0.6144, -2.6240],
        [-0.7321,  1.4803],
        [-0.8574, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3913, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0317, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1416, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0026],
        [-0.0055,  0.0028],
        [-0.0047,  0.0023],
        [-0.0047,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6842],
        [ 0.6135, -2.6236],
        [-0.7321,  1.4802],
        [-0.8572, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4002, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0426, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1653, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0061,  0.0030],
        [-0.0059,  0.0030],
        [-0.0058,  0.0028],
        [-0.0057,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3049,  0.6846],
        [ 0.6131, -2.6234],
        [-0.7332,  1.4806],
        [-0.8581, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4838, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0285, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1538, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0025],
        [-0.0043,  0.0022],
        [-0.0048,  0.0026],
        [-0.0045,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6841],
        [ 0.6146, -2.6242],
        [-0.7322,  1.4804],
        [-0.8569, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  33
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4570, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1618, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0030],
        [-0.0053,  0.0028],
        [-0.0057,  0.0027],
        [-0.0054,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3052,  0.6846],
        [ 0.6136, -2.6237],
        [-0.7330,  1.4805],
        [-0.8579, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4740, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0339, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1627, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0023],
        [-0.0049,  0.0024],
        [-0.0048,  0.0024],
        [-0.0049,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6839],
        [ 0.6140, -2.6240],
        [-0.7322,  1.4802],
        [-0.8573, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3998, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1523, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0026],
        [-0.0048,  0.0027],
        [-0.0047,  0.0026],
        [-0.0052,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6841],
        [ 0.6140, -2.6238],
        [-0.7321,  1.4804],
        [-0.8576, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3996, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1617, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0020],
        [-0.0046,  0.0023],
        [-0.0045,  0.0020],
        [-0.0053,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6835],
        [ 0.6142, -2.6242],
        [-0.7319,  1.4798],
        [-0.8577, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4062, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1517, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0031],
        [-0.0063,  0.0034],
        [-0.0060,  0.0034],
        [-0.0062,  0.0035]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3053,  0.6847],
        [ 0.6125, -2.6230],
        [-0.7334,  1.4812],
        [-0.8587, -2.7442]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4180, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1575, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0024],
        [-0.0052,  0.0028],
        [-0.0049,  0.0025],
        [-0.0049,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6839],
        [ 0.6136, -2.6237],
        [-0.7322,  1.4804],
        [-0.8573, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3993, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1611, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0023],
        [-0.0047,  0.0025],
        [-0.0049,  0.0023],
        [-0.0050,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6838],
        [ 0.6141, -2.6240],
        [-0.7323,  1.4802],
        [-0.8575, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5233, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1826, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0027],
        [-0.0051,  0.0025],
        [-0.0049,  0.0024],
        [-0.0053,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6842],
        [ 0.6138, -2.6240],
        [-0.7323,  1.4803],
        [-0.8577, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3912, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1497, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0024],
        [-0.0052,  0.0025],
        [-0.0052,  0.0024],
        [-0.0054,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6839],
        [ 0.6136, -2.6239],
        [-0.7326,  1.4803],
        [-0.8578, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4139, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0343, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1514, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0020],
        [-0.0046,  0.0024],
        [-0.0049,  0.0026],
        [-0.0053,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6835],
        [ 0.6142, -2.6241],
        [-0.7323,  1.4805],
        [-0.8577, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4178, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1671, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0025],
        [-0.0052,  0.0024],
        [-0.0047,  0.0026],
        [-0.0044,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6840],
        [ 0.6137, -2.6240],
        [-0.7322,  1.4804],
        [-0.8568, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4252, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0455, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1761, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0027],
        [-0.0047,  0.0027],
        [-0.0042,  0.0021],
        [-0.0056,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6841],
        [ 0.6141, -2.6238],
        [-0.7316,  1.4799],
        [-0.8580, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4035, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1531, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0026],
        [-0.0046,  0.0023],
        [-0.0047,  0.0024],
        [-0.0052,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6840],
        [ 0.6142, -2.6242],
        [-0.7321,  1.4803],
        [-0.8577, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4108, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1518, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0022],
        [-0.0046,  0.0022],
        [-0.0045,  0.0023],
        [-0.0042,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3067,  0.6836],
        [ 0.6143, -2.6243],
        [-0.7320,  1.4802],
        [-0.8566, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4091, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1678, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 4, Batch:100, loss: 0.001678, Time: 37.1
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0032],
        [-0.0054,  0.0030],
        [-0.0054,  0.0030],
        [-0.0054,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3050,  0.6846],
        [ 0.6134, -2.6235],
        [-0.7328,  1.4809],
        [-0.8579, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4160, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1613, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0026],
        [-0.0051,  0.0029],
        [-0.0050,  0.0026],
        [-0.0052,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6840],
        [ 0.6138, -2.6236],
        [-0.7324,  1.4806],
        [-0.8576, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4787, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1754, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0024],
        [-0.0049,  0.0024],
        [-0.0052,  0.0027],
        [-0.0048,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6838],
        [ 0.6140, -2.6241],
        [-0.7327,  1.4806],
        [-0.8572, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4166, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0320, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1474, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0029],
        [-0.0055,  0.0031],
        [-0.0053,  0.0028],
        [-0.0052,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6842],
        [ 0.6134, -2.6234],
        [-0.7328,  1.4807],
        [-0.8577, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3982, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1543, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0027],
        [-0.0059,  0.0034],
        [-0.0060,  0.0032],
        [-0.0054,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6840],
        [ 0.6130, -2.6231],
        [-0.7334,  1.4812],
        [-0.8578, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3801, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0431, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1623, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0025],
        [-0.0047,  0.0024],
        [-0.0048,  0.0024],
        [-0.0047,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6838],
        [ 0.6142, -2.6241],
        [-0.7323,  1.4804],
        [-0.8571, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4907, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1687, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0028],
        [-0.0059,  0.0031],
        [-0.0061,  0.0031],
        [-0.0057,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6841],
        [ 0.6129, -2.6234],
        [-0.7336,  1.4811],
        [-0.8582, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4113, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1539, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0030],
        [-0.0053,  0.0028],
        [-0.0054,  0.0030],
        [-0.0051,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6843],
        [ 0.6135, -2.6237],
        [-0.7329,  1.4810],
        [-0.8575, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4158, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1621, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0028],
        [-0.0056,  0.0032],
        [-0.0055,  0.0029],
        [-0.0054,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6841],
        [ 0.6133, -2.6234],
        [-0.7330,  1.4809],
        [-0.8578, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4197, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0322, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1483, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0027],
        [-0.0053,  0.0027],
        [-0.0050,  0.0028],
        [-0.0050,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6840],
        [ 0.6136, -2.6238],
        [-0.7325,  1.4807],
        [-0.8575, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3969, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1554, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0026],
        [-0.0048,  0.0027],
        [-0.0047,  0.0024],
        [-0.0047,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6839],
        [ 0.6141, -2.6238],
        [-0.7322,  1.4804],
        [-0.8571, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4288, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0455, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1767, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0024],
        [-0.0050,  0.0025],
        [-0.0052,  0.0028],
        [-0.0048,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6836],
        [ 0.6139, -2.6241],
        [-0.7327,  1.4808],
        [-0.8573, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4093, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1602, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0027],
        [-0.0047,  0.0025],
        [-0.0055,  0.0030],
        [-0.0051,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6840],
        [ 0.6141, -2.6241],
        [-0.7331,  1.4810],
        [-0.8575, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4058, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1546, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0022],
        [-0.0054,  0.0027],
        [-0.0051,  0.0026],
        [-0.0052,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6834],
        [ 0.6135, -2.6238],
        [-0.7327,  1.4806],
        [-0.8577, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3955, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1521, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0025],
        [-0.0053,  0.0027],
        [-0.0046,  0.0023],
        [-0.0049,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6837],
        [ 0.6135, -2.6238],
        [-0.7321,  1.4804],
        [-0.8573, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4759, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1693, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0023],
        [-0.0051,  0.0026],
        [-0.0054,  0.0025],
        [-0.0050,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6835],
        [ 0.6137, -2.6240],
        [-0.7329,  1.4805],
        [-0.8574, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4180, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1646, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0022],
        [-0.0046,  0.0022],
        [-0.0046,  0.0022],
        [-0.0045,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3067,  0.6834],
        [ 0.6143, -2.6243],
        [-0.7321,  1.4803],
        [-0.8570, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4126, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0462, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1748, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0027],
        [-0.0050,  0.0026],
        [-0.0048,  0.0026],
        [-0.0047,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6839],
        [ 0.6139, -2.6239],
        [-0.7323,  1.4806],
        [-0.8572, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4078, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1585, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0021],
        [-0.0047,  0.0023],
        [-0.0043,  0.0021],
        [-0.0044,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6833],
        [ 0.6141, -2.6243],
        [-0.7318,  1.4802],
        [-0.8569, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4410, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1565, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0040,  0.0019],
        [-0.0044,  0.0023],
        [-0.0043,  0.0022],
        [-0.0042,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6831],
        [ 0.6145, -2.6243],
        [-0.7319,  1.4803],
        [-0.8566, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4025, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1582, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0027],
        [-0.0048,  0.0025],
        [-0.0044,  0.0024],
        [-0.0059,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6839],
        [ 0.6141, -2.6240],
        [-0.7319,  1.4805],
        [-0.8583, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4583, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1616, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0020],
        [-0.0049,  0.0024],
        [-0.0047,  0.0025],
        [-0.0048,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3067,  0.6832],
        [ 0.6140, -2.6242],
        [-0.7322,  1.4806],
        [-0.8572, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4379, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0309, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1494, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0040,  0.0019],
        [-0.0041,  0.0019],
        [-0.0043,  0.0020],
        [-0.0041,  0.0017]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6830],
        [ 0.6148, -2.6247],
        [-0.7318,  1.4801],
        [-0.8566, -2.7459]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3747, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1423, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0025],
        [-0.0049,  0.0022],
        [-0.0055,  0.0027],
        [-0.0054,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6837],
        [ 0.6139, -2.6244],
        [-0.7330,  1.4808],
        [-0.8578, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4061, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1513, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0021],
        [-0.0059,  0.0029],
        [-0.0057,  0.0028],
        [-0.0049,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6832],
        [ 0.6130, -2.6237],
        [-0.7332,  1.4808],
        [-0.8574, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4005, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1559, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0024],
        [-0.0054,  0.0026],
        [-0.0048,  0.0023],
        [-0.0045,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6836],
        [ 0.6135, -2.6239],
        [-0.7323,  1.4804],
        [-0.8569, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4104, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1608, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0023],
        [-0.0047,  0.0022],
        [-0.0049,  0.0023],
        [-0.0043,  0.0019]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6834],
        [ 0.6141, -2.6244],
        [-0.7324,  1.4804],
        [-0.8568, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4088, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1530, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0022],
        [-0.0049,  0.0022],
        [-0.0045,  0.0022],
        [-0.0046,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6833],
        [ 0.6140, -2.6244],
        [-0.7320,  1.4803],
        [-0.8571, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3994, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1545, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0027],
        [-0.0056,  0.0027],
        [-0.0052,  0.0025],
        [-0.0052,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6838],
        [ 0.6133, -2.6239],
        [-0.7327,  1.4806],
        [-0.8576, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4050, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1512, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0022],
        [-0.0048,  0.0023],
        [-0.0049,  0.0023],
        [-0.0047,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6833],
        [ 0.6141, -2.6243],
        [-0.7325,  1.4804],
        [-0.8572, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4009, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1534, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0021],
        [-0.0055,  0.0027],
        [-0.0049,  0.0025],
        [-0.0055,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6833],
        [ 0.6133, -2.6239],
        [-0.7324,  1.4806],
        [-0.8580, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4045, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1621, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0025],
        [-0.0050,  0.0026],
        [-0.0048,  0.0025],
        [-0.0057,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6836],
        [ 0.6138, -2.6240],
        [-0.7323,  1.4806],
        [-0.8582, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4247, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1634, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0020],
        [-0.0043,  0.0020],
        [-0.0046,  0.0022],
        [-0.0046,  0.0020]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6831],
        [ 0.6145, -2.6246],
        [-0.7322,  1.4803],
        [-0.8571, -2.7456]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4154, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0440, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1711, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0024],
        [-0.0043,  0.0021],
        [-0.0040,  0.0021],
        [-0.0043,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6834],
        [ 0.6145, -2.6245],
        [-0.7316,  1.4802],
        [-0.8568, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4254, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0428, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1707, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0022],
        [-0.0049,  0.0026],
        [-0.0052,  0.0025],
        [-0.0049,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6833],
        [ 0.6139, -2.6240],
        [-0.7328,  1.4806],
        [-0.8574, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4074, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1525, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0028],
        [-0.0061,  0.0032],
        [-0.0060,  0.0030],
        [-0.0057,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6839],
        [ 0.6127, -2.6234],
        [-0.7335,  1.4811],
        [-0.8582, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4439, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1599, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0019],
        [-0.0047,  0.0022],
        [-0.0041,  0.0019],
        [-0.0044,  0.0019]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6830],
        [ 0.6141, -2.6245],
        [-0.7316,  1.4800],
        [-0.8569, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4049, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1574, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0024],
        [-0.0053,  0.0024],
        [-0.0053,  0.0025],
        [-0.0058,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6835],
        [ 0.6135, -2.6242],
        [-0.7328,  1.4806],
        [-0.8583, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4241, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1599, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0040,  0.0020],
        [-0.0049,  0.0024],
        [-0.0044,  0.0021],
        [-0.0044,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6831],
        [ 0.6139, -2.6242],
        [-0.7319,  1.4802],
        [-0.8569, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4078, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1532, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0029],
        [-0.0058,  0.0032],
        [-0.0057,  0.0029],
        [-0.0062,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6840],
        [ 0.6130, -2.6235],
        [-0.7333,  1.4811],
        [-0.8587, -2.7442]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3890, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1544, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0023],
        [-0.0048,  0.0021],
        [-0.0043,  0.0020],
        [-0.0049,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6834],
        [ 0.6140, -2.6245],
        [-0.7318,  1.4801],
        [-0.8574, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3787, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1547, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0023],
        [-0.0050,  0.0025],
        [-0.0046,  0.0022],
        [-0.0047,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6833],
        [ 0.6138, -2.6242],
        [-0.7321,  1.4803],
        [-0.8572, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3896, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1517, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0029],
        [-0.0053,  0.0029],
        [-0.0056,  0.0030],
        [-0.0052,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6839],
        [ 0.6135, -2.6237],
        [-0.7331,  1.4812],
        [-0.8577, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4060, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1533, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0023],
        [-0.0045,  0.0024],
        [-0.0045,  0.0024],
        [-0.0042,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3068,  0.6834],
        [ 0.6143, -2.6243],
        [-0.7321,  1.4805],
        [-0.8568, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4095, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1585, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0025],
        [-0.0052,  0.0027],
        [-0.0049,  0.0028],
        [-0.0047,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6836],
        [ 0.6136, -2.6239],
        [-0.7324,  1.4810],
        [-0.8573, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3971, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1603, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0020],
        [-0.0048,  0.0025],
        [-0.0045,  0.0024],
        [-0.0040,  0.0019]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3067,  0.6831],
        [ 0.6140, -2.6241],
        [-0.7321,  1.4806],
        [-0.8566, -2.7457]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3912, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0330, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1442, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0024],
        [-0.0047,  0.0025],
        [-0.0048,  0.0024],
        [-0.0046,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6835],
        [ 0.6141, -2.6242],
        [-0.7324,  1.4806],
        [-0.8572, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4105, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1590, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0024],
        [-0.0046,  0.0022],
        [-0.0048,  0.0024],
        [-0.0054,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6835],
        [ 0.6142, -2.6244],
        [-0.7323,  1.4806],
        [-0.8580, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3757, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0467, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1686, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0024],
        [-0.0046,  0.0022],
        [-0.0045,  0.0022],
        [-0.0049,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6834],
        [ 0.6142, -2.6244],
        [-0.7320,  1.4804],
        [-0.8574, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3837, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1487, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0025],
        [-0.0045,  0.0023],
        [-0.0045,  0.0023],
        [-0.0045,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6835],
        [ 0.6143, -2.6244],
        [-0.7321,  1.4805],
        [-0.8570, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3700, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1553, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0023],
        [-0.0047,  0.0026],
        [-0.0050,  0.0028],
        [-0.0049,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6834],
        [ 0.6141, -2.6241],
        [-0.7326,  1.4810],
        [-0.8574, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4089, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1493, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0032],
        [-0.0052,  0.0032],
        [-0.0054,  0.0030],
        [-0.0050,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6843],
        [ 0.6136, -2.6235],
        [-0.7330,  1.4812],
        [-0.8576, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3813, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1456, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0026],
        [-0.0047,  0.0026],
        [-0.0044,  0.0024],
        [-0.0046,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6837],
        [ 0.6141, -2.6241],
        [-0.7320,  1.4806],
        [-0.8571, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3873, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0424, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1623, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0023],
        [-0.0043,  0.0025],
        [-0.0042,  0.0024],
        [-0.0047,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6834],
        [ 0.6145, -2.6242],
        [-0.7318,  1.4807],
        [-0.8572, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5049, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0324, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1657, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0028],
        [-0.0047,  0.0024],
        [-0.0050,  0.0029],
        [-0.0052,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6838],
        [ 0.6141, -2.6243],
        [-0.7326,  1.4811],
        [-0.8577, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5083, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1793, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0022],
        [-0.0041,  0.0022],
        [-0.0039,  0.0020],
        [-0.0044,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6833],
        [ 0.6147, -2.6245],
        [-0.7315,  1.4802],
        [-0.8569, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4137, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1529, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0025],
        [-0.0053,  0.0028],
        [-0.0049,  0.0027],
        [-0.0052,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3058,  0.6836],
        [ 0.6135, -2.6239],
        [-0.7325,  1.4810],
        [-0.8578, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4166, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1579, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0020],
        [-0.0042,  0.0025],
        [-0.0039,  0.0022],
        [-0.0044,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6831],
        [ 0.6146, -2.6242],
        [-0.7315,  1.4805],
        [-0.8570, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4127, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0427, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1680, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0027],
        [-0.0049,  0.0027],
        [-0.0049,  0.0028],
        [-0.0046,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6838],
        [ 0.6139, -2.6239],
        [-0.7325,  1.4811],
        [-0.8571, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3762, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1566, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0025],
        [-0.0045,  0.0023],
        [-0.0043,  0.0024],
        [-0.0043,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6836],
        [ 0.6143, -2.6243],
        [-0.7319,  1.4806],
        [-0.8568, -2.7454]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4474, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1754, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0034,  0.0021],
        [-0.0042,  0.0023],
        [-0.0042,  0.0028],
        [-0.0036,  0.0021]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3073,  0.6832],
        [ 0.6146, -2.6244],
        [-0.7319,  1.4811],
        [-0.8561, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4468, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1668, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0023],
        [-0.0049,  0.0029],
        [-0.0045,  0.0024],
        [-0.0046,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6834],
        [ 0.6139, -2.6238],
        [-0.7322,  1.4807],
        [-0.8571, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4199, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0328, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1495, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0023],
        [-0.0043,  0.0027],
        [-0.0043,  0.0027],
        [-0.0044,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6834],
        [ 0.6145, -2.6240],
        [-0.7319,  1.4810],
        [-0.8569, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4320, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1603, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0025],
        [-0.0047,  0.0027],
        [-0.0047,  0.0025],
        [-0.0044,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6837],
        [ 0.6141, -2.6240],
        [-0.7324,  1.4808],
        [-0.8570, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3925, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1553, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0025],
        [-0.0042,  0.0027],
        [-0.0041,  0.0024],
        [-0.0043,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6837],
        [ 0.6146, -2.6240],
        [-0.7318,  1.4807],
        [-0.8568, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4280, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1551, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0028],
        [-0.0044,  0.0028],
        [-0.0046,  0.0026],
        [-0.0042,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6840],
        [ 0.6143, -2.6239],
        [-0.7323,  1.4809],
        [-0.8568, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4036, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1563, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0021],
        [-0.0041,  0.0025],
        [-0.0040,  0.0023],
        [-0.0039,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3072,  0.6832],
        [ 0.6147, -2.6242],
        [-0.7317,  1.4807],
        [-0.8565, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4374, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0438, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1750, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0029],
        [-0.0050,  0.0030],
        [-0.0052,  0.0032],
        [-0.0048,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6841],
        [ 0.6138, -2.6237],
        [-0.7329,  1.4815],
        [-0.8573, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4082, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1518, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0027],
        [-0.0038,  0.0022],
        [-0.0045,  0.0026],
        [-0.0043,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6839],
        [ 0.6150, -2.6245],
        [-0.7322,  1.4810],
        [-0.8568, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4090, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1575, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0037,  0.0022],
        [-0.0038,  0.0024],
        [-0.0037,  0.0022],
        [-0.0039,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3070,  0.6834],
        [ 0.6150, -2.6243],
        [-0.7314,  1.4806],
        [-0.8564, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4280, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1666, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0033],
        [-0.0054,  0.0033],
        [-0.0059,  0.0036],
        [-0.0050,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6845],
        [ 0.6134, -2.6234],
        [-0.7336,  1.4820],
        [-0.8576, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4106, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1632, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0024],
        [-0.0037,  0.0023],
        [-0.0046,  0.0029],
        [-0.0043,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6836],
        [ 0.6151, -2.6244],
        [-0.7323,  1.4812],
        [-0.8568, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4210, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1585, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0028],
        [-0.0042,  0.0024],
        [-0.0046,  0.0027],
        [-0.0044,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6840],
        [ 0.6146, -2.6243],
        [-0.7323,  1.4811],
        [-0.8569, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4064, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1515, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0041,  0.0026],
        [-0.0043,  0.0027],
        [-0.0042,  0.0027],
        [-0.0042,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3066,  0.6838],
        [ 0.6145, -2.6240],
        [-0.7319,  1.4811],
        [-0.8567, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5122, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1847, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0027],
        [-0.0044,  0.0029],
        [-0.0044,  0.0029],
        [-0.0046,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6839],
        [ 0.6144, -2.6238],
        [-0.7322,  1.4813],
        [-0.8571, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4118, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1535, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0038,  0.0028],
        [-0.0039,  0.0024],
        [-0.0036,  0.0023],
        [-0.0039,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6840],
        [ 0.6149, -2.6243],
        [-0.7314,  1.4807],
        [-0.8564, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4003, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1586, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0027],
        [-0.0039,  0.0025],
        [-0.0042,  0.0025],
        [-0.0045,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6839],
        [ 0.6149, -2.6242],
        [-0.7320,  1.4809],
        [-0.8570, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4141, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1579, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0026],
        [-0.0038,  0.0024],
        [-0.0043,  0.0025],
        [-0.0047,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6837],
        [ 0.6150, -2.6243],
        [-0.7321,  1.4809],
        [-0.8572, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4479, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1724, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0039,  0.0022],
        [-0.0042,  0.0025],
        [-0.0040,  0.0026],
        [-0.0036,  0.0022]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3069,  0.6834],
        [ 0.6147, -2.6242],
        [-0.7318,  1.4810],
        [-0.8561, -2.7455]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4125, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0334, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1494, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0033],
        [-0.0044,  0.0029],
        [-0.0045,  0.0028],
        [-0.0047,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6845],
        [ 0.6145, -2.6239],
        [-0.7323,  1.4812],
        [-0.8572, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3954, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1564, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0028],
        [-0.0048,  0.0029],
        [-0.0047,  0.0029],
        [-0.0049,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6840],
        [ 0.6141, -2.6238],
        [-0.7325,  1.4813],
        [-0.8574, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4328, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1644, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0032],
        [-0.0058,  0.0034],
        [-0.0054,  0.0033],
        [-0.0050,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6844],
        [ 0.6131, -2.6233],
        [-0.7332,  1.4817],
        [-0.8575, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4096, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1515, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0029],
        [-0.0042,  0.0026],
        [-0.0041,  0.0025],
        [-0.0041,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6841],
        [ 0.6146, -2.6241],
        [-0.7320,  1.4809],
        [-0.8566, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4221, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1544, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0027],
        [-0.0049,  0.0032],
        [-0.0051,  0.0032],
        [-0.0048,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6838],
        [ 0.6140, -2.6236],
        [-0.7329,  1.4816],
        [-0.8573, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3794, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1562, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0030],
        [-0.0052,  0.0030],
        [-0.0051,  0.0029],
        [-0.0054,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6842],
        [ 0.6137, -2.6237],
        [-0.7329,  1.4813],
        [-0.8579, -2.7443]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4309, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1628, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0028],
        [-0.0048,  0.0026],
        [-0.0045,  0.0025],
        [-0.0049,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6839],
        [ 0.6141, -2.6241],
        [-0.7324,  1.4809],
        [-0.8574, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4444, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0329, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1547, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0026],
        [-0.0043,  0.0024],
        [-0.0047,  0.0028],
        [-0.0047,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6838],
        [ 0.6146, -2.6244],
        [-0.7325,  1.4812],
        [-0.8572, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4036, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1593, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0026],
        [-0.0046,  0.0028],
        [-0.0052,  0.0032],
        [-0.0050,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6838],
        [ 0.6143, -2.6239],
        [-0.7331,  1.4817],
        [-0.8574, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4227, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1511, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0028],
        [-0.0048,  0.0026],
        [-0.0052,  0.0028],
        [-0.0050,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6839],
        [ 0.6141, -2.6242],
        [-0.7330,  1.4813],
        [-0.8575, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4052, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1618, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0029],
        [-0.0042,  0.0025],
        [-0.0047,  0.0027],
        [-0.0047,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6840],
        [ 0.6147, -2.6243],
        [-0.7326,  1.4812],
        [-0.8572, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5218, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1796, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0029],
        [-0.0048,  0.0031],
        [-0.0043,  0.0026],
        [-0.0047,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6840],
        [ 0.6141, -2.6237],
        [-0.7321,  1.4810],
        [-0.8572, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4024, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1627, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0027],
        [-0.0048,  0.0026],
        [-0.0049,  0.0030],
        [-0.0045,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6838],
        [ 0.6142, -2.6242],
        [-0.7327,  1.4814],
        [-0.8570, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4364, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1632, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0027],
        [-0.0053,  0.0030],
        [-0.0047,  0.0029],
        [-0.0055,  0.0035]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6838],
        [ 0.6136, -2.6237],
        [-0.7326,  1.4813],
        [-0.8579, -2.7442]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4038, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1594, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0032],
        [-0.0039,  0.0023],
        [-0.0044,  0.0025],
        [-0.0048,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6843],
        [ 0.6150, -2.6245],
        [-0.7322,  1.4810],
        [-0.8572, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3964, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1476, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0042,  0.0022],
        [-0.0042,  0.0021],
        [-0.0043,  0.0026],
        [-0.0048,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6833],
        [ 0.6147, -2.6246],
        [-0.7322,  1.4811],
        [-0.8572, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3922, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1556, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0031],
        [-0.0053,  0.0033],
        [-0.0053,  0.0032],
        [-0.0051,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6842],
        [ 0.6136, -2.6235],
        [-0.7332,  1.4817],
        [-0.8576, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4056, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1592, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0029],
        [-0.0043,  0.0025],
        [-0.0045,  0.0027],
        [-0.0042,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6840],
        [ 0.6147, -2.6243],
        [-0.7324,  1.4812],
        [-0.8566, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4176, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1713, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0026],
        [-0.0041,  0.0024],
        [-0.0044,  0.0024],
        [-0.0044,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6836],
        [ 0.6148, -2.6244],
        [-0.7322,  1.4809],
        [-0.8569, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4333, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1677, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0033],
        [-0.0047,  0.0029],
        [-0.0047,  0.0032],
        [-0.0055,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6844],
        [ 0.6142, -2.6239],
        [-0.7326,  1.4817],
        [-0.8579, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3908, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1560, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0027],
        [-0.0046,  0.0028],
        [-0.0044,  0.0025],
        [-0.0040,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6837],
        [ 0.6144, -2.6240],
        [-0.7323,  1.4809],
        [-0.8565, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3888, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0466, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1709, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 4, Batch:200, loss: 0.000855, Time: 73.7
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0029],
        [-0.0048,  0.0028],
        [-0.0053,  0.0029],
        [-0.0053,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6840],
        [ 0.6141, -2.6240],
        [-0.7332,  1.4814],
        [-0.8577, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3856, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1517, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0026],
        [-0.0042,  0.0027],
        [-0.0045,  0.0026],
        [-0.0043,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6836],
        [ 0.6147, -2.6241],
        [-0.7324,  1.4811],
        [-0.8568, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3936, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0417, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1621, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0026],
        [-0.0053,  0.0033],
        [-0.0049,  0.0030],
        [-0.0053,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6837],
        [ 0.6136, -2.6235],
        [-0.7327,  1.4815],
        [-0.8577, -2.7443]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3949, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1597, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0032],
        [-0.0050,  0.0030],
        [-0.0054,  0.0031],
        [-0.0048,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3051,  0.6843],
        [ 0.6139, -2.6238],
        [-0.7333,  1.4816],
        [-0.8573, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3826, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1592, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0027],
        [-0.0047,  0.0031],
        [-0.0049,  0.0029],
        [-0.0046,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6837],
        [ 0.6143, -2.6237],
        [-0.7328,  1.4815],
        [-0.8570, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4021, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1583, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0026],
        [-0.0046,  0.0026],
        [-0.0041,  0.0024],
        [-0.0040,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6836],
        [ 0.6144, -2.6242],
        [-0.7320,  1.4809],
        [-0.8564, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3917, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1572, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0026],
        [-0.0041,  0.0024],
        [-0.0041,  0.0024],
        [-0.0043,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3065,  0.6837],
        [ 0.6149, -2.6244],
        [-0.7320,  1.4809],
        [-0.8567, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3835, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1530, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0027],
        [-0.0040,  0.0024],
        [-0.0045,  0.0027],
        [-0.0041,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3062,  0.6837],
        [ 0.6150, -2.6244],
        [-0.7324,  1.4813],
        [-0.8565, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4138, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1567, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0025],
        [-0.0051,  0.0030],
        [-0.0051,  0.0028],
        [-0.0042,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3064,  0.6835],
        [ 0.6139, -2.6238],
        [-0.7330,  1.4813],
        [-0.8566, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4163, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0475, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1782, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0026],
        [-0.0047,  0.0027],
        [-0.0052,  0.0030],
        [-0.0052,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6837],
        [ 0.6142, -2.6241],
        [-0.7331,  1.4816],
        [-0.8576, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4192, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0323, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1485, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0029],
        [-0.0047,  0.0031],
        [-0.0052,  0.0034],
        [-0.0049,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6839],
        [ 0.6142, -2.6237],
        [-0.7332,  1.4819],
        [-0.8573, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4159, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1646, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0044,  0.0027],
        [-0.0052,  0.0030],
        [-0.0050,  0.0033],
        [-0.0044,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6837],
        [ 0.6137, -2.6238],
        [-0.7329,  1.4819],
        [-0.8568, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3991, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1468, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0029],
        [-0.0050,  0.0030],
        [-0.0049,  0.0026],
        [-0.0047,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6839],
        [ 0.6140, -2.6238],
        [-0.7328,  1.4812],
        [-0.8571, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3848, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1556, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0032],
        [-0.0055,  0.0037],
        [-0.0054,  0.0036],
        [-0.0056,  0.0036]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6842],
        [ 0.6135, -2.6231],
        [-0.7334,  1.4822],
        [-0.8580, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3810, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1532, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0058,  0.0036],
        [-0.0050,  0.0031],
        [-0.0051,  0.0032],
        [-0.0059,  0.0036]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3049,  0.6845],
        [ 0.6140, -2.6238],
        [-0.7330,  1.4818],
        [-0.8582, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4148, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1495, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0032],
        [-0.0048,  0.0029],
        [-0.0054,  0.0031],
        [-0.0053,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6842],
        [ 0.6142, -2.6239],
        [-0.7334,  1.4817],
        [-0.8577, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4197, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1520, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0032],
        [-0.0054,  0.0030],
        [-0.0060,  0.0037],
        [-0.0053,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3052,  0.6842],
        [ 0.6136, -2.6239],
        [-0.7340,  1.4823],
        [-0.8577, -2.7443]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4256, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1671, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0025],
        [-0.0046,  0.0026],
        [-0.0046,  0.0026],
        [-0.0040,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6835],
        [ 0.6144, -2.6242],
        [-0.7325,  1.4812],
        [-0.8563, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4217, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1562, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0031],
        [-0.0048,  0.0027],
        [-0.0046,  0.0026],
        [-0.0049,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6841],
        [ 0.6142, -2.6241],
        [-0.7326,  1.4812],
        [-0.8573, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4101, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1649, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0032],
        [-0.0046,  0.0028],
        [-0.0047,  0.0029],
        [-0.0048,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6842],
        [ 0.6143, -2.6240],
        [-0.7327,  1.4815],
        [-0.8572, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4075, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1574, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0029],
        [-0.0049,  0.0030],
        [-0.0047,  0.0029],
        [-0.0046,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6838],
        [ 0.6141, -2.6238],
        [-0.7327,  1.4815],
        [-0.8570, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4067, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1551, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0028],
        [-0.0050,  0.0033],
        [-0.0049,  0.0030],
        [-0.0054,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6838],
        [ 0.6140, -2.6236],
        [-0.7328,  1.4816],
        [-0.8577, -2.7443]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4156, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1630, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0031],
        [-0.0050,  0.0029],
        [-0.0050,  0.0031],
        [-0.0053,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6840],
        [ 0.6140, -2.6240],
        [-0.7330,  1.4817],
        [-0.8577, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4594, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1640, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0033],
        [-0.0054,  0.0031],
        [-0.0052,  0.0030],
        [-0.0050,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6843],
        [ 0.6136, -2.6238],
        [-0.7331,  1.4816],
        [-0.8573, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3895, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1455, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0027],
        [-0.0044,  0.0028],
        [-0.0045,  0.0029],
        [-0.0046,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6836],
        [ 0.6146, -2.6241],
        [-0.7325,  1.4815],
        [-0.8569, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4031, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0433, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1672, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0034],
        [-0.0057,  0.0034],
        [-0.0047,  0.0029],
        [-0.0054,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3051,  0.6843],
        [ 0.6133, -2.6234],
        [-0.7327,  1.4815],
        [-0.8577, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4326, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1676, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0025],
        [-0.0048,  0.0026],
        [-0.0049,  0.0028],
        [-0.0046,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6835],
        [ 0.6142, -2.6243],
        [-0.7328,  1.4814],
        [-0.8569, -2.7453]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3864, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1631, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0031],
        [-0.0047,  0.0028],
        [-0.0051,  0.0032],
        [-0.0056,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6840],
        [ 0.6142, -2.6240],
        [-0.7331,  1.4818],
        [-0.8579, -2.7443]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4105, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1614, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0031],
        [-0.0057,  0.0037],
        [-0.0054,  0.0032],
        [-0.0054,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6841],
        [ 0.6133, -2.6232],
        [-0.7334,  1.4819],
        [-0.8578, -2.7443]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5141, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0317, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1662, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0031],
        [-0.0049,  0.0028],
        [-0.0052,  0.0028],
        [-0.0052,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6841],
        [ 0.6140, -2.6241],
        [-0.7331,  1.4814],
        [-0.8575, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3896, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1552, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0027],
        [-0.0046,  0.0025],
        [-0.0049,  0.0025],
        [-0.0055,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6836],
        [ 0.6143, -2.6244],
        [-0.7328,  1.4812],
        [-0.8578, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4143, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1540, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0035],
        [-0.0060,  0.0037],
        [-0.0061,  0.0037],
        [-0.0056,  0.0036]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3052,  0.6844],
        [ 0.6129, -2.6231],
        [-0.7340,  1.4824],
        [-0.8579, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4358, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1567, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0033],
        [-0.0054,  0.0033],
        [-0.0054,  0.0032],
        [-0.0060,  0.0037]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6842],
        [ 0.6135, -2.6235],
        [-0.7333,  1.4819],
        [-0.8583, -2.7440]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4161, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1622, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0058,  0.0033],
        [-0.0053,  0.0029],
        [-0.0054,  0.0032],
        [-0.0054,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3049,  0.6842],
        [ 0.6136, -2.6240],
        [-0.7333,  1.4818],
        [-0.8577, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3957, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1536, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0038],
        [-0.0050,  0.0034],
        [-0.0050,  0.0032],
        [-0.0053,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3048,  0.6847],
        [ 0.6139, -2.6234],
        [-0.7329,  1.4819],
        [-0.8576, -2.7442]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3898, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1559, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0030],
        [-0.0054,  0.0033],
        [-0.0050,  0.0027],
        [-0.0051,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3053,  0.6840],
        [ 0.6135, -2.6235],
        [-0.7329,  1.4814],
        [-0.8574, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4135, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0457, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1742, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0025],
        [-0.0051,  0.0030],
        [-0.0043,  0.0024],
        [-0.0045,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6834],
        [ 0.6138, -2.6238],
        [-0.7322,  1.4811],
        [-0.8568, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3948, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1576, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0029],
        [-0.0053,  0.0030],
        [-0.0055,  0.0032],
        [-0.0054,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6839],
        [ 0.6136, -2.6238],
        [-0.7334,  1.4818],
        [-0.8577, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4053, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1536, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0063,  0.0039],
        [-0.0056,  0.0034],
        [-0.0050,  0.0030],
        [-0.0057,  0.0035]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3043,  0.6849],
        [ 0.6133, -2.6235],
        [-0.7329,  1.4817],
        [-0.8579, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4004, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0421, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1643, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0031],
        [-0.0050,  0.0029],
        [-0.0056,  0.0031],
        [-0.0054,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3052,  0.6840],
        [ 0.6139, -2.6240],
        [-0.7335,  1.4818],
        [-0.8577, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3799, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1582, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0033],
        [-0.0060,  0.0036],
        [-0.0055,  0.0033],
        [-0.0053,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3051,  0.6842],
        [ 0.6129, -2.6232],
        [-0.7334,  1.4820],
        [-0.8576, -2.7442]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4205, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1595, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0028],
        [-0.0053,  0.0032],
        [-0.0055,  0.0031],
        [-0.0061,  0.0035]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6837],
        [ 0.6136, -2.6237],
        [-0.7334,  1.4818],
        [-0.8583, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3849, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1581, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0031],
        [-0.0056,  0.0032],
        [-0.0053,  0.0030],
        [-0.0054,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3051,  0.6840],
        [ 0.6132, -2.6237],
        [-0.7332,  1.4817],
        [-0.8576, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3973, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0334, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1462, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0035],
        [-0.0062,  0.0034],
        [-0.0059,  0.0034],
        [-0.0061,  0.0035]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3047,  0.6843],
        [ 0.6126, -2.6235],
        [-0.7338,  1.4822],
        [-0.8584, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4068, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1547, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0031],
        [-0.0051,  0.0028],
        [-0.0050,  0.0027],
        [-0.0049,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3051,  0.6840],
        [ 0.6138, -2.6241],
        [-0.7329,  1.4815],
        [-0.8571, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4010, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1619, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0030],
        [-0.0055,  0.0032],
        [-0.0063,  0.0037],
        [-0.0058,  0.0036]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3053,  0.6838],
        [ 0.6133, -2.6236],
        [-0.7342,  1.4824],
        [-0.8580, -2.7440]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4188, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1574, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0035],
        [-0.0053,  0.0033],
        [-0.0055,  0.0032],
        [-0.0055,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3052,  0.6843],
        [ 0.6136, -2.6235],
        [-0.7333,  1.4819],
        [-0.8578, -2.7442]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4112, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1571, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0032],
        [-0.0049,  0.0030],
        [-0.0049,  0.0028],
        [-0.0050,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3053,  0.6840],
        [ 0.6140, -2.6239],
        [-0.7328,  1.4816],
        [-0.8572, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4356, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0315, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1501, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0030],
        [-0.0048,  0.0029],
        [-0.0052,  0.0031],
        [-0.0051,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6839],
        [ 0.6141, -2.6240],
        [-0.7331,  1.4818],
        [-0.8573, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4029, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1590, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0043,  0.0024],
        [-0.0049,  0.0027],
        [-0.0050,  0.0026],
        [-0.0048,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3063,  0.6832],
        [ 0.6140, -2.6241],
        [-0.7329,  1.4813],
        [-0.8570, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4182, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1645, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0046,  0.0023],
        [-0.0051,  0.0029],
        [-0.0053,  0.0030],
        [-0.0051,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3060,  0.6832],
        [ 0.6138, -2.6240],
        [-0.7332,  1.4817],
        [-0.8573, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3917, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1576, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0037],
        [-0.0051,  0.0032],
        [-0.0053,  0.0035],
        [-0.0055,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3051,  0.6845],
        [ 0.6138, -2.6237],
        [-0.7332,  1.4822],
        [-0.8577, -2.7443]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4208, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1585, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0036],
        [-0.0064,  0.0040],
        [-0.0059,  0.0036],
        [-0.0057,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3047,  0.6844],
        [ 0.6125, -2.6229],
        [-0.7337,  1.4824],
        [-0.8579, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4249, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1633, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0035],
        [-0.0052,  0.0032],
        [-0.0057,  0.0034],
        [-0.0052,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3049,  0.6843],
        [ 0.6137, -2.6237],
        [-0.7336,  1.4821],
        [-0.8574, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4202, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1561, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0058,  0.0030],
        [-0.0051,  0.0027],
        [-0.0055,  0.0029],
        [-0.0053,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3048,  0.6839],
        [ 0.6138, -2.6242],
        [-0.7334,  1.4817],
        [-0.8576, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4251, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0421, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1693, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0029],
        [-0.0049,  0.0028],
        [-0.0054,  0.0031],
        [-0.0052,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6838],
        [ 0.6139, -2.6241],
        [-0.7333,  1.4819],
        [-0.8574, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4056, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1583, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0036],
        [-0.0055,  0.0032],
        [-0.0049,  0.0030],
        [-0.0051,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3050,  0.6845],
        [ 0.6133, -2.6237],
        [-0.7328,  1.4817],
        [-0.8573, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4209, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1649, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0034],
        [-0.0051,  0.0030],
        [-0.0051,  0.0031],
        [-0.0055,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3052,  0.6842],
        [ 0.6138, -2.6240],
        [-0.7330,  1.4819],
        [-0.8577, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4608, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1594, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0027],
        [-0.0054,  0.0030],
        [-0.0044,  0.0025],
        [-0.0045,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6835],
        [ 0.6134, -2.6239],
        [-0.7323,  1.4812],
        [-0.8567, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4310, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1618, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0031],
        [-0.0053,  0.0030],
        [-0.0054,  0.0034],
        [-0.0056,  0.0035]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6839],
        [ 0.6136, -2.6239],
        [-0.7333,  1.4822],
        [-0.8578, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3875, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1578, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0035],
        [-0.0062,  0.0034],
        [-0.0054,  0.0032],
        [-0.0053,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3046,  0.6843],
        [ 0.6127, -2.6235],
        [-0.7333,  1.4820],
        [-0.8575, -2.7443]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3936, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1596, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0030],
        [-0.0048,  0.0028],
        [-0.0050,  0.0029],
        [-0.0054,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6839],
        [ 0.6141, -2.6242],
        [-0.7329,  1.4817],
        [-0.8576, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4091, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0316, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1450, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0045,  0.0026],
        [-0.0046,  0.0028],
        [-0.0050,  0.0031],
        [-0.0046,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3061,  0.6835],
        [ 0.6143, -2.6241],
        [-0.7329,  1.4819],
        [-0.8568, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4107, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1492, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0031],
        [-0.0057,  0.0031],
        [-0.0059,  0.0032],
        [-0.0057,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3051,  0.6839],
        [ 0.6132, -2.6238],
        [-0.7337,  1.4819],
        [-0.8579, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3968, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1519, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0027],
        [-0.0051,  0.0026],
        [-0.0054,  0.0029],
        [-0.0056,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6835],
        [ 0.6138, -2.6243],
        [-0.7333,  1.4817],
        [-0.8578, -2.7442]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4197, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0460, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1758, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0030],
        [-0.0056,  0.0032],
        [-0.0054,  0.0029],
        [-0.0054,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6839],
        [ 0.6133, -2.6237],
        [-0.7333,  1.4817],
        [-0.8576, -2.7442]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4056, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1553, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0030],
        [-0.0048,  0.0027],
        [-0.0049,  0.0028],
        [-0.0058,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6839],
        [ 0.6141, -2.6242],
        [-0.7328,  1.4816],
        [-0.8580, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3927, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0427, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1640, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0030],
        [-0.0061,  0.0033],
        [-0.0058,  0.0031],
        [-0.0056,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3050,  0.6839],
        [ 0.6128, -2.6236],
        [-0.7336,  1.4819],
        [-0.8578, -2.7443]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4212, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1550, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0036],
        [-0.0063,  0.0042],
        [-0.0053,  0.0032],
        [-0.0058,  0.0036]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3049,  0.6845],
        [ 0.6126, -2.6227],
        [-0.7332,  1.4820],
        [-0.8580, -2.7439]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4304, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0324, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1509, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0029],
        [-0.0047,  0.0025],
        [-0.0051,  0.0028],
        [-0.0057,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3053,  0.6838],
        [ 0.6142, -2.6244],
        [-0.7329,  1.4816],
        [-0.8579, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3940, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1545, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0031],
        [-0.0052,  0.0029],
        [-0.0054,  0.0031],
        [-0.0056,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3051,  0.6840],
        [ 0.6137, -2.6240],
        [-0.7333,  1.4819],
        [-0.8578, -2.7443]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4170, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1598, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0027],
        [-0.0053,  0.0029],
        [-0.0049,  0.0024],
        [-0.0049,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6836],
        [ 0.6136, -2.6240],
        [-0.7327,  1.4813],
        [-0.8571, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4123, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1594, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0027],
        [-0.0054,  0.0030],
        [-0.0056,  0.0030],
        [-0.0053,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6836],
        [ 0.6135, -2.6239],
        [-0.7334,  1.4819],
        [-0.8575, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3973, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1495, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0025],
        [-0.0054,  0.0028],
        [-0.0057,  0.0033],
        [-0.0054,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3059,  0.6834],
        [ 0.6135, -2.6241],
        [-0.7336,  1.4822],
        [-0.8576, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3714, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1494, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0058,  0.0029],
        [-0.0054,  0.0028],
        [-0.0060,  0.0032],
        [-0.0062,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3048,  0.6838],
        [ 0.6135, -2.6241],
        [-0.7339,  1.4820],
        [-0.8584, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4139, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1593, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0031],
        [-0.0057,  0.0029],
        [-0.0056,  0.0032],
        [-0.0048,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3052,  0.6840],
        [ 0.6132, -2.6240],
        [-0.7334,  1.4820],
        [-0.8570, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4198, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1594, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0027],
        [-0.0056,  0.0026],
        [-0.0053,  0.0027],
        [-0.0047,  0.0023]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3052,  0.6837],
        [ 0.6133, -2.6243],
        [-0.7331,  1.4816],
        [-0.8569, -2.7452]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4149, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1576, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0030],
        [-0.0051,  0.0028],
        [-0.0052,  0.0030],
        [-0.0058,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3051,  0.6839],
        [ 0.6138, -2.6242],
        [-0.7330,  1.4818],
        [-0.8580, -2.7442]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4349, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0311, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1491, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0027],
        [-0.0050,  0.0027],
        [-0.0052,  0.0027],
        [-0.0054,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6836],
        [ 0.6139, -2.6242],
        [-0.7331,  1.4816],
        [-0.8576, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3916, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1588, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0029],
        [-0.0047,  0.0026],
        [-0.0047,  0.0023],
        [-0.0050,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3052,  0.6838],
        [ 0.6143, -2.6244],
        [-0.7325,  1.4812],
        [-0.8572, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4127, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1586, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0029],
        [-0.0055,  0.0032],
        [-0.0055,  0.0030],
        [-0.0047,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6839],
        [ 0.6134, -2.6238],
        [-0.7333,  1.4819],
        [-0.8569, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4199, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1629, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0027],
        [-0.0061,  0.0032],
        [-0.0060,  0.0036],
        [-0.0053,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3053,  0.6837],
        [ 0.6129, -2.6238],
        [-0.7338,  1.4824],
        [-0.8575, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4591, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1658, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0027],
        [-0.0057,  0.0029],
        [-0.0059,  0.0030],
        [-0.0051,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3050,  0.6837],
        [ 0.6133, -2.6241],
        [-0.7338,  1.4819],
        [-0.8573, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3930, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1469, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0060,  0.0029],
        [-0.0061,  0.0030],
        [-0.0056,  0.0029],
        [-0.0054,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3045,  0.6839],
        [ 0.6129, -2.6240],
        [-0.7335,  1.4818],
        [-0.8575, -2.7450]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4101, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1590, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0031],
        [-0.0048,  0.0028],
        [-0.0050,  0.0028],
        [-0.0049,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3048,  0.6841],
        [ 0.6141, -2.6242],
        [-0.7328,  1.4817],
        [-0.8571, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4185, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1572, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0058,  0.0034],
        [-0.0060,  0.0037],
        [-0.0060,  0.0035],
        [-0.0053,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3047,  0.6844],
        [ 0.6130, -2.6232],
        [-0.7338,  1.4824],
        [-0.8575, -2.7442]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3947, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1501, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0030],
        [-0.0053,  0.0032],
        [-0.0053,  0.0029],
        [-0.0051,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3050,  0.6840],
        [ 0.6137, -2.6238],
        [-0.7332,  1.4818],
        [-0.8573, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4234, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1590, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0031],
        [-0.0050,  0.0026],
        [-0.0051,  0.0027],
        [-0.0060,  0.0035]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3050,  0.6841],
        [ 0.6140, -2.6244],
        [-0.7329,  1.4816],
        [-0.8581, -2.7440]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3994, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1563, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0026],
        [-0.0053,  0.0030],
        [-0.0056,  0.0031],
        [-0.0058,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6837],
        [ 0.6137, -2.6239],
        [-0.7334,  1.4820],
        [-0.8580, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3994, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0454, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1707, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0035],
        [-0.0054,  0.0029],
        [-0.0052,  0.0027],
        [-0.0050,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3047,  0.6845],
        [ 0.6136, -2.6241],
        [-0.7330,  1.4816],
        [-0.8572, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3996, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1564, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0034],
        [-0.0057,  0.0033],
        [-0.0054,  0.0029],
        [-0.0053,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3047,  0.6844],
        [ 0.6133, -2.6237],
        [-0.7333,  1.4818],
        [-0.8575, -2.7442]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3892, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1551, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0061,  0.0035],
        [-0.0062,  0.0033],
        [-0.0055,  0.0030],
        [-0.0054,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3044,  0.6846],
        [ 0.6128, -2.6236],
        [-0.7334,  1.4819],
        [-0.8575, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4279, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1531, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0032],
        [-0.0054,  0.0035],
        [-0.0060,  0.0037],
        [-0.0056,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6843],
        [ 0.6136, -2.6235],
        [-0.7339,  1.4827],
        [-0.8577, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4105, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1567, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0029],
        [-0.0046,  0.0027],
        [-0.0052,  0.0029],
        [-0.0049,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3052,  0.6840],
        [ 0.6144, -2.6243],
        [-0.7330,  1.4818],
        [-0.8570, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3942, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1532, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0031],
        [-0.0055,  0.0028],
        [-0.0060,  0.0032],
        [-0.0056,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3045,  0.6842],
        [ 0.6136, -2.6241],
        [-0.7339,  1.4822],
        [-0.8578, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4511, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0303, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1509, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0052,  0.0031],
        [-0.0055,  0.0033],
        [-0.0055,  0.0029],
        [-0.0061,  0.0036]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3052,  0.6842],
        [ 0.6135, -2.6237],
        [-0.7334,  1.4819],
        [-0.8583, -2.7439]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4046, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1524, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0028],
        [-0.0055,  0.0031],
        [-0.0055,  0.0032],
        [-0.0052,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6839],
        [ 0.6135, -2.6239],
        [-0.7334,  1.4821],
        [-0.8573, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4120, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1514, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0058,  0.0031],
        [-0.0058,  0.0031],
        [-0.0057,  0.0032],
        [-0.0054,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3047,  0.6843],
        [ 0.6133, -2.6239],
        [-0.7336,  1.4821],
        [-0.8576, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4448, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1710, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0030],
        [-0.0063,  0.0035],
        [-0.0062,  0.0033],
        [-0.0059,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3046,  0.6841],
        [ 0.6127, -2.6235],
        [-0.7341,  1.4822],
        [-0.8581, -2.7443]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4003, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1633, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0031],
        [-0.0055,  0.0031],
        [-0.0056,  0.0029],
        [-0.0059,  0.0035]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3048,  0.6843],
        [ 0.6136, -2.6239],
        [-0.7334,  1.4818],
        [-0.8581, -2.7440]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4006, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1544, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 4, Batch:300, loss: 0.000515, Time: 109.4
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0033],
        [-0.0061,  0.0037],
        [-0.0058,  0.0034],
        [-0.0057,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3048,  0.6845],
        [ 0.6129, -2.6233],
        [-0.7337,  1.4824],
        [-0.8579, -2.7442]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3927, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1586, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0032],
        [-0.0056,  0.0032],
        [-0.0057,  0.0032],
        [-0.0052,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3050,  0.6843],
        [ 0.6135, -2.6239],
        [-0.7336,  1.4822],
        [-0.8574, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3948, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0420, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1630, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0061,  0.0033],
        [-0.0062,  0.0036],
        [-0.0057,  0.0033],
        [-0.0056,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3043,  0.6844],
        [ 0.6128, -2.6234],
        [-0.7336,  1.4823],
        [-0.8578, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3945, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1528, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0028],
        [-0.0057,  0.0027],
        [-0.0058,  0.0032],
        [-0.0056,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3049,  0.6839],
        [ 0.6134, -2.6243],
        [-0.7337,  1.4822],
        [-0.8578, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3921, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1520, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0031],
        [-0.0056,  0.0031],
        [-0.0060,  0.0035],
        [-0.0052,  0.0026]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3050,  0.6842],
        [ 0.6135, -2.6240],
        [-0.7339,  1.4825],
        [-0.8574, -2.7449]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4158, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1588, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0029],
        [-0.0056,  0.0031],
        [-0.0052,  0.0029],
        [-0.0052,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3053,  0.6841],
        [ 0.6135, -2.6239],
        [-0.7331,  1.4819],
        [-0.8574, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4049, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1641, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0055,  0.0028],
        [-0.0055,  0.0027],
        [-0.0050,  0.0027],
        [-0.0057,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3049,  0.6839],
        [ 0.6136, -2.6244],
        [-0.7329,  1.4817],
        [-0.8579, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4018, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1624, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0051,  0.0025],
        [-0.0054,  0.0029],
        [-0.0043,  0.0021],
        [-0.0052,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3053,  0.6837],
        [ 0.6137, -2.6241],
        [-0.7322,  1.4811],
        [-0.8574, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3926, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0455, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1695, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0060,  0.0033],
        [-0.0065,  0.0037],
        [-0.0057,  0.0034],
        [-0.0062,  0.0038]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3044,  0.6845],
        [ 0.6126, -2.6234],
        [-0.7335,  1.4824],
        [-0.8584, -2.7437]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3811, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0446, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1653, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0030],
        [-0.0060,  0.0034],
        [-0.0050,  0.0028],
        [-0.0055,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3051,  0.6842],
        [ 0.6130, -2.6236],
        [-0.7329,  1.4819],
        [-0.8577, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4105, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0331, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1483, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0060,  0.0034],
        [-0.0060,  0.0036],
        [-0.0060,  0.0035],
        [-0.0065,  0.0038]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3044,  0.6846],
        [ 0.6131, -2.6235],
        [-0.7339,  1.4825],
        [-0.8587, -2.7438]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4091, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1502, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0032],
        [-0.0058,  0.0032],
        [-0.0056,  0.0029],
        [-0.0055,  0.0029]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3045,  0.6843],
        [ 0.6133, -2.6238],
        [-0.7334,  1.4819],
        [-0.8577, -2.7447]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3963, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1613, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0067,  0.0038],
        [-0.0057,  0.0031],
        [-0.0060,  0.0034],
        [-0.0057,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3037,  0.6850],
        [ 0.6134, -2.6239],
        [-0.7339,  1.4824],
        [-0.8579, -2.7446]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4020, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1591, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0048,  0.0026],
        [-0.0049,  0.0029],
        [-0.0054,  0.0031],
        [-0.0055,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3056,  0.6838],
        [ 0.6141, -2.6242],
        [-0.7333,  1.4821],
        [-0.8577, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4243, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1582, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0065,  0.0040],
        [-0.0064,  0.0038],
        [-0.0064,  0.0038],
        [-0.0057,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3038,  0.6852],
        [ 0.6127, -2.6233],
        [-0.7342,  1.4828],
        [-0.8579, -2.7443]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4262, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0471, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1793, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0031],
        [-0.0053,  0.0031],
        [-0.0055,  0.0031],
        [-0.0047,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3054,  0.6843],
        [ 0.6138, -2.6240],
        [-0.7334,  1.4821],
        [-0.8569, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3819, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1511, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0030],
        [-0.0055,  0.0029],
        [-0.0054,  0.0030],
        [-0.0054,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3050,  0.6842],
        [ 0.6136, -2.6242],
        [-0.7333,  1.4820],
        [-0.8576, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3907, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0309, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1399, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0049,  0.0028],
        [-0.0050,  0.0025],
        [-0.0050,  0.0028],
        [-0.0047,  0.0025]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3055,  0.6840],
        [ 0.6141, -2.6245],
        [-0.7329,  1.4818],
        [-0.8569, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4383, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1671, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0025],
        [-0.0053,  0.0029],
        [-0.0057,  0.0034],
        [-0.0050,  0.0027]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6837],
        [ 0.6138, -2.6241],
        [-0.7336,  1.4824],
        [-0.8572, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4031, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1632, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0047,  0.0025],
        [-0.0047,  0.0025],
        [-0.0051,  0.0028],
        [-0.0050,  0.0024]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3057,  0.6837],
        [ 0.6144, -2.6245],
        [-0.7329,  1.4818],
        [-0.8572, -2.7451]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4058, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0465, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1742, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0030],
        [-0.0050,  0.0029],
        [-0.0057,  0.0032],
        [-0.0052,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3051,  0.6842],
        [ 0.6141, -2.6241],
        [-0.7336,  1.4822],
        [-0.8573, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4230, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1568, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0027],
        [-0.0048,  0.0028],
        [-0.0048,  0.0027],
        [-0.0050,  0.0028]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3053,  0.6839],
        [ 0.6143, -2.6243],
        [-0.7327,  1.4817],
        [-0.8572, -2.7448]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4146, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1587, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0033],
        [-0.0055,  0.0034],
        [-0.0055,  0.0035],
        [-0.0052,  0.0032]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3050,  0.6844],
        [ 0.6136, -2.6236],
        [-0.7333,  1.4825],
        [-0.8574, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4307, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0343, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1548, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0061,  0.0035],
        [-0.0058,  0.0035],
        [-0.0054,  0.0032],
        [-0.0056,  0.0035]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3043,  0.6847],
        [ 0.6134, -2.6235],
        [-0.7333,  1.4822],
        [-0.8577, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4017, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0455, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1714, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0032],
        [-0.0059,  0.0037],
        [-0.0058,  0.0035],
        [-0.0059,  0.0033]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3045,  0.6843],
        [ 0.6132, -2.6234],
        [-0.7337,  1.4825],
        [-0.8580, -2.7442]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3707, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0445, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1632, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0034],
        [-0.0057,  0.0036],
        [-0.0063,  0.0038],
        [-0.0060,  0.0038]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3048,  0.6846],
        [ 0.6134, -2.6235],
        [-0.7342,  1.4828],
        [-0.8582, -2.7438]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4087, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1601, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0070,  0.0046],
        [-0.0055,  0.0036],
        [-0.0058,  0.0039],
        [-0.0062,  0.0040]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3033,  0.6858],
        [ 0.6137, -2.6234],
        [-0.7336,  1.4830],
        [-0.8584, -2.7436]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4015, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1631, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0050,  0.0030],
        [-0.0052,  0.0032],
        [-0.0056,  0.0033],
        [-0.0058,  0.0036]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3053,  0.6841],
        [ 0.6140, -2.6239],
        [-0.7335,  1.4824],
        [-0.8580, -2.7440]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4025, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0327, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1460, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0063,  0.0039],
        [-0.0055,  0.0035],
        [-0.0053,  0.0032],
        [-0.0059,  0.0037]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3040,  0.6851],
        [ 0.6137, -2.6236],
        [-0.7332,  1.4822],
        [-0.8581, -2.7439]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3982, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1591, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0061,  0.0042],
        [-0.0052,  0.0035],
        [-0.0054,  0.0037],
        [-0.0057,  0.0037]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3042,  0.6853],
        [ 0.6139, -2.6236],
        [-0.7333,  1.4828],
        [-0.8578, -2.7439]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3970, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1497, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0064,  0.0041],
        [-0.0059,  0.0038],
        [-0.0070,  0.0045],
        [-0.0066,  0.0044]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3039,  0.6853],
        [ 0.6133, -2.6233],
        [-0.7349,  1.4835],
        [-0.8588, -2.7432]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4084, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1535, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0036],
        [-0.0058,  0.0035],
        [-0.0057,  0.0036],
        [-0.0057,  0.0038]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3046,  0.6848],
        [ 0.6134, -2.6236],
        [-0.7335,  1.4826],
        [-0.8579, -2.7438]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3990, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1492, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0060,  0.0038],
        [-0.0057,  0.0037],
        [-0.0056,  0.0034],
        [-0.0054,  0.0035]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3043,  0.6849],
        [ 0.6135, -2.6234],
        [-0.7335,  1.4824],
        [-0.8576, -2.7441]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3942, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1542, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0054,  0.0034],
        [-0.0057,  0.0034],
        [-0.0055,  0.0034],
        [-0.0058,  0.0038]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3049,  0.6845],
        [ 0.6135, -2.6237],
        [-0.7334,  1.4824],
        [-0.8580, -2.7438]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3980, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0445, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1686, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0040],
        [-0.0064,  0.0042],
        [-0.0065,  0.0045],
        [-0.0065,  0.0046]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3045,  0.6851],
        [ 0.6128, -2.6229],
        [-0.7344,  1.4836],
        [-0.8587, -2.7430]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3954, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0427, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1645, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0063,  0.0042],
        [-0.0059,  0.0039],
        [-0.0061,  0.0039],
        [-0.0058,  0.0039]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3040,  0.6853],
        [ 0.6133, -2.6232],
        [-0.7340,  1.4830],
        [-0.8580, -2.7437]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4086, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1631, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0058,  0.0037],
        [-0.0061,  0.0041],
        [-0.0056,  0.0037],
        [-0.0061,  0.0040]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3044,  0.6849],
        [ 0.6130, -2.6230],
        [-0.7335,  1.4827],
        [-0.8583, -2.7436]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3993, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1590, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0056,  0.0036],
        [-0.0052,  0.0037],
        [-0.0055,  0.0035],
        [-0.0057,  0.0040]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3047,  0.6848],
        [ 0.6139, -2.6234],
        [-0.7334,  1.4826],
        [-0.8579, -2.7436]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4408, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1740, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0036],
        [-0.0056,  0.0033],
        [-0.0063,  0.0041],
        [-0.0062,  0.0037]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3044,  0.6848],
        [ 0.6136, -2.6238],
        [-0.7342,  1.4831],
        [-0.8584, -2.7439]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4179, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1555, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0062,  0.0039],
        [-0.0062,  0.0040],
        [-0.0060,  0.0035],
        [-0.0062,  0.0036]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3041,  0.6851],
        [ 0.6130, -2.6231],
        [-0.7339,  1.4826],
        [-0.8584, -2.7439]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4042, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0326, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1460, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0067,  0.0044],
        [-0.0064,  0.0041],
        [-0.0061,  0.0042],
        [-0.0059,  0.0039]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3036,  0.6855],
        [ 0.6127, -2.6230],
        [-0.7340,  1.4833],
        [-0.8581, -2.7437]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4284, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1606, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0065,  0.0042],
        [-0.0069,  0.0044],
        [-0.0067,  0.0043],
        [-0.0064,  0.0041]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3037,  0.6853],
        [ 0.6123, -2.6227],
        [-0.7346,  1.4834],
        [-0.8586, -2.7435]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4200, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1587, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0063,  0.0042],
        [-0.0061,  0.0040],
        [-0.0060,  0.0042],
        [-0.0053,  0.0038]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3039,  0.6853],
        [ 0.6131, -2.6231],
        [-0.7339,  1.4832],
        [-0.8575, -2.7438]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3809, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1570, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0067,  0.0039],
        [-0.0061,  0.0038],
        [-0.0061,  0.0038],
        [-0.0060,  0.0036]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3036,  0.6851],
        [ 0.6130, -2.6233],
        [-0.7340,  1.4829],
        [-0.8582, -2.7439]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4246, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1646, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0065,  0.0044],
        [-0.0072,  0.0049],
        [-0.0062,  0.0039],
        [-0.0069,  0.0046]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3038,  0.6855],
        [ 0.6119, -2.6222],
        [-0.7341,  1.4830],
        [-0.8591, -2.7429]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3984, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1562, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0053,  0.0032],
        [-0.0052,  0.0034],
        [-0.0053,  0.0035],
        [-0.0056,  0.0034]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3050,  0.6844],
        [ 0.6139, -2.6238],
        [-0.7333,  1.4826],
        [-0.8577, -2.7442]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4298, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1645, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0057,  0.0039],
        [-0.0052,  0.0035],
        [-0.0057,  0.0037],
        [-0.0057,  0.0039]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3045,  0.6850],
        [ 0.6139, -2.6236],
        [-0.7336,  1.4828],
        [-0.8579, -2.7436]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3746, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1565, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0072,  0.0049],
        [-0.0071,  0.0048],
        [-0.0071,  0.0049],
        [-0.0075,  0.0052]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3030,  0.6860],
        [ 0.6120, -2.6223],
        [-0.7351,  1.4840],
        [-0.8597, -2.7424]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3940, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1553, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0060,  0.0039],
        [-0.0058,  0.0040],
        [-0.0068,  0.0045],
        [-0.0067,  0.0043]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3043,  0.6851],
        [ 0.6133, -2.6231],
        [-0.7347,  1.4837],
        [-0.8589, -2.7433]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3764, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1466, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0037],
        [-0.0060,  0.0037],
        [-0.0060,  0.0039],
        [-0.0060,  0.0037]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3044,  0.6849],
        [ 0.6132, -2.6234],
        [-0.7339,  1.4830],
        [-0.8581, -2.7439]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3894, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1603, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0038],
        [-0.0067,  0.0043],
        [-0.0063,  0.0041],
        [-0.0061,  0.0042]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3043,  0.6849],
        [ 0.6124, -2.6229],
        [-0.7342,  1.4832],
        [-0.8583, -2.7434]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3817, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1551, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0065,  0.0043],
        [-0.0067,  0.0047],
        [-0.0071,  0.0047],
        [-0.0068,  0.0048]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  gt_cnt:  40
gt_cnt:  41
gt_cnt:  38
gt_cnt:  40
gt_cnt:  35
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  34
gt_cnt:  40
gt_cnt:  39
gt_cnt:  36
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  40
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  33
gt_cnt:  37
gt_cnt:  41
gt_cnt:  39
gt_cnt:  38
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  36
gt_cnt:  41
gt_cnt:  41
gt_cnt:  41
gt_cnt:  44
gt_cnt:  37
gt_cnt:  38
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  38
gt_cnt:  37
gt_cnt:  37
gt_cnt:  38
gt_cnt:  41
gt_cnt:  41
gt_cnt:  40
gt_cnt:  37
gt_cnt:  42
gt_cnt:  37
gt_cnt:  39
gt_cnt:  35
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  43
gt_cnt:  36
gt_cnt:  36
gt_cnt:  38
gt_cnt:  37
gt_cnt:  36
gt_cnt:  37
gt_cnt:  40
gt_cnt:  44
gt_cnt:  37
gt_cnt:  36
gt_cnt:  39
gt_cnt:  39
gt_cnt:  40
gt_cnt:  36
gt_cnt:  40
gt_cnt:  39
gt_cnt:  38
gt_cnt:  39
gt_cnt:  35
gt_cnt:  40
gt_cnt:  39
gt_cnt:  38
gt_cnt:  44
gt_cnt:  35
gt_cnt:  41
gt_cnt:  38
gt_cnt:  41
gt_cnt:  38
gt_cnt:  42
gt_cnt:  39
gt_cnt:  42
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  37
gt_cnt:  42
gt_cnt:  36
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  37
gt_cnt:  41
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  40
gt_cnt:  35
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  42
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  41
gt_cnt:  42
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  41
gt_cnt:  40
gt_cnt:  42
gt_cnt:  39
gt_cnt:  37
gt_cnt:  41
gt_cnt:  40
gt_cnt:  42
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  36
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  36
gt_cnt:  38
gt_cnt:  39
gt_cnt:  43
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  42
gt_cnt:  39
gt_cnt:  37
gt_cnt:  41
gt_cnt:  41
gt_cnt:  38
gt_cnt:  35
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  36
gt_cnt:  39
gt_cnt:  42
gt_cnt:  40
gt_cnt:  41
gt_cnt:  37
gt_cnt:  35
gt_cnt:  44
gt_cnt:  38
gt_cnt:  37
gt_cnt:  37
gt_cnt:  41
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  42
gt_cnt:  37
gt_cnt:  37
gt_cnt:  36
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  37
gt_cnt:  35
gt_cnt:  43
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  40
gt_cnt:  36
gt_cnt:  37
gt_cnt:  38
gt_cnt:  36
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  39
gt_cnt:  40
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  40
gt_cnt:  38
gt_cnt:  37
gt_cnt:  41
gt_cnt:  35
gt_cnt:  40
gt_cnt:  36
gt_cnt:  42
gt_cnt:  34
gt_cnt:  39
gt_cnt:  40
gt_cnt:  35
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  43
gt_cnt:  39
gt_cnt:  37
gt_cnt:  39
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  44
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  36
gt_cnt:  39
gt_cnt:  41
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  38
gt_cnt:  39
gt_cnt:  35
gt_cnt:  40
gt_cnt:  41
gt_cnt:  42
gt_cnt:  40
gt_cnt:  37
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  37
gt_cnt:  37
gt_cnt:  41
gt_cnt:  35
gt_cnt:  41
gt_cnt:  36
gt_cnt:  40
gt_cnt:  41
gt_cnt:  35
gt_cnt:  35
gt_cnt:  38
gt_cnt:  38
gt_cnt:  36
gt_cnt:  38
gt_cnt:  43
gt_cnt:  38
gt_cnt:  35
gt_cnt:  42
gt_cnt:  39
gt_cnt:  43
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  40
gt_cnt:  42
gt_cnt:  40
gt_cnt:  38
gt_cnt:  41
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  36
gt_cnt:  42
gt_cnt:  38
gt_cnt:  40
gt_cnt:  40
gt_cnt:  37
gt_cnt:  38
gt_cnt:  42
gt_cnt:  36
gt_cnt:  35
gt_cnt:  39
gt_cnt:  41
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  40
gt_cnt:  38
gt_cnt:  40
gt_cnt:  36
gt_cnt:  41
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  35
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  43
gt_cnt:  42
gt_cnt:  42
gt_cnt:  42
gt_cnt:  37
tensor([[ 2.3037,  0.6854],
        [ 0.6125, -2.6224],
        [-0.7350,  1.4838],
        [-0.8590, -2.7428]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4184, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1578, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0064,  0.0043],
        [-0.0067,  0.0044],
        [-0.0065,  0.0045],
        [-0.0064,  0.0041]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3038,  0.6854],
        [ 0.6124, -2.6227],
        [-0.7344,  1.4836],
        [-0.8586, -2.7435]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4160, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1624, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0060,  0.0043],
        [-0.0064,  0.0041],
        [-0.0058,  0.0039],
        [-0.0056,  0.0039]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3042,  0.6854],
        [ 0.6128, -2.6230],
        [-0.7337,  1.4831],
        [-0.8578, -2.7436]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4275, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1602, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0067,  0.0042],
        [-0.0059,  0.0037],
        [-0.0069,  0.0046],
        [-0.0063,  0.0038]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3035,  0.6853],
        [ 0.6132, -2.6234],
        [-0.7349,  1.4838],
        [-0.8584, -2.7437]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3945, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1580, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0062,  0.0038],
        [-0.0065,  0.0042],
        [-0.0064,  0.0042],
        [-0.0057,  0.0036]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3040,  0.6849],
        [ 0.6126, -2.6230],
        [-0.7344,  1.4834],
        [-0.8579, -2.7440]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3952, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1535, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0040],
        [-0.0067,  0.0044],
        [-0.0067,  0.0047],
        [-0.0071,  0.0045]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3043,  0.6851],
        [ 0.6124, -2.6227],
        [-0.7347,  1.4839],
        [-0.8593, -2.7431]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4348, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1658, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0059,  0.0040],
        [-0.0059,  0.0039],
        [-0.0058,  0.0039],
        [-0.0058,  0.0040]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3043,  0.6851],
        [ 0.6133, -2.6232],
        [-0.7338,  1.4831],
        [-0.8579, -2.7435]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3820, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1529, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0065,  0.0043],
        [-0.0059,  0.0039],
        [-0.0059,  0.0039],
        [-0.0061,  0.0040]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3037,  0.6854],
        [ 0.6132, -2.6232],
        [-0.7339,  1.4831],
        [-0.8583, -2.7435]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4339, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1700, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0058,  0.0038],
        [-0.0053,  0.0035],
        [-0.0053,  0.0031],
        [-0.0050,  0.0030]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3044,  0.6849],
        [ 0.6138, -2.6237],
        [-0.7332,  1.4823],
        [-0.8572, -2.7445]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3953, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1549, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 4, Batch:360, loss: 0.000430, Time: 131.0
Testing...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0047],
        [-0.0074,  0.0047],
        [-0.0074,  0.0047],
        [-0.0074,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3028,  0.6857],
        [ 0.6117, -2.6225],
        [-0.7353,  1.4839],
        [-0.8595, -2.7429]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7252, device='cuda:0'), 'loss_center': tensor(0.0360, device='cuda:0')}
loss: tensor(0.2171, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838,
         0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838,
         0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838,
         0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838,
         0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838, 0.7838,
         0.7838, 0.7838, 0.7838, 0.7838, 0.7838]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046]], device='cuda:0')
after ref add :  tensor([[ 2.3028,  0.6857],
        [ 0.6118, -2.6226],
        [-0.7353,  1.4838],
        [-0.8595, -2.7430]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7323, device='cuda:0'), 'loss_center': tensor(0.0378, device='cuda:0')}
loss: tensor(0.2221, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858,
         0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858,
         0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858,
         0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858,
         0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858, 0.7858,
         0.7858, 0.7858, 0.7858, 0.7858, 0.7858]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0076,  0.0048],
        [-0.0076,  0.0048],
        [-0.0076,  0.0048],
        [-0.0076,  0.0048]], device='cuda:0')
after ref add :  tensor([[ 2.3026,  0.6859],
        [ 0.6115, -2.6223],
        [-0.7356,  1.4841],
        [-0.8598, -2.7427]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7446, device='cuda:0'), 'loss_center': tensor(0.0372, device='cuda:0')}
loss: tensor(0.2234, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891,
         0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891,
         0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891,
         0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891,
         0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891, 0.7891,
         0.7891, 0.7891, 0.7891, 0.7891, 0.7891]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0047],
        [-0.0074,  0.0047],
        [-0.0074,  0.0047],
        [-0.0074,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3028,  0.6858],
        [ 0.6117, -2.6225],
        [-0.7354,  1.4839],
        [-0.8596, -2.7429]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7409, device='cuda:0'), 'loss_center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.2251, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881,
         0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881,
         0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881,
         0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881,
         0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881, 0.7881,
         0.7881, 0.7881, 0.7881, 0.7881, 0.7881]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0048],
        [-0.0075,  0.0048],
        [-0.0075,  0.0048],
        [-0.0075,  0.0048]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6859],
        [ 0.6116, -2.6224],
        [-0.7355,  1.4840],
        [-0.8597, -2.7428]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7678, device='cuda:0'), 'loss_center': tensor(0.0327, device='cuda:0')}
loss: tensor(0.2190, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949,
         0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949,
         0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949,
         0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949,
         0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949, 0.7949,
         0.7949, 0.7949, 0.7949, 0.7949, 0.7949]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6858],
        [ 0.6116, -2.6224],
        [-0.7355,  1.4840],
        [-0.8597, -2.7428]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7361, device='cuda:0'), 'loss_center': tensor(0.0339, device='cuda:0')}
loss: tensor(0.2150, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866,
         0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866,
         0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866,
         0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866,
         0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866, 0.7866,
         0.7866, 0.7866, 0.7866, 0.7866, 0.7866]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6857],
        [ 0.6116, -2.6225],
        [-0.7354,  1.4839],
        [-0.8596, -2.7429]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7116, device='cuda:0'), 'loss_center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.2190, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796,
         0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796,
         0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796,
         0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796,
         0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796, 0.7796,
         0.7796, 0.7796, 0.7796, 0.7796, 0.7796]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046]], device='cuda:0')
after ref add :  tensor([[ 2.3028,  0.6857],
        [ 0.6117, -2.6225],
        [-0.7353,  1.4838],
        [-0.8595, -2.7429]], device='cuda:0')
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7301, device='cuda:0'), 'loss_center': tensor(0.0382, device='cuda:0')}
loss: tensor(0.2225, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846,
         0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846,
         0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846,
         0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846,
         0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846,
         0.7846, 0.7846, 0.7846, 0.7846, 0.7846]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0047],
        [-0.0074,  0.0047],
        [-0.0074,  0.0047],
        [-0.0074,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3028,  0.6858],
        [ 0.6117, -2.6225],
        [-0.7354,  1.4839],
        [-0.8596, -2.7429]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6997, device='cuda:0'), 'loss_center': tensor(0.0414, device='cuda:0')}
loss: tensor(0.2227, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6857],
        [ 0.6117, -2.6225],
        [-0.7354,  1.4838],
        [-0.8596, -2.7429]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7079, device='cuda:0'), 'loss_center': tensor(0.0385, device='cuda:0')}
loss: tensor(0.2186, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789,
         0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789,
         0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789,
         0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789,
         0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789, 0.7789,
         0.7789, 0.7789, 0.7789, 0.7789, 0.7789]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0045],
        [-0.0074,  0.0045],
        [-0.0074,  0.0045],
        [-0.0074,  0.0045]], device='cuda:0')
after ref add :  tensor([[ 2.3028,  0.6856],
        [ 0.6117, -2.6226],
        [-0.7354,  1.4837],
        [-0.8596, -2.7430]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7164, device='cuda:0'), 'loss_center': tensor(0.0415, device='cuda:0')}
loss: tensor(0.2263, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813,
         0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813,
         0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813,
         0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813,
         0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813, 0.7813,
         0.7813, 0.7813, 0.7813, 0.7813, 0.7813]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6858],
        [ 0.6116, -2.6225],
        [-0.7354,  1.4839],
        [-0.8596, -2.7428]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7127, device='cuda:0'), 'loss_center': tensor(0.0377, device='cuda:0')}
loss: tensor(0.2180, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801,
         0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801,
         0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801,
         0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801,
         0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801, 0.7801,
         0.7801, 0.7801, 0.7801, 0.7801, 0.7801]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046]], device='cuda:0')
after ref add :  tensor([[ 2.3028,  0.6857],
        [ 0.6117, -2.6225],
        [-0.7354,  1.4838],
        [-0.8596, -2.7429]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7102, device='cuda:0'), 'loss_center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.2186, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798,
         0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798,
         0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798,
         0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798,
         0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798, 0.7798,
         0.7798, 0.7798, 0.7798, 0.7798, 0.7798]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0045],
        [-0.0074,  0.0045],
        [-0.0074,  0.0045],
        [-0.0074,  0.0045]], device='cuda:0')
after ref add :  tensor([[ 2.3028,  0.6856],
        [ 0.6117, -2.6226],
        [-0.7354,  1.4838],
        [-0.8596, -2.7430]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6989, device='cuda:0'), 'loss_center': tensor(0.0371, device='cuda:0')}
loss: tensor(0.2139, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0076,  0.0047],
        [-0.0076,  0.0047],
        [-0.0076,  0.0047],
        [-0.0076,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3026,  0.6857],
        [ 0.6116, -2.6225],
        [-0.7355,  1.4839],
        [-0.8597, -2.7429]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6789, device='cuda:0'), 'loss_center': tensor(0.0378, device='cuda:0')}
loss: tensor(0.2114, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707,
         0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707,
         0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707,
         0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707,
         0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707, 0.7707,
         0.7707, 0.7707, 0.7707, 0.7707, 0.7707]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0046],
        [-0.0075,  0.0046],
        [-0.0075,  0.0046],
        [-0.0075,  0.0046]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6857],
        [ 0.6116, -2.6225],
        [-0.7355,  1.4838],
        [-0.8597, -2.7429]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6950, device='cuda:0'), 'loss_center': tensor(0.0364, device='cuda:0')}
loss: tensor(0.2118, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756,
         0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756,
         0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756,
         0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756,
         0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756, 0.7756,
         0.7756, 0.7756, 0.7756, 0.7756, 0.7756]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6857],
        [ 0.6116, -2.6225],
        [-0.7355,  1.4839],
        [-0.8597, -2.7429]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7498, device='cuda:0'), 'loss_center': tensor(0.0345, device='cuda:0')}
loss: tensor(0.2189, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905,
         0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905,
         0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905,
         0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905,
         0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905, 0.7905,
         0.7905, 0.7905, 0.7905, 0.7905, 0.7905]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0073,  0.0046],
        [-0.0073,  0.0046],
        [-0.0073,  0.0046],
        [-0.0073,  0.0046]], device='cuda:0')
after ref add :  tensor([[ 2.3029,  0.6857],
        [ 0.6118, -2.6226],
        [-0.7353,  1.4838],
        [-0.8595, -2.7430]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7396, device='cuda:0'), 'loss_center': tensor(0.0405, device='cuda:0')}
loss: tensor(0.2290, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878,
         0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878,
         0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878,
         0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878,
         0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878, 0.7878,
         0.7878, 0.7878, 0.7878, 0.7878, 0.7878]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0076,  0.0047],
        [-0.0076,  0.0047],
        [-0.0076,  0.0047],
        [-0.0076,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3026,  0.6858],
        [ 0.6115, -2.6224],
        [-0.7356,  1.4839],
        [-0.8598, -2.7428]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7281, device='cuda:0'), 'loss_center': tensor(0.0356, device='cuda:0')}
loss: tensor(0.2168, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846,
         0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846,
         0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846,
         0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846,
         0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846, 0.7846,
         0.7846, 0.7846, 0.7846, 0.7846, 0.7846]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0046],
        [-0.0075,  0.0046],
        [-0.0075,  0.0046],
        [-0.0075,  0.0046]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6857],
        [ 0.6117, -2.6226],
        [-0.7354,  1.4838],
        [-0.8596, -2.7430]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7261, device='cuda:0'), 'loss_center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.2219, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843,
         0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843,
         0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843,
         0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843,
         0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843, 0.7843,
         0.7843, 0.7843, 0.7843, 0.7843, 0.7843]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6858],
        [ 0.6116, -2.6225],
        [-0.7355,  1.4839],
        [-0.8597, -2.7429]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7379, device='cuda:0'), 'loss_center': tensor(0.0331, device='cuda:0')}
loss: tensor(0.2137, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874,
         0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874,
         0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874,
         0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874,
         0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874, 0.7874,
         0.7874, 0.7874, 0.7874, 0.7874, 0.7874]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0046],
        [-0.0075,  0.0046],
        [-0.0075,  0.0046],
        [-0.0075,  0.0046]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6857],
        [ 0.6116, -2.6225],
        [-0.7355,  1.4838],
        [-0.8596, -2.7429]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7423, device='cuda:0'), 'loss_center': tensor(0.0328, device='cuda:0')}
loss: tensor(0.2140, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882,
         0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882,
         0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882,
         0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882,
         0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882,
         0.7882, 0.7882, 0.7882, 0.7882, 0.7882]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0077,  0.0048],
        [-0.0077,  0.0048],
        [-0.0077,  0.0048],
        [-0.0077,  0.0048]], device='cuda:0')
after ref add :  tensor([[ 2.3025,  0.6858],
        [ 0.6115, -2.6224],
        [-0.7356,  1.4840],
        [-0.8598, -2.7428]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7153, device='cuda:0'), 'loss_center': tensor(0.0314, device='cuda:0')}
loss: tensor(0.2059, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807,
         0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807,
         0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807,
         0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807,
         0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807,
         0.7807, 0.7807, 0.7807, 0.7807, 0.7807]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0046],
        [-0.0075,  0.0046],
        [-0.0075,  0.0046],
        [-0.0075,  0.0046]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6857],
        [ 0.6116, -2.6225],
        [-0.7355,  1.4839],
        [-0.8597, -2.7429]], device='cuda:0')
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6767, device='cuda:0'), 'loss_center': tensor(0.0366, device='cuda:0')}
loss: tensor(0.2086, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691, 0.7691,
         0.7691, 0.7691, 0.7691, 0.7691, 0.7691]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046]], device='cuda:0')
after ref add :  tensor([[ 2.3028,  0.6857],
        [ 0.6117, -2.6226],
        [-0.7354,  1.4838],
        [-0.8596, -2.7430]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6894, device='cuda:0'), 'loss_center': tensor(0.0396, device='cuda:0')}
loss: tensor(0.2172, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732,
         0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732,
         0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732,
         0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732,
         0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732, 0.7732,
         0.7732, 0.7732, 0.7732, 0.7732, 0.7732]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046]], device='cuda:0')
after ref add :  tensor([[ 2.3028,  0.6857],
        [ 0.6117, -2.6225],
        [-0.7354,  1.4838],
        [-0.8596, -2.7429]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6727, device='cuda:0'), 'loss_center': tensor(0.0353, device='cuda:0')}
loss: tensor(0.2050, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681,
         0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681,
         0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681,
         0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681,
         0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681, 0.7681,
         0.7681, 0.7681, 0.7681, 0.7681, 0.7681]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0076,  0.0048],
        [-0.0076,  0.0048],
        [-0.0076,  0.0048],
        [-0.0076,  0.0048]], device='cuda:0')
after ref add :  tensor([[ 2.3026,  0.6859],
        [ 0.6115, -2.6223],
        [-0.7356,  1.4840],
        [-0.8598, -2.7427]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7088, device='cuda:0'), 'loss_center': tensor(0.0395, device='cuda:0')}
loss: tensor(0.2208, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790,
         0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790,
         0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790,
         0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790,
         0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790, 0.7790,
         0.7790, 0.7790, 0.7790, 0.7790, 0.7790]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046]], device='cuda:0')
after ref add :  tensor([[ 2.3028,  0.6857],
        [ 0.6117, -2.6225],
        [-0.7354,  1.4838],
        [-0.8596, -2.7429]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7003, device='cuda:0'), 'loss_center': tensor(0.0379, device='cuda:0')}
loss: tensor(0.2158, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766, 0.7766,
         0.7766, 0.7766, 0.7766, 0.7766, 0.7766]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0045],
        [-0.0074,  0.0045],
        [-0.0074,  0.0045],
        [-0.0074,  0.0045]], device='cuda:0')
after ref add :  tensor([[ 2.3028,  0.6856],
        [ 0.6117, -2.6226],
        [-0.7354,  1.4837],
        [-0.8596, -2.7430]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7046, device='cuda:0'), 'loss_center': tensor(0.0435, device='cuda:0')}
loss: tensor(0.2279, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778,
         0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778,
         0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778,
         0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778,
         0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778, 0.7778,
         0.7778, 0.7778, 0.7778, 0.7778, 0.7778]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0046],
        [-0.0075,  0.0046],
        [-0.0075,  0.0046],
        [-0.0075,  0.0046]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6857],
        [ 0.6116, -2.6225],
        [-0.7355,  1.4838],
        [-0.8597, -2.7429]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6944, device='cuda:0'), 'loss_center': tensor(0.0452, device='cuda:0')}
loss: tensor(0.2293, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747,
         0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747,
         0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747,
         0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747,
         0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747, 0.7747,
         0.7747, 0.7747, 0.7747, 0.7747, 0.7747]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0076,  0.0047],
        [-0.0076,  0.0047],
        [-0.0076,  0.0047],
        [-0.0076,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3026,  0.6857],
        [ 0.6115, -2.6225],
        [-0.7356,  1.4839],
        [-0.8597, -2.7429]], device='cuda:0')
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7064, device='cuda:0'), 'loss_center': tensor(0.0340, device='cuda:0')}
loss: tensor(0.2093, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777,
         0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777,
         0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777,
         0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777,
         0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777, 0.7777,
         0.7777, 0.7777, 0.7777, 0.7777, 0.7777]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6858],
        [ 0.6116, -2.6225],
        [-0.7355,  1.4839],
        [-0.8597, -2.7429]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7153, device='cuda:0'), 'loss_center': tensor(0.0369, device='cuda:0')}
loss: tensor(0.2168, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807,
         0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807,
         0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807,
         0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807,
         0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807, 0.7807,
         0.7807, 0.7807, 0.7807, 0.7807, 0.7807]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0048],
        [-0.0075,  0.0048],
        [-0.0075,  0.0048],
        [-0.0075,  0.0048]], device='cuda:0')
after ref add :  tensor([[ 2.3026,  0.6858],
        [ 0.6116, -2.6224],
        [-0.7355,  1.4840],
        [-0.8597, -2.7428]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7428, device='cuda:0'), 'loss_center': tensor(0.0393, device='cuda:0')}
loss: tensor(0.2272, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882,
         0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882,
         0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882,
         0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882,
         0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882, 0.7882,
         0.7882, 0.7882, 0.7882, 0.7882, 0.7882]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6858],
        [ 0.6116, -2.6224],
        [-0.7355,  1.4839],
        [-0.8597, -2.7428]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7159, device='cuda:0'), 'loss_center': tensor(0.0393, device='cuda:0')}
loss: tensor(0.2218, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810,
         0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810,
         0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810,
         0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810,
         0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810, 0.7810,
         0.7810, 0.7810, 0.7810, 0.7810, 0.7810]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0047],
        [-0.0074,  0.0047],
        [-0.0074,  0.0047],
        [-0.0074,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6857],
        [ 0.6117, -2.6225],
        [-0.7354,  1.4839],
        [-0.8596, -2.7429]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7032, device='cuda:0'), 'loss_center': tensor(0.0417, device='cuda:0')}
loss: tensor(0.2241, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772,
         0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772,
         0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772,
         0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772,
         0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772, 0.7772,
         0.7772, 0.7772, 0.7772, 0.7772, 0.7772]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6858],
        [ 0.6116, -2.6225],
        [-0.7354,  1.4839],
        [-0.8596, -2.7429]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7402, device='cuda:0'), 'loss_center': tensor(0.0444, device='cuda:0')}
loss: tensor(0.2369, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875,
         0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875,
         0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875,
         0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875,
         0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875, 0.7875,
         0.7875, 0.7875, 0.7875, 0.7875, 0.7875]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0047],
        [-0.0074,  0.0047],
        [-0.0074,  0.0047],
        [-0.0074,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3028,  0.6858],
        [ 0.6117, -2.6225],
        [-0.7354,  1.4839],
        [-0.8596, -2.7429]], device='cuda:0')
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7151, device='cuda:0'), 'loss_center': tensor(0.0360, device='cuda:0')}
loss: tensor(0.2150, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802,
         0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802,
         0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802,
         0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802,
         0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802, 0.7802,
         0.7802, 0.7802, 0.7802, 0.7802, 0.7802]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046],
        [-0.0074,  0.0046]], device='cuda:0')
after ref add :  tensor([[ 2.3028,  0.6857],
        [ 0.6117, -2.6225],
        [-0.7354,  1.4839],
        [-0.8595, -2.7429]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7279, device='cuda:0'), 'loss_center': tensor(0.0376, device='cuda:0')}
loss: tensor(0.2208, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842,
         0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842,
         0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842,
         0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842,
         0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842, 0.7842,
         0.7842, 0.7842, 0.7842, 0.7842, 0.7842]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047],
        [-0.0075,  0.0047]], device='cuda:0')
after ref add :  tensor([[ 2.3027,  0.6858],
        [ 0.6116, -2.6224],
        [-0.7355,  1.4839],
        [-0.8597, -2.7428]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7432, device='cuda:0'), 'loss_center': tensor(0.0393, device='cuda:0')}
loss: tensor(0.2273, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888,
         0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888,
         0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888,
         0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888,
         0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888, 0.7888,
         0.7888, 0.7888, 0.7888, 0.7888, 0.7888]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0076,  0.0048],
        [-0.0076,  0.0048],
        [-0.0076,  0.0048],
        [-0.0076,  0.0048]], device='cuda:0')
after ref add :  tensor([[ 2.3026,  0.6859],
        [ 0.6115, -2.6223],
        [-0.7356,  1.4840],
        [-0.8598, -2.7427]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7187, device='cuda:0'), 'loss_center': tensor(0.0417, device='cuda:0')}
loss: tensor(0.2271, device='cuda:0', dtype=torch.float64)
top10 scores:  gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  37
gt_cnt:  36
gt_cnt:  39
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  35
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  40
gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  36
gt_cnt:  37
gt_cnt:  36
gt_cnt:  34
gt_cnt:  39
gt_cnt:  36
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  36
gt_cnt:  37
gt_cnt:  34
gt_cnt:  36
gt_cnt:  39
tensor([[0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823,
         0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823,
         0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823,
         0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823,
         0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823, 0.7823,
         0.7823, 0.7823, 0.7823, 0.7823, 0.7823]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
moda: 0.0%, modp: 34.1%, prec: 6.9%, recall: 9.2%
Test, loss: 0.219389, Time: 15.096
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0064,  0.0040],
        [-0.0056,  0.0035],
        [-0.0061,  0.0038],
        [-0.0064,  0.0038]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3038,  0.6851],
        [ 0.6135, -2.6236],
        [-0.7341,  1.4830],
        [-0.8586, -2.7437]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4091, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0327, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1473, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0062,  0.0041],
        [-0.0065,  0.0043],
        [-0.0069,  0.0046],
        [-0.0066,  0.0042]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3040,  0.6852],
        [ 0.6126, -2.6229],
        [-0.7349,  1.4839],
        [-0.8588, -2.7433]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4133, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1510, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0069,  0.0044],
        [-0.0069,  0.0043],
        [-0.0066,  0.0042],
        [-0.0062,  0.0036]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3033,  0.6855],
        [ 0.6122, -2.6229],
        [-0.7345,  1.4834],
        [-0.8584, -2.7439]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4109, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1534, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0070,  0.0043],
        [-0.0067,  0.0043],
        [-0.0068,  0.0043],
        [-0.0068,  0.0043]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3032,  0.6853],
        [ 0.6124, -2.6229],
        [-0.7348,  1.4836],
        [-0.8589, -2.7432]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3951, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1606, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0071,  0.0044],
        [-0.0081,  0.0054],
        [-0.0072,  0.0046],
        [-0.0080,  0.0051]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3031,  0.6855],
        [ 0.6110, -2.6217],
        [-0.7352,  1.4839],
        [-0.8602, -2.7425]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4190, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1537, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0072,  0.0045],
        [-0.0074,  0.0046],
        [-0.0069,  0.0043],
        [-0.0068,  0.0042]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3030,  0.6855],
        [ 0.6117, -2.6225],
        [-0.7349,  1.4835],
        [-0.8590, -2.7433]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4161, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1572, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0063,  0.0041],
        [-0.0052,  0.0032],
        [-0.0064,  0.0041],
        [-0.0062,  0.0039]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3039,  0.6852],
        [ 0.6139, -2.6240],
        [-0.7344,  1.4834],
        [-0.8584, -2.7436]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6154, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2037, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0068,  0.0040],
        [-0.0063,  0.0037],
        [-0.0070,  0.0041],
        [-0.0069,  0.0041]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3034,  0.6851],
        [ 0.6128, -2.6235],
        [-0.7350,  1.4834],
        [-0.8591, -2.7435]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3913, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1528, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0063,  0.0034],
        [-0.0072,  0.0040],
        [-0.0058,  0.0034],
        [-0.0067,  0.0037]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3039,  0.6845],
        [ 0.6119, -2.6232],
        [-0.7338,  1.4827],
        [-0.8589, -2.7438]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4028, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0343, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1492, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0058,  0.0034],
        [-0.0061,  0.0036],
        [-0.0063,  0.0037],
        [-0.0062,  0.0036]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  gt_cnt:  40
gt_cnt:  41
gt_cnt:  39
gt_cnt:  35
tensor([[ 2.3043,  0.6844],
        [ 0.6130, -2.6236],
        [-0.7343,  1.4830],
        [-0.8584, -2.7440]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4161, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1647, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0063,  0.0037],
        [-0.0057,  0.0031],
        [-0.0056,  0.0032],
        [-0.0055,  0.0031]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3039,  0.6848],
        [ 0.6133, -2.6241],
        [-0.7336,  1.4825],
        [-0.8577, -2.7444]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5370, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1805, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0066,  0.0035],
        [-0.0067,  0.0037],
        [-0.0065,  0.0036],
        [-0.0069,  0.0035]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3036,  0.6846],
        [ 0.6124, -2.6236],
        [-0.7345,  1.4830],
        [-0.8591, -2.7440]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4096, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1563, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0079,  0.0046],
        [-0.0085,  0.0048],
        [-0.0084,  0.0048],
        [-0.0080,  0.0046]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3023,  0.6856],
        [ 0.6106, -2.6224],
        [-0.7363,  1.4842],
        [-0.8601, -2.7430]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4013, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1514, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0073,  0.0042],
        [-0.0076,  0.0041],
        [-0.0078,  0.0043],
        [-0.0069,  0.0037]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3029,  0.6852],
        [ 0.6115, -2.6231],
        [-0.7358,  1.4837],
        [-0.8590, -2.7438]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4056, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1586, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0075,  0.0042],
        [-0.0073,  0.0042],
        [-0.0071,  0.0039],
        [-0.0069,  0.0037]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3027,  0.6852],
        [ 0.6117, -2.6230],
        [-0.7350,  1.4832],
        [-0.8590, -2.7438]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4578, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1653, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0071,  0.0036],
        [-0.0075,  0.0041],
        [-0.0074,  0.0037],
        [-0.0077,  0.0040]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3031,  0.6847],
        [ 0.6116, -2.6232],
        [-0.7354,  1.4830],
        [-0.8598, -2.7436]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4318, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0339, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1542, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
