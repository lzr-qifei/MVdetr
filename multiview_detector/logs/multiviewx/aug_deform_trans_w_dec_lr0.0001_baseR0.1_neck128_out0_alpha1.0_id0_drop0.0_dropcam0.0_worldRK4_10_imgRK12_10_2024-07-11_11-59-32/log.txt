logs/multiviewx/aug_deform_trans_w_dec_lr0.0001_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-11_11-59-32
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 100, 'lr': 0.0001, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX', 'two_stage': False}
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 117,
        127, 133, 137, 143, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 39, 36, 12, 24,  0,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(6.6015, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(29.1031, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(42.3061, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,
         86,  90, 106, 121, 126, 158, 159, 166, 178, 179, 195, 200, 203, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 261, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38, 30,  0,
         8, 16, 31, 36, 12, 22,  1, 39, 10, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(6.6050, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(27.3836, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(40.5936, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  49,  51,  60,  70,
         74,  86, 105, 106, 133, 137, 153, 156, 164, 166, 170, 179, 194, 195,
        210, 221, 234, 240, 245, 248, 249, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 40, 26, 39, 38, 13, 21,  0, 30,
        41, 24, 12, 10,  5, 37,  8, 22, 15,  1,  9, 28, 31, 17, 20, 16, 42,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(6.0924, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(24.2504, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(36.4352, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86,  91, 127, 133, 137, 149, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40,  5, 12, 24,  0, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(6.0839, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(26.2902, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(38.4579, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:4, loss: 9.614467, Time: 6.5
Testing...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 158, 159, 166, 178, 179, 195, 200, 203, 206,
        215, 221, 232, 238, 244, 249, 250, 255, 264, 270, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 16, 31, 36, 12, 22,  1, 39, 10, 23,  3, 32, 15, 17, 28, 40, 18, 29,
         2, 27, 24, 19,  9]))]
{'labels': tensor(6.1036, device='cuda:0'), 'center': tensor(26.5821, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 133, 137, 153, 156, 164, 166, 170, 179,
        194, 195, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 41, 24, 12, 10,  5, 37,  8, 22, 15,  1,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(5.6822, device='cuda:0'), 'center': tensor(24.2829, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  50,  56,  58,
         60,  62,  74,  83,  86, 127, 133, 137, 149, 153, 156, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39, 37,  8, 14, 38, 27, 13, 17,
        21,  5, 40, 24,  0, 12, 10, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(5.9013, device='cuda:0'), 'center': tensor(26.0408, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  83,  91,  95,
        100, 127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 26, 39, 20, 33, 36, 12, 24,
         0, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(6.0360, device='cuda:0'), 'center': tensor(28.1354, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 19
Frame 1: FP: 22.0, Misses: 22.0
Frame 2: Detected: 21
Frame 2: FP: 22.0, Misses: 22.0
Frame 3: Detected: 16
Frame 3: FP: 26.0, Misses: 26.0
Frame 4: Detected: 17
Frame 4: FP: 24.0, Misses: 24.0
moda: 0.0%, modp: 37.2%, prec: 43.7%, recall: 43.7%
Test, loss: 38.121834, Time: 2.177
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(5.8261, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(24.9852, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(36.6373, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  30,  34,  35,  42,  44,  49,  56,  58,
         60,  62,  74,  83,  86, 127, 133, 137, 149, 153, 156, 164, 166, 179,
        210, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18,  2, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17,
        21,  5, 40, 24,  0, 12, 10, 37, 36, 22,  9, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(5.9146, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(25.8390, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(37.6681, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  91,  95, 100,
        127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 39, 20, 33, 36, 12, 24,  0,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(6.0228, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(28.2166, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(40.2623, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,
         86,  90, 106, 121, 126, 150, 158, 159, 166, 178, 195, 200, 203, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 261, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38, 30,  0,
         8, 22, 16, 31, 36, 12,  1, 39, 10, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(5.9448, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(27.5023, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(39.3918, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 2, Batch:4, loss: 9.847950, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 158, 159, 166, 178, 179, 195, 200, 203, 206,
        215, 221, 228, 232, 238, 244, 249, 250, 255, 264, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 16, 31, 36, 12, 22,  1, 39, 10, 23,  3, 32, 27, 15, 17, 28, 40, 18,
        29,  2, 24, 19,  9]))]
{'labels': tensor(5.4911, device='cuda:0'), 'center': tensor(26.9986, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 133, 137, 153, 156, 164, 166, 170, 179,
        194, 195, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 41, 24, 12, 10,  5, 37,  8, 22, 15,  1,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(5.1441, device='cuda:0'), 'center': tensor(24.1732, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  50,  56,  58,
         60,  62,  74,  83,  86,  91, 127, 133, 137, 149, 156, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39, 37,  8, 14, 38, 27, 13, 17,
        21, 40,  5, 12, 24,  0, 10, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(5.3337, device='cuda:0'), 'center': tensor(26.3728, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  83,  91,  95,
        100, 127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 26, 39, 20, 33, 36, 12, 24,
         0, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(5.4832, device='cuda:0'), 'center': tensor(28.0346, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 19
Frame 1: FP: 22.0, Misses: 22.0
Frame 2: Detected: 21
Frame 2: FP: 22.0, Misses: 22.0
Frame 3: Detected: 16
Frame 3: FP: 26.0, Misses: 26.0
Frame 4: Detected: 17
Frame 4: FP: 24.0, Misses: 24.0
moda: 0.0%, modp: 37.3%, prec: 43.7%, recall: 43.7%
Test, loss: 37.120779, Time: 2.132
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86,  91,  93, 127, 133, 137, 149, 156, 164, 166, 179,
        210, 213, 215, 220, 224, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 30,  5, 12, 24,  0, 10, 37, 36, 22,  9,  2, 16,  1, 29, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(5.7072, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(26.1603, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(37.5746, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  83,  95, 100,
        117, 127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 26, 20, 33, 39, 36, 12, 24,
         0, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(5.7277, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(28.6931, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(40.1485, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 158, 159, 166, 178, 179, 195, 200, 203, 206,
        215, 221, 238, 244, 249, 250, 255, 264, 270, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 16, 31, 36, 12, 22,  1, 39, 10, 23,  3, 32, 17, 28, 40, 18, 29,  2,
        27, 15, 24, 19,  9]))]
{'labels': tensor(5.6969, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(26.5503, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(37.9440, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         70,  74,  83,  86, 105, 106, 133, 137, 153, 156, 164, 166, 170, 179,
        194, 195, 210, 221, 234, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 38, 13, 17, 21,
         0, 30, 41, 24, 12, 10,  5, 37,  8, 22, 15,  1,  9, 28, 31, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(5.1514, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(24.2420, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(34.5449, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 3, Batch:4, loss: 8.636226, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,
         86,  90, 106, 121, 126, 158, 159, 166, 178, 179, 195, 200, 203, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38, 30,  0,
         8, 16, 31, 36, 12, 22,  1, 39, 10, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(4.8775, device='cuda:0'), 'center': tensor(27.1930, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 133, 137, 153, 156, 164, 166, 170, 179,
        194, 195, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 41, 24, 12, 10,  5, 37,  8, 22, 15,  1,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(4.5342, device='cuda:0'), 'center': tensor(24.0582, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  50,  56,  58,
         60,  62,  74,  83,  86,  91, 127, 133, 137, 149, 156, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39, 37,  8, 14, 38, 27, 13, 17,
        21, 40,  5, 12, 24,  0, 10, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(4.6859, device='cuda:0'), 'center': tensor(26.2611, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  83,  91,  95,
        100, 127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 26, 39, 20, 33, 36, 12, 24,
         0, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(4.8244, device='cuda:0'), 'center': tensor(27.9088, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 19
Frame 1: FP: 22.0, Misses: 22.0
Frame 2: Detected: 21
Frame 2: FP: 22.0, Misses: 22.0
Frame 3: Detected: 16
Frame 3: FP: 26.0, Misses: 26.0
Frame 4: Detected: 17
Frame 4: FP: 24.0, Misses: 24.0
moda: 0.0%, modp: 37.4%, prec: 43.7%, recall: 43.7%
Test, loss: 35.816308, Time: 2.158
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 133, 137, 153, 156, 164, 166, 170, 179,
        194, 195, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 41, 24, 12, 10,  5, 37,  8, 22, 15,  1,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(4.9940, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(24.0637, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(34.0516, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  50,  56,  58,
         60,  62,  74,  83,  86,  91, 127, 133, 137, 149, 156, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39, 37,  8, 14, 38, 27, 13, 17,
        21, 40,  5, 12, 24,  0, 10, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(5.1056, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(26.2367, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(36.4480, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 238, 244, 249, 250, 255, 264, 270, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 17, 28, 40, 18, 29,  2,
        27, 15, 24, 19,  9]))]
{'labels': tensor(5.1843, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(26.5042, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(36.8728, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  27,  32,  36,  40,  44,  58,  60,  74,  91,  95, 100, 127,
        133, 137, 144, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 18,  8, 29,  2,  6, 14, 37, 13, 39, 20, 33, 36, 12, 24, 23,  0,
        11, 38,  7, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(5.1110, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(27.0521, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(37.2741, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 4, Batch:4, loss: 9.318528, Time: 2.7
Testing...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 158, 159, 166, 178, 179, 195, 200, 203, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 16, 31, 36, 12, 22,  1, 39, 10, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(4.2313, device='cuda:0'), 'center': tensor(26.8755, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(3.9846, device='cuda:0'), 'center': tensor(24.5990, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  50,  56,  58,
         60,  62,  74,  83,  86,  91, 127, 133, 137, 149, 156, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39, 37,  8, 14, 38, 27, 13, 17,
        21, 40,  5, 12, 24,  0, 10, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(4.1315, device='cuda:0'), 'center': tensor(26.1276, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  83,  91,  95,
        100, 127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 26, 39, 20, 33, 36, 12, 24,
         0, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(4.2327, device='cuda:0'), 'center': tensor(27.7593, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 19
Frame 1: FP: 22.0, Misses: 22.0
Frame 2: Detected: 21
Frame 2: FP: 22.0, Misses: 22.0
Frame 3: Detected: 16
Frame 3: FP: 26.0, Misses: 26.0
Frame 4: Detected: 17
Frame 4: FP: 24.0, Misses: 24.0
moda: 0.0%, modp: 37.5%, prec: 43.7%, recall: 43.7%
Test, loss: 34.630411, Time: 2.145
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86,  92, 106, 121, 126, 158, 159, 166, 178, 179, 200, 203, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21,  1, 30,
         0,  8, 16, 31, 36, 12, 22, 39, 10, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(4.9246, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(27.0097, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(36.8590, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  30,  34,  35,  42,  44,  49,  50,  56,
         58,  60,  62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 166, 179,
        210, 215, 220, 234, 247, 251, 253, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18,  2, 11, 33, 35, 34,  6, 39, 37,  8, 14, 38, 27, 13,
        17, 21, 40, 24,  0, 12,  5, 10, 36, 22,  9, 16,  1, 30, 20,  3, 29,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(4.7896, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(25.2916, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(34.8708, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  27,  32,  36,  40,  44,  58,  60,  74,  91,  95, 100, 127,
        133, 137, 144, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 18,  8, 29,  2,  6, 14, 37, 13, 39, 20, 33, 36, 12, 24, 23,  0,
        11, 38,  7, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(4.7456, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(26.9327, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(36.4239, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  17,  25,  27,  29,  30,  34,  35,  42,  44,  49,  51,  60,
         70,  74,  86, 105, 106, 133, 136, 137, 153, 164, 166, 170, 179, 194,
        195, 210, 234, 240, 245, 248, 249, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25, 28,  7, 18,  2, 11, 34, 36, 35,  6, 40, 26, 39, 38, 13, 21,  0,
        30, 41, 10, 24, 12,  5, 37,  8, 22, 15,  1,  9, 31, 17, 20, 16, 42,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(4.4551, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(23.8191, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(32.7292, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 5, Batch:4, loss: 8.182312, Time: 2.7
Testing...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,
         86,  90, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(3.6824, device='cuda:0'), 'center': tensor(26.9951, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194, 195,
        200, 210, 221, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 38, 13, 21,  0,
        30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 28, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(3.4398, device='cuda:0'), 'center': tensor(24.4412, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  50,  56,  58,
         60,  62,  74,  83,  86, 127, 133, 137, 149, 153, 156, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39, 37,  8, 14, 38, 27, 13, 17,
        21,  5, 40, 24,  0, 12, 10, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(3.5327, device='cuda:0'), 'center': tensor(25.5417, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  83,  91,  95,
        100, 127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 26, 39, 20, 33, 36, 12, 24,
         0, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(3.6535, device='cuda:0'), 'center': tensor(27.5662, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 20
Frame 1: FP: 21.0, Misses: 21.0
Frame 2: Detected: 22
Frame 2: FP: 21.0, Misses: 21.0
Frame 3: Detected: 16
Frame 3: FP: 26.0, Misses: 26.0
Frame 4: Detected: 17
Frame 4: FP: 24.0, Misses: 24.0
moda: 0.0%, modp: 36.5%, prec: 44.9%, recall: 44.9%
Test, loss: 33.290208, Time: 2.100
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 150, 158, 159, 166, 178, 195, 200, 203, 206,
        215, 221, 238, 244, 249, 250, 255, 261, 270, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 22, 16, 31, 36, 12,  1, 39, 10, 23,  3, 32, 17, 28, 40, 18, 29,  2,
        27, 15, 24, 19,  9]))]
{'labels': tensor(4.6309, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(26.4705, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(35.7323, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  83,  91,  95,
        100, 127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 26, 39, 20, 33, 36, 12, 24,
         0, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(4.4019, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(27.5141, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(36.3179, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  30,  34,  35,  42,  44,  49,  50,  56,
         58,  60,  62,  74,  83,  86,  93, 127, 133, 137, 149, 153, 156, 166,
        179, 210, 215, 220, 224, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18,  2, 11, 33, 35, 34,  6, 39, 37,  8, 14, 38, 27, 13,
        17, 21, 30,  5, 40, 24,  0, 12, 10, 36, 22,  9, 16,  1, 29, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(4.1591, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(25.4810, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(33.7992, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         70,  74,  86, 105, 106, 133, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 210, 221, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 38, 13, 21,  0,
        30, 41, 24, 12, 10,  5, 37,  8, 22, 15,  1,  9, 28, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(3.9446, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(23.5862, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(31.4754, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 6, Batch:4, loss: 7.868854, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(3.1265, device='cuda:0'), 'center': tensor(26.6027, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(2.9415, device='cuda:0'), 'center': tensor(24.1842, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  50,  56,  58,
         60,  62,  74,  83,  86, 127, 133, 137, 149, 153, 156, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39, 37,  8, 14, 38, 27, 13, 17,
        21,  5, 40, 24,  0, 12, 10, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(3.0208, device='cuda:0'), 'center': tensor(25.3463, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  83,  91,  95,
        100, 127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 26, 39, 20, 33, 36, 12, 24,
         0, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(3.0964, device='cuda:0'), 'center': tensor(27.3184, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 21
Frame 1: FP: 20.0, Misses: 20.0
Frame 2: Detected: 22
Frame 2: FP: 21.0, Misses: 21.0
Frame 3: Detected: 16
Frame 3: FP: 26.0, Misses: 26.0
Frame 4: Detected: 17
Frame 4: FP: 24.0, Misses: 24.0
moda: 0.0%, modp: 36.5%, prec: 45.5%, recall: 45.5%
Test, loss: 31.955484, Time: 2.169
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  83,  95, 100,
        127, 133, 137, 149, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 26, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(4.1226, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(27.4132, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(35.6584, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  30,  34,  35,  42,  44,  49,  56,  58,
         60,  62,  74,  83,  86, 127, 133, 137, 149, 153, 156, 164, 166, 179,
        210, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18,  2, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17,
        21,  5, 40, 24,  0, 12, 10, 37, 36, 22,  9, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(3.8035, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(25.1233, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(32.7304, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(3.9008, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(26.5129, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(34.3145, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(3.6288, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(23.9817, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(31.2393, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 7, Batch:4, loss: 7.809819, Time: 2.6
Testing...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(2.6549, device='cuda:0'), 'center': tensor(26.4071, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(2.5128, device='cuda:0'), 'center': tensor(23.8969, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 127, 133, 137, 149, 153, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
         5, 40, 24,  0, 12, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(2.5678, device='cuda:0'), 'center': tensor(24.8731, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  83,  91,  95,
        100, 127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 26, 39, 20, 33, 36, 12, 24,
         0, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(2.6167, device='cuda:0'), 'center': tensor(27.0090, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 22
Frame 1: FP: 19.0, Misses: 19.0
Frame 2: Detected: 22
Frame 2: FP: 21.0, Misses: 21.0
Frame 3: Detected: 16
Frame 3: FP: 26.0, Misses: 26.0
Frame 4: Detected: 17
Frame 4: FP: 24.0, Misses: 24.0
moda: 0.0%, modp: 36.9%, prec: 46.1%, recall: 46.1%
Test, loss: 30.722676, Time: 2.114
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 117,
        133, 137, 144, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 39, 12, 24, 36,  0,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(3.6621, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(27.7373, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(35.0615, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(3.6165, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(26.5726, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(33.8055, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  30,  34,  35,  42,  44,  49,  56,  58,
         60,  62,  74,  83,  86,  93, 127, 133, 137, 149, 153, 156, 164, 166,
        179, 210, 215, 220, 224, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18,  2, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17,
        21, 30,  5, 40, 24,  0, 12, 10, 37, 36, 22,  9, 16,  1, 29, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(3.4466, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(24.7719, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(31.6652, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(3.1619, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(23.6508, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(29.9745, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 8, Batch:4, loss: 7.493626, Time: 2.8
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(2.2066, device='cuda:0'), 'center': tensor(26.1490, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(2.0688, device='cuda:0'), 'center': tensor(23.5372, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 127, 133, 137, 149, 153, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
         5, 40, 24,  0, 12, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(2.1236, device='cuda:0'), 'center': tensor(24.5712, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 149, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(2.1712, device='cuda:0'), 'center': tensor(26.8030, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 22
Frame 1: FP: 19.0, Misses: 19.0
Frame 2: Detected: 22
Frame 2: FP: 21.0, Misses: 21.0
Frame 3: Detected: 16
Frame 3: FP: 26.0, Misses: 26.0
Frame 4: Detected: 17
Frame 4: FP: 24.0, Misses: 24.0
moda: 0.0%, modp: 37.4%, prec: 46.1%, recall: 46.1%
Test, loss: 29.550203, Time: 2.122
Training...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  30,  34,  35,  42,  44,  49,  56,  58,
         60,  62,  74,  83,  86,  91, 133, 137, 149, 155, 156, 164, 166, 179,
        210, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18,  2, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17,
        21, 40, 12, 24,  0,  5, 10, 37, 36, 22,  9, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(3.1251, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(24.5926, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(30.8427, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(3.1545, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(26.3083, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(32.6173, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  17,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,
         60,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25, 28,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(2.9068, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(23.6257, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(29.4394, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 117,
        127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 39, 36, 12, 24,  0,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(2.9292, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(27.1014, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(32.9599, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 9, Batch:4, loss: 8.239972, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(1.7580, device='cuda:0'), 'center': tensor(25.8448, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(1.6510, device='cuda:0'), 'center': tensor(23.0991, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 127, 133, 137, 149, 153, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
         5, 40, 24,  0, 12, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(1.6915, device='cuda:0'), 'center': tensor(24.2000, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 149, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(1.7292, device='cuda:0'), 'center': tensor(26.3788, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 22
Frame 1: FP: 19.0, Misses: 19.0
Frame 2: Detected: 22
Frame 2: FP: 21.0, Misses: 21.0
Frame 3: Detected: 17
Frame 3: FP: 25.0, Misses: 25.0
Frame 4: Detected: 18
Frame 4: FP: 23.0, Misses: 23.0
moda: 0.0%, modp: 37.0%, prec: 47.3%, recall: 47.3%
Test, loss: 28.295537, Time: 2.084
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 133, 137, 153, 156, 164, 166, 170, 179,
        194, 195, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 41, 24, 12, 10,  5, 37,  8, 22, 15,  1,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(2.6357, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(22.4186, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(27.6899, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  91,  95, 100,
        127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 39, 20, 33, 36, 12, 24,  0,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(2.7377, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(26.1869, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(31.6623, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(2.4996, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(23.5076, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(28.5068, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(2.5413, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(25.6086, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(30.6912, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 10, Batch:4, loss: 7.672795, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(1.3224, device='cuda:0'), 'center': tensor(25.5290, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(1.2426, device='cuda:0'), 'center': tensor(22.5683, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(1.2816, device='cuda:0'), 'center': tensor(23.2510, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 149, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(1.2960, device='cuda:0'), 'center': tensor(25.8386, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 22
Frame 1: FP: 19.0, Misses: 19.0
Frame 2: Detected: 22
Frame 2: FP: 21.0, Misses: 21.0
Frame 3: Detected: 17
Frame 3: FP: 25.0, Misses: 25.0
Frame 4: Detected: 18
Frame 4: FP: 23.0, Misses: 23.0
moda: 0.0%, modp: 37.5%, prec: 47.3%, recall: 47.3%
Test, loss: 26.868063, Time: 2.108
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 158, 159, 166, 178, 179, 195, 200, 203, 206,
        215, 221, 238, 244, 249, 250, 255, 264, 270, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 16, 31, 36, 12, 22,  1, 39, 10, 23,  3, 32, 17, 28, 40, 18, 29,  2,
        27, 15, 24, 19,  9]))]
{'labels': tensor(2.3881, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(25.0268, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(29.8030, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(2.1683, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(22.4466, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(26.7832, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  30,  34,  35,  42,  44,  49,  56,  58,
         60,  62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179,
        210, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18,  2, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17,
        21, 40, 24,  0, 12,  5, 10, 37, 36, 22,  9, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(2.1159, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(23.1030, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(27.3348, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  83,  95, 100,
        127, 133, 137, 149, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 26, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(2.0103, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(25.3760, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(29.3967, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 11, Batch:4, loss: 7.349172, Time: 2.7
Testing...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.9579, device='cuda:0'), 'center': tensor(25.0929, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.8976, device='cuda:0'), 'center': tensor(21.9868, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.9250, device='cuda:0'), 'center': tensor(22.7655, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 149, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.9319, device='cuda:0'), 'center': tensor(25.2655, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 22
Frame 1: FP: 19.0, Misses: 19.0
Frame 2: Detected: 22
Frame 2: FP: 21.0, Misses: 21.0
Frame 3: Detected: 17
Frame 3: FP: 25.0, Misses: 25.0
Frame 4: Detected: 18
Frame 4: FP: 23.0, Misses: 23.0
moda: 0.0%, modp: 37.7%, prec: 47.3%, recall: 47.3%
Test, loss: 25.633816, Time: 2.253
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(1.8189, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(21.9803, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(25.6180, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(1.7917, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(22.6635, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(26.2468, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(1.7248, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(25.1452, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(28.5948, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 117,
        127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 39, 36, 12, 24,  0,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(1.6849, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(25.3694, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(28.7392, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 12, Batch:4, loss: 7.184792, Time: 2.7
Testing...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.6840, device='cuda:0'), 'center': tensor(24.6635, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.6396, device='cuda:0'), 'center': tensor(21.3209, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6560, device='cuda:0'), 'center': tensor(22.1699, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 149, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6578, device='cuda:0'), 'center': tensor(24.6025, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 22
Frame 1: FP: 19.0, Misses: 19.0
Frame 2: Detected: 23
Frame 2: FP: 20.0, Misses: 20.0
Frame 3: Detected: 18
Frame 3: FP: 24.0, Misses: 24.0
Frame 4: Detected: 19
Frame 4: FP: 22.0, Misses: 22.0
moda: 0.0%, modp: 37.2%, prec: 49.1%, recall: 49.1%
Test, loss: 24.507855, Time: 2.123
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 149, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(1.5734, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(24.6093, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(27.7561, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 238, 244, 249, 250, 255, 264, 270, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 17, 28, 40, 18, 29,  2,
        27, 15, 24, 19,  9]))]
{'labels': tensor(1.5091, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(24.0699, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(27.0881, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(1.3373, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(21.0186, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(23.6933, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(1.2191, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(21.7388, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(24.1770, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 13, Batch:4, loss: 6.044246, Time: 2.8
Testing...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.5140, device='cuda:0'), 'center': tensor(24.1415, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.4817, device='cuda:0'), 'center': tensor(20.6330, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4907, device='cuda:0'), 'center': tensor(21.5831, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4841, device='cuda:0'), 'center': tensor(23.8026, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 22
Frame 1: FP: 19.0, Misses: 19.0
Frame 2: Detected: 23
Frame 2: FP: 20.0, Misses: 20.0
Frame 3: Detected: 18
Frame 3: FP: 24.0, Misses: 24.0
Frame 4: Detected: 19
Frame 4: FP: 22.0, Misses: 22.0
moda: 0.0%, modp: 38.0%, prec: 49.1%, recall: 49.1%
Test, loss: 23.525335, Time: 2.179
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 149, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(1.2025, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(23.8309, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(26.2359, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(1.1073, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(21.4360, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(23.6506, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(1.0175, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(20.2794, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(22.3144, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 240, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(1.0140, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(24.0445, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(26.0724, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 14, Batch:4, loss: 6.518093, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.4378, device='cuda:0'), 'center': tensor(23.6815, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.4122, device='cuda:0'), 'center': tensor(19.8893, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4187, device='cuda:0'), 'center': tensor(20.8403, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4063, device='cuda:0'), 'center': tensor(22.9409, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 23
Frame 1: FP: 18.0, Misses: 18.0
Frame 2: Detected: 23
Frame 2: FP: 20.0, Misses: 20.0
Frame 3: Detected: 18
Frame 3: FP: 24.0, Misses: 24.0
Frame 4: Detected: 19
Frame 4: FP: 22.0, Misses: 22.0
moda: 0.0%, modp: 38.7%, prec: 49.7%, recall: 49.7%
Test, loss: 22.675534, Time: 2.156
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.9021, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(19.8756, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(21.6799, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.8682, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(22.8008, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(24.5372, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.8556, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(20.5335, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(22.2447, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.8055, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(23.2448, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(24.8557, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 15, Batch:4, loss: 6.213926, Time: 2.6
Testing...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.4303, device='cuda:0'), 'center': tensor(23.1396, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.4086, device='cuda:0'), 'center': tensor(19.0578, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4139, device='cuda:0'), 'center': tensor(20.1306, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3972, device='cuda:0'), 'center': tensor(22.0821, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 23
Frame 1: FP: 18.0, Misses: 18.0
Frame 2: Detected: 23
Frame 2: FP: 20.0, Misses: 20.0
Frame 3: Detected: 19
Frame 3: FP: 23.0, Misses: 23.0
Frame 4: Detected: 19
Frame 4: FP: 22.0, Misses: 22.0
moda: 0.6%, modp: 39.4%, prec: 50.3%, recall: 50.3%
Test, loss: 21.927470, Time: 2.228
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.6961, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(19.0920, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(20.4842, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.7441, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(23.1800, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(24.6682, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 149, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6679, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(21.7590, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(23.0947, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6347, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(19.7501, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(21.0195, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 16, Batch:4, loss: 5.254882, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.4619, device='cuda:0'), 'center': tensor(22.4222, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.4434, device='cuda:0'), 'center': tensor(18.2183, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4488, device='cuda:0'), 'center': tensor(19.4955, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4289, device='cuda:0'), 'center': tensor(21.2445, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 23
Frame 1: FP: 18.0, Misses: 18.0
Frame 2: Detected: 25
Frame 2: FP: 18.0, Misses: 18.0
Frame 3: Detected: 19
Frame 3: FP: 23.0, Misses: 23.0
Frame 4: Detected: 19
Frame 4: FP: 22.0, Misses: 22.0
moda: 3.0%, modp: 39.7%, prec: 51.5%, recall: 51.5%
Test, loss: 21.236590, Time: 2.134
Training...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6152, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(21.2583, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(22.4887, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5792, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(19.3443, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(20.5026, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.5246, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(17.8528, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(18.9019, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.5722, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(22.2601, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(23.4046, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 17, Batch:4, loss: 5.851140, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.5105, device='cuda:0'), 'center': tensor(21.8834, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.4929, device='cuda:0'), 'center': tensor(17.4522, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4995, device='cuda:0'), 'center': tensor(18.6777, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4779, device='cuda:0'), 'center': tensor(20.2824, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 23
Frame 1: FP: 18.0, Misses: 18.0
Frame 2: Detected: 26
Frame 2: FP: 17.0, Misses: 17.0
Frame 3: Detected: 19
Frame 3: FP: 23.0, Misses: 23.0
Frame 4: Detected: 20
Frame 4: FP: 21.0, Misses: 21.0
moda: 5.4%, modp: 40.1%, prec: 52.7%, recall: 52.7%
Test, loss: 20.564294, Time: 2.182
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.5315, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(22.0393, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(23.1024, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.4896, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(17.2783, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(18.2575, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4739, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(18.4565, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(19.4043, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4772, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(19.7218, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(20.6762, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 18, Batch:4, loss: 5.169047, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.5632, device='cuda:0'), 'center': tensor(21.0657, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.5472, device='cuda:0'), 'center': tensor(16.6353, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5520, device='cuda:0'), 'center': tensor(18.0416, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.5299, device='cuda:0'), 'center': tensor(19.4949, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 24
Frame 1: FP: 17.0, Misses: 17.0
Frame 2: Detected: 28
Frame 2: FP: 15.0, Misses: 15.0
Frame 3: Detected: 19
Frame 3: FP: 23.0, Misses: 23.0
Frame 4: Detected: 19
Frame 4: FP: 22.0, Misses: 22.0
moda: 7.8%, modp: 40.3%, prec: 53.9%, recall: 53.9%
Test, loss: 19.905495, Time: 2.157
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 195,
        200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.4728, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(17.1284, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(18.0740, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 158, 159, 166, 178, 179, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 16, 31, 36, 12, 22,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.4641, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(20.8738, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(21.8019, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4313, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(19.0908, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(19.9534, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4463, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(17.6289, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(18.5215, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 19, Batch:4, loss: 4.630376, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.6113, device='cuda:0'), 'center': tensor(20.5314, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 195,
        200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.5962, device='cuda:0'), 'center': tensor(16.2272, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6004, device='cuda:0'), 'center': tensor(17.4244, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.5774, device='cuda:0'), 'center': tensor(18.6145, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 24
Frame 1: FP: 17.0, Misses: 17.0
Frame 2: Detected: 30
Frame 2: FP: 13.0, Misses: 13.0
Frame 3: Detected: 20
Frame 3: FP: 22.0, Misses: 22.0
Frame 4: Detected: 19
Frame 4: FP: 22.0, Misses: 22.0
moda: 11.4%, modp: 40.2%, prec: 55.7%, recall: 55.7%
Test, loss: 19.391965, Time: 2.209
Training...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4183, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(17.5041, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(18.3406, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.4489, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(20.4144, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(21.3123, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4365, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(18.2674, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(19.1404, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.4263, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(15.4113, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(16.2639, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 20, Batch:4, loss: 4.065963, Time: 2.8
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.6503, device='cuda:0'), 'center': tensor(19.8879, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 195,
        200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.6357, device='cuda:0'), 'center': tensor(15.5099, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6402, device='cuda:0'), 'center': tensor(16.8344, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6172, device='cuda:0'), 'center': tensor(17.7357, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 24
Frame 1: FP: 17.0, Misses: 17.0
Frame 2: Detected: 30
Frame 2: FP: 13.0, Misses: 13.0
Frame 3: Detected: 21
Frame 3: FP: 21.0, Misses: 21.0
Frame 4: Detected: 20
Frame 4: FP: 21.0, Misses: 21.0
moda: 13.8%, modp: 40.6%, prec: 56.9%, recall: 56.9%
Test, loss: 18.763659, Time: 2.169
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.4127, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(19.8997, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(20.7250, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4253, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(17.5310, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(18.3816, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4063, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(16.5865, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(17.3992, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4157, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(15.3073, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(16.1387, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 21, Batch:4, loss: 4.034666, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 264, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(0.6806, device='cuda:0'), 'center': tensor(19.1236, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 195,
        200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 27, 32, 23, 33]))]
{'labels': tensor(0.6679, device='cuda:0'), 'center': tensor(14.7639, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6703, device='cuda:0'), 'center': tensor(16.1972, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6473, device='cuda:0'), 'center': tensor(16.8529, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 25
Frame 1: FP: 16.0, Misses: 16.0
Frame 2: Detected: 30
Frame 2: FP: 13.0, Misses: 13.0
Frame 3: Detected: 20
Frame 3: FP: 22.0, Misses: 22.0
Frame 4: Detected: 20
Frame 4: FP: 21.0, Misses: 21.0
moda: 13.8%, modp: 42.0%, prec: 56.9%, recall: 56.9%
Test, loss: 18.067476, Time: 2.178
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4060, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(16.8320, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(17.6440, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4139, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(14.8095, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(15.6372, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38, 30,  0,  8,
        10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4242, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(18.9437, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(19.7921, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4101, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(15.7208, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(16.5410, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 22, Batch:4, loss: 4.135238, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,  74,
         86, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,  8,
        10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.6989, device='cuda:0'), 'center': tensor(18.2760, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.6879, device='cuda:0'), 'center': tensor(14.1031, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6918, device='cuda:0'), 'center': tensor(15.5479, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6685, device='cuda:0'), 'center': tensor(15.9523, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 27
Frame 1: FP: 14.0, Misses: 14.0
Frame 2: Detected: 30
Frame 2: FP: 13.0, Misses: 13.0
Frame 3: Detected: 20
Frame 3: FP: 22.0, Misses: 22.0
Frame 4: Detected: 21
Frame 4: FP: 20.0, Misses: 20.0
moda: 17.4%, modp: 42.5%, prec: 58.7%, recall: 58.7%
Test, loss: 17.343347, Time: 2.165
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4031, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(15.6043, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(16.4105, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3926, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(15.8102, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(16.5953, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3985, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(13.7812, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(14.5781, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,  74,
         86, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,  8,
        10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4210, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(17.9602, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(18.8022, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 23, Batch:4, loss: 4.700538, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,  74,
         86, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,  8,
        10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.7103, device='cuda:0'), 'center': tensor(17.8264, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.7000, device='cuda:0'), 'center': tensor(13.3590, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.7035, device='cuda:0'), 'center': tensor(14.6135, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6791, device='cuda:0'), 'center': tensor(15.1300, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 26
Frame 1: FP: 15.0, Misses: 15.0
Frame 2: Detected: 30
Frame 2: FP: 13.0, Misses: 13.0
Frame 3: Detected: 21
Frame 3: FP: 21.0, Misses: 21.0
Frame 4: Detected: 22
Frame 4: FP: 19.0, Misses: 19.0
moda: 18.6%, modp: 43.5%, prec: 59.3%, recall: 59.3%
Test, loss: 16.628645, Time: 2.181
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3927, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(15.2067, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(15.9922, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4154, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(14.5668, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(15.3975, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3974, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(13.0762, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(13.8710, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90, 121, 125, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  0, 30,  8,
        10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4094, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(17.7799, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(18.5986, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 24, Batch:4, loss: 4.649652, Time: 2.7
Testing...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38, 30,  0,  8,
        10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.7163, device='cuda:0'), 'center': tensor(17.4749, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.7057, device='cuda:0'), 'center': tensor(12.6620, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.7095, device='cuda:0'), 'center': tensor(13.8957, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6846, device='cuda:0'), 'center': tensor(14.3275, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 25
Frame 1: FP: 16.0, Misses: 16.0
Frame 2: Detected: 30
Frame 2: FP: 13.0, Misses: 13.0
Frame 3: Detected: 23
Frame 3: FP: 19.0, Misses: 19.0
Frame 4: Detected: 24
Frame 4: FP: 17.0, Misses: 17.0
moda: 22.2%, modp: 43.5%, prec: 61.1%, recall: 61.1%
Test, loss: 15.998103, Time: 2.130
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4009, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(13.9283, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(14.7301, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3837, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(14.2047, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(14.9720, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4074, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(12.3491, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(13.1639, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38, 30,  0,  8,
        10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4374, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(17.0655, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(17.9403, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 25, Batch:4, loss: 4.485075, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 106, 121, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1, 30,  0,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.7136, device='cuda:0'), 'center': tensor(16.7935, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.7048, device='cuda:0'), 'center': tensor(12.0113, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.7086, device='cuda:0'), 'center': tensor(13.2133, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6833, device='cuda:0'), 'center': tensor(13.6420, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 25
Frame 1: FP: 16.0, Misses: 16.0
Frame 2: Detected: 30
Frame 2: FP: 13.0, Misses: 13.0
Frame 3: Detected: 25
Frame 3: FP: 17.0, Misses: 17.0
Frame 4: Detected: 25
Frame 4: FP: 16.0, Misses: 16.0
moda: 25.7%, modp: 44.1%, prec: 62.9%, recall: 62.9%
Test, loss: 15.320152, Time: 2.082
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4008, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(13.6803, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(14.4819, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90, 106, 121, 126, 136, 150, 158, 159, 166, 178, 195, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38, 30,  0,  8,
        10, 22, 16, 31, 36, 12,  1, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4131, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(16.6273, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(17.4536, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  56,  58,  60,  62,
         74,  86, 133, 137, 149, 153, 155, 156, 158, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6,  8, 14, 38, 27, 13, 21, 40, 24,
         0, 12,  5, 10, 39, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3913, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(13.2600, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(14.0426, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3867, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(11.6600, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(12.4334, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 26, Batch:4, loss: 3.108350, Time: 2.6
Testing...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 106, 121, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1, 30,  0,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.7067, device='cuda:0'), 'center': tensor(15.8345, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.6993, device='cuda:0'), 'center': tensor(11.4632, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6999, device='cuda:0'), 'center': tensor(12.8538, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6773, device='cuda:0'), 'center': tensor(12.9761, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 24
Frame 1: FP: 17.0, Misses: 17.0
Frame 2: Detected: 30
Frame 2: FP: 13.0, Misses: 13.0
Frame 3: Detected: 25
Frame 3: FP: 17.0, Misses: 17.0
Frame 4: Detected: 27
Frame 4: FP: 14.0, Misses: 14.0
moda: 26.9%, modp: 45.2%, prec: 63.5%, recall: 63.5%
Test, loss: 14.673468, Time: 2.127
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3779, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(12.9253, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(13.6812, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 106, 121, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1, 30,  0,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4194, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(15.7183, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(16.5571, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3959, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(12.8254, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(13.6173, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3951, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(11.2038, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(11.9941, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 27, Batch:4, loss: 2.998522, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.7017, device='cuda:0'), 'center': tensor(15.0364, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.6953, device='cuda:0'), 'center': tensor(10.9490, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6989, device='cuda:0'), 'center': tensor(12.4549, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6743, device='cuda:0'), 'center': tensor(12.3638, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 25
Frame 1: FP: 16.0, Misses: 16.0
Frame 2: Detected: 31
Frame 2: FP: 12.0, Misses: 12.0
Frame 3: Detected: 25
Frame 3: FP: 17.0, Misses: 17.0
Frame 4: Detected: 27
Frame 4: FP: 14.0, Misses: 14.0
moda: 29.3%, modp: 46.0%, prec: 64.7%, recall: 64.7%
Test, loss: 14.086180, Time: 2.141
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4208, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(15.0843, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(15.9258, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3991, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(10.8432, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(11.6414, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  56,  58,  60,  62,
         74,  86, 133, 137, 149, 153, 155, 156, 158, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6,  8, 14, 38, 27, 13, 21, 40, 24,
         0, 12,  5, 10, 39, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3895, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(12.6299, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(13.4089, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3859, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(12.1915, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(12.9632, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 28, Batch:4, loss: 3.240798, Time: 2.8
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.6932, device='cuda:0'), 'center': tensor(14.2261, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.6885, device='cuda:0'), 'center': tensor(10.3372, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6904, device='cuda:0'), 'center': tensor(12.1193, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6686, device='cuda:0'), 'center': tensor(11.9967, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 25
Frame 1: FP: 16.0, Misses: 16.0
Frame 2: Detected: 32
Frame 2: FP: 11.0, Misses: 11.0
Frame 3: Detected: 25
Frame 3: FP: 17.0, Misses: 17.0
Frame 4: Detected: 27
Frame 4: FP: 14.0, Misses: 14.0
moda: 30.5%, modp: 47.1%, prec: 65.3%, recall: 65.3%
Test, loss: 13.540175, Time: 2.201
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4059, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(10.3255, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(11.1372, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4184, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(12.0353, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(12.8722, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3950, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(14.3158, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(15.1059, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3874, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(11.6742, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(12.4491, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 29, Batch:4, loss: 3.112272, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.6853, device='cuda:0'), 'center': tensor(13.9455, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.6829, device='cuda:0'), 'center': tensor(9.8318, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6848, device='cuda:0'), 'center': tensor(11.4243, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6649, device='cuda:0'), 'center': tensor(11.5072, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 25
Frame 1: FP: 16.0, Misses: 16.0
Frame 2: Detected: 34
Frame 2: FP: 9.0, Misses: 9.0
Frame 3: Detected: 27
Frame 3: FP: 15.0, Misses: 15.0
Frame 4: Detected: 28
Frame 4: FP: 13.0, Misses: 13.0
moda: 36.5%, modp: 46.5%, prec: 68.3%, recall: 68.3%
Test, loss: 13.036162, Time: 2.158
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3828, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(9.9678, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(10.7333, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4097, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(11.4506, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(12.2699, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4006, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(11.4313, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(12.2324, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4157, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(14.0499, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(14.8813, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 30, Batch:4, loss: 3.720314, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.6759, device='cuda:0'), 'center': tensor(13.7272, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.6734, device='cuda:0'), 'center': tensor(9.4563, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6769, device='cuda:0'), 'center': tensor(10.8087, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6565, device='cuda:0'), 'center': tensor(10.9677, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 26
Frame 1: FP: 15.0, Misses: 15.0
Frame 2: Detected: 34
Frame 2: FP: 9.0, Misses: 9.0
Frame 3: Detected: 27
Frame 3: FP: 15.0, Misses: 15.0
Frame 4: Detected: 28
Frame 4: FP: 13.0, Misses: 13.0
moda: 37.7%, modp: 47.8%, prec: 68.9%, recall: 68.9%
Test, loss: 12.581347, Time: 2.224
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  56,  58,  60,  62,
         74,  86, 133, 137, 149, 153, 155, 156, 158, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6,  8, 14, 38, 27, 13, 21, 40, 24,
         0, 12,  5, 10, 39, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4012, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(11.0017, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(11.8041, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3853, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(9.4173, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(10.1879, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3968, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(13.6990, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(14.4927, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3860, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(10.6632, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(11.4351, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 31, Batch:4, loss: 2.858782, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.6651, device='cuda:0'), 'center': tensor(13.0691, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.6633, device='cuda:0'), 'center': tensor(9.1354, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6651, device='cuda:0'), 'center': tensor(10.4910, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6463, device='cuda:0'), 'center': tensor(10.5742, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 27
Frame 1: FP: 14.0, Misses: 14.0
Frame 2: Detected: 35
Frame 2: FP: 8.0, Misses: 8.0
Frame 3: Detected: 28
Frame 3: FP: 14.0, Misses: 14.0
Frame 4: Detected: 28
Frame 4: FP: 13.0, Misses: 13.0
moda: 41.3%, modp: 47.7%, prec: 70.7%, recall: 70.7%
Test, loss: 12.137292, Time: 2.168
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3747, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(9.1664, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(9.9157, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4069, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(10.7176, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(11.5314, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4181, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(10.5167, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(11.3529, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4249, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(13.0583, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(13.9081, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 32, Batch:4, loss: 3.477028, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.6608, device='cuda:0'), 'center': tensor(12.5512, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.6594, device='cuda:0'), 'center': tensor(8.8191, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6595, device='cuda:0'), 'center': tensor(10.2978, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6429, device='cuda:0'), 'center': tensor(10.1715, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 28
Frame 1: FP: 13.0, Misses: 13.0
Frame 2: Detected: 36
Frame 2: FP: 7.0, Misses: 7.0
Frame 3: Detected: 27
Frame 3: FP: 15.0, Misses: 15.0
Frame 4: Detected: 28
Frame 4: FP: 13.0, Misses: 13.0
moda: 42.5%, modp: 48.2%, prec: 71.3%, recall: 71.3%
Test, loss: 11.771156, Time: 2.178
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4173, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(10.3694, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(11.2040, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4000, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(12.4704, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(13.2703, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3740, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(8.9435, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(9.6916, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3885, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(9.9824, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(10.7594, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 33, Batch:4, loss: 2.689858, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.6486, device='cuda:0'), 'center': tensor(11.8932, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.6459, device='cuda:0'), 'center': tensor(8.6428, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6458, device='cuda:0'), 'center': tensor(10.0815, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6302, device='cuda:0'), 'center': tensor(9.9090, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 29
Frame 1: FP: 12.0, Misses: 12.0
Frame 2: Detected: 35
Frame 2: FP: 8.0, Misses: 8.0
Frame 3: Detected: 29
Frame 3: FP: 13.0, Misses: 13.0
Frame 4: Detected: 29
Frame 4: FP: 12.0, Misses: 12.0
moda: 46.1%, modp: 47.2%, prec: 73.1%, recall: 73.1%
Test, loss: 11.416839, Time: 2.137
Training...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3998, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(12.1633, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(12.9629, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4039, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(9.9138, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(10.7216, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4135, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(8.1216, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.9486, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3979, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(10.0901, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(10.8859, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 34, Batch:4, loss: 2.721464, Time: 2.7
Testing...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.6494, device='cuda:0'), 'center': tensor(11.4165, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12, 10,  5, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.6454, device='cuda:0'), 'center': tensor(8.4711, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6474, device='cuda:0'), 'center': tensor(9.8055, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6341, device='cuda:0'), 'center': tensor(9.4099, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 30
Frame 1: FP: 11.0, Misses: 11.0
Frame 2: Detected: 35
Frame 2: FP: 8.0, Misses: 8.0
Frame 3: Detected: 29
Frame 3: FP: 13.0, Misses: 13.0
Frame 4: Detected: 29
Frame 4: FP: 12.0, Misses: 12.0
moda: 47.3%, modp: 48.7%, prec: 73.7%, recall: 73.7%
Test, loss: 11.063892, Time: 2.167
Training...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3795, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(11.7209, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(12.4799, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 153, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24, 12,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3851, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.9104, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.6805, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3854, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(9.3005, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(10.0714, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3917, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(9.4828, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(10.2662, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 35, Batch:4, loss: 2.566546, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.6102, device='cuda:0'), 'center': tensor(11.5297, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.6109, device='cuda:0'), 'center': tensor(7.7312, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6165, device='cuda:0'), 'center': tensor(9.1673, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6010, device='cuda:0'), 'center': tensor(9.0144, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 29
Frame 1: FP: 12.0, Misses: 12.0
Frame 2: Detected: 36
Frame 2: FP: 7.0, Misses: 7.0
Frame 3: Detected: 29
Frame 3: FP: 13.0, Misses: 13.0
Frame 4: Detected: 29
Frame 4: FP: 12.0, Misses: 12.0
moda: 47.3%, modp: 50.4%, prec: 73.7%, recall: 73.7%
Test, loss: 10.579933, Time: 2.225
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4137, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(11.6638, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(12.4911, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4013, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(8.9771, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(9.7796, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  56,  58,  60,  62,
         74,  86, 133, 137, 149, 153, 155, 156, 158, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6,  8, 14, 38, 27, 13, 21, 40, 24,
         0, 12,  5, 10, 39, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3971, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(9.2326, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(10.0267, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 155, 156, 166, 170, 178, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24,  5, 10, 37,  8, 12, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3925, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.7841, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.5690, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 36, Batch:4, loss: 2.142242, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5987, device='cuda:0'), 'center': tensor(11.3396, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.5921, device='cuda:0'), 'center': tensor(7.6234, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5879, device='cuda:0'), 'center': tensor(8.6278, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.5766, device='cuda:0'), 'center': tensor(8.6790, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 28
Frame 1: FP: 13.0, Misses: 13.0
Frame 2: Detected: 36
Frame 2: FP: 7.0, Misses: 7.0
Frame 3: Detected: 31
Frame 3: FP: 11.0, Misses: 11.0
Frame 4: Detected: 29
Frame 4: FP: 12.0, Misses: 12.0
moda: 48.5%, modp: 51.0%, prec: 74.3%, recall: 74.3%
Test, loss: 10.245120, Time: 2.227
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3996, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(8.7736, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(9.5728, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3851, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.5633, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.3336, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3896, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(11.5051, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(12.2843, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3768, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(8.4959, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(9.2494, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 37, Batch:4, loss: 2.312359, Time: 2.6
Testing...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.6201, device='cuda:0'), 'center': tensor(10.4455, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.6234, device='cuda:0'), 'center': tensor(7.4128, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.6206, device='cuda:0'), 'center': tensor(8.4557, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.6125, device='cuda:0'), 'center': tensor(8.3819, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 30
Frame 1: FP: 11.0, Misses: 11.0
Frame 2: Detected: 36
Frame 2: FP: 7.0, Misses: 7.0
Frame 3: Detected: 31
Frame 3: FP: 11.0, Misses: 11.0
Frame 4: Detected: 29
Frame 4: FP: 12.0, Misses: 12.0
moda: 50.9%, modp: 50.6%, prec: 75.4%, recall: 75.4%
Test, loss: 9.912237, Time: 2.106
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3959, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(8.7287, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(9.5205, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3936, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(8.5077, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(9.2949, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4199, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(10.6139, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(11.4537, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3999, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.5023, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.3022, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 38, Batch:4, loss: 2.075538, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 117, 121, 125, 126, 136, 150, 158, 159, 166, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1, 12,  0,
        30,  8, 10, 22, 16, 31, 36, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5758, device='cuda:0'), 'center': tensor(10.1206, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.5698, device='cuda:0'), 'center': tensor(7.4866, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5797, device='cuda:0'), 'center': tensor(8.0544, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.5819, device='cuda:0'), 'center': tensor(8.0829, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 31
Frame 1: FP: 10.0, Misses: 10.0
Frame 2: Detected: 33
Frame 2: FP: 10.0, Misses: 10.0
Frame 3: Detected: 33
Frame 3: FP: 9.0, Misses: 9.0
Frame 4: Detected: 30
Frame 4: FP: 11.0, Misses: 11.0
moda: 52.1%, modp: 49.8%, prec: 76.0%, recall: 76.0%
Test, loss: 9.589725, Time: 2.132
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3970, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.3817, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.1756, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3888, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(8.0952, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.8729, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3851, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(8.1805, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.9507, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4156, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(11.0385, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(11.8698, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 39, Batch:4, loss: 2.967441, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  70,  72,  74,  86,  90,
         92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215, 221,
        228, 238, 244, 249, 250, 255, 264, 270, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 37,  5, 13, 21, 38,  1,  0, 30,  8,
        10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2, 26,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5845, device='cuda:0'), 'center': tensor(11.2623, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 137, 155, 156, 166, 170, 178, 179, 195,
        200, 210, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 24,  5, 10, 37,  8, 12, 22,  1, 41,  9, 31, 17, 20, 16,  3,  4,
        29, 25, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.5713, device='cuda:0'), 'center': tensor(7.1474, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5621, device='cuda:0'), 'center': tensor(7.3110, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.5575, device='cuda:0'), 'center': tensor(8.1177, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 25
Frame 1: FP: 16.0, Misses: 16.0
Frame 2: Detected: 35
Frame 2: FP: 8.0, Misses: 8.0
Frame 3: Detected: 33
Frame 3: FP: 9.0, Misses: 9.0
Frame 4: Detected: 30
Frame 4: FP: 11.0, Misses: 11.0
moda: 47.3%, modp: 53.1%, prec: 73.7%, recall: 73.7%
Test, loss: 9.597248, Time: 2.109
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3853, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.9947, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.7653, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4119, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(10.6528, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(11.4766, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3730, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.8362, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.5822, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4072, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.8954, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.7098, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 40, Batch:4, loss: 2.177455, Time: 2.8
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 117, 121, 125, 126, 136, 150, 158, 159, 166, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1, 12,  0,
        30,  8, 10, 22, 16, 31, 36, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5451, device='cuda:0'), 'center': tensor(9.4306, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.5307, device='cuda:0'), 'center': tensor(7.2476, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5422, device='cuda:0'), 'center': tensor(8.2245, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.5537, device='cuda:0'), 'center': tensor(7.9798, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 33
Frame 1: FP: 8.0, Misses: 8.0
Frame 2: Detected: 34
Frame 2: FP: 9.0, Misses: 9.0
Frame 3: Detected: 34
Frame 3: FP: 8.0, Misses: 8.0
Frame 4: Detected: 31
Frame 4: FP: 10.0, Misses: 10.0
moda: 58.1%, modp: 47.4%, prec: 79.0%, recall: 79.0%
Test, loss: 9.306477, Time: 2.248
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4023, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.7497, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.5542, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4038, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.7690, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.5766, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3946, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(9.7114, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(10.5007, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3875, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.7501, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.5251, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 41, Batch:4, loss: 2.131278, Time: 2.7
Testing...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5711, device='cuda:0'), 'center': tensor(9.4574, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 210, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,  4,
        29, 25, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.5590, device='cuda:0'), 'center': tensor(6.5299, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5312, device='cuda:0'), 'center': tensor(6.9643, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.5455, device='cuda:0'), 'center': tensor(7.5323, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 32
Frame 1: FP: 9.0, Misses: 9.0
Frame 2: Detected: 36
Frame 2: FP: 7.0, Misses: 7.0
Frame 3: Detected: 34
Frame 3: FP: 8.0, Misses: 8.0
Frame 4: Detected: 31
Frame 4: FP: 10.0, Misses: 10.0
moda: 59.3%, modp: 52.6%, prec: 79.6%, recall: 79.6%
Test, loss: 8.724387, Time: 2.256
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4000, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.5588, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.3588, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4103, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.0876, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.9082, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3966, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(9.6301, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(10.4234, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3761, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.4731, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.2254, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 42, Batch:4, loss: 1.806342, Time: 2.6
Testing...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 117, 121, 125, 126, 136, 150, 158, 159, 166, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1, 12,  0,
        30,  8, 10, 22, 16, 31, 36, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5340, device='cuda:0'), 'center': tensor(8.7850, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.5847, device='cuda:0'), 'center': tensor(7.1900, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5327, device='cuda:0'), 'center': tensor(6.3929, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5502, device='cuda:0'), 'center': tensor(7.3550, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 33
Frame 1: FP: 8.0, Misses: 8.0
Frame 2: Detected: 33
Frame 2: FP: 10.0, Misses: 10.0
Frame 3: Detected: 35
Frame 3: FP: 7.0, Misses: 7.0
Frame 4: Detected: 32
Frame 4: FP: 9.0, Misses: 9.0
moda: 59.3%, modp: 49.6%, prec: 79.6%, recall: 79.6%
Test, loss: 8.531521, Time: 2.182
Training...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3903, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.6057, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.3863, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 117, 121, 125, 126, 136, 150, 158, 159, 166, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1, 12,  0,
        30,  8, 10, 22, 16, 31, 36, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4370, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(9.0064, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(9.8804, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4149, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.7036, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.5334, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4235, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.2720, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.1191, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 43, Batch:4, loss: 2.029767, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  70,  72,  74,  86,  90,
         92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215, 221,
        228, 238, 244, 249, 250, 255, 264, 270, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 37,  5, 13, 21, 38,  1,  0, 30,  8,
        10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2, 26,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5625, device='cuda:0'), 'center': tensor(9.6122, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 210, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,  4,
        29, 25, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4900, device='cuda:0'), 'center': tensor(6.8491, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4583, device='cuda:0'), 'center': tensor(6.6239, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4951, device='cuda:0'), 'center': tensor(7.4356, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 28
Frame 1: FP: 13.0, Misses: 13.0
Frame 2: Detected: 35
Frame 2: FP: 8.0, Misses: 8.0
Frame 3: Detected: 34
Frame 3: FP: 8.0, Misses: 8.0
Frame 4: Detected: 33
Frame 4: FP: 8.0, Misses: 8.0
moda: 55.7%, modp: 53.8%, prec: 77.8%, recall: 77.8%
Test, loss: 8.633172, Time: 2.160
Training...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3935, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.5725, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.3595, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3689, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.8571, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.5950, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3808, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.3688, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.1304, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4040, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(8.5432, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(9.3511, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 44, Batch:4, loss: 2.337782, Time: 2.8
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 117, 121, 125, 126, 136, 150, 158, 159, 166, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1, 12,  0,
        30,  8, 10, 22, 16, 31, 36, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5730, device='cuda:0'), 'center': tensor(7.9591, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.6464, device='cuda:0'), 'center': tensor(6.2259, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5574, device='cuda:0'), 'center': tensor(5.6276, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 149, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.5983, device='cuda:0'), 'center': tensor(6.9805, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 34
Frame 1: FP: 7.0, Misses: 7.0
Frame 2: Detected: 37
Frame 2: FP: 6.0, Misses: 6.0
Frame 3: Detected: 36
Frame 3: FP: 6.0, Misses: 6.0
Frame 4: Detected: 34
Frame 4: FP: 7.0, Misses: 7.0
moda: 68.9%, modp: 51.2%, prec: 84.4%, recall: 84.4%
Test, loss: 7.885773, Time: 2.183
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 137, 149, 153, 155, 156, 164, 166, 179, 200, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 24,
         0, 12,  5, 10, 37, 36, 22, 40,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4157, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.0914, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.9228, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3757, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.3039, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.0554, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4249, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(8.1896, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(9.0395, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3956, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.1954, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.9866, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 45, Batch:4, loss: 1.996642, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5188, device='cuda:0'), 'center': tensor(7.7071, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.5425, device='cuda:0'), 'center': tensor(5.6891, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 137, 149, 153, 155, 156, 164, 166, 179, 200, 207, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 255, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 24,
         0, 12,  5, 10, 37, 36, 22, 40, 32,  9,  2, 16,  1, 29, 30, 17, 41, 20,
         3,  4, 28, 26, 31, 19]))]
{'labels': tensor(0.5592, device='cuda:0'), 'center': tensor(6.5069, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.5291, device='cuda:0'), 'center': tensor(6.9177, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 34
Frame 1: FP: 7.0, Misses: 7.0
Frame 2: Detected: 37
Frame 2: FP: 6.0, Misses: 6.0
Frame 3: Detected: 34
Frame 3: FP: 8.0, Misses: 8.0
Frame 4: Detected: 34
Frame 4: FP: 7.0, Misses: 7.0
moda: 66.5%, modp: 52.7%, prec: 83.2%, recall: 83.2%
Test, loss: 7.780000, Time: 2.191
Training...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3864, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.9838, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.7566, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3804, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.8160, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.5768, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3736, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.4422, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.1894, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3857, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.7977, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.5692, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 46, Batch:4, loss: 1.892305, Time: 2.8
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4994, device='cuda:0'), 'center': tensor(7.0947, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.5679, device='cuda:0'), 'center': tensor(5.8779, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4989, device='cuda:0'), 'center': tensor(5.3928, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4873, device='cuda:0'), 'center': tensor(6.7705, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 35
Frame 1: FP: 6.0, Misses: 6.0
Frame 2: Detected: 36
Frame 2: FP: 7.0, Misses: 7.0
Frame 3: Detected: 37
Frame 3: FP: 5.0, Misses: 5.0
Frame 4: Detected: 33
Frame 4: FP: 8.0, Misses: 8.0
moda: 68.9%, modp: 53.9%, prec: 84.4%, recall: 84.4%
Test, loss: 7.310693, Time: 2.161
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4105, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.7861, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.6072, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4080, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.6273, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.4432, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3859, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.3161, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.0879, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4000, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.5842, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.3842, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 47, Batch:4, loss: 1.596041, Time: 2.7
Testing...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  41,  42,  44,  50,  51,  70,  72,  74,
         86,  90,  92, 117, 121, 125, 126, 150, 158, 159, 166, 172, 206, 215,
        221, 228, 240, 249, 250, 255, 264, 275, 277, 279, 283, 292, 297]), tensor([14,  7,  4, 11, 33, 35, 10, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1, 12,
         0, 30,  8, 22, 16, 31, 36, 39, 23,  3, 32, 27, 17, 40, 18, 29,  2, 25,
        15, 24, 19,  9, 28]))]
{'labels': tensor(0.4328, device='cuda:0'), 'center': tensor(10.8870, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         70,  74,  83,  86,  92, 105, 117, 137, 155, 156, 159, 166, 170, 179,
        190, 200, 210, 221, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 38, 13, 27, 21,
         1,  0, 12, 24,  5, 10, 31, 37,  8, 22, 30, 41,  9, 28, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4766, device='cuda:0'), 'center': tensor(9.5654, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  59,
         60,  74,  86, 133, 137, 149, 155, 156, 164, 166, 179, 200, 210, 213,
        215, 220, 221, 224, 234, 240, 242, 247, 251, 255, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 32, 38, 13, 21, 12,
        24,  0,  5, 10, 37, 36, 22, 40,  9,  2, 16,  1, 27, 29, 30, 26, 41, 20,
         3,  4, 28, 17, 31, 19]))]
{'labels': tensor(0.5945, device='cuda:0'), 'center': tensor(7.8314, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        123, 127, 133, 137, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197,
        210, 220, 223, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33,  0, 36, 12, 24,
        39, 11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4959, device='cuda:0'), 'center': tensor(8.7492, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 30
Frame 1: FP: 11.0, Misses: 11.0
Frame 2: Detected: 31
Frame 2: FP: 12.0, Misses: 12.0
Frame 3: Detected: 33
Frame 3: FP: 9.0, Misses: 9.0
Frame 4: Detected: 28
Frame 4: FP: 13.0, Misses: 13.0
moda: 46.1%, modp: 43.7%, prec: 73.1%, recall: 73.1%
Test, loss: 10.258199, Time: 2.100
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        220, 224, 234, 240, 242, 243, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2,  1, 29, 30, 26, 41, 16, 20,  3,
         4, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.4191, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.9567, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.7948, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4096, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.1398, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.9590, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 210, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,  4,
        29, 25, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4027, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.3558, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.1611, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.3941, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.2349, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.0231, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 48, Batch:4, loss: 2.005768, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5562, device='cuda:0'), 'center': tensor(6.5560, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 210, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,  4,
        29, 25, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.5433, device='cuda:0'), 'center': tensor(5.8374, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5201, device='cuda:0'), 'center': tensor(6.0021, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.5426, device='cuda:0'), 'center': tensor(7.0914, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 35
Frame 1: FP: 6.0, Misses: 6.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 36
Frame 3: FP: 6.0, Misses: 6.0
Frame 4: Detected: 34
Frame 4: FP: 7.0, Misses: 7.0
moda: 71.3%, modp: 53.1%, prec: 85.6%, recall: 85.6%
Test, loss: 7.452850, Time: 2.153
Training...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3816, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.5597, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.3229, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
         4, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3683, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.7984, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.5350, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4339, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.0460, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.9139, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.4024, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.4814, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.2862, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 49, Batch:4, loss: 1.821560, Time: 2.7
Testing...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  41,  42,  44,  50,  51,  70,  72,  74,
         86,  90,  92, 117, 121, 125, 126, 150, 158, 159, 166, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 10, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1, 12,
         0, 30,  8, 22, 16, 31, 36, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5337, device='cuda:0'), 'center': tensor(8.3050, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.5985, device='cuda:0'), 'center': tensor(6.3808, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 137, 149, 153, 155, 156, 164, 166, 179, 200, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 24,
         0, 12,  5, 10, 37, 36, 22, 40,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5839, device='cuda:0'), 'center': tensor(5.9387, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        123, 127, 133, 137, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33,  0, 36, 12, 24,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.6183, device='cuda:0'), 'center': tensor(6.9045, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 33
Frame 1: FP: 8.0, Misses: 8.0
Frame 2: Detected: 37
Frame 2: FP: 6.0, Misses: 6.0
Frame 3: Detected: 36
Frame 3: FP: 6.0, Misses: 6.0
Frame 4: Detected: 31
Frame 4: FP: 10.0, Misses: 10.0
moda: 64.1%, modp: 50.7%, prec: 82.0%, recall: 82.0%
Test, loss: 8.049447, Time: 2.222
Training...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 133, 137, 153, 155, 156, 164, 166, 179, 210, 213, 215,
        220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 40,
        24, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,  4,
        32, 28, 26, 31,  0, 19]))]
{'labels': tensor(0.3884, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.7402, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.5171, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3872, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.7599, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.5344, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3855, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.4143, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.1852, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3967, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.7736, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.5669, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 50, Batch:4, loss: 1.891731, Time: 2.9
Testing...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  41,  42,  44,  50,  51,  70,  72,  74,
         86,  90,  92, 121, 125, 126, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 10, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0,
        30,  8, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5391, device='cuda:0'), 'center': tensor(6.9210, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5843, device='cuda:0'), 'center': tensor(5.4461, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5160, device='cuda:0'), 'center': tensor(5.0180, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5721, device='cuda:0'), 'center': tensor(6.4561, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 33
Frame 1: FP: 8.0, Misses: 8.0
Frame 2: Detected: 37
Frame 2: FP: 6.0, Misses: 6.0
Frame 3: Detected: 37
Frame 3: FP: 5.0, Misses: 5.0
Frame 4: Detected: 33
Frame 4: FP: 8.0, Misses: 8.0
moda: 67.7%, modp: 56.1%, prec: 83.8%, recall: 83.8%
Test, loss: 7.066032, Time: 2.173
Training...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3941, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.6019, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.3901, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3546, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.1544, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.8635, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4079, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.1847, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.0005, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3753, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.3610, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.1115, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 51, Batch:4, loss: 1.527883, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  70,  72,  74,  86,  90,
         92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215, 221,
        228, 238, 244, 249, 250, 255, 264, 270, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 37,  5, 13, 21, 38,  1,  0, 30,  8,
        10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2, 26,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5476, device='cuda:0'), 'center': tensor(8.6890, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4855, device='cuda:0'), 'center': tensor(6.4217, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4788, device='cuda:0'), 'center': tensor(6.6715, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(0.5123, device='cuda:0'), 'center': tensor(6.9854, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 31
Frame 1: FP: 10.0, Misses: 10.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 34
Frame 3: FP: 8.0, Misses: 8.0
Frame 4: Detected: 36
Frame 4: FP: 5.0, Misses: 5.0
moda: 66.5%, modp: 49.6%, prec: 83.2%, recall: 83.2%
Test, loss: 8.203985, Time: 2.110
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3720, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(7.3582, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(8.1022, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3590, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.4770, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.1951, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3911, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.9379, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.7201, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  59,
         60,  62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 255, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 32, 38, 27, 13, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,
         3,  4, 28, 26, 31, 19]))]
{'labels': tensor(0.4244, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.3974, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.2463, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 52, Batch:4, loss: 1.561574, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  41,  42,  44,  50,  51,  65,  70,  72,
         74,  86,  90,  92, 117, 121, 125, 126, 150, 158, 166, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 10, 34,  6, 20, 26, 31, 37,  5, 13, 21, 38,  1,
        12,  0, 30,  8, 22, 16, 36, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4616, device='cuda:0'), 'center': tensor(8.5195, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.5135, device='cuda:0'), 'center': tensor(4.9131, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 17, 41, 20,
         3, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4642, device='cuda:0'), 'center': tensor(5.7594, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5112, device='cuda:0'), 'center': tensor(5.7528, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 30
Frame 1: FP: 11.0, Misses: 11.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 37
Frame 3: FP: 5.0, Misses: 5.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 70.1%, modp: 53.5%, prec: 85.0%, recall: 85.0%
Test, loss: 7.211435, Time: 2.138
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 153, 155, 156, 164, 166, 179, 210, 213, 215,
        220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,  4,
        32, 28, 26, 31,  0, 19]))]
{'labels': tensor(0.3944, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.2313, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.0200, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.4000, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.7899, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.5899, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3706, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.6207, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.3619, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3907, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.3793, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.1607, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 53, Batch:4, loss: 1.790171, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  29,  30,  34,  35,  42,  44,  50,  62,  70,  72,  74,
         86,  90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206,
        215, 228, 240, 244, 249, 250, 255, 270, 275, 277, 279, 283, 292]), tensor([14,  7,  4,  2, 11, 33, 35, 34,  6, 20, 32, 37,  5, 13, 21, 38,  1,  0,
        30,  8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 27, 17, 28, 40, 18, 29, 26,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5349, device='cuda:0'), 'center': tensor(8.1789, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 210, 234, 240, 245, 248, 251, 255, 264, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,  4,
         2, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4255, device='cuda:0'), 'center': tensor(6.4298, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  36,  44,  49,  56,  58,  60,
         62,  74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 30,  6, 39,  8, 14, 38, 27, 13, 21, 34,
        12, 40, 24,  0,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4053, device='cuda:0'), 'center': tensor(6.7315, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  36,  40,  44,  60,  74, 100, 127, 133, 137,
        143, 154, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223, 231,
        237, 240, 253, 258, 259, 264, 268, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0,  8, 11, 38,
        14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 31, 39, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5098, device='cuda:0'), 'center': tensor(6.6332, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 32
Frame 1: FP: 9.0, Misses: 9.0
Frame 2: Detected: 36
Frame 2: FP: 7.0, Misses: 7.0
Frame 3: Detected: 34
Frame 3: FP: 8.0, Misses: 8.0
Frame 4: Detected: 35
Frame 4: FP: 6.0, Misses: 6.0
moda: 64.1%, modp: 51.5%, prec: 82.0%, recall: 82.0%
Test, loss: 7.931168, Time: 2.108
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4180, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.4546, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.2906, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3828, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.5154, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.2811, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3685, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.5767, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.3137, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3701, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.2455, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.9856, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 54, Batch:4, loss: 1.746403, Time: 2.7
Testing...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  29,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,
         86,  90,  92, 117, 121, 125, 126, 136, 150, 158, 159, 166, 200, 206,
        215, 221, 228, 240, 244, 249, 250, 255, 275, 277, 279, 283, 292]), tensor([14,  7,  4,  2, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1, 12,
         0, 30,  8, 10, 22, 16, 31, 36, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5365, device='cuda:0'), 'center': tensor(7.8608, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.6101, device='cuda:0'), 'center': tensor(4.9122, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  59,  60,
         62,  74,  86, 100, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 255, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 32, 38, 27, 13, 21, 34,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,
         3,  4, 28, 26, 31, 19]))]
{'labels': tensor(0.5324, device='cuda:0'), 'center': tensor(4.7774, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5990, device='cuda:0'), 'center': tensor(7.1653, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 32
Frame 1: FP: 9.0, Misses: 9.0
Frame 2: Detected: 37
Frame 2: FP: 6.0, Misses: 6.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 32
Frame 4: FP: 9.0, Misses: 9.0
moda: 67.7%, modp: 53.9%, prec: 83.8%, recall: 83.8%
Test, loss: 7.317934, Time: 2.255
Training...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3802, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.3400, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.1005, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3835, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.6268, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.3937, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3377, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.5852, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.2606, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3868, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(6.3008, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(7.0745, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 55, Batch:4, loss: 1.768619, Time: 2.9
Testing...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5856, device='cuda:0'), 'center': tensor(5.4357, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5998, device='cuda:0'), 'center': tensor(5.2218, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86,  93, 100, 117, 137, 149, 155, 156, 164, 166, 179, 200, 210,
        213, 215, 220, 224, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 30, 34,
        12, 24,  0,  5, 10, 37, 36, 22, 40,  9,  2, 16,  1, 29, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5132, device='cuda:0'), 'center': tensor(5.5630, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 237, 240, 253, 258, 259, 268, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 39, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5985, device='cuda:0'), 'center': tensor(6.5180, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 35
Frame 1: FP: 6.0, Misses: 6.0
Frame 2: Detected: 37
Frame 2: FP: 6.0, Misses: 6.0
Frame 3: Detected: 36
Frame 3: FP: 6.0, Misses: 6.0
Frame 4: Detected: 34
Frame 4: FP: 7.0, Misses: 7.0
moda: 70.1%, modp: 59.7%, prec: 85.0%, recall: 85.0%
Test, loss: 6.833197, Time: 2.187
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3755, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.2777, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.0287, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 238, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3637, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.4399, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.1673, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3730, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.7326, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.4786, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4005, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.3323, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.1333, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 56, Batch:4, loss: 1.283337, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4900, device='cuda:0'), 'center': tensor(6.3317, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.5311, device='cuda:0'), 'center': tensor(5.1385, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 207, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 255, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  0,  5, 10, 37, 36, 22, 32,  9,  2, 16,  1, 29, 30, 17, 41, 20,
         3,  4, 28, 26, 31, 19]))]
{'labels': tensor(0.4897, device='cuda:0'), 'center': tensor(6.0261, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 237, 240, 253, 258, 259, 268, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 11,
        10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 20, 39, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4697, device='cuda:0'), 'center': tensor(7.0043, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 36
Frame 1: FP: 5.0, Misses: 5.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 36
Frame 3: FP: 6.0, Misses: 6.0
Frame 4: Detected: 34
Frame 4: FP: 7.0, Misses: 7.0
moda: 72.5%, modp: 52.3%, prec: 86.2%, recall: 86.2%
Test, loss: 7.115397, Time: 2.196
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3514, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.7239, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.4268, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3590, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.1155, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.8335, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.4035, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.4647, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.2716, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4114, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.1341, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.9569, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 57, Batch:4, loss: 1.489235, Time: 2.7
Testing...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5101, device='cuda:0'), 'center': tensor(5.2225, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.6119, device='cuda:0'), 'center': tensor(4.2494, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
        32, 28, 26, 31,  0, 19]))]
{'labels': tensor(0.5465, device='cuda:0'), 'center': tensor(4.8864, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.6061, device='cuda:0'), 'center': tensor(6.0167, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 37
Frame 2: FP: 6.0, Misses: 6.0
Frame 3: Detected: 36
Frame 3: FP: 6.0, Misses: 6.0
Frame 4: Detected: 33
Frame 4: FP: 8.0, Misses: 8.0
moda: 71.3%, modp: 60.9%, prec: 85.6%, recall: 85.6%
Test, loss: 6.231069, Time: 2.191
Training...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3748, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.1315, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.8811, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3804, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.2635, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.0242, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  59,
         60,  62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 255, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 32, 38, 27, 13, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,
         3,  4, 28, 26, 31, 19]))]
{'labels': tensor(0.3664, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.6573, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.3900, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3652, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.5116, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.2421, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 58, Batch:4, loss: 1.560514, Time: 2.6
Testing...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5485, device='cuda:0'), 'center': tensor(4.9499, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.6119, device='cuda:0'), 'center': tensor(4.5645, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5700, device='cuda:0'), 'center': tensor(4.8819, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  40,  44,  60,  74, 100, 127, 133, 137,
        143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        234, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11, 10,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 29,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5302, device='cuda:0'), 'center': tensor(5.4587, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 37
Frame 2: FP: 6.0, Misses: 6.0
Frame 3: Detected: 36
Frame 3: FP: 6.0, Misses: 6.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 76.0%, modp: 59.6%, prec: 88.0%, recall: 88.0%
Test, loss: 6.094029, Time: 2.235
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3654, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.3586, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.0893, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3638, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.5090, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.2366, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3661, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.1536, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.8858, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3813, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.6230, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.3856, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 59, Batch:4, loss: 1.346388, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4496, device='cuda:0'), 'center': tensor(5.5022, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5373, device='cuda:0'), 'center': tensor(4.8941, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  36,  44,  49,  56,  58,  60,
         62,  74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 30,  6, 39,  8, 14, 38, 27, 13, 21, 34,
        12, 40, 24,  0,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4893, device='cuda:0'), 'center': tensor(4.6279, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  40,  44,  60,  74, 100, 127, 133, 137,
        143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        234, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11, 10,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 29,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4667, device='cuda:0'), 'center': tensor(5.7313, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 36
Frame 2: FP: 7.0, Misses: 7.0
Frame 3: Detected: 37
Frame 3: FP: 5.0, Misses: 5.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 76.0%, modp: 55.8%, prec: 88.0%, recall: 88.0%
Test, loss: 6.160365, Time: 2.213
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.4026, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.2151, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.0203, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3511, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.3149, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.0170, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  41,  42,  44,  50,  51,  70,  72,  74,
         86,  90,  92, 121, 125, 126, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 10, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0,
        30,  8, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4392, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.2064, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.0847, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
         4, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3775, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.5753, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.3303, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 60, Batch:4, loss: 1.332563, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5145, device='cuda:0'), 'center': tensor(5.1493, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5911, device='cuda:0'), 'center': tensor(4.0580, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 137, 149, 155, 156, 164, 166, 179, 200, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        24,  0,  5, 10, 37, 36, 22, 40,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.5939, device='cuda:0'), 'center': tensor(4.4202, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 234, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 29,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5194, device='cuda:0'), 'center': tensor(5.2399, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 37
Frame 3: FP: 5.0, Misses: 5.0
Frame 4: Detected: 36
Frame 4: FP: 5.0, Misses: 5.0
moda: 77.2%, modp: 60.2%, prec: 88.6%, recall: 88.6%
Test, loss: 5.826298, Time: 2.206
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3851, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.4982, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.2684, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3778, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.2462, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(6.0018, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3376, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.7733, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.4484, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 15, 19, 32, 23, 33]))]
{'labels': tensor(0.3826, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.2582, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.0235, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 61, Batch:4, loss: 1.255864, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5517, device='cuda:0'), 'center': tensor(4.5223, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5802, device='cuda:0'), 'center': tensor(4.1286, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  40,  44,  49,  56,  58,  60,
         62,  74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184,
        210, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  2,  6, 39,  8, 14, 38, 27, 13, 21, 34,
        12, 40, 24,  0,  5, 10, 37, 36, 22,  4,  9, 16,  1, 29, 30, 17, 41, 20,
         3, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4964, device='cuda:0'), 'center': tensor(4.4847, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  40,  44,  60,  74,  95, 100, 127, 133,
        137, 143, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        234, 237, 240, 253, 258, 264, 268, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 11, 10,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 29,  3, 26, 28, 27, 31, 39, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5312, device='cuda:0'), 'center': tensor(5.8598, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 38
Frame 3: FP: 4.0, Misses: 4.0
Frame 4: Detected: 36
Frame 4: FP: 5.0, Misses: 5.0
moda: 78.4%, modp: 60.2%, prec: 89.2%, recall: 89.2%
Test, loss: 5.828557, Time: 2.137
Training...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3517, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.1744, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.8777, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3813, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.0462, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.8088, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  59,
         60,  62,  74,  86, 133, 137, 149, 153, 155, 156, 164, 166, 179, 184,
        210, 213, 215, 220, 224, 234, 240, 242, 247, 251, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 32, 38, 27, 13, 21,
        40, 24,  0, 12,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 17, 41,
        20,  3, 28, 26, 31, 19]))]
{'labels': tensor(0.3559, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.3876, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.0995, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3498, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.8161, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.5157, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 62, Batch:4, loss: 1.378916, Time: 2.6
Testing...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5118, device='cuda:0'), 'center': tensor(4.9827, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5417, device='cuda:0'), 'center': tensor(4.5267, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
         4, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.4875, device='cuda:0'), 'center': tensor(3.9793, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  91,  95, 100,
        127, 133, 137, 143, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        223, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 293, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 39, 20, 33, 36, 12, 24,  0,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21, 16,  3, 26, 28, 27, 31, 22, 19,
        30, 40,  9,  1, 17]))]
{'labels': tensor(0.5212, device='cuda:0'), 'center': tensor(5.1291, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 35
Frame 4: FP: 6.0, Misses: 6.0
moda: 79.6%, modp: 58.2%, prec: 89.8%, recall: 89.8%
Test, loss: 5.685538, Time: 2.224
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3715, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.5791, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.3220, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 133, 137, 149, 153, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 40,
        24,  0, 12,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3542, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.1881, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.8964, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3760, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.2978, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.0498, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3780, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.6807, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.4366, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 63, Batch:4, loss: 1.359141, Time: 2.7
Testing...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4191, device='cuda:0'), 'center': tensor(5.1062, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 244, 245, 248, 251, 255, 271, 277, 283, 285, 287,
        292]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 33, 20, 16,  3,
         4, 29, 15, 19, 32, 23,  9]))]
{'labels': tensor(0.4862, device='cuda:0'), 'center': tensor(4.6750, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  36,  44,  49,  56,  58,  60,
         62,  74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 30,  6, 39,  8, 14, 38, 27, 13, 21, 34,
        12, 40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4038, device='cuda:0'), 'center': tensor(4.4983, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        223, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 293, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21, 16,  3, 26, 28, 27, 31, 22, 19,
        30, 40,  9,  1, 17]))]
{'labels': tensor(0.4251, device='cuda:0'), 'center': tensor(5.1746, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 38
Frame 3: FP: 4.0, Misses: 4.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 80.8%, modp: 55.4%, prec: 90.4%, recall: 90.4%
Test, loss: 5.730564, Time: 2.102
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3780, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.5915, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.3475, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 17, 41, 20,  3,
         4, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.4010, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.2875, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.0895, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3735, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.9520, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.6990, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3900, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.9276, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7075, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 64, Batch:4, loss: 1.176884, Time: 2.6
Testing...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  41,  42,  44,  50,  51,  70,  72,  74,
         86,  90,  92, 121, 125, 126, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 10, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0,
        30,  8, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4452, device='cuda:0'), 'center': tensor(5.6477, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5000, device='cuda:0'), 'center': tensor(4.3464, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  59,  60,
         62,  74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 32, 38, 27, 13, 21, 34,
        12, 40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4377, device='cuda:0'), 'center': tensor(3.9308, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4630, device='cuda:0'), 'center': tensor(4.7941, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 36
Frame 1: FP: 5.0, Misses: 5.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 36
Frame 4: FP: 5.0, Misses: 5.0
moda: 78.4%, modp: 58.0%, prec: 89.2%, recall: 89.2%
Test, loss: 5.602691, Time: 2.204
Training...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.4141, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.0776, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.9058, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3655, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.3941, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.1251, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3634, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.6936, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.4204, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
         4, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3720, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.9839, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7278, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 65, Batch:4, loss: 1.181945, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 172, 178, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 39, 12, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5207, device='cuda:0'), 'center': tensor(4.7130, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5818, device='cuda:0'), 'center': tensor(4.0039, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.4941, device='cuda:0'), 'center': tensor(3.7101, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 223, 231,
        237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 293, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21, 16, 10,  3, 26, 28, 27, 20, 31, 22, 19,
        30, 40,  9,  1, 17]))]
{'labels': tensor(0.5326, device='cuda:0'), 'center': tensor(4.6663, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 82.0%, modp: 60.9%, prec: 91.0%, recall: 91.0%
Test, loss: 5.337897, Time: 2.191
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3644, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.7570, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.4857, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3829, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(5.0319, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.7977, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3460, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.7373, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.4294, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3541, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.2157, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.9240, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 66, Batch:4, loss: 1.230990, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 172, 178, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 39, 12, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4828, device='cuda:0'), 'center': tensor(5.5606, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5814, device='cuda:0'), 'center': tensor(4.1754, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.4931, device='cuda:0'), 'center': tensor(3.5923, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5191, device='cuda:0'), 'center': tensor(4.8616, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 36
Frame 4: FP: 5.0, Misses: 5.0
moda: 79.6%, modp: 58.3%, prec: 89.8%, recall: 89.8%
Test, loss: 5.585684, Time: 2.191
Training...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3680, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.4151, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.1511, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3484, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.3640, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.0608, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
         4, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3788, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.9604, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7181, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3705, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.2023, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.9433, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 67, Batch:4, loss: 1.235813, Time: 2.6
Testing...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 172, 178, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 39, 12, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4519, device='cuda:0'), 'center': tensor(5.3153, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5292, device='cuda:0'), 'center': tensor(4.4133, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.4586, device='cuda:0'), 'center': tensor(3.5421, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  40,  44,  60,  74, 100, 127, 133, 137,
        143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        234, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11, 10,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 29,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4803, device='cuda:0'), 'center': tensor(5.3908, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 36
Frame 1: FP: 5.0, Misses: 5.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 36
Frame 4: FP: 5.0, Misses: 5.0
moda: 79.6%, modp: 57.5%, prec: 89.8%, recall: 89.8%
Test, loss: 5.625402, Time: 2.119
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3752, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.3268, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.0772, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3822, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.6283, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.3927, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3622, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.1441, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.8685, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3558, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.5170, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.2287, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 68, Batch:4, loss: 1.057180, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4745, device='cuda:0'), 'center': tensor(4.9449, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.6088, device='cuda:0'), 'center': tensor(4.2734, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4707, device='cuda:0'), 'center': tensor(3.5429, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  40,  44,  60,  74,  95, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 234, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10, 29,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5202, device='cuda:0'), 'center': tensor(4.7186, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 82.0%, modp: 59.5%, prec: 91.0%, recall: 91.0%
Test, loss: 5.407075, Time: 2.199
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3639, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.4223, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.1501, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3527, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.3596, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.0650, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3796, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.6650, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.4242, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 17, 41, 20,
         3, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3460, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.6962, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.3883, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 69, Batch:4, loss: 1.097070, Time: 2.7
Testing...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5600, device='cuda:0'), 'center': tensor(4.2829, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.6097, device='cuda:0'), 'center': tensor(3.7507, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.5688, device='cuda:0'), 'center': tensor(3.4074, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5640, device='cuda:0'), 'center': tensor(4.0596, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 82.0%, modp: 63.8%, prec: 91.0%, recall: 91.0%
Test, loss: 5.026413, Time: 2.291
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3466, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.1253, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.8186, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3630, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8565, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.5826, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3540, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.7371, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.4452, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 17, 41, 20,
         3, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3598, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8627, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.5823, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 70, Batch:4, loss: 1.145580, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5284, device='cuda:0'), 'center': tensor(4.5512, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5977, device='cuda:0'), 'center': tensor(4.0054, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.5020, device='cuda:0'), 'center': tensor(3.4920, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5251, device='cuda:0'), 'center': tensor(4.0363, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 82.0%, modp: 61.7%, prec: 91.0%, recall: 91.0%
Test, loss: 5.097845, Time: 2.212
Training...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 17, 41, 20,
         3, 32, 28, 26, 31, 19]))]
{'labels': tensor(0.3560, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.4938, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.2059, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3468, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.4113, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.1050, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3654, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.7563, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.4871, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  29,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,
         86,  90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206,
        215, 221, 228, 240, 244, 249, 250, 255, 275, 277, 279, 283, 292]), tensor([14,  7,  4,  2, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0,
        30,  8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3710, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.1831, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.9251, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 71, Batch:4, loss: 1.231266, Time: 2.6
Testing...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4365, device='cuda:0'), 'center': tensor(4.6089, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 137, 155, 156, 166, 170, 178, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 24,  5, 10, 37,  8, 12, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5070, device='cuda:0'), 'center': tensor(4.4631, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4064, device='cuda:0'), 'center': tensor(3.7572, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  91, 100, 127,
        133, 137, 143, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 39, 33, 36, 12, 24,  0, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4919, device='cuda:0'), 'center': tensor(4.7350, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 36
Frame 4: FP: 5.0, Misses: 5.0
moda: 79.6%, modp: 59.5%, prec: 89.8%, recall: 89.8%
Test, loss: 5.312000, Time: 2.186
Training...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3742, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8822, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.6306, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
         4, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3575, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.4959, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.2109, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3447, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.2015, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.8909, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3635, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.0636, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7906, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 72, Batch:4, loss: 1.197644, Time: 2.7
Testing...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  62,  70,  72,  74,
         86,  90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206,
        215, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 32, 37,  5, 13, 21, 38,  1,  0,
        30,  8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4601, device='cuda:0'), 'center': tensor(4.3865, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5097, device='cuda:0'), 'center': tensor(4.2795, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4276, device='cuda:0'), 'center': tensor(3.3635, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  40,  44,  60,  74,  95, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 234, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10, 29,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4850, device='cuda:0'), 'center': tensor(4.8612, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 82.0%, modp: 60.0%, prec: 91.0%, recall: 91.0%
Test, loss: 5.163814, Time: 2.107
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3907, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.7120, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.4934, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3631, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.1566, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.8829, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3642, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.1229, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.8512, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3751, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.6394, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.3896, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 73, Batch:4, loss: 1.097403, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4790, device='cuda:0'), 'center': tensor(4.2610, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5537, device='cuda:0'), 'center': tensor(3.8386, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4349, device='cuda:0'), 'center': tensor(3.2515, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5020, device='cuda:0'), 'center': tensor(4.0154, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 82.0%, modp: 63.7%, prec: 91.0%, recall: 91.0%
Test, loss: 4.826441, Time: 2.094
Training...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3492, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.4885, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.1870, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3506, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.0553, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7565, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3457, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.1813, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.8727, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3637, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.6188, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.3462, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 74, Batch:4, loss: 1.086549, Time: 2.6
Testing...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4782, device='cuda:0'), 'center': tensor(4.0014, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5815, device='cuda:0'), 'center': tensor(3.5755, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86,  96, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184,
        210, 213, 215, 220, 224, 234, 240, 242, 247, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21,  3, 34,
        12, 40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41,
        20, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.4617, device='cuda:0'), 'center': tensor(3.8910, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  40,  44,  60,  74,  95, 100, 123, 127,
        133, 137, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 234, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8,  2,  6, 37, 13, 20, 33,  0, 36, 12, 24, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10, 29,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5251, device='cuda:0'), 'center': tensor(4.6296, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 38
Frame 3: FP: 4.0, Misses: 4.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 80.8%, modp: 63.5%, prec: 90.4%, recall: 90.4%
Test, loss: 5.047616, Time: 2.183
Training...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3457, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.5918, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.2832, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3413, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.3126, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.9953, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3392, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.3756, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.0541, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3712, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.3694, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.1118, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 75, Batch:4, loss: 1.277952, Time: 2.7
Testing...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5047, device='cuda:0'), 'center': tensor(3.9948, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5698, device='cuda:0'), 'center': tensor(3.6587, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4396, device='cuda:0'), 'center': tensor(3.1158, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  40,  44,  60,  74,  95, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 234, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10, 29,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5110, device='cuda:0'), 'center': tensor(4.3774, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 82.0%, modp: 64.4%, prec: 91.0%, recall: 91.0%
Test, loss: 4.799191, Time: 2.167
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3513, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.5889, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.2916, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3744, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.5864, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.3353, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3655, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.4988, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(5.2298, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3565, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.9752, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.6883, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 76, Batch:4, loss: 1.172080, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4934, device='cuda:0'), 'center': tensor(4.0515, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5720, device='cuda:0'), 'center': tensor(3.8592, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86,  96, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21,  3, 34,
        12, 40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4523, device='cuda:0'), 'center': tensor(3.9412, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4771, device='cuda:0'), 'center': tensor(4.5191, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 38
Frame 3: FP: 4.0, Misses: 4.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 79.6%, modp: 63.4%, prec: 89.8%, recall: 89.8%
Test, loss: 5.090174, Time: 2.092
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3616, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.1947, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.9179, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3575, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.1002, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.8152, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3879, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.5909, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.3666, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.3670, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.3173, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.0514, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 77, Batch:4, loss: 1.012841, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4473, device='cuda:0'), 'center': tensor(4.4282, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5567, device='cuda:0'), 'center': tensor(3.9094, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4091, device='cuda:0'), 'center': tensor(3.2311, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4581, device='cuda:0'), 'center': tensor(4.2028, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 80.8%, modp: 62.4%, prec: 90.4%, recall: 90.4%
Test, loss: 4.878432, Time: 2.158
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3475, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.1470, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.8421, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3592, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.1862, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.9046, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3364, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.2456, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.9185, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3848, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.0287, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7983, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 78, Batch:4, loss: 1.199575, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4769, device='cuda:0'), 'center': tensor(4.2764, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5469, device='cuda:0'), 'center': tensor(3.6115, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86,  96, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21,  3, 34,
        12, 40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4236, device='cuda:0'), 'center': tensor(4.0054, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 223, 231,
        237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 293, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21, 16, 10,  3, 26, 28, 27, 20, 31, 22, 19,
        30, 40,  9,  1, 17]))]
{'labels': tensor(0.4903, device='cuda:0'), 'center': tensor(4.3502, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 38
Frame 3: FP: 4.0, Misses: 4.0
Frame 4: Detected: 38
Frame 4: FP: 3.0, Misses: 3.0
moda: 82.0%, modp: 62.2%, prec: 91.0%, recall: 91.0%
Test, loss: 5.029736, Time: 2.212
Training...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3885, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.6163, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.3932, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3699, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8345, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.5743, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3722, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.2114, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.9558, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3620, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8743, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.5984, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 79, Batch:4, loss: 1.149589, Time: 2.7
Testing...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4652, device='cuda:0'), 'center': tensor(4.0782, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5806, device='cuda:0'), 'center': tensor(3.8845, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86,  96, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184,
        210, 213, 215, 220, 224, 234, 240, 242, 247, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21,  3, 34,
        12, 40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41,
        20, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.4307, device='cuda:0'), 'center': tensor(4.2728, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4801, device='cuda:0'), 'center': tensor(4.2645, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 38
Frame 3: FP: 4.0, Misses: 4.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 79.6%, modp: 63.4%, prec: 89.8%, recall: 89.8%
Test, loss: 5.103289, Time: 2.148
Training...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3809, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.5767, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.3386, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3611, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.9540, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.6761, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.3630, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.3839, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.1099, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3374, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.9138, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.5886, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 80, Batch:4, loss: 1.147148, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5010, device='cuda:0'), 'center': tensor(4.2211, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5665, device='cuda:0'), 'center': tensor(3.5700, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4559, device='cuda:0'), 'center': tensor(3.2198, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5120, device='cuda:0'), 'center': tensor(4.1063, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 38
Frame 4: FP: 3.0, Misses: 3.0
moda: 83.2%, modp: 63.0%, prec: 91.6%, recall: 91.6%
Test, loss: 4.797003, Time: 2.116
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3779, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.3486, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.1044, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3405, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.1298, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.8107, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3569, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.9377, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.6516, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3923, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.9284, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7131, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 81, Batch:4, loss: 1.178277, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4638, device='cuda:0'), 'center': tensor(4.1664, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5868, device='cuda:0'), 'center': tensor(3.5292, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86,  96, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21,  3,
        12, 40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4837, device='cuda:0'), 'center': tensor(4.0269, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4902, device='cuda:0'), 'center': tensor(4.0352, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 38
Frame 3: FP: 4.0, Misses: 4.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 80.8%, modp: 63.8%, prec: 90.4%, recall: 90.4%
Test, loss: 4.951661, Time: 2.155
Training...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3602, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.0766, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7970, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3732, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.5034, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.2497, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 207,
        210, 213, 215, 220, 224, 234, 240, 242, 247, 251, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4, 32,  9,  2, 16,  1, 29, 30, 26, 41,
        20,  3, 28, 17, 31, 19]))]
{'labels': tensor(0.3498, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.1913, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.8909, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3576, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.1168, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.8319, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 82, Batch:4, loss: 1.207985, Time: 2.9
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4785, device='cuda:0'), 'center': tensor(3.9871, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5926, device='cuda:0'), 'center': tensor(3.4609, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4743, device='cuda:0'), 'center': tensor(3.3325, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5167, device='cuda:0'), 'center': tensor(3.8124, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 82.0%, modp: 65.2%, prec: 91.0%, recall: 91.0%
Test, loss: 4.679268, Time: 2.126
Training...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3640, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.0279, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7558, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3515, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.2250, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.9281, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3661, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.0743, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.8065, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3778, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.4125, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.1682, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 83, Batch:4, loss: 1.042050, Time: 2.8
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4756, device='cuda:0'), 'center': tensor(4.1380, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5512, device='cuda:0'), 'center': tensor(3.5426, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4468, device='cuda:0'), 'center': tensor(3.2240, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5110, device='cuda:0'), 'center': tensor(4.0427, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 82.0%, modp: 64.6%, prec: 91.0%, recall: 91.0%
Test, loss: 4.729057, Time: 2.306
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3594, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.4942, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.2130, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3271, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8184, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.4727, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.3477, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.0755, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.7709, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3722, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8999, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.6444, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 84, Batch:4, loss: 1.161093, Time: 2.8
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4759, device='cuda:0'), 'center': tensor(4.1107, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5677, device='cuda:0'), 'center': tensor(3.6389, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4955, device='cuda:0'), 'center': tensor(3.1770, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4983, device='cuda:0'), 'center': tensor(3.7617, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 38
Frame 4: FP: 3.0, Misses: 3.0
moda: 83.2%, modp: 64.3%, prec: 91.6%, recall: 91.6%
Test, loss: 4.690789, Time: 2.195
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3657, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.9718, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7031, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3545, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.9271, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.6361, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3639, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.3765, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.1043, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3319, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.1125, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.7764, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 85, Batch:4, loss: 0.944109, Time: 2.8
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4627, device='cuda:0'), 'center': tensor(4.4010, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5880, device='cuda:0'), 'center': tensor(3.6571, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  59,
         60,  62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184,
        210, 213, 215, 220, 224, 234, 240, 242, 247, 251, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 32, 38, 27, 13, 21,
        12, 40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41,
        20,  3, 28, 17, 31, 19]))]
{'labels': tensor(0.5070, device='cuda:0'), 'center': tensor(3.1303, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4824, device='cuda:0'), 'center': tensor(3.9927, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 80.8%, modp: 64.3%, prec: 90.4%, recall: 90.4%
Test, loss: 4.815375, Time: 2.189
Training...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
         4, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3375, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.1597, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.8346, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3738, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8132, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.5609, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3367, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8028, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.4762, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3922, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.3590, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.1433, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 86, Batch:4, loss: 1.035823, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4530, device='cuda:0'), 'center': tensor(4.6228, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5662, device='cuda:0'), 'center': tensor(3.9254, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4436, device='cuda:0'), 'center': tensor(3.2865, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4844, device='cuda:0'), 'center': tensor(4.3421, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 80.8%, modp: 61.8%, prec: 90.4%, recall: 90.4%
Test, loss: 5.017780, Time: 2.158
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3320, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8888, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.5529, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3566, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.0829, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7961, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3776, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.3955, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.1508, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3673, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.2577, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.9924, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 87, Batch:4, loss: 0.998088, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4563, device='cuda:0'), 'center': tensor(4.3111, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5738, device='cuda:0'), 'center': tensor(3.8592, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4493, device='cuda:0'), 'center': tensor(3.1806, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5013, device='cuda:0'), 'center': tensor(3.8447, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 38
Frame 4: FP: 3.0, Misses: 3.0
moda: 82.0%, modp: 63.4%, prec: 91.0%, recall: 91.0%
Test, loss: 4.789291, Time: 2.207
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3434, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.2296, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.9164, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.3464, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.1447, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.8375, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3651, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8994, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.6296, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3593, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.5035, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.2222, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 88, Batch:4, loss: 1.055540, Time: 2.7
Testing...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4523, device='cuda:0'), 'center': tensor(4.5248, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5613, device='cuda:0'), 'center': tensor(3.7344, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4408, device='cuda:0'), 'center': tensor(3.1523, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4832, device='cuda:0'), 'center': tensor(3.9242, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 38
Frame 4: FP: 3.0, Misses: 3.0
moda: 82.0%, modp: 63.8%, prec: 91.0%, recall: 91.0%
Test, loss: 4.802694, Time: 2.149
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3635, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.3206, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.0475, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3444, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.9322, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.6209, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3495, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.1197, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.8187, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3441, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8983, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.5865, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 89, Batch:4, loss: 1.146623, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4359, device='cuda:0'), 'center': tensor(4.7593, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5587, device='cuda:0'), 'center': tensor(3.7479, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4283, device='cuda:0'), 'center': tensor(3.1835, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4963, device='cuda:0'), 'center': tensor(4.0311, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 80.8%, modp: 62.9%, prec: 90.4%, recall: 90.4%
Test, loss: 4.890068, Time: 2.239
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3774, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.4433, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.1982, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3447, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(2.9401, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.6295, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3686, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.6285, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.3657, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3707, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.0558, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7972, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 90, Batch:4, loss: 1.199303, Time: 2.6
Testing...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4595, device='cuda:0'), 'center': tensor(4.1284, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5720, device='cuda:0'), 'center': tensor(3.5132, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4239, device='cuda:0'), 'center': tensor(3.0560, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5175, device='cuda:0'), 'center': tensor(3.9416, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 38
Frame 4: FP: 3.0, Misses: 3.0
moda: 83.2%, modp: 65.0%, prec: 91.6%, recall: 91.6%
Test, loss: 4.646182, Time: 2.132
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3758, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.9796, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7313, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.3467, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.0797, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.7731, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3409, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8980, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.5798, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3826, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.3747, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.1398, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 91, Batch:4, loss: 1.034957, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4645, device='cuda:0'), 'center': tensor(4.2530, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5638, device='cuda:0'), 'center': tensor(3.7444, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86,  96, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184,
        210, 213, 215, 220, 224, 234, 240, 242, 247, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21,  3, 34,
        12, 40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41,
        20, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.4423, device='cuda:0'), 'center': tensor(3.8381, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4956, device='cuda:0'), 'center': tensor(3.8247, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 38
Frame 3: FP: 4.0, Misses: 4.0
Frame 4: Detected: 36
Frame 4: FP: 5.0, Misses: 5.0
moda: 79.6%, modp: 64.4%, prec: 89.8%, recall: 89.8%
Test, loss: 4.898122, Time: 2.196
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3335, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.0346, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7016, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 255, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
         4, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3504, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.0963, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.7970, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3755, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.3656, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.1166, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3341, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8300, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.4982, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 92, Batch:4, loss: 1.124552, Time: 2.8
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4527, device='cuda:0'), 'center': tensor(4.3130, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5672, device='cuda:0'), 'center': tensor(3.6735, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86,  96, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184,
        210, 213, 215, 220, 224, 234, 240, 242, 247, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21,  3, 34,
        12, 40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41,
        20, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.4396, device='cuda:0'), 'center': tensor(3.7360, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4907, device='cuda:0'), 'center': tensor(3.9935, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 38
Frame 3: FP: 4.0, Misses: 4.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 79.6%, modp: 64.4%, prec: 89.8%, recall: 89.8%
Test, loss: 4.904133, Time: 2.134
Training...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3745, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.4841, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.2332, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3420, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.0964, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.7804, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3523, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.6565, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.3612, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3462, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.7658, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.4582, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 93, Batch:4, loss: 1.114560, Time: 2.8
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4710, device='cuda:0'), 'center': tensor(4.2282, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5942, device='cuda:0'), 'center': tensor(3.5842, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4430, device='cuda:0'), 'center': tensor(2.8459, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4932, device='cuda:0'), 'center': tensor(3.8197, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 38
Frame 4: FP: 3.0, Misses: 3.0
moda: 83.2%, modp: 65.5%, prec: 91.6%, recall: 91.6%
Test, loss: 4.620203, Time: 2.247
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3789, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.7692, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.5270, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3626, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.0769, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.8022, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3536, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.3463, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.0534, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3530, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.6108, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.3168, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 94, Batch:4, loss: 1.079193, Time: 2.6
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4540, device='cuda:0'), 'center': tensor(4.0973, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5511, device='cuda:0'), 'center': tensor(3.8706, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4295, device='cuda:0'), 'center': tensor(3.3082, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4906, device='cuda:0'), 'center': tensor(3.6726, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 37
Frame 4: FP: 4.0, Misses: 4.0
moda: 80.8%, modp: 63.8%, prec: 90.4%, recall: 90.4%
Test, loss: 4.699787, Time: 2.139
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3563, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.7206, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.4332, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74, 100, 127, 133,
        137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220, 223,
        231, 237, 240, 253, 258, 259, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39, 11,
        38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 20, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3317, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.6286, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.2920, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 137, 155, 156, 164, 166, 179, 184, 200, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        24,  5, 10, 37, 36, 22,  4, 40,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.3407, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.4890, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.1705, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3639, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.3537, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.0816, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 95, Batch:4, loss: 1.020398, Time: 2.8
Testing...
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4980, device='cuda:0'), 'center': tensor(3.8339, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5491, device='cuda:0'), 'center': tensor(3.6337, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4458, device='cuda:0'), 'center': tensor(2.8274, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4762, device='cuda:0'), 'center': tensor(3.7777, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 38
Frame 4: FP: 3.0, Misses: 3.0
moda: 83.2%, modp: 66.3%, prec: 91.6%, recall: 91.6%
Test, loss: 4.502683, Time: 2.197
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3479, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.1875, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.8833, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3794, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.3833, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.1421, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 237, 240, 253, 258, 259, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 20, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3217, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.1166, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.7601, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3596, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.1065, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.8256, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 96, Batch:4, loss: 1.206405, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4577, device='cuda:0'), 'center': tensor(4.3172, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5494, device='cuda:0'), 'center': tensor(3.8553, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4145, device='cuda:0'), 'center': tensor(3.2424, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4936, device='cuda:0'), 'center': tensor(3.6021, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 38
Frame 4: FP: 3.0, Misses: 3.0
moda: 83.2%, modp: 63.2%, prec: 91.6%, recall: 91.6%
Test, loss: 4.711911, Time: 2.223
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3526, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(2.8497, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.5549, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3488, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.7808, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.4785, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3543, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.3258, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.0345, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3543, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(4.0924, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.8011, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 97, Batch:4, loss: 1.200271, Time: 2.7
Testing...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4672, device='cuda:0'), 'center': tensor(4.0806, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5785, device='cuda:0'), 'center': tensor(3.7656, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4325, device='cuda:0'), 'center': tensor(2.8863, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4825, device='cuda:0'), 'center': tensor(3.8417, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 38
Frame 4: FP: 3.0, Misses: 3.0
moda: 82.0%, modp: 65.3%, prec: 91.0%, recall: 91.0%
Test, loss: 4.623909, Time: 2.203
Training...
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.3419, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(2.9501, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.6340, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3580, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.4448, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.1609, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3489, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.9292, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.6270, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3526, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.7048, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.4101, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 98, Batch:4, loss: 1.102515, Time: 2.7
Testing...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4848, device='cuda:0'), 'center': tensor(4.1153, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5644, device='cuda:0'), 'center': tensor(3.5508, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86,  96, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21,  3, 34,
        12, 40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4692, device='cuda:0'), 'center': tensor(3.5462, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4939, device='cuda:0'), 'center': tensor(3.8904, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 38
Frame 3: FP: 4.0, Misses: 4.0
Frame 4: Detected: 38
Frame 4: FP: 3.0, Misses: 3.0
moda: 82.0%, modp: 64.7%, prec: 91.0%, recall: 91.0%
Test, loss: 4.781784, Time: 2.115
Training...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3528, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.8098, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.5154, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  86, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 21, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3637, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.0482, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.7755, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3638, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.4224, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.1500, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3461, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.6236, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.3158, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 99, Batch:4, loss: 1.078950, Time: 2.6
Testing...
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.5131, device='cuda:0'), 'center': tensor(3.9925, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5501, device='cuda:0'), 'center': tensor(3.7995, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86,  96, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21,  3, 34,
        12, 40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4391, device='cuda:0'), 'center': tensor(3.5648, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5009, device='cuda:0'), 'center': tensor(3.8919, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 38
Frame 2: FP: 5.0, Misses: 5.0
Frame 3: Detected: 38
Frame 3: FP: 4.0, Misses: 4.0
Frame 4: Detected: 38
Frame 4: FP: 3.0, Misses: 3.0
moda: 80.8%, modp: 65.2%, prec: 90.4%, recall: 90.4%
Test, loss: 4.813757, Time: 2.220
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.3907, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.2503, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.0316, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.3554, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.7467, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.4575, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 149, 155, 156, 164, 166, 179, 184, 210,
        213, 215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  0,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,
         3, 32, 28, 17, 31, 19]))]
{'labels': tensor(0.3491, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.0727, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(3.7708, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  32,  36,  40,  44,  60,  74,  95, 100,
        127, 133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 240, 253, 258, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18, 31,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0,
        39, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.3469, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(3.9307, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(4.6245, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 100, Batch:4, loss: 1.156119, Time: 2.7
Testing...
gt_cnt:  42
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4416, device='cuda:0'), 'center': tensor(4.3882, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,  62,
         70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179, 195,
        200, 234, 240, 245, 248, 251, 255, 271, 275, 277, 283, 285, 287, 292,
        297]), tensor([14,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27, 21,
         0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4, 29,
        25, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5679, device='cuda:0'), 'center': tensor(3.6920, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4145, device='cuda:0'), 'center': tensor(3.0179, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 156, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 10, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.4990, device='cuda:0'), 'center': tensor(3.5581, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 38
Frame 4: FP: 3.0, Misses: 3.0
moda: 83.2%, modp: 64.3%, prec: 91.6%, recall: 91.6%
Test, loss: 4.625505, Time: 2.122
Test loaded model...
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,  86,
         90,  92, 121, 125, 126, 136, 150, 158, 159, 166, 178, 200, 206, 215,
        221, 228, 240, 244, 249, 250, 255, 264, 275, 277, 279, 283, 292]), tensor([14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38,  1,  0, 30,
         8, 10, 22, 16, 31, 36, 12, 39, 23,  3, 32, 27, 17, 28, 40, 18, 29,  2,
        25, 15, 24, 19,  9]))]
{'labels': tensor(0.4554, device='cuda:0'), 'center': tensor(4.1540, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  83,  86, 105, 106, 117, 137, 155, 156, 166, 170, 179,
        195, 200, 234, 240, 245, 248, 251, 255, 271, 277, 283, 285, 287, 292,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 27,
        21,  0, 30, 12, 24,  5, 10, 37,  8, 22,  1, 41, 31, 17, 20, 16,  3,  4,
        29, 15, 19, 32, 23,  9, 33]))]
{'labels': tensor(0.5434, device='cuda:0'), 'center': tensor(3.4617, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([43, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  44,  49,  56,  58,  60,  62,
         74,  86, 100, 117, 133, 137, 155, 156, 164, 166, 179, 184, 210, 213,
        215, 220, 224, 234, 240, 242, 247, 251, 261, 271, 284, 285, 295, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35,  6, 39,  8, 14, 38, 27, 13, 21, 34, 12,
        40, 24,  5, 10, 37, 36, 22,  4,  9,  2, 16,  1, 29, 30, 26, 41, 20,  3,
        32, 28, 17, 31,  0, 19]))]
{'labels': tensor(0.4034, device='cuda:0'), 'center': tensor(3.1106, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([42, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 127,
        133, 137, 143, 153, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 36, 12, 24,  0, 39,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        19, 30, 40,  9, 17]))]
{'labels': tensor(0.5260, device='cuda:0'), 'center': tensor(3.8423, device='cuda:0')}
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([41, 2])
Frame 1: Detected: 37
Frame 1: FP: 4.0, Misses: 4.0
Frame 2: Detected: 39
Frame 2: FP: 4.0, Misses: 4.0
Frame 3: Detected: 39
Frame 3: FP: 3.0, Misses: 3.0
Frame 4: Detected: 38
Frame 4: FP: 3.0, Misses: 3.0
moda: 83.2%, modp: 65.0%, prec: 91.6%, recall: 91.6%
Test, loss: 4.606272, Time: 2.286
