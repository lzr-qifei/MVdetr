logs/multiviewx/aug_deform_trans_w_dec_lr0.0001_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-08_13-38-24
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 100, 'lr': 0.0001, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX'}
rpts:  torch.Size([60000, 6, 4, 2])
pos_emb size:  [ 80 125]
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6729],
        [ 0.6167, -2.6265],
        [-0.7281,  1.4702],
        [-0.8537, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.8407, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4412, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.4039e-05, -6.1167e-05],
        [-6.0329e-05, -6.1745e-05],
        [-5.9068e-05, -5.9252e-05],
        [-6.6520e-05, -6.6350e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6728],
        [ 0.6167, -2.6265],
        [-0.7280,  1.4702],
        [-0.8538, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(8.3756, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.7543, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.1980e-05, -1.0214e-04],
        [-3.8522e-05, -1.2726e-04],
        [-3.9339e-05, -1.1377e-04],
        [-3.8950e-05, -1.2573e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6728],
        [ 0.6168, -2.6265],
        [-0.7279,  1.4701],
        [-0.8537, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.9348, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6680, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.8085e-06, -1.6753e-04],
        [-1.5795e-05, -1.5557e-04],
        [-1.0776e-05, -1.4997e-04],
        [-1.2005e-05, -1.6539e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6168, -2.6265],
        [-0.7278,  1.4700],
        [-0.8536, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.1446, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5028, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 9.4143e-06, -1.4677e-04],
        [ 1.5524e-05, -1.6635e-04],
        [ 2.1761e-05, -1.6001e-04],
        [ 1.5166e-05, -1.6491e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6168, -2.6266],
        [-0.7278,  1.4700],
        [-0.8535, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.2942, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5344, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.4473e-05, -1.8974e-04],
        [ 5.3588e-05, -2.0517e-04],
        [ 5.5847e-05, -1.9717e-04],
        [ 5.6643e-05, -2.2670e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6168, -2.6266],
        [-0.7278,  1.4699],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.4460, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5563, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.3416e-05, -1.8715e-04],
        [ 6.6246e-05, -2.2685e-04],
        [ 5.3022e-05, -1.7199e-04],
        [ 5.1125e-05, -1.8327e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.8891, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4505, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 8.5055e-05, -2.2094e-04],
        [ 8.5324e-05, -2.1611e-04],
        [ 8.8166e-05, -2.3341e-04],
        [ 9.1730e-05, -2.0289e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4699],
        [-0.8533, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.3647, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3565, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.5679e-05, -1.8805e-04],
        [ 7.4118e-05, -1.9925e-04],
        [ 7.8954e-05, -1.8727e-04],
        [ 7.6803e-05, -2.0082e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.2428, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3220, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.9356e-05, -1.6650e-04],
        [ 7.0136e-05, -1.5864e-04],
        [ 7.5610e-05, -1.7703e-04],
        [ 7.7940e-05, -1.6439e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.1858, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5120, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.5672e-05, -1.8491e-04],
        [ 7.5154e-05, -1.8123e-04],
        [ 7.6995e-05, -2.0309e-04],
        [ 7.8016e-05, -1.8137e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.9458, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2673, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.9137e-05, -1.9482e-04],
        [ 7.1920e-05, -1.8745e-04],
        [ 8.7330e-05, -2.3200e-04],
        [ 7.4303e-05, -1.9436e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.6719, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4119, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.7597e-05, -1.8104e-04],
        [ 5.7818e-05, -1.8961e-04],
        [ 5.6831e-05, -1.8299e-04],
        [ 5.3424e-05, -1.8072e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.5481, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5822, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0272e-04, -2.1690e-04],
        [ 9.0524e-05, -1.6743e-04],
        [ 9.2907e-05, -2.0479e-04],
        [ 9.7644e-05, -1.8637e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4701],
        [-0.8532, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(9.4173, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.9509, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8532, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.8851, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6530, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0969e-04, -1.8268e-04],
        [ 9.8923e-05, -1.9388e-04],
        [ 1.0191e-04, -1.8433e-04],
        [ 1.0054e-04, -1.8223e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.9902, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2788, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.5705, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5979, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4702],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.4623, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5756, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4228e-04, -1.3881e-04],
        [ 1.3305e-04, -1.0600e-04],
        [ 1.3644e-04, -1.1575e-04],
        [ 1.4030e-04, -9.8999e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6265],
        [-0.7279,  1.4702],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.0932, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5023, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7280,  1.4702],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1367, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3033, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6169, -2.6266],
        [-0.7280,  1.4702],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1186, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3029, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0002, -0.0001],
        [ 0.0002, -0.0001],
        [ 0.0002, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6170, -2.6266],
        [-0.7280,  1.4703],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1250, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3050, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0002, -0.0002],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6170, -2.6266],
        [-0.7280,  1.4702],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.9429, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4688, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.2697e-04, -8.7495e-05],
        [ 1.5125e-04, -1.0348e-04],
        [ 1.4148e-04, -5.3539e-05],
        [ 1.3377e-04, -4.1507e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6729],
        [ 0.6171, -2.6266],
        [-0.7281,  1.4704],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.6923, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4222, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.7122e-04, -7.6574e-05],
        [ 1.6319e-04, -3.7622e-05],
        [ 1.6385e-04, -8.0349e-05],
        [ 1.8658e-04, -7.9651e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6729],
        [ 0.6171, -2.6265],
        [-0.7281,  1.4703],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2450, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1281, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4254e-04, -8.4810e-05],
        [ 1.3645e-04, -8.5368e-05],
        [ 1.4141e-04, -4.7699e-05],
        [ 1.3215e-04, -8.0443e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6729],
        [ 0.6171, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7134, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2174, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4957e-04, -9.0276e-05],
        [ 1.3950e-04, -4.6135e-05],
        [ 1.4511e-04, -7.7374e-05],
        [ 1.4158e-04, -8.6346e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6172, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.2879, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0446, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3467, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5114e-04, -4.1481e-05],
        [ 1.2383e-04, -5.7941e-05],
        [ 1.5279e-04, -4.9043e-05],
        [ 1.6507e-04, -3.1356e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6172, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.6329, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3950, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5765e-04, -7.6318e-05],
        [ 1.7563e-04, -1.0464e-04],
        [ 1.5870e-04, -7.9445e-05],
        [ 1.6975e-04, -5.3519e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6173, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4585, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0422, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1762, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5664e-04, -8.7072e-05],
        [ 1.3761e-04, -7.8184e-05],
        [ 1.2937e-04, -8.2756e-05],
        [ 1.5422e-04, -6.7519e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6173, -2.6265],
        [-0.7282,  1.4704],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0103, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0427, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0875, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5160e-04, -8.9359e-05],
        [ 1.4970e-04, -9.7333e-05],
        [ 1.6174e-04, -6.5940e-05],
        [ 1.5931e-04, -7.6600e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7281,  1.4704],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7499, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2285, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.3436e-04, -1.2752e-04],
        [ 1.4297e-04, -9.6980e-05],
        [ 1.4221e-04, -1.0691e-04],
        [ 1.5010e-04, -1.1203e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7282,  1.4704],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4185, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1516, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0856e-04, -5.3369e-05],
        [ 1.2970e-04, -5.1387e-05],
        [ 1.0260e-04, -2.0713e-05],
        [ 9.7553e-05, -6.4329e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7282,  1.4705],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.4235, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3654, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4832e-04, -2.3958e-05],
        [ 1.3341e-04, -5.7661e-05],
        [ 1.4735e-04, -3.6669e-05],
        [ 1.5509e-04, -4.3626e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7204, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2133, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 9.4259e-05, -1.5831e-05],
        [ 8.4509e-05, -1.4008e-05],
        [ 9.4303e-05, -1.0443e-05],
        [ 1.3739e-04, -8.7253e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7282,  1.4705],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0712, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0850, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 8.1169e-05, -3.8680e-05],
        [ 8.1388e-05, -2.7901e-05],
        [ 9.7725e-05, -5.6087e-06],
        [ 1.1447e-04, -2.5543e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.0480, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2841, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[9.9209e-05, 2.6745e-05],
        [8.9881e-05, 4.8397e-05],
        [1.0081e-04, 1.4944e-05],
        [1.0811e-04, 2.5498e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6733],
        [ 0.6174, -2.6264],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1862, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1190, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.7163e-05, -1.4933e-05],
        [ 6.8328e-05, -1.2041e-06],
        [ 7.6996e-05, -2.4494e-05],
        [ 9.2022e-05,  1.3805e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6732],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4705],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7764, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2300, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.0039e-04, 4.1017e-05],
        [1.1095e-04, 3.9858e-05],
        [7.5848e-05, 9.6623e-06],
        [8.1729e-05, 2.7306e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6733],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4705],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1714, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3085, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.1379e-04, 4.2001e-05],
        [9.0167e-05, 7.3490e-05],
        [5.7866e-05, 4.3976e-05],
        [8.9699e-05, 9.2452e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6733],
        [ 0.6175, -2.6264],
        [-0.7282,  1.4706],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7873, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0300, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.0382e-05, 1.5939e-05],
        [6.2003e-05, 4.7045e-05],
        [5.0447e-05, 5.4764e-05],
        [7.0232e-05, 4.5632e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6733],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5006, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0304, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1609, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.2154e-04, 5.8152e-05],
        [4.8129e-05, 7.1826e-05],
        [5.4288e-05, 6.5870e-05],
        [6.3949e-05, 4.0238e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5357, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0431, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1934, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.3498e-05, 4.5703e-05],
        [1.7484e-05, 4.9068e-05],
        [8.4106e-06, 2.6263e-05],
        [1.8335e-05, 6.4159e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2595, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9311, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.7890e-05, 5.5832e-05],
        [6.3208e-05, 7.4304e-05],
        [5.9448e-05, 5.8780e-05],
        [5.5331e-05, 1.8996e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8534, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2864, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1362, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.6961e-05, 3.7852e-05],
        [1.6685e-05, 1.0567e-05],
        [3.8764e-05, 2.4976e-05],
        [6.9952e-06, 4.7640e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6735],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8534, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1496, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9081, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.6203e-05, 6.0005e-05],
        [4.7300e-05, 4.6951e-05],
        [1.8122e-05, 4.2770e-05],
        [2.4419e-05, 3.6675e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6735],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8534, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2820, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1369, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[8.4820e-05, 9.2075e-05],
        [6.4108e-05, 9.2888e-05],
        [5.0736e-05, 9.2448e-05],
        [7.0517e-05, 1.2290e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6736],
        [ 0.6176, -2.6265],
        [-0.7282,  1.4707],
        [-0.8533, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.6102, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1919, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.4771e-05, 1.2266e-05],
        [2.5585e-05, 4.6423e-05],
        [6.7322e-05, 1.8790e-05],
        [2.2260e-05, 3.4574e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6735],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3850, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0309, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9387, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[8.3692e-05, 1.9395e-05],
        [5.4565e-05, 1.8509e-05],
        [2.4220e-05, 1.1697e-05],
        [5.4901e-05, 1.7092e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6736],
        [ 0.6176, -2.6266],
        [-0.7282,  1.4706],
        [-0.8532, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3345, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1420, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 3.9302e-05,  2.7218e-05],
        [-5.5156e-07,  2.5183e-05],
        [-6.2381e-06,  1.4387e-05],
        [-1.6720e-05,  3.3985e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6736],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4282, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1579, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2500e-05,  2.7901e-05],
        [ 3.4483e-07, -3.2801e-05],
        [ 5.8143e-06,  1.6335e-05],
        [-1.2677e-05,  1.0561e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6736],
        [ 0.6176, -2.6267],
        [-0.7282,  1.4706],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7884, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0274, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.1757e-06,  3.7048e-05],
        [-4.1378e-05,  1.0929e-05],
        [-3.0565e-06,  3.6376e-05],
        [-2.7680e-05,  4.7160e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6736],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2843, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1392, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[6.1505e-05, 4.6603e-05],
        [2.2220e-05, 3.1229e-05],
        [5.1262e-05, 6.7543e-05],
        [4.1405e-05, 4.4496e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0899, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0864, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.5568e-05, 7.1775e-05],
        [3.2843e-05, 5.1385e-05],
        [2.4499e-05, 5.2765e-05],
        [1.0236e-05, 7.4306e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2503, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0432, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9364, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.1116e-05, 1.9802e-05],
        [1.1226e-05, 2.6890e-05],
        [1.7010e-05, 4.3715e-05],
        [3.2037e-06, 3.7068e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4094, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1517, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.7981e-05, 5.9591e-05],
        [3.9740e-05, 6.2499e-05],
        [5.1375e-05, 6.0180e-05],
        [5.3027e-05, 7.8434e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6738],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4591, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0471, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9861, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.2310e-05, 5.2257e-05],
        [1.0140e-06, 3.2497e-05],
        [1.2587e-05, 6.2953e-05],
        [2.2658e-05, 5.2612e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6738],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.0589, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2903, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.4351e-05, 7.9620e-05],
        [9.9461e-05, 4.5123e-05],
        [5.8799e-05, 5.2516e-05],
        [9.8602e-05, 1.0532e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6739],
        [ 0.6177, -2.6266],
        [-0.7281,  1.4706],
        [-0.8529, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7942, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0482, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2553, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.9440e-05, 1.0848e-04],
        [1.4778e-05, 1.5320e-04],
        [1.3827e-05, 9.8307e-05],
        [4.1692e-05, 1.4644e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6739],
        [ 0.6176, -2.6265],
        [-0.7281,  1.4707],
        [-0.8529, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.9926, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0737, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 4.9289e-05, -4.1561e-05],
        [ 6.3804e-05,  1.2699e-05],
        [ 4.2743e-05, -3.1814e-05],
        [ 4.1227e-05, -1.3058e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6738],
        [ 0.6177, -2.6267],
        [-0.7281,  1.4706],
        [-0.8529, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4199, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1567, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 9.7442e-06,  1.7099e-05],
        [ 2.1151e-05, -1.9894e-05],
        [ 2.6900e-05, -2.9150e-05],
        [ 4.2314e-06, -4.4080e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6739],
        [ 0.6176, -2.6267],
        [-0.7281,  1.4706],
        [-0.8529, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2166, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9217, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.2289e-05, 5.8465e-05],
        [5.0626e-05, 3.3991e-05],
        [3.7016e-05, 6.6292e-05],
        [4.8585e-05, 7.7428e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6740],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4707],
        [-0.8528, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1421, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0996, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 2.7894e-05,  1.3692e-05],
        [ 3.1437e-05, -1.3247e-05],
        [ 3.9172e-05,  6.1681e-07],
        [-6.4016e-06,  2.0034e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6740],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4706],
        [-0.8529, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0130, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8786, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.6181e-05, 2.7709e-05],
        [4.2985e-05, 5.2862e-05],
        [4.5985e-05, 3.8668e-05],
        [2.9021e-05, 3.7160e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6740],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2142, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9241, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.1650e-05, 6.6176e-05],
        [9.8920e-06, 6.9968e-05],
        [1.8682e-05, 3.2457e-05],
        [9.9794e-06, 1.4244e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6741],
        [ 0.6176, -2.6266],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3912, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9525, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.3246e-05, -1.0903e-05],
        [ 4.5820e-05,  3.8929e-06],
        [ 4.3778e-05, -9.8019e-06],
        [ 3.1742e-05,  3.7427e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6741],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5089, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9817, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.8857e-05, 1.1407e-04],
        [1.8705e-05, 1.0011e-04],
        [5.1318e-05, 8.8351e-05],
        [6.2450e-06, 7.6896e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6743],
        [ 0.6175, -2.6266],
        [-0.7279,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3652, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1539, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.4630e-05, 4.0347e-05],
        [3.2299e-05, 1.9078e-05],
        [6.8089e-05, 3.0621e-06],
        [3.3071e-05, 2.9686e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6742],
        [ 0.6175, -2.6267],
        [-0.7279,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.9820, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0824, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.8715e-05, -3.2644e-05],
        [-3.5027e-05, -3.9223e-06],
        [-3.8951e-05, -1.2008e-05],
        [-4.1405e-05,  9.2998e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6742],
        [ 0.6174, -2.6267],
        [-0.7280,  1.4708],
        [-0.8529, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9931, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8776, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3734e-05,  2.5255e-05],
        [ 1.4228e-05,  4.9945e-06],
        [-1.9572e-05, -2.3746e-05],
        [ 1.0807e-05,  5.3358e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6743],
        [ 0.6174, -2.6267],
        [-0.7280,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3403, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0445, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9571, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.2490e-05, -8.9977e-06],
        [ 4.1736e-05,  1.9419e-05],
        [ 1.4566e-05, -1.7063e-05],
        [ 1.4494e-05,  1.4949e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6743],
        [ 0.6175, -2.6267],
        [-0.7279,  1.4708],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5553, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9868, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7846e-05,  9.5868e-05],
        [-9.9408e-06,  9.5450e-05],
        [-2.7915e-05,  6.3572e-05],
        [ 2.6835e-05,  5.8602e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7280,  1.4709],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3576, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1491, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.7954e-06,  5.2453e-05],
        [ 1.4627e-05,  2.6197e-05],
        [ 1.4343e-05,  4.4131e-05],
        [-9.6226e-06,  5.3796e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4709],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7469, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8256, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 2.2789e-05,  5.0046e-05],
        [ 2.2358e-05,  9.0442e-05],
        [ 3.8764e-05,  5.6110e-05],
        [-1.5280e-06,  2.6006e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.9097, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0637, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.8087e-06, -1.4467e-05],
        [ 1.3367e-05,  2.8123e-05],
        [-2.0681e-05,  3.5090e-07],
        [ 3.3147e-05,  2.1153e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4709],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7518, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2340, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.9824e-06, 6.3920e-05],
        [7.5485e-06, 4.8647e-05],
        [6.1652e-07, 2.0804e-05],
        [6.4521e-06, 7.9003e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6746],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4990, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9758, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.7394e-05, 7.5969e-05],
        [3.3074e-05, 1.4801e-05],
        [3.4943e-05, 6.0214e-05],
        [2.4335e-05, 5.4505e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6746],
        [ 0.6174, -2.6268],
        [-0.7279,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.6186, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9994, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.3828e-05, 9.2828e-05],
        [2.7103e-05, 9.6545e-05],
        [6.4374e-05, 5.7113e-05],
        [3.2281e-05, 8.6889e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6747],
        [ 0.6173, -2.6267],
        [-0.7278,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5843, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9995, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.6222e-05, 8.3462e-05],
        [4.7282e-05, 7.7483e-05],
        [3.9079e-06, 6.2561e-05],
        [6.1404e-05, 9.1919e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6747],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7063, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0113, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9031e-05, -2.7513e-05],
        [-1.2478e-05,  7.1098e-05],
        [ 8.0775e-07, -2.3237e-05],
        [-2.9428e-06, -5.3728e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6747],
        [ 0.6173, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2205, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0286, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1013, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.0887e-05,  2.5390e-05],
        [-7.0051e-05,  3.5569e-05],
        [-5.6499e-05,  6.2996e-05],
        [-2.9341e-05,  5.0434e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6748],
        [ 0.6172, -2.6268],
        [-0.7279,  1.4711],
        [-0.8529, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.6736, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0021, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2044e-05,  1.0295e-06],
        [-2.7575e-05,  4.7515e-05],
        [-5.5609e-05,  1.2616e-05],
        [-2.6748e-05,  4.0846e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6748],
        [ 0.6173, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5970, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9950, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1291e-05, -2.5884e-05],
        [-2.1234e-05,  9.9475e-06],
        [-2.4441e-05, -2.0387e-05],
        [-2.7873e-05,  2.5302e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6748],
        [ 0.6173, -2.6268],
        [-0.7279,  1.4710],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6219, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8036, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.4143e-05,  3.7766e-05],
        [-9.7367e-06, -2.4610e-05],
        [ 8.3245e-06,  4.6249e-05],
        [-2.9347e-06,  1.3265e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6749],
        [ 0.6173, -2.6268],
        [-0.7278,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1576, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9011, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.9847e-06,  4.4345e-05],
        [-5.0746e-05,  3.4257e-05],
        [-3.6479e-05,  3.9604e-05],
        [-1.9063e-05,  6.5237e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6749],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.8408, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0402, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.8246e-05,  5.1645e-05],
        [-3.8358e-05,  2.5699e-05],
        [-2.9207e-05,  5.9218e-06],
        [-5.1647e-05,  1.2452e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6749],
        [ 0.6172, -2.6268],
        [-0.7279,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3560, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9540, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.8956e-05,  5.1615e-05],
        [-8.6443e-05,  6.9896e-05],
        [-4.2052e-05,  8.6157e-05],
        [-3.7073e-05,  3.4223e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6750],
        [ 0.6172, -2.6267],
        [-0.7278,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1568, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1095, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.5559e-05,  3.5962e-05],
        [-5.3900e-05,  3.7875e-05],
        [-6.8315e-05,  2.0099e-05],
        [-3.6022e-05,  7.0043e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6750],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5955, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1905, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5995e-05, -3.4658e-05],
        [-1.0542e-05, -1.2963e-05],
        [-1.7941e-05,  2.1619e-05],
        [ 3.0787e-05, -7.3075e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6750],
        [ 0.6172, -2.6268],
        [-0.7278,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7139, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8186, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6015e-05,  1.3459e-06],
        [-2.5859e-05,  4.8602e-05],
        [ 1.8183e-05,  1.5746e-05],
        [-1.0771e-05,  1.5297e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6751],
        [ 0.6172, -2.6267],
        [-0.7277,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1555, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9018, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8907e-05, -1.4258e-05],
        [-5.0779e-05, -1.8578e-05],
        [-7.6291e-05, -2.0737e-05],
        [-3.4327e-05, -3.7361e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6751],
        [ 0.6172, -2.6268],
        [-0.7278,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3465, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9436, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5061e-04,  1.6634e-05],
        [-1.1874e-04,  2.5975e-05],
        [-1.3365e-04,  8.6998e-05],
        [-1.1768e-04,  4.2584e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6752],
        [ 0.6171, -2.6267],
        [-0.7278,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5681, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9881, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.2951e-05, -6.7492e-06],
        [-5.1791e-05,  6.6889e-06],
        [-6.8593e-05, -2.3716e-05],
        [-6.9804e-05,  1.0771e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6752],
        [ 0.6171, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5513, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9923, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.1141e-05, -2.0342e-05],
        [-4.3758e-05,  4.7092e-06],
        [-9.6463e-05, -9.1284e-05],
        [-7.6061e-05, -5.1435e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6752],
        [ 0.6171, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1097, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8954, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2003e-04, -2.5781e-05],
        [-6.7135e-05, -1.4255e-05],
        [-5.7765e-05, -7.8278e-05],
        [-7.1379e-05, -2.8323e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6753],
        [ 0.6171, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.8918, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8603, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.8521e-05, -2.7465e-05],
        [-9.6499e-05, -6.6167e-05],
        [-3.8158e-05, -2.4662e-05],
        [-4.3872e-05, -4.5320e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6753],
        [ 0.6171, -2.6268],
        [-0.7276,  1.4711],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1991, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9065, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2305e-04, -6.0421e-05],
        [-1.2124e-04, -7.7185e-05],
        [-1.7159e-04, -6.9236e-05],
        [-1.0941e-04, -1.5560e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6753],
        [ 0.6170, -2.6268],
        [-0.7277,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7562, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0271, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.2046e-05, -9.9007e-05],
        [-6.7163e-05, -6.5685e-05],
        [-1.0541e-04, -7.7576e-05],
        [-9.3990e-05, -8.7730e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6754],
        [ 0.6171, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2821, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9354, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.1759e-05, -2.2887e-05],
        [-6.2276e-05, -4.8227e-05],
        [-7.2860e-05, -5.7087e-05],
        [-9.4695e-05, -2.9119e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6755],
        [ 0.6170, -2.6267],
        [-0.7276,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1055, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0952, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.2366e-05, -6.5776e-05],
        [-5.8949e-05, -1.0508e-05],
        [-3.5932e-05, -2.5942e-05],
        [-2.1958e-05, -9.3296e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6755],
        [ 0.6170, -2.6267],
        [-0.7275,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2260, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1186, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:100, loss: 0.011186, Time: 41.9
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.9960e-05, -1.1027e-04],
        [-1.1350e-04, -4.2673e-05],
        [-1.1764e-04, -5.9682e-05],
        [-1.7048e-04, -2.3625e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6755],
        [ 0.6170, -2.6267],
        [-0.7276,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3954, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9528, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.6806e-05, -9.8803e-05],
        [-9.5261e-05, -1.1537e-04],
        [-7.8772e-05, -3.6731e-05],
        [-8.2111e-05, -1.0279e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6756],
        [ 0.6170, -2.6268],
        [-0.7275,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7844, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0249, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.2089e-05, -1.3053e-06],
        [-1.3368e-04,  2.4957e-05],
        [-7.8293e-05, -2.6779e-05],
        [-6.1830e-05, -1.8993e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6757],
        [ 0.6170, -2.6266],
        [-0.7275,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4635, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7665, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.0084e-05, -9.4102e-05],
        [-5.7709e-05, -3.2904e-05],
        [-5.9667e-05, -6.9580e-05],
        [-8.8480e-05, -7.3662e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6757],
        [ 0.6170, -2.6267],
        [-0.7275,  1.4712],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6439, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7992, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.5742e-05, -1.2212e-04],
        [-8.2684e-05, -8.4261e-05],
        [-2.8052e-05, -5.5462e-05],
        [-4.1230e-05, -8.8096e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6757],
        [ 0.6170, -2.6268],
        [-0.7274,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7373, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8215, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.5026e-05, -1.3565e-04],
        [-3.3320e-05, -1.2288e-04],
        [-3.0400e-05, -1.4265e-04],
        [-2.1127e-05, -1.5197e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6758],
        [ 0.6171, -2.6268],
        [-0.7274,  1.4711],
        [-0.8529, -2.7502]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5260, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1816, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.0979e-05, -6.1951e-05],
        [-5.8252e-06, -7.0928e-05],
        [-2.6642e-05, -3.7030e-05],
        [-4.9404e-05, -5.2403e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6759],
        [ 0.6171, -2.6267],
        [-0.7274,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7116, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8238, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0088e-04, -1.0252e-04],
        [-9.0099e-05, -1.6035e-04],
        [-1.2740e-04, -1.2702e-04],
        [-1.1080e-04, -1.2928e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6759],
        [ 0.6171, -2.6268],
        [-0.7274,  1.4711],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3945, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7620, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0729e-04, -7.8766e-05],
        [-8.6793e-05, -1.3373e-04],
        [-8.0773e-05, -1.7571e-04],
        [-8.5186e-05, -1.4764e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6760],
        [ 0.6171, -2.6268],
        [-0.7274,  1.4710],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7571, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6321, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6399e-04, -1.2735e-04],
        [-1.5537e-04, -7.1569e-05],
        [-1.2168e-04, -1.2855e-04],
        [-1.4216e-04, -9.0469e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6760],
        [ 0.6170, -2.6268],
        [-0.7274,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.8147, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0452, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.4635e-05,  1.7419e-05],
        [-6.4021e-05, -1.6251e-05],
        [-5.0660e-05, -6.8034e-06],
        [-4.8709e-05, -3.4196e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6762],
        [ 0.6172, -2.6267],
        [-0.7273,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7932, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8323, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.7593e-05, -6.8337e-05],
        [-8.4096e-05, -4.0992e-05],
        [-9.7383e-05, -6.7195e-05],
        [-5.5359e-05, -4.6402e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6761],
        [ 0.6171, -2.6268],
        [-0.7273,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9079, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8539, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.5921e-05, -1.2554e-05],
        [-8.3583e-05, -3.9170e-05],
        [-1.1630e-04, -7.0479e-05],
        [-1.0365e-04, -3.3511e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6762],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4711],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4985, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9782, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.4953e-05, -1.2212e-04],
        [-2.3006e-05, -7.0409e-05],
        [-1.1079e-05, -1.0594e-04],
        [-7.2840e-05, -1.3371e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6762],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0020, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8752, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3508e-04, -1.1171e-04],
        [-1.2338e-04, -4.9917e-05],
        [-1.0281e-04, -5.7035e-05],
        [-1.1295e-04, -6.9054e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6762],
        [ 0.6171, -2.6268],
        [-0.7273,  1.4712],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.8219, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8345, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.7006e-05, -7.5840e-05],
        [-5.9192e-05, -3.2596e-05],
        [-6.1350e-05, -8.3544e-05],
        [-6.9233e-05, -1.3277e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6763],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.8178, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8352, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.6838e-05, -8.0227e-05],
        [-3.0748e-05, -9.1426e-05],
        [-1.9184e-05, -1.8448e-05],
        [-5.2588e-05, -5.6372e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6764],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2745, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9232, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0001, -0.0001],
        [-0.0001, -0.0001],
        [-0.0001, -0.0001],
        [-0.0001, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6763],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0431, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8896, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.3813e-05, -6.1021e-05],
        [ 3.1130e-05, -3.5108e-05],
        [-2.6344e-05, -4.7681e-05],
        [-2.3630e-05, -6.9223e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6765],
        [ 0.6173, -2.6268],
        [-0.7271,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0491, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8883, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.5568e-05, -8.9044e-05],
        [-2.6383e-05, -1.5577e-05],
        [-2.1815e-05, -4.9436e-05],
        [-1.3157e-05, -2.8049e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6765],
        [ 0.6173, -2.6268],
        [-0.7271,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5369, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9882, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0439e-04, -7.2293e-05],
        [-1.1114e-04, -8.3520e-05],
        [-1.2559e-04, -6.6248e-05],
        [-9.7593e-05, -2.0162e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6766],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4712],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0923, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7003, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.0909e-05, -2.9781e-05],
        [-1.0768e-04, -4.5550e-05],
        [-9.3190e-05, -1.4634e-05],
        [-9.1325e-05, -7.5198e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6766],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3690, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0434, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9606, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2454e-04, -2.9538e-05],
        [-1.4249e-04, -5.7072e-05],
        [-1.3513e-04, -1.3368e-04],
        [-1.2688e-04, -1.2059e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6767],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4711],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7341, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8346, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6470e-04, -1.0272e-04],
        [-2.1848e-04, -1.3226e-04],
        [-2.2014e-04, -3.4381e-05],
        [-2.1661e-04, -1.0577e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6767],
        [ 0.6172, -2.6269],
        [-0.7273,  1.4712],
        [-0.8532, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7367, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8194, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0394e-04, -6.9228e-05],
        [-1.7129e-04, -1.1870e-04],
        [-1.0118e-04, -8.3614e-05],
        [-1.3779e-04, -1.0245e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6767],
        [ 0.6172, -2.6269],
        [-0.7271,  1.4711],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2828, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0424, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7414, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2937e-04, -5.5846e-05],
        [-1.1639e-04, -2.3674e-06],
        [-1.2056e-04, -5.3874e-05],
        [-1.1107e-04, -9.3657e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6768],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4711],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7592, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0428, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6375, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7309e-04, -7.4605e-05],
        [-1.6586e-04, -1.4502e-04],
        [-1.8910e-04, -5.6021e-05],
        [-1.7925e-04, -9.2724e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6768],
        [ 0.6172, -2.6269],
        [-0.7272,  1.4712],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6108, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8046, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8008e-04, -5.0360e-05],
        [-2.2550e-04, -1.0958e-04],
        [-2.2367e-04, -6.1505e-05],
        [-1.3686e-04, -4.5125e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6769],
        [ 0.6172, -2.6269],
        [-0.7273,  1.4712],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3162, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7401, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3323e-04, -9.7471e-05],
        [-1.3710e-04, -1.0989e-04],
        [-1.3555e-04, -7.6252e-05],
        [-1.4945e-04, -1.1126e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6768],
        [ 0.6173, -2.6269],
        [-0.7272,  1.4711],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1460, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8997, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.0394e-04, -9.1827e-05],
        [-2.1710e-04, -6.9205e-05],
        [-2.2831e-04, -7.1817e-05],
        [-2.1989e-04, -9.5103e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6769],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4712],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7212, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6181, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1679e-04, -1.3134e-04],
        [-1.9138e-04, -8.7647e-05],
        [-1.8677e-04, -4.6925e-05],
        [-1.5947e-04, -7.2869e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6769],
        [ 0.6173, -2.6269],
        [-0.7272,  1.4712],
        [-0.8531, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7381, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0451, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8378, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8657e-04,  1.3409e-05],
        [-2.0751e-04,  3.3232e-05],
        [-1.6069e-04, -3.9174e-05],
        [-1.9335e-04,  2.7395e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6770],
        [ 0.6173, -2.6267],
        [-0.7272,  1.4712],
        [-0.8531, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2941, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7337, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7102e-04, -2.1523e-05],
        [-1.6476e-04,  8.7282e-05],
        [-2.0603e-04,  2.2402e-05],
        [-1.4033e-04,  1.4732e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6770],
        [ 0.6173, -2.6267],
        [-0.7272,  1.4713],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0647, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6887, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1965e-04,  1.8328e-05],
        [-8.9011e-05,  1.3382e-05],
        [-1.5839e-04,  1.9544e-05],
        [-9.6572e-05, -1.9443e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6771],
        [ 0.6174, -2.6268],
        [-0.7272,  1.4713],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5798, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7988, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6200e-04,  4.6679e-06],
        [-1.2820e-04,  5.0160e-06],
        [-1.2335e-04, -3.7333e-05],
        [-1.3100e-04, -2.0389e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6771],
        [ 0.6174, -2.6268],
        [-0.7271,  1.4712],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5902, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9997, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1554e-04,  2.3055e-05],
        [-2.6197e-04,  4.7468e-05],
        [-2.4098e-04, -4.7881e-05],
        [-3.0895e-04,  4.1289e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6772],
        [ 0.6172, -2.6267],
        [-0.7272,  1.4712],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2838, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7275, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6898e-04, -5.5220e-05],
        [-1.8000e-04, -8.1281e-05],
        [-1.5163e-04, -9.5090e-05],
        [-1.4934e-04, -5.1683e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6771],
        [ 0.6173, -2.6269],
        [-0.7271,  1.4712],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4364, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7591, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.0301e-04, -3.8805e-05],
        [-1.9592e-04, -3.3977e-05],
        [-2.1241e-04, -6.8837e-05],
        [-1.5448e-04, -4.0630e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6772],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1297, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0315, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6889, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.3920e-04, -3.8074e-05],
        [-2.6971e-04, -9.8099e-05],
        [-3.0104e-04, -6.0459e-05],
        [-2.5446e-04, -1.0845e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6772],
        [ 0.6172, -2.6269],
        [-0.7273,  1.4712],
        [-0.8531, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0610, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6840, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.3373e-04, -6.0455e-05],
        [-2.4313e-04, -5.1055e-05],
        [-2.5168e-04, -9.7374e-05],
        [-2.4040e-04, -6.1267e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6772],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9060, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6577, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.0445e-04,  2.1100e-05],
        [-2.5376e-04,  1.2082e-05],
        [-2.0360e-04, -5.4205e-05],
        [-2.6531e-04, -1.2959e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6773],
        [ 0.6173, -2.6267],
        [-0.7272,  1.4713],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5869, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8002, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9180e-04, -7.9093e-05],
        [-2.3339e-04, -3.9735e-05],
        [-1.8382e-04, -1.3416e-04],
        [-2.1828e-04, -7.4835e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6772],
        [ 0.6173, -2.6268],
        [-0.7271,  1.4712],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2437, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9302, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.3156e-04, -2.9276e-05],
        [-3.5044e-04, -6.0361e-05],
        [-3.3093e-04,  1.7057e-05],
        [-2.2791e-04, -4.3410e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6773],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4714],
        [-0.8531, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3480, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7415, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.6719e-04, -3.8247e-05],
        [-2.7315e-04, -2.4670e-05],
        [-2.8915e-04,  3.3375e-05],
        [-2.9444e-04, -8.6442e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6773],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4714],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5307, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5753, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.6222e-04, -7.4772e-05],
        [-2.8117e-04,  5.7782e-05],
        [-2.3505e-04, -5.8738e-05],
        [-1.9852e-04, -2.9457e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6773],
        [ 0.6172, -2.6267],
        [-0.7272,  1.4713],
        [-0.8530, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0494, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0339, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8778, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7991e-04,  1.0840e-04],
        [-2.3106e-04,  6.0212e-05],
        [-1.7873e-04,  3.6487e-05],
        [-2.3662e-04,  6.9392e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6775],
        [ 0.6173, -2.6267],
        [-0.7271,  1.4714],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9655, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6743, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.0515e-04,  5.3154e-05],
        [-2.6017e-04,  1.1223e-04],
        [-3.0080e-04,  7.1095e-05],
        [-2.3654e-04,  7.5948e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6775],
        [ 0.6172, -2.6266],
        [-0.7272,  1.4714],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0037, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8760, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.3938e-04, -2.9475e-05],
        [-3.8813e-04, -5.1232e-05],
        [-3.4989e-04, -3.1308e-05],
        [-3.5422e-04, -8.5988e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6775],
        [ 0.6171, -2.6268],
        [-0.7273,  1.4713],
        [-0.8532, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3291, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7340, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.1322e-04, -1.0765e-04],
        [-3.5154e-04, -5.5514e-05],
        [-2.9359e-04, -4.4481e-05],
        [-3.6173e-04, -1.3122e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6774],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4713],
        [-0.8532, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9342, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6637, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9998e-04, -6.1807e-05],
        [-3.0951e-04, -6.2747e-05],
        [-3.2116e-04, -3.5543e-05],
        [-2.6085e-04, -3.1032e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6775],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4713],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  33
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1782, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7072, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2946e-04, -6.4694e-05],
        [-2.7078e-04, -3.6847e-05],
        [-2.5881e-04, -9.5658e-05],
        [-2.4634e-04, -1.0018e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6776],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4713],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9115, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0312, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6447, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7126e-04,  1.7780e-05],
        [-2.3940e-04,  3.0033e-05],
        [-2.6372e-04,  1.2362e-05],
        [-2.4939e-04, -3.5150e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6777],
        [ 0.6173, -2.6267],
        [-0.7272,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1611, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9068, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.6367e-04, -5.0237e-05],
        [-2.6043e-04,  9.2495e-06],
        [-3.7075e-04, -3.4764e-05],
        [-3.2123e-04, -2.1423e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6777],
        [ 0.6173, -2.6267],
        [-0.7273,  1.4713],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0592, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0482, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7083, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0003, -0.0001],
        [-0.0003, -0.0001],
        [-0.0003, -0.0002],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6776],
        [ 0.6173, -2.6269],
        [-0.7272,  1.4712],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1905, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7082, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2416e-04, -2.8122e-05],
        [-4.0223e-04, -1.4911e-04],
        [-4.2929e-04, -2.7358e-05],
        [-3.3468e-04, -7.6802e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6777],
        [ 0.6172, -2.6269],
        [-0.7273,  1.4714],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7017, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6139, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0003, -0.0002],
        [-0.0003, -0.0001],
        [-0.0003, -0.0002],
        [-0.0003, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6776],
        [ 0.6173, -2.6269],
        [-0.7272,  1.4713],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4528, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7632, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1087e-04, -9.4317e-05],
        [-4.1340e-04, -8.1844e-05],
        [-4.0267e-04, -1.5815e-04],
        [-4.3668e-04, -9.5600e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6777],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4713],
        [-0.8532, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.8470, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6495, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.6227e-04, -5.0515e-05],
        [-3.2354e-04, -4.4337e-05],
        [-3.0577e-04, -1.0480e-04],
        [-2.7284e-04, -9.0988e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6778],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4714],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2642, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7364, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.8871e-04, -1.1605e-04],
        [-4.2091e-04, -1.1086e-04],
        [-3.0034e-04, -6.2859e-05],
        [-3.8327e-04, -1.0917e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6778],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4714],
        [-0.8532, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9752, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6741, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.0068e-04,  4.9300e-06],
        [-2.8571e-04, -1.0327e-04],
        [-3.5781e-04, -1.8583e-05],
        [-3.7577e-04, -5.2136e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6780],
        [ 0.6174, -2.6268],
        [-0.7272,  1.4715],
        [-0.8531, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1013, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9022, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.2930e-04, -6.4895e-05],
        [-3.2671e-04, -5.0722e-05],
        [-2.7481e-04, -4.8956e-05],
        [-3.2239e-04, -1.5326e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6780],
        [ 0.6174, -2.6267],
        [-0.7271,  1.4715],
        [-0.8531, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5475, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7908, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0004, -0.0002],
        [-0.0004, -0.0002],
        [-0.0004, -0.0001],
        [-0.0003, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6779],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4715],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7305, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6201, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.8196e-04, -1.2751e-04],
        [-2.4638e-04, -4.3062e-05],
        [-3.4242e-04, -6.1257e-05],
        [-3.4815e-04, -1.4649e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6780],
        [ 0.6175, -2.6267],
        [-0.7272,  1.4716],
        [-0.8531, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6948, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8249, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0004, -0.0001],
        [-0.0004, -0.0002],
        [-0.0004, -0.0002],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6781],
        [ 0.6175, -2.6268],
        [-0.7272,  1.4715],
        [-0.8532, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9807, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6798, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.1340e-04, -2.5260e-05],
        [-5.0732e-04, -7.2158e-05],
        [-4.9329e-04, -3.3822e-05],
        [-4.8400e-04, -8.2939e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6783],
        [ 0.6173, -2.6267],
        [-0.7274,  1.4717],
        [-0.8533, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4581, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9637, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0001],
        [-0.0005, -0.0002],
        [-0.0006, -0.0003],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6782],
        [ 0.6173, -2.6268],
        [-0.7275,  1.4715],
        [-0.8532, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9073, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4575, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.3351e-04, -7.6533e-05],
        [-4.3366e-04, -7.5309e-05],
        [-5.0473e-04, -5.7341e-05],
        [-4.1559e-04, -6.4858e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6784],
        [ 0.6175, -2.6267],
        [-0.7274,  1.4718],
        [-0.8532, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5555, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5827, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.3834e-04, -1.0770e-04],
        [-4.7487e-04, -1.3494e-04],
        [-3.4562e-04, -7.5040e-05],
        [-4.1883e-04, -1.4357e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6784],
        [ 0.6175, -2.6267],
        [-0.7272,  1.4718],
        [-0.8532, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5935, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7908, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.7880e-04, -1.0845e-04],
        [-6.0344e-04, -1.4892e-04],
        [-5.6310e-04, -9.0507e-05],
        [-5.5440e-04, -1.7011e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6785],
        [ 0.6173, -2.6267],
        [-0.7275,  1.4719],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9882, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8707, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.0574e-04, -9.7652e-05],
        [-6.6184e-04, -1.6296e-04],
        [-5.9223e-04, -1.6163e-04],
        [-5.2716e-04, -1.0333e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6785],
        [ 0.6173, -2.6267],
        [-0.7275,  1.4718],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4752, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5774, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0001],
        [-0.0005, -0.0001],
        [-0.0005, -0.0002],
        [-0.0005, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6786],
        [ 0.6175, -2.6266],
        [-0.7274,  1.4719],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2678, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7282, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0005, -0.0001],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6785],
        [ 0.6174, -2.6266],
        [-0.7274,  1.4719],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1889, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7123, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0006, -0.0002],
        [-0.0005, -0.0002],
        [-0.0005, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6787],
        [ 0.6174, -2.6267],
        [-0.7274,  1.4720],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4076, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0314, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7443, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0003],
        [-0.0005, -0.0002],
        [-0.0005, -0.0001],
        [-0.0005, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6787],
        [ 0.6175, -2.6267],
        [-0.7274,  1.4721],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3986, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5545, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.8761e-04, -1.0513e-04],
        [-5.6161e-04, -9.3191e-05],
        [-5.9122e-04, -8.6074e-05],
        [-4.9847e-04, -7.7801e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6789],
        [ 0.6174, -2.6266],
        [-0.7275,  1.4722],
        [-0.8534, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4480, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5662, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0003],
        [-0.0007, -0.0003],
        [-0.0008, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6788],
        [ 0.6173, -2.6268],
        [-0.7276,  1.4721],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2406, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7198, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6789],
        [ 0.6174, -2.6267],
        [-0.7275,  1.4721],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1527, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7069, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0005, -0.0001],
        [-0.0005, -0.0001],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6789],
        [ 0.6176, -2.6266],
        [-0.7274,  1.4722],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3134, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5421, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6790],
        [ 0.6173, -2.6267],
        [-0.7275,  1.4721],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4322, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5671, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0008, -0.0002],
        [-0.0008, -0.0003],
        [-0.0008, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6791],
        [ 0.6173, -2.6267],
        [-0.7276,  1.4722],
        [-0.8537, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0066, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6770, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0003],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6791],
        [ 0.6174, -2.6267],
        [-0.7275,  1.4722],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4078, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5574, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0007, -0.0002],
        [-0.0006, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6792],
        [ 0.6174, -2.6267],
        [-0.7274,  1.4723],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4383, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7688, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0003],
        [-0.0008, -0.0003],
        [-0.0008, -0.0003],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6791],
        [ 0.6173, -2.6268],
        [-0.7277,  1.4723],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6674, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0326, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5987, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0008, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6793],
        [ 0.6174, -2.6267],
        [-0.7276,  1.4723],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5399, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5895, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0006, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6794],
        [ 0.6175, -2.6267],
        [-0.7274,  1.4724],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1488, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5025, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0003],
        [-0.0008, -0.0003],
        [-0.0007, -0.0003],
        [-0.0008, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6793],
        [ 0.6175, -2.6269],
        [-0.7276,  1.4723],
        [-0.8536, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8350, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4469, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0006, -0.0002],
        [-0.0008, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6794],
        [ 0.6176, -2.6268],
        [-0.7276,  1.4724],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4395, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7692, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0001],
        [-0.0006, -0.0001],
        [-0.0005, -0.0001],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6795],
        [ 0.6176, -2.6267],
        [-0.7274,  1.4725],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5210, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5788, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0006, -0.0002],
        [-0.0006, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6795],
        [ 0.6177, -2.6267],
        [-0.7275,  1.4725],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2273, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5165, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0008, -0.0002],
        [-0.0008, -0.0002],
        [-0.0008, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6795],
        [ 0.6176, -2.6268],
        [-0.7277,  1.4724],
        [-0.8537, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7371, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4144, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0009, -0.0002],
        [-0.0009, -0.0002],
        [-0.0010, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6796],
        [ 0.6175, -2.6268],
        [-0.7278,  1.4725],
        [-0.8538, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9259, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6630, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0008, -0.0002],
        [-0.0008, -0.0001],
        [-0.0008, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6797],
        [ 0.6176, -2.6268],
        [-0.7277,  1.4726],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9926, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6769, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0011, -0.0002],
        [-0.0010, -0.0002],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6797],
        [ 0.6174, -2.6267],
        [-0.7280,  1.4726],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3870, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5524, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0011, -0.0002],
        [-0.0010, -0.0002],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6797],
        [ 0.6174, -2.6268],
        [-0.7280,  1.4725],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3435, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5515, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0003],
        [-0.0008, -0.0003],
        [-0.0009, -0.0003],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6797],
        [ 0.6178, -2.6268],
        [-0.7279,  1.4724],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7704, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6231, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0001],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0008, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6799],
        [ 0.6179, -2.6267],
        [-0.7278,  1.4726],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6268, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6017, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0010, -0.0002],
        [-0.0009, -0.0001],
        [-0.0010, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6799],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4726],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7361, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6259, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.6241e-04, -5.8802e-05],
        [-8.2923e-04,  5.3261e-07],
        [-9.2558e-04, -4.6802e-05],
        [-9.8104e-04, -5.0752e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6800],
        [ 0.6178, -2.6266],
        [-0.7280,  1.4727],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7280, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6209, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0009, -0.0002],
        [-0.0009, -0.0002],
        [-0.0009, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6799],
        [ 0.6177, -2.6267],
        [-0.7280,  1.4726],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6171, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6025, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0002],
        [-0.0008, -0.0002],
        [-0.0010, -0.0001],
        [-0.0008, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6800],
        [ 0.6179, -2.6267],
        [-0.7281,  1.4727],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2890, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5273, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:200, loss: 0.002636, Time: 79.3
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0003],
        [-0.0011, -0.0002],
        [-0.0010, -0.0003],
        [-0.0010, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6798],
        [ 0.6177, -2.6268],
        [-0.7281,  1.4726],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5405, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0432, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5945, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0001],
        [-0.0010, -0.0002],
        [-0.0011, -0.0002],
        [-0.0011, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6800],
        [ 0.6177, -2.6267],
        [-0.7282,  1.4727],
        [-0.8539, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0105, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4804, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0001],
        [-0.0009, -0.0002],
        [-0.0009, -0.0001],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6800],
        [ 0.6179, -2.6268],
        [-0.7281,  1.4727],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7547, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6295, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.0713e-04, -5.1676e-05],
        [-6.2346e-04, -1.9334e-04],
        [-7.5615e-04, -3.5313e-05],
        [-5.7791e-04, -1.2097e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6801],
        [ 0.6182, -2.6268],
        [-0.7280,  1.4728],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2999, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0332, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5263, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.3148e-04, -1.6874e-04],
        [-7.7501e-04, -8.8744e-05],
        [-6.7076e-04, -1.1361e-04],
        [-8.7783e-04, -1.2862e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6800],
        [ 0.6180, -2.6267],
        [-0.7279,  1.4728],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6161, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5978, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0293e-03, -1.4297e-04],
        [-1.0885e-03, -1.0604e-04],
        [-1.1449e-03, -1.4096e-04],
        [-1.0933e-03, -6.4945e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6800],
        [ 0.6177, -2.6267],
        [-0.7284,  1.4728],
        [-0.8539, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2416, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0316, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5115, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1472e-03, -1.9636e-04],
        [-9.6557e-04, -1.8106e-04],
        [-9.8579e-04, -1.1616e-04],
        [-9.9663e-04, -9.6440e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6799],
        [ 0.6179, -2.6268],
        [-0.7283,  1.4728],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4521, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5686, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0858e-03, -1.5212e-04],
        [-1.0693e-03, -6.5693e-05],
        [-1.1813e-03, -1.5913e-05],
        [-1.0324e-03, -5.9311e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6800],
        [ 0.6178, -2.6267],
        [-0.7285,  1.4729],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9152, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0475, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4781, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.1711e-04, -1.2343e-04],
        [-9.1584e-04, -8.3900e-05],
        [-9.2048e-04, -6.2827e-05],
        [-9.1890e-04, -7.1352e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6800],
        [ 0.6179, -2.6267],
        [-0.7283,  1.4729],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1128, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4976, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.7071e-04, -1.3202e-04],
        [-9.7169e-04, -1.4751e-04],
        [-9.6761e-04, -5.4294e-05],
        [-7.9784e-04, -7.5006e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6800],
        [ 0.6178, -2.6268],
        [-0.7283,  1.4729],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9107, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0447, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4715, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1198e-03, -4.8479e-05],
        [-1.3046e-03, -4.6479e-05],
        [-1.2812e-03, -2.4644e-06],
        [-1.2676e-03, -4.3092e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6800],
        [ 0.6175, -2.6267],
        [-0.7287,  1.4730],
        [-0.8540, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4141, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5643, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3735e-03, -1.9651e-04],
        [-1.4016e-03, -7.9400e-05],
        [-1.4890e-03, -1.4344e-04],
        [-1.3591e-03, -1.4032e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6799],
        [ 0.6174, -2.6267],
        [-0.7289,  1.4729],
        [-0.8541, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8632, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0313, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4353, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.2804e-04, -5.0139e-05],
        [-7.9627e-04, -3.3518e-06],
        [-7.7100e-04, -9.6680e-06],
        [-5.7606e-04, -3.1154e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6800],
        [ 0.6180, -2.6266],
        [-0.7282,  1.4730],
        [-0.8533, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5851, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5895, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1258e-03, -9.2180e-05],
        [-1.1429e-03, -8.1932e-05],
        [-1.0537e-03, -5.6028e-05],
        [-1.0840e-03, -4.5038e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6800],
        [ 0.6176, -2.6267],
        [-0.7285,  1.4730],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6433, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6061, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0599e-03, -1.0918e-04],
        [-9.1802e-04, -9.1982e-05],
        [-1.0730e-03, -9.1529e-05],
        [-8.2688e-04, -5.8100e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6799],
        [ 0.6178, -2.6267],
        [-0.7285,  1.4729],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4475, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5661, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013, -0.0002],
        [-0.0011, -0.0002],
        [-0.0013, -0.0003],
        [-0.0011, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6798],
        [ 0.6176, -2.6269],
        [-0.7287,  1.4728],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8099, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0428, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4476, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0133e-03, -8.1134e-05],
        [-9.5480e-04, -9.7715e-05],
        [-1.0932e-03, -6.6621e-05],
        [-1.0047e-03, -9.5570e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6800],
        [ 0.6178, -2.6268],
        [-0.7286,  1.4730],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6963, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6168, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0001],
        [-0.0011, -0.0002],
        [-0.0012, -0.0002],
        [-0.0012, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6799],
        [ 0.6176, -2.6269],
        [-0.7287,  1.4729],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4954, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3811, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0011, -0.0003],
        [-0.0012, -0.0003],
        [-0.0011, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6799],
        [ 0.6176, -2.6270],
        [-0.7287,  1.4729],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9695, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4680, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0862e-03, -7.7677e-05],
        [-1.1028e-03, -1.2553e-04],
        [-1.0324e-03, -7.2536e-05],
        [-1.0845e-03,  2.3689e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6800],
        [ 0.6176, -2.6268],
        [-0.7285,  1.4731],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6624, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6050, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0081e-03, -5.7461e-05],
        [-1.0565e-03, -1.0738e-04],
        [-1.0339e-03, -1.4223e-04],
        [-1.0338e-03, -1.8611e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6801],
        [ 0.6177, -2.6268],
        [-0.7285,  1.4730],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3496, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5466, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0002],
        [-0.0010, -0.0002],
        [-0.0008, -0.0002],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6799],
        [ 0.6177, -2.6269],
        [-0.7283,  1.4730],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9181, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6589, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1516e-03, -2.7749e-05],
        [-1.1033e-03,  9.4593e-06],
        [-1.1576e-03, -5.5775e-05],
        [-1.1550e-03, -1.2464e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6801],
        [ 0.6176, -2.6267],
        [-0.7286,  1.4732],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4810, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0451, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5864, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0009, -0.0001],
        [-0.0009, -0.0002],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6800],
        [ 0.6178, -2.6269],
        [-0.7283,  1.4731],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0294, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4770, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.0993e-04, -1.0078e-04],
        [-8.1194e-04, -1.6501e-04],
        [-8.3717e-04, -6.7901e-05],
        [-7.9747e-04, -1.0465e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6801],
        [ 0.6179, -2.6269],
        [-0.7283,  1.4732],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6471, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0473, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6241, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0002],
        [-0.0013, -0.0001],
        [-0.0012, -0.0001],
        [-0.0012, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6800],
        [ 0.6174, -2.6269],
        [-0.7286,  1.4732],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8529, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0322, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4351, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2059e-03,  9.2054e-05],
        [-1.2668e-03,  2.6983e-06],
        [-1.1350e-03,  5.6894e-05],
        [-1.2106e-03,  4.2376e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6803],
        [ 0.6174, -2.6267],
        [-0.7285,  1.4734],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4589, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5602, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.1346e-04, -1.6241e-04],
        [-1.0057e-03, -1.2619e-04],
        [-1.0617e-03, -8.9806e-05],
        [-1.0285e-03, -8.2997e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6800],
        [ 0.6177, -2.6269],
        [-0.7285,  1.4732],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2685, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5331, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0231e-03, -1.6861e-04],
        [-1.0189e-03, -1.6243e-04],
        [-9.1554e-04, -6.9982e-05],
        [-9.7687e-04, -1.6139e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6800],
        [ 0.6176, -2.6269],
        [-0.7283,  1.4733],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4073, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5527, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.5721e-04, -3.1906e-05],
        [-8.9735e-04,  3.2551e-05],
        [-8.4696e-04, -3.1131e-06],
        [-9.0461e-04,  8.6983e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6802],
        [ 0.6177, -2.6267],
        [-0.7282,  1.4733],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9366, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4630, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3254e-03, -1.6127e-04],
        [-1.0953e-03, -1.2672e-04],
        [-1.0512e-03, -9.3697e-05],
        [-1.1212e-03, -8.9149e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6801],
        [ 0.6175, -2.6269],
        [-0.7284,  1.4732],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8199, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4433, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2220e-03, -2.6350e-05],
        [-1.2025e-03, -1.0729e-04],
        [-1.3096e-03, -2.8920e-05],
        [-1.2587e-03, -7.1691e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6802],
        [ 0.6174, -2.6268],
        [-0.7287,  1.4733],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6868, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4212, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0917e-03,  1.4644e-05],
        [-1.0377e-03,  1.5460e-06],
        [-1.1070e-03, -2.0161e-06],
        [-9.0176e-04,  1.4127e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6803],
        [ 0.6175, -2.6267],
        [-0.7285,  1.4733],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3102, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5376, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2367e-03, -4.6573e-05],
        [-1.0783e-03, -1.0437e-04],
        [-1.3176e-03, -5.5605e-05],
        [-1.1379e-03, -6.2850e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6802],
        [ 0.6175, -2.6268],
        [-0.7287,  1.4733],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3885, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5654, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1245e-03, -6.6568e-05],
        [-1.3473e-03, -6.2600e-05],
        [-1.1521e-03, -5.4259e-05],
        [-1.3298e-03, -4.3181e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6802],
        [ 0.6172, -2.6268],
        [-0.7285,  1.4733],
        [-0.8539, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4702, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3690, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.7831e-04, -4.6624e-06],
        [-9.6242e-04,  1.0852e-05],
        [-9.4739e-04, -1.3040e-05],
        [-8.6114e-04, -8.8479e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6803],
        [ 0.6176, -2.6267],
        [-0.7283,  1.4734],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9727, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4661, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4002e-03, -3.0669e-05],
        [-1.2360e-03, -4.1807e-05],
        [-1.1203e-03,  5.6417e-05],
        [-1.3436e-03, -5.0992e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6803],
        [ 0.6173, -2.6268],
        [-0.7284,  1.4734],
        [-0.8539, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5545, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3778, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2196e-03,  4.4404e-06],
        [-1.2097e-03, -1.2089e-05],
        [-1.0232e-03, -4.5817e-05],
        [-1.0527e-03, -2.8854e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6803],
        [ 0.6173, -2.6267],
        [-0.7283,  1.4733],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6303, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6036, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3702e-03,  7.3215e-05],
        [-1.5551e-03,  1.4089e-04],
        [-1.4960e-03,  1.2223e-04],
        [-1.4591e-03,  7.7450e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6804],
        [ 0.6169, -2.6266],
        [-0.7288,  1.4735],
        [-0.8540, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1935, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5059, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0631e-03, -3.2958e-05],
        [-1.0834e-03, -7.9959e-05],
        [-1.1417e-03,  9.4667e-06],
        [-9.9157e-04, -7.3499e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6803],
        [ 0.6174, -2.6268],
        [-0.7284,  1.4734],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2998, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0441, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5481, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0179e-03, -1.3188e-04],
        [-8.6384e-04, -1.1156e-04],
        [-1.0270e-03, -1.0610e-04],
        [-8.3613e-04, -9.9835e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6802],
        [ 0.6176, -2.6269],
        [-0.7283,  1.4733],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7980, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6334, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0574e-03, -3.9219e-05],
        [-1.1045e-03, -7.1352e-05],
        [-9.5947e-04, -1.2953e-04],
        [-1.0853e-03, -3.9385e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6803],
        [ 0.6173, -2.6268],
        [-0.7282,  1.4733],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6895, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4127, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1618e-03,  3.0714e-05],
        [-1.1781e-03,  1.0685e-04],
        [-9.7266e-04,  7.8332e-05],
        [-1.0073e-03,  8.0268e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6803],
        [ 0.6172, -2.6267],
        [-0.7282,  1.4735],
        [-0.8536, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7231, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0456, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6358, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2729e-03,  6.6946e-05],
        [-1.3170e-03,  3.4821e-05],
        [-1.2961e-03,  9.1945e-05],
        [-1.1635e-03, -6.3149e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6804],
        [ 0.6171, -2.6267],
        [-0.7285,  1.4735],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8664, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4591, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5488e-03,  1.9762e-05],
        [-1.3334e-03, -9.8351e-06],
        [-1.2500e-03, -2.3901e-05],
        [-1.3946e-03, -1.2382e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6803],
        [ 0.6170, -2.6268],
        [-0.7285,  1.4734],
        [-0.8540, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7071, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4118, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0001],
        [-0.0010, -0.0001],
        [-0.0008, -0.0001],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6802],
        [ 0.6174, -2.6269],
        [-0.7281,  1.4733],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1951, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0323, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5037, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0477e-03, -1.7043e-05],
        [-1.2077e-03,  5.7164e-05],
        [-1.2634e-03,  1.0981e-05],
        [-1.1201e-03, -5.9236e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6804],
        [ 0.6171, -2.6267],
        [-0.7285,  1.4734],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6217, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4010, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2933e-03, -6.4490e-06],
        [-1.3862e-03, -6.0170e-05],
        [-1.3623e-03, -4.3282e-05],
        [-1.2432e-03, -7.7032e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6804],
        [ 0.6170, -2.6268],
        [-0.7286,  1.4734],
        [-0.8539, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5195, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3816, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1818e-03,  1.7145e-05],
        [-1.0285e-03, -1.0523e-04],
        [-1.0167e-03,  1.1982e-05],
        [-1.0743e-03,  2.4197e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6805],
        [ 0.6173, -2.6269],
        [-0.7282,  1.4735],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7610, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4304, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3117e-03,  1.0531e-05],
        [-1.3086e-03, -8.5763e-05],
        [-1.3057e-03, -4.1578e-05],
        [-1.4050e-03, -6.7094e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6805],
        [ 0.6170, -2.6268],
        [-0.7285,  1.4734],
        [-0.8541, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8989, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4578, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0098e-03,  8.6883e-05],
        [-1.0122e-03,  2.7636e-05],
        [-1.1978e-03,  9.1140e-05],
        [-9.4057e-04,  1.0173e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6806],
        [ 0.6173, -2.6267],
        [-0.7284,  1.4736],
        [-0.8536, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9383, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0467, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6810, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.1719e-04, -2.8719e-05],
        [-1.0249e-03, -1.5207e-05],
        [-1.0844e-03, -8.3993e-06],
        [-1.0668e-03, -1.1081e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6806],
        [ 0.6173, -2.6268],
        [-0.7283,  1.4735],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9318, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4536, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.3401e-04,  3.0930e-05],
        [-1.0245e-03,  1.0608e-04],
        [-1.1352e-03, -8.6927e-06],
        [-1.1672e-03,  1.7231e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6807],
        [ 0.6173, -2.6266],
        [-0.7283,  1.4735],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8519, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4493, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4159e-03, -4.5835e-05],
        [-1.2289e-03, -9.3738e-05],
        [-1.2017e-03, -1.1720e-04],
        [-1.3526e-03, -3.8235e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6806],
        [ 0.6170, -2.6268],
        [-0.7284,  1.4734],
        [-0.8540, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5667, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0421, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3976, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0001],
        [-0.0012,  0.0001],
        [-0.0013,  0.0001],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6808],
        [ 0.6170, -2.6266],
        [-0.7284,  1.4737],
        [-0.8540, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7085, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6187, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0484e-03,  1.0511e-04],
        [-1.1574e-03,  5.3767e-05],
        [-1.1656e-03,  1.0612e-04],
        [-1.0681e-03,  8.7009e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6809],
        [ 0.6171, -2.6267],
        [-0.7283,  1.4737],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1493, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5102, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0002],
        [-0.0012,  0.0002],
        [-0.0010,  0.0002],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6809],
        [ 0.6171, -2.6266],
        [-0.7282,  1.4737],
        [-0.8540, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5348, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3884, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0013,  0.0002],
        [-0.0013,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6810],
        [ 0.6170, -2.6265],
        [-0.7284,  1.4738],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3250, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0320, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5291, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0002],
        [-0.0012,  0.0002],
        [-0.0013,  0.0002],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6810],
        [ 0.6170, -2.6265],
        [-0.7285,  1.4739],
        [-0.8538, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0784, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4945, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1633e-03,  1.4851e-04],
        [-1.0506e-03,  7.6456e-05],
        [-1.1728e-03,  1.3187e-04],
        [-1.3276e-03,  2.0863e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6810],
        [ 0.6172, -2.6266],
        [-0.7284,  1.4738],
        [-0.8539, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9887, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4667, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1976e-03,  7.9021e-05],
        [-1.2621e-03,  1.1448e-04],
        [-1.0693e-03,  6.5391e-05],
        [-1.1685e-03,  5.6505e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6810],
        [ 0.6169, -2.6266],
        [-0.7283,  1.4737],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8771, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4541, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0001],
        [-0.0011,  0.0002],
        [-0.0012,  0.0003],
        [-0.0011,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6811],
        [ 0.6171, -2.6265],
        [-0.7284,  1.4740],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6524, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4037, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0187e-03, -1.3324e-05],
        [-1.1083e-03,  8.3200e-05],
        [-1.0095e-03,  7.1697e-05],
        [-1.0339e-03,  7.9113e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6810],
        [ 0.6171, -2.6266],
        [-0.7282,  1.4738],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9263, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4636, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0013,  0.0003],
        [-0.0014,  0.0004],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6813],
        [ 0.6169, -2.6264],
        [-0.7286,  1.4741],
        [-0.8539, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2450, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3307, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0011,  0.0002],
        [-0.0012,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6813],
        [ 0.6170, -2.6265],
        [-0.7285,  1.4740],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0524, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4781, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0863e-03,  1.3382e-04],
        [-1.1682e-03,  1.5436e-04],
        [-1.1383e-03,  9.6334e-05],
        [-1.1891e-03,  1.4627e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6812],
        [ 0.6170, -2.6265],
        [-0.7284,  1.4739],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1089, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0296, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4811, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0015,  0.0002],
        [-0.0014,  0.0003],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6814],
        [ 0.6167, -2.6265],
        [-0.7287,  1.4741],
        [-0.8539, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4779, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3712, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0012,  0.0001],
        [-0.0013,  0.0001],
        [-0.0010,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6814],
        [ 0.6169, -2.6266],
        [-0.7285,  1.4740],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9684, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0460, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4857, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2608e-03,  1.3397e-04],
        [-1.0868e-03,  1.0885e-04],
        [-9.7216e-04,  5.2005e-05],
        [-1.2112e-03,  1.6047e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6814],
        [ 0.6171, -2.6266],
        [-0.7282,  1.4739],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2728, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0452, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5449, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0001],
        [-0.0010,  0.0002],
        [-0.0011,  0.0002],
        [-0.0010,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6814],
        [ 0.6171, -2.6265],
        [-0.7284,  1.4741],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3795, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3436, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0014,  0.0003],
        [-0.0015,  0.0003],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6816],
        [ 0.6167, -2.6264],
        [-0.7288,  1.4743],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4211, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3550, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2423e-03,  1.7287e-04],
        [-1.1887e-03,  1.6429e-04],
        [-1.3066e-03,  1.1815e-04],
        [-1.1331e-03,  9.9995e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6815],
        [ 0.6170, -2.6265],
        [-0.7286,  1.4741],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0654, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4870, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009,  0.0002],
        [-0.0010,  0.0002],
        [-0.0010,  0.0003],
        [-0.0010,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6816],
        [ 0.6171, -2.6264],
        [-0.7283,  1.4742],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5247, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3812, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0003],
        [-0.0012,  0.0003],
        [-0.0012,  0.0002],
        [-0.0011,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6817],
        [ 0.6169, -2.6264],
        [-0.7284,  1.4742],
        [-0.8536, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6223, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4007, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0015,  0.0002],
        [-0.0014,  0.0004],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6817],
        [ 0.6166, -2.6264],
        [-0.7287,  1.4744],
        [-0.8538, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5618, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3844, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002],
        [-0.0011,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6817],
        [ 0.6168, -2.6265],
        [-0.7286,  1.4742],
        [-0.8536, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5670, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3872, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0012,  0.0003],
        [-0.0010,  0.0003],
        [-0.0013,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6818],
        [ 0.6169, -2.6264],
        [-0.7283,  1.4743],
        [-0.8538, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4943, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3814, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0013,  0.0003],
        [-0.0016,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6818],
        [ 0.6168, -2.6263],
        [-0.7289,  1.4744],
        [-0.8539, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5025, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0473, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3951, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0003],
        [-0.0011,  0.0002],
        [-0.0013,  0.0002],
        [-0.0010,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6818],
        [ 0.6170, -2.6265],
        [-0.7285,  1.4743],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6702, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0415, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4170, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0017,  0.0004],
        [-0.0016,  0.0004],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6164, -2.6262],
        [-0.7288,  1.4745],
        [-0.8542, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6111, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3920, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0016,  0.0004],
        [-0.0017,  0.0004],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6820],
        [ 0.6165, -2.6262],
        [-0.7289,  1.4745],
        [-0.8541, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0426, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2828, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0015,  0.0005],
        [-0.0015,  0.0005],
        [-0.0015,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6820],
        [ 0.6166, -2.6261],
        [-0.7287,  1.4746],
        [-0.8540, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2298, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5125, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0002],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002],
        [-0.0013,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6818],
        [ 0.6168, -2.6264],
        [-0.7286,  1.4743],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6335, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3993, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0012,  0.0002],
        [-0.0015,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6819],
        [ 0.6169, -2.6264],
        [-0.7287,  1.4744],
        [-0.8539, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7554, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4302, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0014,  0.0002],
        [-0.0015,  0.0002],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6819],
        [ 0.6167, -2.6264],
        [-0.7288,  1.4744],
        [-0.8541, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5426, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0422, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5929, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0586e-03,  7.2805e-05],
        [-1.1435e-03,  2.6409e-05],
        [-1.0786e-03,  6.7416e-05],
        [-1.3609e-03,  5.2220e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6817],
        [ 0.6170, -2.6266],
        [-0.7283,  1.4742],
        [-0.8539, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1209, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7039, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0014,  0.0004],
        [-0.0013,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6819],
        [ 0.6167, -2.6262],
        [-0.7285,  1.4745],
        [-0.8539, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8643, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4473, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0015,  0.0004],
        [-0.0014,  0.0002],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6819],
        [ 0.6166, -2.6262],
        [-0.7287,  1.4744],
        [-0.8538, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2904, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3340, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1845e-03,  1.4032e-04],
        [-1.1305e-03,  4.8366e-05],
        [-1.3320e-03,  1.9104e-04],
        [-1.2364e-03,  1.6863e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6818],
        [ 0.6170, -2.6265],
        [-0.7286,  1.4744],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8290, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4335, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0017,  0.0002],
        [-0.0018,  0.0002],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6164, -2.6264],
        [-0.7290,  1.4744],
        [-0.8540, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2394, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0315, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3108, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0013,  0.0003],
        [-0.0014,  0.0003],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6819],
        [ 0.6169, -2.6263],
        [-0.7287,  1.4745],
        [-0.8539, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0619, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2805, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0005],
        [-0.0019,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6821],
        [ 0.6164, -2.6261],
        [-0.7290,  1.4747],
        [-0.8543, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8856, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0322, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4416, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0013,  0.0001],
        [-0.0012,  0.0001],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6819],
        [ 0.6169, -2.6264],
        [-0.7284,  1.4743],
        [-0.8538, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4518, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3663, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2567e-03,  7.4422e-05],
        [-1.1668e-03,  4.4838e-05],
        [-1.3775e-03,  5.4137e-05],
        [-1.1977e-03,  1.0788e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6818],
        [ 0.6171, -2.6265],
        [-0.7286,  1.4743],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0483, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4956, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0002],
        [-0.0014,  0.0002],
        [-0.0012,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6819],
        [ 0.6168, -2.6264],
        [-0.7284,  1.4744],
        [-0.8538, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9657, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0461, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4853, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0015,  0.0003],
        [-0.0013,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6168, -2.6263],
        [-0.7285,  1.4744],
        [-0.8538, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9721, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4668, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1408e-03,  1.2820e-04],
        [-1.1523e-03,  1.7062e-04],
        [-1.3446e-03,  8.6012e-05],
        [-1.2910e-03,  1.4968e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6819],
        [ 0.6171, -2.6264],
        [-0.7285,  1.4743],
        [-0.8536, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8611, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4546, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0015,  0.0002],
        [-0.0017,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6168, -2.6263],
        [-0.7288,  1.4745],
        [-0.8538, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3990, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0330, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3457, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0001],
        [-0.0013,  0.0002],
        [-0.0015,  0.0002],
        [-0.0015,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6819],
        [ 0.6170, -2.6263],
        [-0.7286,  1.4744],
        [-0.8538, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0881, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0467, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3111, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0014,  0.0002],
        [-0.0017,  0.0003],
        [-0.0018,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6821],
        [ 0.6169, -2.6263],
        [-0.7289,  1.4746],
        [-0.8540, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6574, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4042, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:300, loss: 0.001347, Time: 116.2
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4650e-03,  9.7328e-05],
        [-1.1989e-03,  9.1185e-05],
        [-1.3574e-03,  7.6297e-05],
        [-1.4197e-03,  3.3460e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6172, -2.6264],
        [-0.7285,  1.4744],
        [-0.8536, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7796, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4266, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0002],
        [-0.0018,  0.0002],
        [-0.0016,  0.0003],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6820],
        [ 0.6166, -2.6262],
        [-0.7287,  1.4746],
        [-0.8537, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0818, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2961, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0013,  0.0001],
        [-0.0014,  0.0001],
        [-0.0012,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6171, -2.6264],
        [-0.7285,  1.4744],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7218, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4214, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4955e-03,  1.0208e-04],
        [-1.5980e-03,  1.0447e-04],
        [-1.5510e-03,  8.6124e-05],
        [-1.5285e-03,  1.2986e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6169, -2.6264],
        [-0.7287,  1.4744],
        [-0.8537, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4217, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3552, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0016,  0.0002],
        [-0.0014,  0.0001],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6169, -2.6263],
        [-0.7285,  1.4745],
        [-0.8535, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2949, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0313, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3216, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6925e-03,  1.7438e-04],
        [-1.5893e-03,  1.5426e-04],
        [-1.6670e-03,  1.3536e-04],
        [-1.4324e-03,  6.5405e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6820],
        [ 0.6169, -2.6263],
        [-0.7288,  1.4745],
        [-0.8536, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5075, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0456, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3926, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6494e-03,  1.7159e-04],
        [-1.4047e-03, -1.5519e-05],
        [-1.7045e-03,  1.3698e-04],
        [-1.4699e-03,  1.0005e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6820],
        [ 0.6171, -2.6264],
        [-0.7288,  1.4745],
        [-0.8536, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7023, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0415, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4234, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0012,  0.0002],
        [-0.0013,  0.0002],
        [-0.0012,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6821],
        [ 0.6173, -2.6262],
        [-0.7283,  1.4745],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2058, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3290, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3661e-03,  1.4078e-04],
        [-1.1022e-03,  1.1626e-05],
        [-1.3252e-03,  1.5886e-04],
        [-1.1768e-03,  1.0971e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6820],
        [ 0.6174, -2.6264],
        [-0.7284,  1.4745],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3267, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3352, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0014,  0.0002],
        [-0.0014,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6172, -2.6262],
        [-0.7284,  1.4745],
        [-0.8535, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3089, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3336, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4531e-03,  8.5861e-05],
        [-1.5526e-03,  1.5899e-04],
        [-1.5468e-03,  1.4399e-04],
        [-1.5914e-03,  1.1958e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6170, -2.6262],
        [-0.7286,  1.4745],
        [-0.8537, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2330, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3172, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4758e-03,  6.7994e-05],
        [-1.4306e-03,  9.4581e-05],
        [-1.4016e-03,  9.0096e-05],
        [-1.2416e-03,  1.2624e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6171, -2.6263],
        [-0.7284,  1.4745],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2542, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3298, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0001],
        [-0.0013,  0.0002],
        [-0.0013,  0.0002],
        [-0.0012,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6820],
        [ 0.6173, -2.6262],
        [-0.7283,  1.4745],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3128, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0426, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5477, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0018,  0.0002],
        [-0.0016,  0.0003],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6822],
        [ 0.6167, -2.6261],
        [-0.7286,  1.4747],
        [-0.8538, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7832, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0309, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2184, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0001],
        [-0.0015,  0.0002],
        [-0.0015,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6820],
        [ 0.6171, -2.6262],
        [-0.7285,  1.4745],
        [-0.8535, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2014, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3166, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4608e-03,  9.5267e-05],
        [-1.2317e-03,  1.3041e-04],
        [-1.4500e-03,  1.1584e-04],
        [-1.4476e-03,  1.5610e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6173, -2.6262],
        [-0.7284,  1.4745],
        [-0.8535, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0581, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2939, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0003],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6821],
        [ 0.6170, -2.6260],
        [-0.7286,  1.4747],
        [-0.8537, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9724, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2719, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6821],
        [ 0.6173, -2.6261],
        [-0.7284,  1.4746],
        [-0.8536, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3806, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3550, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0002],
        [-0.0015,  0.0002],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6820],
        [ 0.6171, -2.6261],
        [-0.7283,  1.4746],
        [-0.8535, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6601, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0426, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4173, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0014,  0.0003],
        [-0.0013,  0.0002],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6821],
        [ 0.6172, -2.6259],
        [-0.7282,  1.4747],
        [-0.8533, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7961, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4365, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0013,  0.0002],
        [-0.0012,  0.0002],
        [-0.0011,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6821],
        [ 0.6173, -2.6260],
        [-0.7281,  1.4747],
        [-0.8531, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4825, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3726, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0016,  0.0003],
        [-0.0014,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6821],
        [ 0.6170, -2.6260],
        [-0.7283,  1.4747],
        [-0.8535, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4084, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3600, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0001],
        [-0.0012,  0.0002],
        [-0.0011,  0.0002],
        [-0.0011,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6820],
        [ 0.6175, -2.6260],
        [-0.7280,  1.4747],
        [-0.8531, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0991, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2992, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010,  0.0002],
        [-0.0010,  0.0002],
        [-0.0011,  0.0002],
        [-0.0011,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6821],
        [ 0.6177, -2.6261],
        [-0.7280,  1.4746],
        [-0.8531, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2813, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3383, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0014,  0.0002],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6822],
        [ 0.6173, -2.6260],
        [-0.7284,  1.4748],
        [-0.8534, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3550, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3458, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0019,  0.0004],
        [-0.0017,  0.0004],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6822],
        [ 0.6168, -2.6258],
        [-0.7286,  1.4749],
        [-0.8536, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2309, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0332, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3127, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6822],
        [ 0.6172, -2.6259],
        [-0.7283,  1.4748],
        [-0.8536, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9267, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2637, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0014,  0.0003],
        [-0.0012,  0.0003],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6821],
        [ 0.6173, -2.6259],
        [-0.7281,  1.4748],
        [-0.8534, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5295, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3920, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6822],
        [ 0.6171, -2.6259],
        [-0.7285,  1.4748],
        [-0.8536, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7550, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4339, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0014,  0.0002],
        [-0.0013,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6821],
        [ 0.6173, -2.6259],
        [-0.7281,  1.4748],
        [-0.8533, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6507, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4061, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0015,  0.0003],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6822],
        [ 0.6172, -2.6259],
        [-0.7283,  1.4749],
        [-0.8533, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5358, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3828, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0013,  0.0003],
        [-0.0015,  0.0004],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6823],
        [ 0.6174, -2.6259],
        [-0.7283,  1.4749],
        [-0.8534, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5500, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3837, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0013,  0.0002],
        [-0.0014,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6822],
        [ 0.6174, -2.6259],
        [-0.7283,  1.4749],
        [-0.8532, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6042, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3987, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0002],
        [-0.0015,  0.0003],
        [-0.0016,  0.0003],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6822],
        [ 0.6172, -2.6258],
        [-0.7285,  1.4748],
        [-0.8534, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3572, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3518, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0018,  0.0003],
        [-0.0017,  0.0003],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6822],
        [ 0.6170, -2.6258],
        [-0.7285,  1.4748],
        [-0.8533, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1343, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3039, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0004],
        [-0.0012,  0.0004],
        [-0.0012,  0.0004],
        [-0.0012,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6823],
        [ 0.6175, -2.6258],
        [-0.7281,  1.4750],
        [-0.8531, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2456, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3187, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0015,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6823],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4750],
        [-0.8535, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1322, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2982, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6822],
        [ 0.6173, -2.6258],
        [-0.7283,  1.4748],
        [-0.8533, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4411, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3618, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0016,  0.0004],
        [-0.0014,  0.0003],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6824],
        [ 0.6172, -2.6256],
        [-0.7282,  1.4749],
        [-0.8536, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1157, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0435, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3102, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0014,  0.0004],
        [-0.0015,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6825],
        [ 0.6173, -2.6257],
        [-0.7284,  1.4750],
        [-0.8537, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4610, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3684, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0014,  0.0004],
        [-0.0015,  0.0004],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6824],
        [ 0.6174, -2.6257],
        [-0.7283,  1.4749],
        [-0.8535, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1420, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3032, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0002],
        [-0.0011,  0.0002],
        [-0.0013,  0.0003],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6822],
        [ 0.6177, -2.6258],
        [-0.7281,  1.4749],
        [-0.8532, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8582, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4493, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0004],
        [-0.0015,  0.0004],
        [-0.0012,  0.0004],
        [-0.0014,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6824],
        [ 0.6173, -2.6257],
        [-0.7281,  1.4749],
        [-0.8534, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2010, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3239, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0015,  0.0004],
        [-0.0014,  0.0004],
        [-0.0017,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6825],
        [ 0.6173, -2.6256],
        [-0.7283,  1.4750],
        [-0.8536, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1375, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3074, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0016,  0.0004],
        [-0.0017,  0.0004],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6825],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4750],
        [-0.8536, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3369, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3481, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0019,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6825],
        [ 0.6170, -2.6257],
        [-0.7286,  1.4749],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9696, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2663, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0013,  0.0002],
        [-0.0017,  0.0003],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6824],
        [ 0.6175, -2.6258],
        [-0.7285,  1.4749],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1229, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0420, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3086, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0012,  0.0003],
        [-0.0012,  0.0003],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6824],
        [ 0.6176, -2.6257],
        [-0.7281,  1.4749],
        [-0.8532, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5143, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0323, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3675, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0003],
        [-0.0012,  0.0002],
        [-0.0013,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6824],
        [ 0.6176, -2.6259],
        [-0.7282,  1.4748],
        [-0.8533, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7243, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4173, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0003],
        [-0.0012,  0.0002],
        [-0.0011,  0.0003],
        [-0.0011,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6824],
        [ 0.6176, -2.6258],
        [-0.7280,  1.4748],
        [-0.8531, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1637, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3115, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0014,  0.0004],
        [-0.0015,  0.0004],
        [-0.0015,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6825],
        [ 0.6174, -2.6256],
        [-0.7283,  1.4750],
        [-0.8535, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0335, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4774, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0017,  0.0004],
        [-0.0019,  0.0005],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6825],
        [ 0.6171, -2.6257],
        [-0.7287,  1.4750],
        [-0.8536, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5350, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3814, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0018,  0.0005],
        [-0.0017,  0.0005],
        [-0.0016,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4750],
        [-0.8536, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7988, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2345, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0004],
        [-0.0013,  0.0004],
        [-0.0011,  0.0003],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6825],
        [ 0.6175, -2.6257],
        [-0.7279,  1.4749],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  35
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  36
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  43
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  35
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  41
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  42
gt_cnt:  38
gt_cnt:  37
gt_cnt:  44
gt_cnt:  41
gt_cnt:  41
gt_cnt:  37
gt_cnt:  35
gt_cnt:  42
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  41
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  40
gt_cnt:  36
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  38
gt_cnt:  41
gt_cnt:  40
gt_cnt:  40
gt_cnt:  39
gt_cnt:  40
gt_cnt:  35
gt_cnt:  42
gt_cnt:  38
gt_cnt:  37
gt_cnt:  40
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  42
gt_cnt:  41
gt_cnt:  40
gt_cnt:  41
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  41
gt_cnt:  42
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  35
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  37
gt_cnt:  36
gt_cnt:  37
gt_cnt:  39
gt_cnt:  36
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  41
gt_cnt:  36
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  39
gt_cnt:  36
gt_cnt:  44
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  40
gt_cnt:  36
gt_cnt:  37
gt_cnt:  39
gt_cnt:  37
gt_cnt:  44
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  35
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  34
gt_cnt:  37
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  35
gt_cnt:  38
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  36
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  42
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  36
gt_cnt:  35
gt_cnt:  39
gt_cnt:  36
gt_cnt:  35
gt_cnt:  42
gt_cnt:  37
gt_cnt:  42
gt_cnt:  40
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  43
gt_cnt:  33
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  36
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  41
gt_cnt:  36
gt_cnt:  44
gt_cnt:  40
gt_cnt:  35
gt_cnt:  44
gt_cnt:  40
gt_cnt:  42
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  35
gt_cnt:  36
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  41
gt_cnt:  38
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  43
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  37
gt_cnt:  43
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  42
gt_cnt:  40
gt_cnt:  35
gt_cnt:  41
gt_cnt:  42
gt_cnt:  42
gt_cnt:  38
gt_cnt:  38
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  40
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  35
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  43
gt_cnt:  35
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  42
gt_cnt:  42
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  39
gt_cnt:  35
gt_cnt:  38
gt_cnt:  34
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  36
gt_cnt:  43
gt_cnt:  41
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  42
gt_cnt:  39
gt_cnt:  35
gt_cnt:  41
gt_cnt:  42
gt_cnt:  42
gt_cnt:  40
gt_cnt:  42
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
{'loss_ce': tensor(1.4934, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3812, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0016,  0.0004],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6173, -2.6257],
        [-0.7287,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9990, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2782, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0018,  0.0004],
        [-0.0017,  0.0003],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6825],
        [ 0.6171, -2.6257],
        [-0.7286,  1.4749],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1902, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3070, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0004],
        [-0.0015,  0.0004],
        [-0.0014,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6826],
        [ 0.6174, -2.6257],
        [-0.7282,  1.4749],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2944, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3327, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0003],
        [-0.0012,  0.0004],
        [-0.0011,  0.0004],
        [-0.0010,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6825],
        [ 0.6177, -2.6257],
        [-0.7280,  1.4749],
        [-0.8530, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0517, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0458, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3019, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0015,  0.0004],
        [-0.0015,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6175, -2.6257],
        [-0.7283,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0010, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2809, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0014,  0.0003],
        [-0.0012,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6824],
        [ 0.6176, -2.6258],
        [-0.7280,  1.4747],
        [-0.8533, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1258, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5033, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:360, loss: 0.001398, Time: 138.3
Testing...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7285,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4032, device='cuda:0'), 'loss_center': tensor(0.0363, device='cuda:0')}
loss: tensor(0.1533, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267,
         0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267,
         0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267,
         0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267,
         0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267, 0.5267,
         0.5267, 0.5267, 0.5267, 0.5267, 0.5267]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6174, -2.6257],
        [-0.7284,  1.4750],
        [-0.8536, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4068, device='cuda:0'), 'loss_center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.1579, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130,
         0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130,
         0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130,
         0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130,
         0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130, 0.5130,
         0.5130, 0.5130, 0.5130, 0.5130, 0.5130]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4751],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3875, device='cuda:0'), 'loss_center': tensor(0.0378, device='cuda:0')}
loss: tensor(0.1531, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409,
         0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409,
         0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409,
         0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409,
         0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409, 0.5409,
         0.5409, 0.5409, 0.5409, 0.5409, 0.5409]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7285,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3815, device='cuda:0'), 'loss_center': tensor(0.0381, device='cuda:0')}
loss: tensor(0.1526, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576,
         0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576,
         0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576,
         0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576,
         0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576, 0.5576,
         0.5576, 0.5576, 0.5576, 0.5576, 0.5576]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3947, device='cuda:0'), 'loss_center': tensor(0.0329, device='cuda:0')}
loss: tensor(0.1447, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4751],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3944, device='cuda:0'), 'loss_center': tensor(0.0336, device='cuda:0')}
loss: tensor(0.1462, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545,
         0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545,
         0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545,
         0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545,
         0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545, 0.5545,
         0.5545, 0.5545, 0.5545, 0.5545, 0.5545]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7285,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4131, device='cuda:0'), 'loss_center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.1595, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339,
         0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339,
         0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339,
         0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339,
         0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339,
         0.5339, 0.5339, 0.5339, 0.5339, 0.5339]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0005],
        [-0.0016,  0.0005],
        [-0.0016,  0.0005],
        [-0.0016,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6173, -2.6257],
        [-0.7284,  1.4750],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4300, device='cuda:0'), 'loss_center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.1628, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241,
         0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241,
         0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241,
         0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241,
         0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241, 0.5241,
         0.5241, 0.5241, 0.5241, 0.5241, 0.5241]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7285,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4005, device='cuda:0'), 'loss_center': tensor(0.0415, device='cuda:0')}
loss: tensor(0.1631, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305,
         0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305,
         0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305,
         0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305,
         0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305, 0.5305,
         0.5305, 0.5305, 0.5305, 0.5305, 0.5305]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3950, device='cuda:0'), 'loss_center': tensor(0.0392, device='cuda:0')}
loss: tensor(0.1574, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392,
         0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392,
         0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392,
         0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392,
         0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392, 0.5392,
         0.5392, 0.5392, 0.5392, 0.5392, 0.5392]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4136, device='cuda:0'), 'loss_center': tensor(0.0419, device='cuda:0')}
loss: tensor(0.1665, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144,
         0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144,
         0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144,
         0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144,
         0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144,
         0.5144, 0.5144, 0.5144, 0.5144, 0.5144]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4751],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4059, device='cuda:0'), 'loss_center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.1578, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6828],
        [ 0.6172, -2.6256],
        [-0.7285,  1.4751],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3997, device='cuda:0'), 'loss_center': tensor(0.0386, device='cuda:0')}
loss: tensor(0.1571, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215,
         0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215,
         0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215,
         0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215,
         0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215, 0.5215,
         0.5215, 0.5215, 0.5215, 0.5215, 0.5215]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4750],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4058, device='cuda:0'), 'loss_center': tensor(0.0374, device='cuda:0')}
loss: tensor(0.1560, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142,
         0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142,
         0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142,
         0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142,
         0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142, 0.5142,
         0.5142, 0.5142, 0.5142, 0.5142, 0.5142]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4294, device='cuda:0'), 'loss_center': tensor(0.0378, device='cuda:0')}
loss: tensor(0.1614, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919,
         0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919,
         0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919,
         0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919,
         0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919, 0.4919,
         0.4919, 0.4919, 0.4919, 0.4919, 0.4919]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3995, device='cuda:0'), 'loss_center': tensor(0.0362, device='cuda:0')}
loss: tensor(0.1523, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7285,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3856, device='cuda:0'), 'loss_center': tensor(0.0343, device='cuda:0')}
loss: tensor(0.1457, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452,
         0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452,
         0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452,
         0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452,
         0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452, 0.5452,
         0.5452, 0.5452, 0.5452, 0.5452, 0.5452]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3852, device='cuda:0'), 'loss_center': tensor(0.0409, device='cuda:0')}
loss: tensor(0.1589, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461,
         0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461,
         0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461,
         0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461,
         0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461, 0.5461,
         0.5461, 0.5461, 0.5461, 0.5461, 0.5461]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4022, device='cuda:0'), 'loss_center': tensor(0.0360, device='cuda:0')}
loss: tensor(0.1525, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280,
         0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280,
         0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280,
         0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280,
         0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280, 0.5280,
         0.5280, 0.5280, 0.5280, 0.5280, 0.5280]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6173, -2.6257],
        [-0.7284,  1.4750],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3920, device='cuda:0'), 'loss_center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.1550, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223,
         0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223,
         0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223,
         0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223,
         0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223, 0.5223,
         0.5223, 0.5223, 0.5223, 0.5223, 0.5223]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4750],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3926, device='cuda:0'), 'loss_center': tensor(0.0337, device='cuda:0')}
loss: tensor(0.1460, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318,
         0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318,
         0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318,
         0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318,
         0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318, 0.5318,
         0.5318, 0.5318, 0.5318, 0.5318, 0.5318]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6171, -2.6257],
        [-0.7286,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3942, device='cuda:0'), 'loss_center': tensor(0.0333, device='cuda:0')}
loss: tensor(0.1454, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552,
         0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552,
         0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552,
         0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552,
         0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552, 0.5552,
         0.5552, 0.5552, 0.5552, 0.5552, 0.5552]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4750],
        [-0.8539, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4062, device='cuda:0'), 'loss_center': tensor(0.0314, device='cuda:0')}
loss: tensor(0.1440, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442,
         0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442,
         0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442,
         0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442,
         0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442, 0.5442,
         0.5442, 0.5442, 0.5442, 0.5442, 0.5442]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4411, device='cuda:0'), 'loss_center': tensor(0.0370, device='cuda:0')}
loss: tensor(0.1621, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7285,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4383, device='cuda:0'), 'loss_center': tensor(0.0399, device='cuda:0')}
loss: tensor(0.1675, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076,
         0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076,
         0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076,
         0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076,
         0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076, 0.5076,
         0.5076, 0.5076, 0.5076, 0.5076, 0.5076]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4750],
        [-0.8539, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4317, device='cuda:0'), 'loss_center': tensor(0.0351, device='cuda:0')}
loss: tensor(0.1565, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135, 0.5135,
         0.5135, 0.5135, 0.5135, 0.5135, 0.5135]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4751],
        [-0.8539, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4049, device='cuda:0'), 'loss_center': tensor(0.0398, device='cuda:0')}
loss: tensor(0.1606, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348,
         0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348,
         0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348,
         0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348,
         0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348, 0.5348,
         0.5348, 0.5348, 0.5348, 0.5348, 0.5348]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4750],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4086, device='cuda:0'), 'loss_center': tensor(0.0381, device='cuda:0')}
loss: tensor(0.1580, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296,
         0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296,
         0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296,
         0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296,
         0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296, 0.5296,
         0.5296, 0.5296, 0.5296, 0.5296, 0.5296]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4050, device='cuda:0'), 'loss_center': tensor(0.0434, device='cuda:0')}
loss: tensor(0.1678, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346,
         0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346,
         0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346,
         0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346,
         0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346, 0.5346,
         0.5346, 0.5346, 0.5346, 0.5346, 0.5346]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7285,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4273, device='cuda:0'), 'loss_center': tensor(0.0452, device='cuda:0')}
loss: tensor(0.1758, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178,
         0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178,
         0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178,
         0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178,
         0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178, 0.5178,
         0.5178, 0.5178, 0.5178, 0.5178, 0.5178]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4438, device='cuda:0'), 'loss_center': tensor(0.0343, device='cuda:0')}
loss: tensor(0.1574, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197,
         0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197,
         0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197,
         0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197,
         0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197, 0.5197,
         0.5197, 0.5197, 0.5197, 0.5197, 0.5197]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4044, device='cuda:0'), 'loss_center': tensor(0.0370, device='cuda:0')}
loss: tensor(0.1549, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475,
         0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475,
         0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475,
         0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475,
         0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475, 0.5475,
         0.5475, 0.5475, 0.5475, 0.5475, 0.5475]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4750],
        [-0.8539, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3982, device='cuda:0'), 'loss_center': tensor(0.0394, device='cuda:0')}
loss: tensor(0.1584, device='cuda:0', dtype=torch.float64)
top10 scores:  gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  36
gt_cnt:  37
gt_cnt:  36
gt_cnt:  34
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  37
gt_cnt:  36
tensor([[0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620,
         0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620,
         0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620,
         0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620,
         0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620, 0.5620,
         0.5620, 0.5620, 0.5620, 0.5620, 0.5620]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4750],
        [-0.8539, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3962, device='cuda:0'), 'loss_center': tensor(0.0388, device='cuda:0')}
loss: tensor(0.1569, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502,
         0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502,
         0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502,
         0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502,
         0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502, 0.5502,
         0.5502, 0.5502, 0.5502, 0.5502, 0.5502]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7285,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4058, device='cuda:0'), 'loss_center': tensor(0.0420, device='cuda:0')}
loss: tensor(0.1653, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4026, device='cuda:0'), 'loss_center': tensor(0.0449, device='cuda:0')}
loss: tensor(0.1704, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510,
         0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510,
         0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510,
         0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510,
         0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510, 0.5510,
         0.5510, 0.5510, 0.5510, 0.5510, 0.5510]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4285, device='cuda:0'), 'loss_center': tensor(0.0360, device='cuda:0')}
loss: tensor(0.1577, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355,
         0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355,
         0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355,
         0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355,
         0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355, 0.5355,
         0.5355, 0.5355, 0.5355, 0.5355, 0.5355]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6173, -2.6256],
        [-0.7285,  1.4750],
        [-0.8537, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4137, device='cuda:0'), 'loss_center': tensor(0.0380, device='cuda:0')}
loss: tensor(0.1588, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332,
         0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332,
         0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332,
         0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332,
         0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332, 0.5332,
         0.5332, 0.5332, 0.5332, 0.5332, 0.5332]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3833, device='cuda:0'), 'loss_center': tensor(0.0397, device='cuda:0')}
loss: tensor(0.1561, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513,
         0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513,
         0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513,
         0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513,
         0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513, 0.5513,
         0.5513, 0.5513, 0.5513, 0.5513, 0.5513]], device='cuda:0')
gt_cnt:  39
gt_cnt:  36
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  36
gt_cnt:  37
gt_cnt:  34
gt_cnt:  36
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  35
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
