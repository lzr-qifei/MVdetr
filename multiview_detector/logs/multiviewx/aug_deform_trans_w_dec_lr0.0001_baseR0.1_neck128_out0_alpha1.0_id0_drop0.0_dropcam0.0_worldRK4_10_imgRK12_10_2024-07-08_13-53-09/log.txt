logs/multiviewx/aug_deform_trans_w_dec_lr0.0001_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-08_13-53-09
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 100, 'lr': 0.0001, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX'}
rpts:  torch.Size([60000, 6, 4, 2])
pos_emb size:  [ 80 125]
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6729],
        [ 0.6167, -2.6265],
        [-0.7281,  1.4702],
        [-0.8537, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.8407, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4412, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.4040e-05, -6.1168e-05],
        [-6.0330e-05, -6.1747e-05],
        [-5.9068e-05, -5.9252e-05],
        [-6.6521e-05, -6.6352e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6728],
        [ 0.6167, -2.6265],
        [-0.7280,  1.4702],
        [-0.8538, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(8.3755, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.7543, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.1978e-05, -1.0214e-04],
        [-3.8520e-05, -1.2726e-04],
        [-3.9335e-05, -1.1376e-04],
        [-3.8948e-05, -1.2573e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6728],
        [ 0.6168, -2.6265],
        [-0.7279,  1.4701],
        [-0.8537, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.9347, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6680, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.8097e-06, -1.6753e-04],
        [-1.5794e-05, -1.5558e-04],
        [-1.0776e-05, -1.4998e-04],
        [-1.2005e-05, -1.6540e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6168, -2.6265],
        [-0.7278,  1.4700],
        [-0.8536, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.1449, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5029, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 9.4127e-06, -1.4676e-04],
        [ 1.5524e-05, -1.6634e-04],
        [ 2.1762e-05, -1.6000e-04],
        [ 1.5167e-05, -1.6490e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6168, -2.6266],
        [-0.7278,  1.4700],
        [-0.8535, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.2941, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5343, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.4473e-05, -1.8972e-04],
        [ 5.3589e-05, -2.0516e-04],
        [ 5.5848e-05, -1.9716e-04],
        [ 5.6645e-05, -2.2669e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6168, -2.6266],
        [-0.7278,  1.4699],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.4460, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5563, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.3422e-05, -1.8714e-04],
        [ 6.6248e-05, -2.2683e-04],
        [ 5.3020e-05, -1.7196e-04],
        [ 5.1126e-05, -1.8325e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.8889, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4505, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 8.5054e-05, -2.2094e-04],
        [ 8.5323e-05, -2.1613e-04],
        [ 8.8160e-05, -2.3343e-04],
        [ 9.1735e-05, -2.0291e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4699],
        [-0.8533, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.3645, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3565, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.5676e-05, -1.8804e-04],
        [ 7.4120e-05, -1.9924e-04],
        [ 7.8954e-05, -1.8725e-04],
        [ 7.6794e-05, -2.0080e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.2427, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3220, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.9360e-05, -1.6649e-04],
        [ 7.0146e-05, -1.5863e-04],
        [ 7.5622e-05, -1.7702e-04],
        [ 7.7947e-05, -1.6437e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.1853, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5119, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.5675e-05, -1.8492e-04],
        [ 7.5140e-05, -1.8123e-04],
        [ 7.6983e-05, -2.0309e-04],
        [ 7.8018e-05, -1.8138e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.9457, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2672, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.9130e-05, -1.9475e-04],
        [ 7.1918e-05, -1.8739e-04],
        [ 8.7325e-05, -2.3193e-04],
        [ 7.4306e-05, -1.9434e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.6708, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4116, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.7589e-05, -1.8102e-04],
        [ 5.7827e-05, -1.8958e-04],
        [ 5.6824e-05, -1.8298e-04],
        [ 5.3417e-05, -1.8069e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.5483, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5822, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0272e-04, -2.1688e-04],
        [ 9.0487e-05, -1.6740e-04],
        [ 9.2904e-05, -2.0477e-04],
        [ 9.7640e-05, -1.8637e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4701],
        [-0.8532, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(9.4180, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.9510, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.8853, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6530, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0970e-04, -1.8270e-04],
        [ 9.8915e-05, -1.9390e-04],
        [ 1.0190e-04, -1.8433e-04],
        [ 1.0055e-04, -1.8225e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.9906, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2789, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.5706, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5979, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4702],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.4629, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5757, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4228e-04, -1.3879e-04],
        [ 1.3308e-04, -1.0599e-04],
        [ 1.3645e-04, -1.1568e-04],
        [ 1.4029e-04, -9.8942e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6265],
        [-0.7279,  1.4702],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.0940, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5024, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7280,  1.4702],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1369, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3034, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6169, -2.6266],
        [-0.7280,  1.4702],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1187, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3030, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0002, -0.0001],
        [ 0.0002, -0.0001],
        [ 0.0002, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6170, -2.6266],
        [-0.7280,  1.4703],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1254, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3051, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0002, -0.0002],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6170, -2.6266],
        [-0.7280,  1.4702],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.9430, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4689, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.2693e-04, -8.7521e-05],
        [ 1.5124e-04, -1.0350e-04],
        [ 1.4139e-04, -5.3618e-05],
        [ 1.3368e-04, -4.1554e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6729],
        [ 0.6171, -2.6266],
        [-0.7281,  1.4704],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.6940, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4225, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.7130e-04, -7.6621e-05],
        [ 1.6319e-04, -3.7758e-05],
        [ 1.6383e-04, -8.0364e-05],
        [ 1.8663e-04, -7.9694e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6729],
        [ 0.6171, -2.6265],
        [-0.7281,  1.4703],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2431, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1278, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4252e-04, -8.4696e-05],
        [ 1.3650e-04, -8.5298e-05],
        [ 1.4156e-04, -4.7669e-05],
        [ 1.3227e-04, -8.0342e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6729],
        [ 0.6171, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7143, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2175, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4963e-04, -9.0423e-05],
        [ 1.3953e-04, -4.6227e-05],
        [ 1.4510e-04, -7.7512e-05],
        [ 1.4171e-04, -8.6523e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6729],
        [ 0.6172, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.2887, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0446, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3469, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5124e-04, -4.1557e-05],
        [ 1.2392e-04, -5.8040e-05],
        [ 1.5283e-04, -4.9055e-05],
        [ 1.6515e-04, -3.1386e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6172, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.6316, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3947, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5776e-04, -7.6329e-05],
        [ 1.7567e-04, -1.0458e-04],
        [ 1.5880e-04, -7.9401e-05],
        [ 1.6991e-04, -5.3482e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6173, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4589, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0422, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1763, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5679e-04, -8.7066e-05],
        [ 1.3764e-04, -7.8244e-05],
        [ 1.2938e-04, -8.2742e-05],
        [ 1.5433e-04, -6.7531e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6172, -2.6265],
        [-0.7282,  1.4704],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0086, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0427, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0872, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5172e-04, -8.9387e-05],
        [ 1.4976e-04, -9.7366e-05],
        [ 1.6183e-04, -6.5886e-05],
        [ 1.5941e-04, -7.6635e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7281,  1.4704],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7497, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2284, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.3428e-04, -1.2751e-04],
        [ 1.4291e-04, -9.6987e-05],
        [ 1.4223e-04, -1.0685e-04],
        [ 1.5014e-04, -1.1206e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7282,  1.4704],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4161, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1512, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0853e-04, -5.3378e-05],
        [ 1.2971e-04, -5.1454e-05],
        [ 1.0259e-04, -2.0614e-05],
        [ 9.7480e-05, -6.4343e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7282,  1.4705],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.4218, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3651, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4847e-04, -2.4073e-05],
        [ 1.3344e-04, -5.7733e-05],
        [ 1.4731e-04, -3.6696e-05],
        [ 1.5515e-04, -4.3715e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7198, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2132, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 9.4217e-05, -1.5820e-05],
        [ 8.4482e-05, -1.4079e-05],
        [ 9.4298e-05, -1.0573e-05],
        [ 1.3735e-04, -8.6953e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7282,  1.4705],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0701, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0848, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 8.1284e-05, -3.8696e-05],
        [ 8.1488e-05, -2.7916e-05],
        [ 9.7814e-05, -5.5793e-06],
        [ 1.1450e-04, -2.5540e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.0477, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2841, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[9.9353e-05, 2.6536e-05],
        [8.9998e-05, 4.8358e-05],
        [1.0078e-04, 1.4733e-05],
        [1.0820e-04, 2.5383e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6733],
        [ 0.6174, -2.6264],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1854, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1188, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.7182e-05, -1.4938e-05],
        [ 6.8332e-05, -1.2783e-06],
        [ 7.7048e-05, -2.4510e-05],
        [ 9.2079e-05,  1.3833e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7282,  1.4705],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7745, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2296, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.0060e-04, 4.1027e-05],
        [1.1110e-04, 3.9828e-05],
        [7.6063e-05, 9.5808e-06],
        [8.1941e-05, 2.7303e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6733],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4705],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1708, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3084, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.1375e-04, 4.1988e-05],
        [9.0043e-05, 7.3348e-05],
        [5.7829e-05, 4.3956e-05],
        [8.9773e-05, 9.2351e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6733],
        [ 0.6175, -2.6264],
        [-0.7282,  1.4706],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7899, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0305, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.0397e-05, 1.6016e-05],
        [6.2150e-05, 4.7242e-05],
        [5.0386e-05, 5.4837e-05],
        [7.0187e-05, 4.5709e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6733],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5022, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0304, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1612, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.2154e-04, 5.8266e-05],
        [4.8143e-05, 7.1752e-05],
        [5.4358e-05, 6.5928e-05],
        [6.3982e-05, 4.0231e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5334, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0431, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1929, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.3535e-05, 4.5786e-05],
        [1.7529e-05, 4.9068e-05],
        [8.5012e-06, 2.6299e-05],
        [1.8330e-05, 6.4215e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2586, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9309, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.8082e-05, 5.5815e-05],
        [6.3307e-05, 7.4244e-05],
        [5.9683e-05, 5.8611e-05],
        [5.5402e-05, 1.8924e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8534, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2892, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1367, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.6911e-05, 3.7981e-05],
        [1.6647e-05, 1.0582e-05],
        [3.8790e-05, 2.5157e-05],
        [7.0297e-06, 4.7659e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6735],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8534, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1482, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9078, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.6241e-05, 6.0025e-05],
        [4.7389e-05, 4.7007e-05],
        [1.8035e-05, 4.2834e-05],
        [2.4427e-05, 3.6820e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6735],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8534, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2831, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1371, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[8.4695e-05, 9.2130e-05],
        [6.3979e-05, 9.2804e-05],
        [5.0709e-05, 9.2522e-05],
        [7.0412e-05, 1.2272e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6736],
        [ 0.6176, -2.6265],
        [-0.7282,  1.4707],
        [-0.8533, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.6122, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1923, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.4742e-05, 1.2312e-05],
        [2.5608e-05, 4.6472e-05],
        [6.7392e-05, 1.8957e-05],
        [2.2293e-05, 3.4697e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6735],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3858, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0309, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9389, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[8.3554e-05, 1.9528e-05],
        [5.4291e-05, 1.8448e-05],
        [2.4030e-05, 1.1736e-05],
        [5.4709e-05, 1.6927e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6736],
        [ 0.6176, -2.6266],
        [-0.7282,  1.4706],
        [-0.8532, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3367, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1425, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 3.9392e-05,  2.7354e-05],
        [-4.7032e-07,  2.5224e-05],
        [-6.1897e-06,  1.4382e-05],
        [-1.6515e-05,  3.4044e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6736],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4310, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1585, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2353e-05,  2.7871e-05],
        [ 4.6591e-07, -3.2780e-05],
        [ 5.9524e-06,  1.6417e-05],
        [-1.2744e-05,  1.0607e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6736],
        [ 0.6176, -2.6267],
        [-0.7282,  1.4706],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7901, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0278, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.0322e-06,  3.7260e-05],
        [-4.1422e-05,  1.1196e-05],
        [-3.0056e-06,  3.6480e-05],
        [-2.7413e-05,  4.7240e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6736],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2832, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1390, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[6.1525e-05, 4.6785e-05],
        [2.2273e-05, 3.1383e-05],
        [5.1359e-05, 6.7768e-05],
        [4.1367e-05, 4.4644e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0883, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0860, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.5670e-05, 7.1745e-05],
        [3.2893e-05, 5.1395e-05],
        [2.4424e-05, 5.2961e-05],
        [1.0295e-05, 7.4121e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7282,  1.4706],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2511, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0432, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9365, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.1054e-05, 1.9851e-05],
        [1.1393e-05, 2.6897e-05],
        [1.7104e-05, 4.3598e-05],
        [3.2436e-06, 3.6832e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4089, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1516, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.7901e-05, 5.9587e-05],
        [3.9614e-05, 6.2485e-05],
        [5.1195e-05, 6.0129e-05],
        [5.2954e-05, 7.8539e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6738],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4603, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0471, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9863, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.2290e-05, 5.2025e-05],
        [1.1586e-06, 3.2539e-05],
        [1.2688e-05, 6.2797e-05],
        [2.2681e-05, 5.2303e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6738],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8529, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.0617, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2909, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.4258e-05, 7.9675e-05],
        [9.9478e-05, 4.5131e-05],
        [5.8689e-05, 5.2435e-05],
        [9.8453e-05, 1.0525e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6739],
        [ 0.6177, -2.6266],
        [-0.7281,  1.4706],
        [-0.8528, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7916, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0482, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2548, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.9404e-05, 1.0858e-04],
        [1.4928e-05, 1.5326e-04],
        [1.3708e-05, 9.8143e-05],
        [4.1738e-05, 1.4645e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6739],
        [ 0.6176, -2.6265],
        [-0.7281,  1.4707],
        [-0.8529, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.9892, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0730, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 4.9041e-05, -4.1505e-05],
        [ 6.3753e-05,  1.2850e-05],
        [ 4.2679e-05, -3.1852e-05],
        [ 4.1170e-05, -1.3118e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6738],
        [ 0.6177, -2.6267],
        [-0.7281,  1.4706],
        [-0.8529, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4171, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1561, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 9.8075e-06,  1.7328e-05],
        [ 2.0993e-05, -1.9577e-05],
        [ 2.6824e-05, -2.9021e-05],
        [ 4.1674e-06, -4.3880e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6739],
        [ 0.6176, -2.6267],
        [-0.7281,  1.4706],
        [-0.8529, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2124, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9209, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.2024e-05, 5.8420e-05],
        [5.0380e-05, 3.3905e-05],
        [3.6743e-05, 6.6363e-05],
        [4.8438e-05, 7.7317e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6740],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4707],
        [-0.8528, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1434, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0999, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 2.7814e-05,  1.3970e-05],
        [ 3.1293e-05, -1.2961e-05],
        [ 3.9149e-05,  7.1466e-07],
        [-6.3620e-06,  2.0093e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6740],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4706],
        [-0.8529, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0143, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8789, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.6190e-05, 2.7822e-05],
        [4.2973e-05, 5.2893e-05],
        [4.6002e-05, 3.8785e-05],
        [2.9038e-05, 3.7227e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6740],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2144, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9241, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.1696e-05, 6.6134e-05],
        [9.9331e-06, 6.9958e-05],
        [1.8659e-05, 3.2422e-05],
        [9.9786e-06, 1.4199e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6741],
        [ 0.6176, -2.6266],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3896, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9522, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.3399e-05, -1.0728e-05],
        [ 4.6020e-05,  4.1678e-06],
        [ 4.3920e-05, -9.5832e-06],
        [ 3.1914e-05,  3.7776e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6741],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5072, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9814, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.8958e-05, 1.1391e-04],
        [1.8698e-05, 9.9984e-05],
        [5.1546e-05, 8.8418e-05],
        [6.4146e-06, 7.6983e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6743],
        [ 0.6175, -2.6266],
        [-0.7279,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3642, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1537, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.4993e-05, 4.1141e-05],
        [3.2539e-05, 1.9413e-05],
        [6.8439e-05, 3.4140e-06],
        [3.3372e-05, 3.0061e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6742],
        [ 0.6175, -2.6267],
        [-0.7279,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.9834, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0827, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.8922e-05, -3.2266e-05],
        [-3.5386e-05, -3.5772e-06],
        [-3.9214e-05, -1.1805e-05],
        [-4.1501e-05,  1.5279e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6742],
        [ 0.6174, -2.6267],
        [-0.7280,  1.4708],
        [-0.8529, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9921, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8774, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4051e-05,  2.5377e-05],
        [ 1.4210e-05,  4.9707e-06],
        [-1.9557e-05, -2.3540e-05],
        [ 1.0879e-05,  5.3426e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6743],
        [ 0.6174, -2.6267],
        [-0.7280,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3437, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0445, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9578, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.2821e-05, -8.6708e-06],
        [ 4.2302e-05,  1.9981e-05],
        [ 1.5142e-05, -1.6714e-05],
        [ 1.4898e-05,  1.5325e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6743],
        [ 0.6175, -2.6267],
        [-0.7279,  1.4708],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5579, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9874, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7611e-05,  9.6367e-05],
        [-9.5509e-06,  9.6160e-05],
        [-2.7648e-05,  6.3963e-05],
        [ 2.6940e-05,  5.9229e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7280,  1.4709],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3577, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1491, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.3205e-06,  5.3308e-05],
        [ 1.4800e-05,  2.6701e-05],
        [ 1.4393e-05,  4.4444e-05],
        [-9.1685e-06,  5.4313e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4709],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7485, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8260, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 2.3343e-05,  5.0404e-05],
        [ 2.3020e-05,  9.1367e-05],
        [ 3.9410e-05,  5.6809e-05],
        [-6.3372e-07,  2.6679e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.9095, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0637, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.7248e-06, -1.3891e-05],
        [ 1.3809e-05,  2.9033e-05],
        [-2.0185e-05,  1.1551e-06],
        [ 3.3594e-05,  2.1987e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7280,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7459, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2328, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[6.0321e-06, 6.4328e-05],
        [7.8165e-06, 4.9647e-05],
        [9.5608e-07, 2.1576e-05],
        [6.5142e-06, 7.9590e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6746],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5018, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9763, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.8032e-05, 7.7214e-05],
        [3.3447e-05, 1.5933e-05],
        [3.5104e-05, 6.1146e-05],
        [2.4935e-05, 5.5793e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6746],
        [ 0.6174, -2.6268],
        [-0.7279,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.6225, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0001, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.4285e-05, 9.3562e-05],
        [2.7294e-05, 9.7258e-05],
        [6.4749e-05, 5.7817e-05],
        [3.2893e-05, 8.7763e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6747],
        [ 0.6174, -2.6267],
        [-0.7278,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5820, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9991, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.6099e-05, 8.3863e-05],
        [4.7018e-05, 7.7656e-05],
        [3.6060e-06, 6.3173e-05],
        [6.1800e-05, 9.2920e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6747],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7077, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0116, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9111e-05, -2.7138e-05],
        [-1.2192e-05,  7.1853e-05],
        [ 1.1738e-06, -2.2217e-05],
        [-2.9123e-06, -4.5637e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6747],
        [ 0.6173, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2157, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0286, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1004, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1120e-05,  2.5735e-05],
        [-7.0208e-05,  3.5797e-05],
        [-5.6147e-05,  6.3526e-05],
        [-2.8931e-05,  5.1321e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6748],
        [ 0.6172, -2.6268],
        [-0.7279,  1.4711],
        [-0.8529, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.6748, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0023, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2230e-05,  1.6200e-06],
        [-2.7588e-05,  4.7608e-05],
        [-5.5355e-05,  1.2819e-05],
        [-2.6715e-05,  4.1024e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6748],
        [ 0.6173, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5939, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9943, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1310e-05, -2.4977e-05],
        [-2.1180e-05,  1.0548e-05],
        [-2.4197e-05, -1.9427e-05],
        [-2.8310e-05,  2.5730e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6748],
        [ 0.6173, -2.6268],
        [-0.7279,  1.4710],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6193, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8031, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.3778e-05,  3.8596e-05],
        [-9.4157e-06, -2.4141e-05],
        [ 8.8407e-06,  4.7359e-05],
        [-2.3902e-06,  1.4170e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6749],
        [ 0.6173, -2.6268],
        [-0.7278,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1564, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9008, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.7727e-06,  4.4911e-05],
        [-5.1059e-05,  3.4615e-05],
        [-3.6545e-05,  4.0231e-05],
        [-1.9524e-05,  6.4620e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6749],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.8453, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0411, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.7780e-05,  5.3164e-05],
        [-3.7821e-05,  2.6758e-05],
        [-2.8564e-05,  6.8400e-06],
        [-5.1819e-05,  1.2969e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6750],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3511, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9530, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.8468e-05,  5.2367e-05],
        [-8.6232e-05,  7.0527e-05],
        [-4.1572e-05,  8.6624e-05],
        [-3.6921e-05,  3.4791e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6750],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4712],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1522, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1080, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.4890e-05,  3.6380e-05],
        [-5.3711e-05,  3.8175e-05],
        [-6.7866e-05,  2.0333e-05],
        [-3.6037e-05,  6.7903e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6750],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5990, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1912, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.6071e-05, -3.3654e-05],
        [-1.0280e-05, -1.2209e-05],
        [-1.7457e-05,  2.2762e-05],
        [ 3.1187e-05,  1.5307e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6750],
        [ 0.6172, -2.6268],
        [-0.7278,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7140, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8187, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6602e-05,  1.7599e-06],
        [-2.5978e-05,  4.9553e-05],
        [ 1.8572e-05,  1.6686e-05],
        [-1.1023e-05,  1.6072e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6751],
        [ 0.6172, -2.6267],
        [-0.7277,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1573, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9021, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8644e-05, -1.2749e-05],
        [-5.0951e-05, -1.8038e-05],
        [-7.6676e-05, -2.0412e-05],
        [-3.4299e-05, -3.6604e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6751],
        [ 0.6172, -2.6268],
        [-0.7278,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3413, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9426, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5117e-04,  1.6531e-05],
        [-1.1969e-04,  2.5883e-05],
        [-1.3440e-04,  8.6899e-05],
        [-1.1904e-04,  4.1872e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6752],
        [ 0.6171, -2.6267],
        [-0.7278,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5667, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9878, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.2991e-05, -6.2528e-06],
        [-5.1504e-05,  7.5276e-06],
        [-6.8664e-05, -2.3069e-05],
        [-6.9491e-05,  1.1145e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6752],
        [ 0.6171, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5519, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9924, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.1055e-05, -2.0283e-05],
        [-4.4266e-05,  5.5631e-06],
        [-9.6516e-05, -9.0367e-05],
        [-7.5868e-05, -4.4499e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6752],
        [ 0.6171, -2.6267],
        [-0.7278,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1175, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8970, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2034e-04, -2.4865e-05],
        [-6.7286e-05, -1.3299e-05],
        [-5.8467e-05, -7.8289e-05],
        [-7.1628e-05, -2.7570e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6753],
        [ 0.6171, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.8880, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8595, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.8595e-05, -2.6734e-05],
        [-9.6966e-05, -6.5140e-05],
        [-3.8393e-05, -2.4285e-05],
        [-4.3877e-05, -4.4624e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6753],
        [ 0.6171, -2.6268],
        [-0.7277,  1.4711],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1970, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9061, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2340e-04, -6.0435e-05],
        [-1.2125e-04, -7.6934e-05],
        [-1.7177e-04, -6.8744e-05],
        [-1.0889e-04, -1.4687e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6753],
        [ 0.6170, -2.6268],
        [-0.7278,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7593, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0278, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.2690e-05, -9.8407e-05],
        [-6.8168e-05, -6.5166e-05],
        [-1.0629e-04, -7.7607e-05],
        [-9.4819e-05, -8.7040e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6754],
        [ 0.6171, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2794, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9348, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.2747e-05, -2.2556e-05],
        [-6.2171e-05, -4.7783e-05],
        [-7.3041e-05, -5.6011e-05],
        [-9.5755e-05, -2.8189e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6755],
        [ 0.6170, -2.6267],
        [-0.7276,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1125, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0966, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.4058e-05, -6.6068e-05],
        [-6.0356e-05, -1.0177e-05],
        [-3.8001e-05, -2.6920e-05],
        [-2.4288e-05, -2.2835e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6755],
        [ 0.6170, -2.6267],
        [-0.7275,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2242, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1182, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:100, loss: 0.011182, Time: 41.3
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0083e-04, -1.1023e-04],
        [-1.1394e-04, -4.1904e-05],
        [-1.1824e-04, -5.9343e-05],
        [-1.7073e-04, -2.2426e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6755],
        [ 0.6170, -2.6267],
        [-0.7276,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4029, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9543, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.7648e-05, -9.8632e-05],
        [-9.6293e-05, -1.1488e-04],
        [-7.8731e-05, -3.5791e-05],
        [-8.2430e-05, -1.0203e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6756],
        [ 0.6170, -2.6268],
        [-0.7275,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7794, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0239, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.2483e-05, -7.8272e-07],
        [-1.3512e-04,  2.5434e-05],
        [-8.0496e-05, -2.6790e-05],
        [-6.2917e-05, -1.7993e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6757],
        [ 0.6170, -2.6266],
        [-0.7275,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4635, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7665, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.8965e-05, -9.2060e-05],
        [-5.7050e-05, -3.2568e-05],
        [-5.9010e-05, -6.8119e-05],
        [-8.7812e-05, -7.2190e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6757],
        [ 0.6170, -2.6267],
        [-0.7275,  1.4712],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6517, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8007, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.6064e-05, -1.2195e-04],
        [-8.3270e-05, -8.3151e-05],
        [-2.8923e-05, -5.6425e-05],
        [-4.1501e-05, -8.8070e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6757],
        [ 0.6170, -2.6267],
        [-0.7274,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7416, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8223, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.5680e-05, -1.3530e-04],
        [-3.4226e-05, -1.2362e-04],
        [-3.0417e-05, -1.4234e-04],
        [-2.1418e-05, -1.5238e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6758],
        [ 0.6171, -2.6268],
        [-0.7274,  1.4711],
        [-0.8529, -2.7502]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5275, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1819, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.1089e-05, -6.1503e-05],
        [-5.9099e-06, -7.0094e-05],
        [-2.6867e-05, -3.6445e-05],
        [-4.9100e-05, -5.1624e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6759],
        [ 0.6171, -2.6267],
        [-0.7274,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7111, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8237, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0149e-04, -1.0219e-04],
        [-8.9862e-05, -1.5967e-04],
        [-1.2728e-04, -1.2662e-04],
        [-1.1106e-04, -1.2853e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6759],
        [ 0.6171, -2.6268],
        [-0.7274,  1.4711],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3911, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7614, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0858e-04, -7.9787e-05],
        [-8.7556e-05, -1.3447e-04],
        [-8.1830e-05, -1.7608e-04],
        [-8.5371e-05, -1.4717e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6760],
        [ 0.6171, -2.6268],
        [-0.7274,  1.4711],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7546, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6316, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6363e-04, -1.2646e-04],
        [-1.5492e-04, -7.0691e-05],
        [-1.2152e-04, -1.2817e-04],
        [-1.4285e-04, -8.9132e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6760],
        [ 0.6171, -2.6268],
        [-0.7274,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.8206, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0464, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.5421e-05,  1.7318e-05],
        [-6.3558e-05, -1.5844e-05],
        [-5.1972e-05, -7.1974e-06],
        [-4.9542e-05, -3.4157e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6762],
        [ 0.6172, -2.6267],
        [-0.7273,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7939, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8325, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.7943e-05, -6.7607e-05],
        [-8.3806e-05, -3.9976e-05],
        [-9.8128e-05, -6.6528e-05],
        [-5.5397e-05, -4.5704e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6761],
        [ 0.6171, -2.6267],
        [-0.7273,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9097, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8542, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.6305e-05, -1.1156e-05],
        [-8.5475e-05, -3.9040e-05],
        [-1.1765e-04, -7.0258e-05],
        [-1.0463e-04, -3.3172e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6762],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4711],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4981, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9782, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.6362e-05, -1.2174e-04],
        [-2.3841e-05, -6.9496e-05],
        [-1.1366e-05, -1.0549e-04],
        [-7.3344e-05, -1.3257e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6762],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9997, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8747, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3568e-04, -1.1062e-04],
        [-1.2512e-04, -4.9399e-05],
        [-1.0436e-04, -5.5611e-05],
        [-1.1323e-04, -6.7566e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6762],
        [ 0.6171, -2.6268],
        [-0.7273,  1.4712],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.8248, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8351, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.6343e-05, -7.4756e-05],
        [-5.7570e-05, -3.1535e-05],
        [-6.1161e-05, -8.2753e-05],
        [-6.8889e-05, -1.3225e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6763],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.8190, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8354, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.7745e-05, -8.0280e-05],
        [-3.1507e-05, -9.0686e-05],
        [-2.0280e-05, -1.8913e-05],
        [-5.2702e-05, -5.5868e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6764],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2777, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9238, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0001, -0.0001],
        [-0.0001, -0.0001],
        [-0.0001, -0.0001],
        [-0.0001, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6764],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0425, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8895, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.4597e-05, -6.0888e-05],
        [ 3.1529e-05, -3.4848e-05],
        [-2.8080e-05, -4.7803e-05],
        [-2.4171e-05, -6.8580e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6765],
        [ 0.6173, -2.6268],
        [-0.7271,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0456, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8876, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.6429e-05, -8.9048e-05],
        [-2.6612e-05, -1.5543e-05],
        [-2.2703e-05, -4.9924e-05],
        [-1.3692e-05, -2.8194e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6765],
        [ 0.6173, -2.6268],
        [-0.7271,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5362, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9881, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0384e-04, -7.1791e-05],
        [-1.1146e-04, -8.3015e-05],
        [-1.2695e-04, -6.6052e-05],
        [-9.7863e-05, -2.0077e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6766],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4712],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0911, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7001, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.0672e-05, -2.9505e-05],
        [-1.0727e-04, -4.4632e-05],
        [-9.4042e-05, -1.5402e-05],
        [-9.2758e-05, -7.5872e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6767],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3689, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0434, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9605, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2541e-04, -2.8505e-05],
        [-1.4356e-04, -5.5521e-05],
        [-1.3607e-04, -1.3274e-04],
        [-1.2761e-04, -1.1100e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6767],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4711],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7419, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8361, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6591e-04, -1.0296e-04],
        [-2.1979e-04, -1.3240e-04],
        [-2.2011e-04, -3.3626e-05],
        [-2.1781e-04, -1.0484e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6767],
        [ 0.6172, -2.6269],
        [-0.7273,  1.4712],
        [-0.8532, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7383, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8197, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0489e-04, -6.8766e-05],
        [-1.7295e-04, -1.1795e-04],
        [-1.0232e-04, -8.3054e-05],
        [-1.3934e-04, -1.0156e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6767],
        [ 0.6172, -2.6269],
        [-0.7272,  1.4711],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2889, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0424, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7426, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3149e-04, -5.5546e-05],
        [-1.1810e-04, -2.8517e-06],
        [-1.2104e-04, -5.3103e-05],
        [-1.1258e-04, -9.3031e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6768],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4711],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7608, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0428, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6378, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7488e-04, -7.3574e-05],
        [-1.6747e-04, -1.4364e-04],
        [-1.9011e-04, -5.4765e-05],
        [-1.8050e-04, -9.1438e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6768],
        [ 0.6172, -2.6269],
        [-0.7273,  1.4712],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6122, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8049, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8166e-04, -5.1072e-05],
        [-2.2739e-04, -1.1019e-04],
        [-2.2436e-04, -6.1216e-05],
        [-1.3864e-04, -4.4972e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6769],
        [ 0.6172, -2.6269],
        [-0.7273,  1.4712],
        [-0.8530, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3187, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7409, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3324e-04, -9.9312e-05],
        [-1.3796e-04, -1.1267e-04],
        [-1.3658e-04, -7.8134e-05],
        [-1.4838e-04, -1.1245e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6768],
        [ 0.6173, -2.6269],
        [-0.7272,  1.4711],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1521, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9010, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.0267e-04, -9.1967e-05],
        [-2.1647e-04, -6.9285e-05],
        [-2.2840e-04, -7.1629e-05],
        [-2.1988e-04, -9.6330e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6769],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4712],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7170, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6173, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1481e-04, -1.3181e-04],
        [-1.9003e-04, -9.0335e-05],
        [-1.8380e-04, -4.9656e-05],
        [-1.5770e-04, -7.4817e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6769],
        [ 0.6173, -2.6269],
        [-0.7272,  1.4712],
        [-0.8531, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7362, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0451, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8374, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8450e-04,  9.6353e-06],
        [-2.0453e-04,  2.9097e-05],
        [-1.5870e-04, -4.2757e-05],
        [-1.9073e-04, -2.8727e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6770],
        [ 0.6173, -2.6267],
        [-0.7272,  1.4712],
        [-0.8531, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2969, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7343, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7041e-04, -2.5362e-05],
        [-1.6238e-04,  8.2664e-05],
        [-2.0453e-04,  1.8231e-05],
        [-1.3955e-04,  1.0067e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6770],
        [ 0.6173, -2.6267],
        [-0.7273,  1.4712],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0782, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6914, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1619e-04,  1.3346e-05],
        [-8.5477e-05,  9.1429e-06],
        [-1.5511e-04,  1.5528e-05],
        [-9.3260e-05, -2.4620e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6771],
        [ 0.6174, -2.6268],
        [-0.7272,  1.4713],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5881, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8005, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5867e-04, -3.6861e-08],
        [-1.2434e-04, -5.0809e-07],
        [-1.2108e-04, -4.1694e-05],
        [-1.2719e-04, -2.4351e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6771],
        [ 0.6174, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5993, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0015, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1378e-04,  1.5067e-05],
        [-2.6162e-04,  3.7242e-05],
        [-2.3903e-04, -5.6632e-05],
        [-3.0571e-04,  3.1952e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6772],
        [ 0.6173, -2.6267],
        [-0.7273,  1.4712],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2812, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7270, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6676e-04, -6.3172e-05],
        [-1.7820e-04, -8.8789e-05],
        [-1.4915e-04, -1.0304e-04],
        [-1.4730e-04, -5.8756e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6771],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4390, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7596, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9968e-04, -4.9532e-05],
        [-1.8957e-04, -4.6105e-05],
        [-2.0652e-04, -7.8775e-05],
        [-1.4991e-04, -5.0467e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6772],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1306, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0315, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6891, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.3226e-04, -4.8611e-05],
        [-2.6324e-04, -1.1047e-04],
        [-2.9436e-04, -7.3637e-05],
        [-2.4809e-04, -1.2163e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6772],
        [ 0.6173, -2.6269],
        [-0.7273,  1.4712],
        [-0.8531, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0638, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6845, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2631e-04, -7.5564e-05],
        [-2.3585e-04, -6.5452e-05],
        [-2.4687e-04, -1.1225e-04],
        [-2.3520e-04, -7.6600e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6772],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9133, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6592, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9772e-04,  7.5632e-06],
        [-2.4498e-04, -2.3914e-06],
        [-1.9714e-04, -6.5736e-05],
        [-2.5800e-04, -2.8438e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6773],
        [ 0.6173, -2.6267],
        [-0.7272,  1.4713],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5899, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8008, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8642e-04, -9.2501e-05],
        [-2.2706e-04, -5.3136e-05],
        [-1.7681e-04, -1.4804e-04],
        [-2.1163e-04, -8.9812e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6772],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2513, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9317, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2632e-04, -4.1800e-05],
        [-3.4448e-04, -7.6311e-05],
        [-3.2334e-04, -1.2777e-06],
        [-2.2055e-04, -5.5274e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6773],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4713],
        [-0.8530, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3486, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7416, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5721e-04, -5.6233e-05],
        [-2.6171e-04, -4.4815e-05],
        [-2.7837e-04,  1.4221e-05],
        [-2.8412e-04, -1.0718e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6773],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4714],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5293, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5750, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5688e-04, -9.4298e-05],
        [-2.7487e-04,  3.8957e-05],
        [-2.2943e-04, -7.6388e-05],
        [-1.9335e-04, -4.7812e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6773],
        [ 0.6172, -2.6267],
        [-0.7272,  1.4713],
        [-0.8530, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0406, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8752, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7449e-04,  9.0567e-05],
        [-2.2493e-04,  4.0108e-05],
        [-1.7298e-04,  1.7684e-05],
        [-2.3004e-04,  5.2018e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6775],
        [ 0.6173, -2.6267],
        [-0.7271,  1.4714],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9748, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6764, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9924e-04,  2.9301e-05],
        [-2.5580e-04,  9.0087e-05],
        [-2.9546e-04,  4.7970e-05],
        [-2.3112e-04,  5.5799e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6775],
        [ 0.6172, -2.6266],
        [-0.7273,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9955, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8744, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.3120e-04, -5.4898e-05],
        [-3.8063e-04, -7.6356e-05],
        [-3.4243e-04, -5.5543e-05],
        [-3.4573e-04, -1.0967e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6775],
        [ 0.6171, -2.6268],
        [-0.7273,  1.4713],
        [-0.8532, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3327, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7347, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.0542e-04, -1.3358e-04],
        [-3.4341e-04, -8.5926e-05],
        [-2.8467e-04, -7.0746e-05],
        [-3.5205e-04, -4.3060e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6774],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4713],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9245, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6618, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9879e-04, -8.5065e-05],
        [-3.0688e-04, -8.6541e-05],
        [-3.1940e-04, -5.6582e-05],
        [-2.6141e-04, -5.1099e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6775],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4713],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  33
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1800, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7075, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2666e-04, -8.3942e-05],
        [-2.6713e-04, -5.9421e-05],
        [-2.5562e-04, -1.1983e-04],
        [-2.4397e-04, -1.2220e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6776],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9207, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0312, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6466, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.6857e-04, -5.2782e-06],
        [-2.3685e-04,  7.1376e-06],
        [-2.5936e-04, -1.0381e-05],
        [-2.4794e-04, -2.5132e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6777],
        [ 0.6173, -2.6267],
        [-0.7272,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1593, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9064, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.6094e-04, -7.3689e-05],
        [-2.5978e-04, -1.2369e-05],
        [-3.6938e-04, -5.6665e-05],
        [-3.1938e-04, -4.4203e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6776],
        [ 0.6173, -2.6267],
        [-0.7273,  1.4713],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0574, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0482, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7079, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0003, -0.0002],
        [-0.0003, -0.0001],
        [-0.0003, -0.0002],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6776],
        [ 0.6173, -2.6269],
        [-0.7273,  1.4712],
        [-0.8531, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2055, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7112, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1989e-04, -5.8664e-05],
        [-3.9783e-04, -1.7872e-04],
        [-4.2669e-04, -5.7616e-05],
        [-3.2995e-04, -1.0341e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6777],
        [ 0.6172, -2.6269],
        [-0.7274,  1.4713],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6984, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6132, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0003, -0.0002],
        [-0.0003, -0.0002],
        [-0.0003, -0.0002],
        [-0.0003, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6776],
        [ 0.6173, -2.6269],
        [-0.7273,  1.4712],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4493, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7626, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0004, -0.0001],
        [-0.0004, -0.0001],
        [-0.0004, -0.0002],
        [-0.0004, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6777],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4712],
        [-0.8532, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.8468, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6495, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.6180e-04, -7.5456e-05],
        [-3.2382e-04, -7.3924e-05],
        [-3.0619e-04, -1.3114e-04],
        [-2.7384e-04, -1.1818e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6778],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4713],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2687, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7373, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.8329e-04, -1.5026e-04],
        [-4.2001e-04, -1.4178e-04],
        [-3.0073e-04, -9.5248e-05],
        [-3.8311e-04, -1.3898e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6778],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4714],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9799, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6750, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.0523e-04, -2.7680e-05],
        [-2.8582e-04, -1.3102e-04],
        [-3.6092e-04, -4.8250e-05],
        [-3.7825e-04, -8.6260e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6779],
        [ 0.6174, -2.6268],
        [-0.7273,  1.4715],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1076, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9034, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.3292e-04, -9.0933e-05],
        [-3.2915e-04, -8.0159e-05],
        [-2.7819e-04, -7.5154e-05],
        [-3.2513e-04, -4.2385e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6779],
        [ 0.6174, -2.6267],
        [-0.7272,  1.4715],
        [-0.8531, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5624, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7937, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0004, -0.0002],
        [-0.0004, -0.0002],
        [-0.0004, -0.0001],
        [-0.0003, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6779],
        [ 0.6174, -2.6269],
        [-0.7273,  1.4714],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7293, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6199, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.8081e-04, -1.6450e-04],
        [-2.4814e-04, -7.3749e-05],
        [-3.4045e-04, -9.3195e-05],
        [-3.4922e-04, -5.1670e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6780],
        [ 0.6175, -2.6267],
        [-0.7273,  1.4715],
        [-0.8531, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6977, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8255, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0004, -0.0002],
        [-0.0004, -0.0002],
        [-0.0004, -0.0002],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6780],
        [ 0.6175, -2.6268],
        [-0.7273,  1.4715],
        [-0.8532, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9831, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6802, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.1520e-04, -7.0338e-05],
        [-5.0979e-04, -1.1221e-04],
        [-4.9572e-04, -7.8019e-05],
        [-4.8301e-04, -1.2564e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6782],
        [ 0.6173, -2.6267],
        [-0.7274,  1.4716],
        [-0.8532, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4513, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9623, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0005, -0.0002],
        [-0.0006, -0.0003],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6782],
        [ 0.6173, -2.6268],
        [-0.7276,  1.4715],
        [-0.8532, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9117, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4584, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.3433e-04, -1.1278e-04],
        [-4.3737e-04, -1.1227e-04],
        [-5.1422e-04, -9.7544e-05],
        [-4.2086e-04, -1.0454e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6783],
        [ 0.6175, -2.6267],
        [-0.7275,  1.4717],
        [-0.8532, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5513, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5819, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0004, -0.0001],
        [-0.0005, -0.0002],
        [-0.0003, -0.0001],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6784],
        [ 0.6175, -2.6267],
        [-0.7273,  1.4718],
        [-0.8532, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5934, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7908, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0006, -0.0002],
        [-0.0006, -0.0001],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6784],
        [ 0.6173, -2.6267],
        [-0.7275,  1.4718],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9936, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8718, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0001],
        [-0.0007, -0.0002],
        [-0.0006, -0.0002],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6785],
        [ 0.6173, -2.6267],
        [-0.7276,  1.4718],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4740, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5771, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6785],
        [ 0.6175, -2.6267],
        [-0.7275,  1.4718],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2612, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7269, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0003],
        [-0.0005, -0.0002],
        [-0.0005, -0.0003],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6785],
        [ 0.6174, -2.6266],
        [-0.7275,  1.4718],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1816, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7108, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0006, -0.0003],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6786],
        [ 0.6174, -2.6267],
        [-0.7275,  1.4719],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4146, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0314, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7457, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0003],
        [-0.0005, -0.0002],
        [-0.0005, -0.0001],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6786],
        [ 0.6174, -2.6267],
        [-0.7275,  1.4720],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3940, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5535, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0001],
        [-0.0006, -0.0001],
        [-0.0006, -0.0001],
        [-0.0005, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6788],
        [ 0.6174, -2.6266],
        [-0.7275,  1.4721],
        [-0.8534, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4386, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5639, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0003],
        [-0.0008, -0.0003],
        [-0.0008, -0.0003],
        [-0.0006, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6787],
        [ 0.6173, -2.6268],
        [-0.7277,  1.4720],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2460, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7209, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6789],
        [ 0.6174, -2.6267],
        [-0.7276,  1.4721],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1512, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7066, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0003],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6789],
        [ 0.6176, -2.6266],
        [-0.7274,  1.4721],
        [-0.8533, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3223, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5439, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0007, -0.0003],
        [-0.0007, -0.0003],
        [-0.0007, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6790],
        [ 0.6173, -2.6267],
        [-0.7276,  1.4721],
        [-0.8536, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4258, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5658, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0008, -0.0003],
        [-0.0007, -0.0003],
        [-0.0008, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6791],
        [ 0.6173, -2.6267],
        [-0.7276,  1.4721],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0057, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6771, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0003],
        [-0.0007, -0.0003],
        [-0.0007, -0.0003],
        [-0.0006, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6790],
        [ 0.6174, -2.6267],
        [-0.7276,  1.4721],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4227, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5604, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0007, -0.0003],
        [-0.0006, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6792],
        [ 0.6174, -2.6267],
        [-0.7275,  1.4722],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4428, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7697, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0004],
        [-0.0008, -0.0003],
        [-0.0009, -0.0003],
        [-0.0007, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6791],
        [ 0.6173, -2.6268],
        [-0.7277,  1.4722],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6621, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0326, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5977, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0003],
        [-0.0008, -0.0002],
        [-0.0007, -0.0003],
        [-0.0007, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6792],
        [ 0.6173, -2.6267],
        [-0.7276,  1.4722],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5278, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5871, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0003],
        [-0.0007, -0.0003],
        [-0.0006, -0.0003],
        [-0.0006, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6793],
        [ 0.6175, -2.6267],
        [-0.7275,  1.4723],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1451, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5018, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0004],
        [-0.0008, -0.0004],
        [-0.0007, -0.0004],
        [-0.0008, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6792],
        [ 0.6175, -2.6269],
        [-0.7276,  1.4722],
        [-0.8536, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8431, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4485, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0003],
        [-0.0006, -0.0003],
        [-0.0008, -0.0003],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6793],
        [ 0.6176, -2.6268],
        [-0.7277,  1.4723],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4409, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7695, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0006, -0.0002],
        [-0.0005, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6795],
        [ 0.6176, -2.6267],
        [-0.7275,  1.4724],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5346, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5815, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0003],
        [-0.0007, -0.0002],
        [-0.0006, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6794],
        [ 0.6176, -2.6268],
        [-0.7276,  1.4724],
        [-0.8534, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2205, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5151, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0003],
        [-0.0008, -0.0003],
        [-0.0008, -0.0003],
        [-0.0008, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6795],
        [ 0.6176, -2.6268],
        [-0.7278,  1.4723],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7242, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4118, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0003],
        [-0.0009, -0.0003],
        [-0.0009, -0.0003],
        [-0.0010, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6795],
        [ 0.6175, -2.6269],
        [-0.7279,  1.4724],
        [-0.8538, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9240, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6626, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0008, -0.0003],
        [-0.0008, -0.0002],
        [-0.0008, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6796],
        [ 0.6176, -2.6268],
        [-0.7278,  1.4725],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9912, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6765, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0003],
        [-0.0011, -0.0002],
        [-0.0010, -0.0002],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6796],
        [ 0.6174, -2.6268],
        [-0.7281,  1.4724],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3699, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5490, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0003],
        [-0.0011, -0.0003],
        [-0.0010, -0.0003],
        [-0.0010, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6797],
        [ 0.6174, -2.6269],
        [-0.7281,  1.4724],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3446, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5518, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0003],
        [-0.0008, -0.0003],
        [-0.0009, -0.0004],
        [-0.0010, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6796],
        [ 0.6178, -2.6269],
        [-0.7280,  1.4723],
        [-0.8538, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7700, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6230, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0008, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6798],
        [ 0.6179, -2.6268],
        [-0.7279,  1.4725],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6312, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6026, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0010, -0.0002],
        [-0.0009, -0.0002],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6798],
        [ 0.6176, -2.6268],
        [-0.7281,  1.4725],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7375, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6261, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.6714e-04, -1.4447e-04],
        [-8.3137e-04, -7.8928e-05],
        [-9.2929e-04, -1.2506e-04],
        [-9.8597e-04, -1.3385e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6799],
        [ 0.6178, -2.6266],
        [-0.7281,  1.4726],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7285, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6210, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0009, -0.0002],
        [-0.0009, -0.0003],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6799],
        [ 0.6177, -2.6268],
        [-0.7281,  1.4725],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6260, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6042, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0002],
        [-0.0008, -0.0002],
        [-0.0010, -0.0002],
        [-0.0008, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6799],
        [ 0.6179, -2.6268],
        [-0.7282,  1.4726],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2905, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5276, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:200, loss: 0.002638, Time: 77.1
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0003],
        [-0.0011, -0.0003],
        [-0.0010, -0.0003],
        [-0.0010, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6798],
        [ 0.6177, -2.6269],
        [-0.7282,  1.4725],
        [-0.8538, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5404, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0432, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5945, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0002],
        [-0.0010, -0.0002],
        [-0.0011, -0.0003],
        [-0.0011, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6799],
        [ 0.6177, -2.6268],
        [-0.7283,  1.4726],
        [-0.8539, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9998, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4783, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0009, -0.0003],
        [-0.0009, -0.0002],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6799],
        [ 0.6179, -2.6269],
        [-0.7282,  1.4726],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7663, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6319, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0001],
        [-0.0006, -0.0003],
        [-0.0008, -0.0001],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6800],
        [ 0.6182, -2.6268],
        [-0.7280,  1.4727],
        [-0.8534, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2994, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0332, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5262, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0008, -0.0002],
        [-0.0007, -0.0002],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6799],
        [ 0.6180, -2.6267],
        [-0.7280,  1.4727],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6188, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5983, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0011, -0.0002],
        [-0.0012, -0.0002],
        [-0.0011, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6799],
        [ 0.6177, -2.6267],
        [-0.7285,  1.4726],
        [-0.8539, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2336, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0316, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5099, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0003],
        [-0.0010, -0.0003],
        [-0.0010, -0.0002],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6798],
        [ 0.6179, -2.6268],
        [-0.7284,  1.4727],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4459, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5674, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0003],
        [-0.0011, -0.0002],
        [-0.0012, -0.0001],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6799],
        [ 0.6178, -2.6267],
        [-0.7286,  1.4728],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9147, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0475, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4780, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0002],
        [-0.0009, -0.0002],
        [-0.0009, -0.0001],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6799],
        [ 0.6179, -2.6267],
        [-0.7283,  1.4728],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1089, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4969, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0002],
        [-0.0010, -0.0002],
        [-0.0010, -0.0001],
        [-0.0008, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6799],
        [ 0.6178, -2.6268],
        [-0.7284,  1.4728],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8984, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0447, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4690, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0001],
        [-0.0013, -0.0002],
        [-0.0013, -0.0001],
        [-0.0013, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6799],
        [ 0.6175, -2.6267],
        [-0.7287,  1.4729],
        [-0.8540, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4258, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5666, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014, -0.0003],
        [-0.0014, -0.0002],
        [-0.0015, -0.0003],
        [-0.0014, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6798],
        [ 0.6174, -2.6268],
        [-0.7289,  1.4727],
        [-0.8541, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8525, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0313, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4332, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.2773e-04, -1.2813e-04],
        [-7.8806e-04, -8.2202e-05],
        [-7.7223e-04, -8.1369e-05],
        [-5.7235e-04, -9.3435e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6799],
        [ 0.6180, -2.6267],
        [-0.7283,  1.4729],
        [-0.8533, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6049, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5939, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0002],
        [-0.0011, -0.0002],
        [-0.0011, -0.0001],
        [-0.0011, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6799],
        [ 0.6176, -2.6268],
        [-0.7285,  1.4729],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6478, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6069, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0009, -0.0002],
        [-0.0011, -0.0002],
        [-0.0008, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6798],
        [ 0.6178, -2.6268],
        [-0.7286,  1.4728],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4526, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5672, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013, -0.0004],
        [-0.0011, -0.0003],
        [-0.0013, -0.0004],
        [-0.0011, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6797],
        [ 0.6176, -2.6269],
        [-0.7288,  1.4726],
        [-0.8538, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8159, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0428, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4488, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0010, -0.0002],
        [-0.0011, -0.0002],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6799],
        [ 0.6178, -2.6268],
        [-0.7286,  1.4729],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7069, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6189, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0002],
        [-0.0011, -0.0003],
        [-0.0012, -0.0003],
        [-0.0012, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6798],
        [ 0.6176, -2.6270],
        [-0.7288,  1.4728],
        [-0.8538, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4910, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3802, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0003],
        [-0.0011, -0.0004],
        [-0.0012, -0.0004],
        [-0.0011, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6798],
        [ 0.6176, -2.6270],
        [-0.7287,  1.4728],
        [-0.8537, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9641, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4669, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0759e-03, -1.8294e-04],
        [-1.0945e-03, -2.3338e-04],
        [-1.0241e-03, -1.7489e-04],
        [-1.0748e-03, -8.0477e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6799],
        [ 0.6176, -2.6269],
        [-0.7286,  1.4730],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6640, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6054, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0001],
        [-0.0011, -0.0002],
        [-0.0010, -0.0002],
        [-0.0010, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6800],
        [ 0.6177, -2.6269],
        [-0.7286,  1.4729],
        [-0.8537, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3603, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5487, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0003],
        [-0.0010, -0.0003],
        [-0.0008, -0.0003],
        [-0.0009, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6798],
        [ 0.6177, -2.6270],
        [-0.7284,  1.4729],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9356, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6624, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1409e-03, -1.3770e-04],
        [-1.1044e-03, -8.5749e-05],
        [-1.1554e-03, -1.5522e-04],
        [-1.1497e-03, -1.0582e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6800],
        [ 0.6176, -2.6268],
        [-0.7287,  1.4730],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4902, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0451, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5883, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0003],
        [-0.0009, -0.0002],
        [-0.0009, -0.0003],
        [-0.0010, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6799],
        [ 0.6178, -2.6269],
        [-0.7284,  1.4729],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0270, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4765, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0008, -0.0003],
        [-0.0008, -0.0002],
        [-0.0008, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6800],
        [ 0.6179, -2.6270],
        [-0.7283,  1.4731],
        [-0.8534, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6427, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0473, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6232, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0002],
        [-0.0013, -0.0002],
        [-0.0012, -0.0002],
        [-0.0012, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6799],
        [ 0.6174, -2.6269],
        [-0.7286,  1.4730],
        [-0.8538, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8706, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0322, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4386, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2141e-03, -1.1481e-05],
        [-1.2739e-03, -1.0385e-04],
        [-1.1354e-03, -3.8396e-05],
        [-1.2142e-03, -6.4721e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6802],
        [ 0.6174, -2.6268],
        [-0.7286,  1.4732],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4557, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5595, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0002],
        [-0.0010, -0.0002],
        [-0.0010, -0.0002],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6799],
        [ 0.6176, -2.6269],
        [-0.7285,  1.4731],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2813, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5357, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0003],
        [-0.0010, -0.0002],
        [-0.0009, -0.0002],
        [-0.0010, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6799],
        [ 0.6176, -2.6269],
        [-0.7283,  1.4731],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4036, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5520, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.5652e-04, -1.0833e-04],
        [-9.0422e-04, -4.6019e-05],
        [-8.4356e-04, -7.5393e-05],
        [-8.9763e-04, -6.4290e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6801],
        [ 0.6177, -2.6267],
        [-0.7283,  1.4732],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9368, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4630, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013, -0.0003],
        [-0.0011, -0.0002],
        [-0.0011, -0.0002],
        [-0.0011, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6799],
        [ 0.6175, -2.6269],
        [-0.7285,  1.4731],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8173, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4428, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012, -0.0001],
        [-0.0012, -0.0002],
        [-0.0013, -0.0001],
        [-0.0013, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6801],
        [ 0.6174, -2.6269],
        [-0.7287,  1.4732],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6874, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4213, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0874e-03, -6.8611e-05],
        [-1.0436e-03, -8.3261e-05],
        [-1.1130e-03, -9.0552e-05],
        [-8.9490e-04, -6.1486e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6802],
        [ 0.6175, -2.6268],
        [-0.7285,  1.4732],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3133, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5382, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012, -0.0001],
        [-0.0011, -0.0002],
        [-0.0013, -0.0002],
        [-0.0011, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6801],
        [ 0.6175, -2.6269],
        [-0.7287,  1.4732],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3878, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5653, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0002],
        [-0.0013, -0.0002],
        [-0.0011, -0.0001],
        [-0.0013, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6801],
        [ 0.6172, -2.6269],
        [-0.7285,  1.4732],
        [-0.8539, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4819, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3714, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.6538e-04, -9.1089e-05],
        [-9.5174e-04, -6.9897e-05],
        [-9.3056e-04, -9.5328e-05],
        [-8.5340e-04, -8.6974e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6802],
        [ 0.6176, -2.6268],
        [-0.7283,  1.4732],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9734, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4662, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3833e-03, -1.3341e-04],
        [-1.2223e-03, -1.3907e-04],
        [-1.1075e-03, -3.5358e-05],
        [-1.3284e-03, -1.5824e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6802],
        [ 0.6173, -2.6268],
        [-0.7285,  1.4733],
        [-0.8539, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5666, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3802, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2194e-03, -9.9045e-05],
        [-1.2154e-03, -1.1412e-04],
        [-1.0186e-03, -1.3994e-04],
        [-1.0521e-03, -1.2157e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6802],
        [ 0.6173, -2.6268],
        [-0.7284,  1.4732],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.6371, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6050, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3694e-03, -3.4407e-05],
        [-1.5563e-03,  2.4037e-05],
        [-1.4937e-03,  1.0992e-05],
        [-1.4682e-03, -3.4323e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6803],
        [ 0.6169, -2.6267],
        [-0.7289,  1.4734],
        [-0.8540, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1932, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5059, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0658e-03, -1.2244e-04],
        [-1.0874e-03, -1.6820e-04],
        [-1.1438e-03, -8.8185e-05],
        [-9.9071e-04, -1.6247e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6802],
        [ 0.6174, -2.6269],
        [-0.7285,  1.4733],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3022, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0441, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5486, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0009, -0.0002],
        [-0.0010, -0.0002],
        [-0.0008, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6801],
        [ 0.6176, -2.6269],
        [-0.7284,  1.4732],
        [-0.8534, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7978, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6334, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0001],
        [-0.0011, -0.0002],
        [-0.0010, -0.0002],
        [-0.0011, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6802],
        [ 0.6173, -2.6269],
        [-0.7283,  1.4731],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6882, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4124, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1598e-03, -6.5873e-05],
        [-1.1737e-03,  1.3031e-05],
        [-9.7264e-04, -5.2940e-06],
        [-1.0061e-03, -5.4431e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6802],
        [ 0.6172, -2.6267],
        [-0.7283,  1.4734],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7246, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0456, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6361, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2652e-03, -2.5831e-05],
        [-1.3178e-03, -6.5483e-05],
        [-1.2957e-03, -7.7714e-06],
        [-1.1600e-03, -9.9147e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6803],
        [ 0.6171, -2.6268],
        [-0.7286,  1.4734],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8674, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4593, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5458e-03, -9.2706e-05],
        [-1.3270e-03, -1.1125e-04],
        [-1.2413e-03, -1.1818e-04],
        [-1.3901e-03, -1.1760e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6802],
        [ 0.6171, -2.6269],
        [-0.7285,  1.4733],
        [-0.8540, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7022, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4108, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0010, -0.0002],
        [-0.0008, -0.0002],
        [-0.0010, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6801],
        [ 0.6174, -2.6269],
        [-0.7281,  1.4732],
        [-0.8536, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1938, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0323, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5035, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0465e-03, -1.0726e-04],
        [-1.2111e-03, -3.9551e-05],
        [-1.2663e-03, -8.7493e-05],
        [-1.1222e-03, -1.4579e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6803],
        [ 0.6172, -2.6268],
        [-0.7285,  1.4733],
        [-0.8537, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6339, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4035, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013, -0.0001],
        [-0.0014, -0.0002],
        [-0.0014, -0.0001],
        [-0.0012, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6803],
        [ 0.6170, -2.6269],
        [-0.7286,  1.4733],
        [-0.8539, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5232, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3823, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1735e-03, -7.1984e-05],
        [-1.0273e-03, -1.7971e-04],
        [-1.0088e-03, -6.7531e-05],
        [-1.0624e-03, -6.3458e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6804],
        [ 0.6173, -2.6269],
        [-0.7283,  1.4734],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7577, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4297, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3102e-03, -8.0804e-05],
        [-1.3103e-03, -1.8267e-04],
        [-1.2981e-03, -1.3750e-04],
        [-1.4100e-03, -1.6505e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6804],
        [ 0.6170, -2.6269],
        [-0.7285,  1.4733],
        [-0.8540, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9098, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4600, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0095e-03,  6.5403e-06],
        [-1.0077e-03, -5.6881e-05],
        [-1.2011e-03,  1.4276e-06],
        [-9.3635e-04,  2.2380e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6805],
        [ 0.6173, -2.6268],
        [-0.7284,  1.4735],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9375, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0467, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6808, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.1245e-04, -1.0963e-04],
        [-1.0215e-03, -1.0401e-04],
        [-1.0822e-03, -9.9095e-05],
        [-1.0659e-03, -2.0225e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6805],
        [ 0.6173, -2.6268],
        [-0.7283,  1.4734],
        [-0.8537, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9166, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4506, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.3570e-04, -3.9952e-05],
        [-1.0259e-03,  1.7290e-05],
        [-1.1413e-03, -9.3170e-05],
        [-1.1675e-03,  8.5963e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6806],
        [ 0.6173, -2.6267],
        [-0.7284,  1.4734],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8566, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4502, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014, -0.0001],
        [-0.0012, -0.0002],
        [-0.0012, -0.0002],
        [-0.0013, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6805],
        [ 0.6171, -2.6269],
        [-0.7284,  1.4733],
        [-0.8540, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5680, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0421, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3979, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2229e-03,  2.9585e-05],
        [-1.2012e-03,  3.2481e-05],
        [-1.2564e-03,  5.9204e-05],
        [-1.4181e-03,  6.9240e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6807],
        [ 0.6171, -2.6267],
        [-0.7285,  1.4736],
        [-0.8540, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7180, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6206, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0593e-03,  2.3395e-05],
        [-1.1586e-03, -4.1897e-05],
        [-1.1751e-03,  1.1139e-05],
        [-1.0810e-03,  7.2294e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6808],
        [ 0.6171, -2.6268],
        [-0.7284,  1.4736],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1608, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5125, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1343e-03,  6.9500e-05],
        [-1.1899e-03,  7.6738e-05],
        [-1.0428e-03,  7.2827e-05],
        [-1.3706e-03,  1.6087e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6808],
        [ 0.6171, -2.6266],
        [-0.7283,  1.4736],
        [-0.8539, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5327, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3880, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2951e-03,  6.4092e-05],
        [-1.2572e-03,  1.2263e-04],
        [-1.2714e-03,  7.9924e-05],
        [-1.2040e-03,  8.0249e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6809],
        [ 0.6170, -2.6266],
        [-0.7285,  1.4737],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3284, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0320, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5298, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0936e-03,  9.1995e-05],
        [-1.2300e-03,  1.1888e-04],
        [-1.3242e-03,  1.4377e-04],
        [-1.1929e-03,  1.6791e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6809],
        [ 0.6170, -2.6266],
        [-0.7285,  1.4738],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0737, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4935, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1513e-03,  5.4908e-05],
        [-1.0423e-03, -1.4891e-05],
        [-1.1726e-03,  4.3098e-05],
        [-1.3292e-03,  1.1086e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6809],
        [ 0.6172, -2.6267],
        [-0.7284,  1.4737],
        [-0.8539, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9986, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4687, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2053e-03, -1.3571e-05],
        [-1.2684e-03,  2.0482e-05],
        [-1.0763e-03, -2.7336e-05],
        [-1.1713e-03, -3.8668e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6809],
        [ 0.6169, -2.6267],
        [-0.7283,  1.4736],
        [-0.8537, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8818, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4550, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3721e-03,  2.1937e-05],
        [-1.0954e-03,  8.8411e-05],
        [-1.1617e-03,  1.8515e-04],
        [-1.1455e-03,  6.4334e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6810],
        [ 0.6171, -2.6266],
        [-0.7284,  1.4739],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6435, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4019, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0126e-03, -9.8371e-05],
        [-1.0971e-03, -1.0667e-05],
        [-1.0048e-03, -1.2414e-05],
        [-1.0231e-03, -1.0754e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6809],
        [ 0.6171, -2.6267],
        [-0.7283,  1.4737],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9397, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4663, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3723e-03,  1.8134e-04],
        [-1.3119e-03,  1.7134e-04],
        [-1.3840e-03,  2.5155e-04],
        [-1.3085e-03,  8.8186e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6812],
        [ 0.6169, -2.6265],
        [-0.7286,  1.4740],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2568, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3331, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2777e-03,  1.4708e-04],
        [-1.1284e-03,  8.5621e-05],
        [-1.2450e-03,  9.5007e-05],
        [-1.1833e-03,  9.1679e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6812],
        [ 0.6171, -2.6266],
        [-0.7285,  1.4738],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0756, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4827, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0861e-03,  5.3019e-05],
        [-1.1636e-03,  6.8196e-05],
        [-1.1373e-03,  8.1799e-06],
        [-1.1816e-03,  5.9603e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6811],
        [ 0.6170, -2.6266],
        [-0.7284,  1.4738],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1174, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0296, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4828, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3132e-03,  1.1404e-04],
        [-1.4844e-03,  9.7129e-05],
        [-1.4422e-03,  1.6586e-04],
        [-1.3056e-03,  1.2472e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6813],
        [ 0.6167, -2.6266],
        [-0.7287,  1.4740],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4810, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3718, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3483e-03,  1.0817e-04],
        [-1.2222e-03,  2.2204e-05],
        [-1.3140e-03,  1.2976e-05],
        [-9.9949e-04,  5.0863e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6813],
        [ 0.6169, -2.6266],
        [-0.7286,  1.4738],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9592, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0460, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4839, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2700e-03,  4.8815e-05],
        [-1.1007e-03,  3.8801e-05],
        [-9.7482e-04, -1.9933e-05],
        [-1.2244e-03,  7.3586e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6813],
        [ 0.6171, -2.6266],
        [-0.7283,  1.4738],
        [-0.8537, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2701, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0452, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5444, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2412e-03,  4.9035e-05],
        [-1.0309e-03,  8.5129e-05],
        [-1.1102e-03,  7.0253e-05],
        [-1.0482e-03,  3.8450e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6813],
        [ 0.6171, -2.6266],
        [-0.7284,  1.4740],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3728, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3421, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0001],
        [-0.0015,  0.0002],
        [-0.0015,  0.0002],
        [-0.0013,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6815],
        [ 0.6167, -2.6265],
        [-0.7288,  1.4741],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4144, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3537, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2594e-03,  9.3408e-05],
        [-1.2076e-03,  8.7200e-05],
        [-1.3259e-03,  3.8534e-05],
        [-1.1509e-03,  2.7828e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6814],
        [ 0.6170, -2.6266],
        [-0.7286,  1.4740],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0551, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4850, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009,  0.0002],
        [-0.0010,  0.0002],
        [-0.0010,  0.0002],
        [-0.0010,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6815],
        [ 0.6171, -2.6265],
        [-0.7283,  1.4741],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5244, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3811, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0002],
        [-0.0012,  0.0002],
        [-0.0012,  0.0001],
        [-0.0011,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6816],
        [ 0.6169, -2.6265],
        [-0.7285,  1.4741],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6264, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4015, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0002],
        [-0.0015,  0.0001],
        [-0.0014,  0.0003],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6816],
        [ 0.6167, -2.6265],
        [-0.7287,  1.4742],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5625, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3846, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2913e-03,  1.0787e-04],
        [-1.3331e-03,  8.4877e-05],
        [-1.3839e-03,  1.1733e-04],
        [-1.0875e-03,  1.1622e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6816],
        [ 0.6168, -2.6266],
        [-0.7287,  1.4741],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5598, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3857, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0012,  0.0002],
        [-0.0010,  0.0002],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6817],
        [ 0.6169, -2.6265],
        [-0.7283,  1.4742],
        [-0.8537, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4997, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3825, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0013,  0.0002],
        [-0.0016,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6817],
        [ 0.6168, -2.6264],
        [-0.7289,  1.4742],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5170, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0471, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3977, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1459e-03,  2.1885e-04],
        [-1.0901e-03,  9.7659e-05],
        [-1.2891e-03,  1.1251e-04],
        [-1.0430e-03,  5.3189e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6817],
        [ 0.6171, -2.6265],
        [-0.7286,  1.4742],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6574, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0415, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4144, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0018,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6818],
        [ 0.6164, -2.6263],
        [-0.7289,  1.4743],
        [-0.8542, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6028, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3904, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0016,  0.0003],
        [-0.0017,  0.0003],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6819],
        [ 0.6165, -2.6263],
        [-0.7290,  1.4744],
        [-0.8540, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0481, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2839, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0015,  0.0004],
        [-0.0015,  0.0004],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6819],
        [ 0.6166, -2.6262],
        [-0.7288,  1.4745],
        [-0.8540, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.2426, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5151, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1452e-03,  7.8892e-05],
        [-1.3012e-03,  8.4257e-05],
        [-1.3790e-03,  7.7264e-05],
        [-1.2861e-03,  5.0319e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6817],
        [ 0.6168, -2.6265],
        [-0.7287,  1.4742],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6359, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3998, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0002],
        [-0.0012,  0.0002],
        [-0.0015,  0.0002],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6818],
        [ 0.6169, -2.6264],
        [-0.7288,  1.4743],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7553, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4302, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0015,  0.0001],
        [-0.0015,  0.0001],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6818],
        [ 0.6167, -2.6264],
        [-0.7288,  1.4742],
        [-0.8541, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5518, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0422, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5947, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0744e-03,  8.6144e-06],
        [-1.1536e-03, -4.0166e-05],
        [-1.0849e-03, -5.6290e-06],
        [-1.3697e-03, -2.7969e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6816],
        [ 0.6170, -2.6266],
        [-0.7284,  1.4741],
        [-0.8538, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1428, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7083, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0015,  0.0003],
        [-0.0013,  0.0003],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6818],
        [ 0.6167, -2.6263],
        [-0.7286,  1.4744],
        [-0.8538, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8698, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4484, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0015,  0.0003],
        [-0.0014,  0.0001],
        [-0.0013,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6818],
        [ 0.6166, -2.6263],
        [-0.7287,  1.4743],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2961, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3351, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2098e-03,  6.9572e-05],
        [-1.1513e-03, -2.0352e-05],
        [-1.3650e-03,  1.1040e-04],
        [-1.2652e-03,  9.8271e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6817],
        [ 0.6170, -2.6266],
        [-0.7286,  1.4742],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8219, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4321, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5545e-03,  1.1470e-04],
        [-1.7608e-03,  1.0077e-04],
        [-1.8575e-03,  1.3307e-04],
        [-1.6435e-03,  9.1136e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6818],
        [ 0.6164, -2.6264],
        [-0.7291,  1.4743],
        [-0.8540, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2466, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0315, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3122, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0001],
        [-0.0013,  0.0002],
        [-0.0015,  0.0002],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6818],
        [ 0.6169, -2.6263],
        [-0.7287,  1.4743],
        [-0.8539, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0598, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2801, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0019,  0.0003],
        [-0.0018,  0.0004],
        [-0.0019,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6820],
        [ 0.6163, -2.6262],
        [-0.7291,  1.4746],
        [-0.8542, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8924, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0322, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4430, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2848e-03,  8.7215e-05],
        [-1.3637e-03,  4.8941e-05],
        [-1.1951e-03,  4.8671e-05],
        [-1.4621e-03,  1.1339e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6818],
        [ 0.6169, -2.6265],
        [-0.7284,  1.4742],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4506, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3661, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2921e-03,  7.6131e-07],
        [-1.2018e-03, -1.8523e-05],
        [-1.4154e-03, -2.0721e-05],
        [-1.2327e-03,  3.0062e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6817],
        [ 0.6170, -2.6265],
        [-0.7286,  1.4741],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0443, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4948, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1366e-03,  1.1093e-04],
        [-1.4352e-03,  9.5620e-05],
        [-1.2222e-03,  8.3457e-05],
        [-1.4684e-03,  1.0230e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6818],
        [ 0.6168, -2.6264],
        [-0.7284,  1.4742],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9713, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0461, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4864, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0015,  0.0002],
        [-0.0014,  0.0001],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6818],
        [ 0.6167, -2.6263],
        [-0.7286,  1.4743],
        [-0.8537, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9778, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4680, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1630e-03,  5.8843e-05],
        [-1.1819e-03,  9.6776e-05],
        [-1.3796e-03,  8.0499e-06],
        [-1.3253e-03,  7.6592e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6818],
        [ 0.6171, -2.6264],
        [-0.7286,  1.4742],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8515, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4526, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5384e-03,  8.4663e-05],
        [-1.5870e-03,  1.0961e-04],
        [-1.7137e-03,  1.3188e-04],
        [-1.5743e-03,  1.0565e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6818],
        [ 0.6167, -2.6264],
        [-0.7289,  1.4743],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4097, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0330, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3479, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5599e-03,  2.7134e-05],
        [-1.3375e-03,  8.4053e-05],
        [-1.5117e-03,  7.2214e-05],
        [-1.5450e-03,  5.8920e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6817],
        [ 0.6170, -2.6264],
        [-0.7287,  1.4743],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1000, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0467, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3135, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0002],
        [-0.0015,  0.0001],
        [-0.0018,  0.0002],
        [-0.0018,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6819],
        [ 0.6169, -2.6264],
        [-0.7289,  1.4745],
        [-0.8539, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6532, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4034, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:300, loss: 0.001345, Time: 113.9
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4939e-03,  1.4568e-05],
        [-1.2282e-03,  2.3195e-05],
        [-1.3914e-03,  4.4306e-06],
        [-1.4571e-03, -4.2869e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6818],
        [ 0.6172, -2.6264],
        [-0.7286,  1.4742],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7764, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4260, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0001],
        [-0.0019,  0.0002],
        [-0.0016,  0.0002],
        [-0.0015,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6819],
        [ 0.6165, -2.6263],
        [-0.7287,  1.4744],
        [-0.8536, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0766, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2951, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5511e-03,  1.0035e-04],
        [-1.3696e-03,  3.2785e-05],
        [-1.4308e-03,  2.7734e-05],
        [-1.2698e-03,  3.1321e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6819],
        [ 0.6171, -2.6264],
        [-0.7286,  1.4743],
        [-0.8533, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7366, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4243, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5453e-03,  2.4794e-05],
        [-1.6447e-03,  1.8285e-05],
        [-1.5959e-03,  6.9804e-06],
        [-1.5734e-03,  5.2439e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6818],
        [ 0.6168, -2.6264],
        [-0.7287,  1.4743],
        [-0.8536, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4140, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3537, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4777e-03,  8.5616e-05],
        [-1.6280e-03,  1.0405e-04],
        [-1.4172e-03,  6.3458e-05],
        [-1.3521e-03,  9.3192e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6169, -2.6263],
        [-0.7285,  1.4743],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2953, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0313, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3216, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7478e-03,  9.8150e-05],
        [-1.6420e-03,  8.9078e-05],
        [-1.7186e-03,  6.4899e-05],
        [-1.4818e-03, -1.2356e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6819],
        [ 0.6169, -2.6263],
        [-0.7288,  1.4743],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5071, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0456, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3926, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6906e-03,  1.0370e-04],
        [-1.4406e-03, -7.8706e-05],
        [-1.7444e-03,  7.2986e-05],
        [-1.5044e-03,  4.2952e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6819],
        [ 0.6171, -2.6265],
        [-0.7289,  1.4744],
        [-0.8535, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6939, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0415, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4217, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3244e-03,  1.7633e-04],
        [-1.2709e-03,  1.2507e-04],
        [-1.3084e-03,  9.5111e-05],
        [-1.1989e-03,  7.6572e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6820],
        [ 0.6173, -2.6263],
        [-0.7284,  1.4744],
        [-0.8532, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1976, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3274, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4080e-03,  6.3334e-05],
        [-1.1315e-03, -5.5287e-05],
        [-1.3664e-03,  7.6877e-05],
        [-1.2166e-03,  3.9857e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6819],
        [ 0.6174, -2.6264],
        [-0.7284,  1.4744],
        [-0.8532, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3258, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3350, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5291e-03,  1.1056e-04],
        [-1.3940e-03,  1.2219e-04],
        [-1.4464e-03,  9.8673e-05],
        [-1.4172e-03,  8.0777e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6172, -2.6262],
        [-0.7285,  1.4744],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3119, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3342, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4927e-03,  1.2201e-05],
        [-1.5892e-03,  8.3328e-05],
        [-1.5940e-03,  6.9350e-05],
        [-1.6365e-03,  4.4641e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6818],
        [ 0.6170, -2.6263],
        [-0.7287,  1.4744],
        [-0.8536, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2372, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3180, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5370e-03, -5.8837e-06],
        [-1.4819e-03,  2.5721e-05],
        [-1.4519e-03,  1.7385e-05],
        [-1.2951e-03,  5.7109e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6818],
        [ 0.6171, -2.6263],
        [-0.7285,  1.4743],
        [-0.8533, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2544, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3299, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2018e-03,  8.9642e-05],
        [-1.3029e-03,  9.5992e-05],
        [-1.3018e-03,  1.0778e-04],
        [-1.2062e-03,  5.2347e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6819],
        [ 0.6173, -2.6262],
        [-0.7283,  1.4744],
        [-0.8532, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3118, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0426, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5475, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0002],
        [-0.0019,  0.0002],
        [-0.0017,  0.0002],
        [-0.0018,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6820],
        [ 0.6167, -2.6261],
        [-0.7287,  1.4746],
        [-0.8537, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7846, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0309, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2187, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3941e-03,  7.6604e-05],
        [-1.5362e-03,  8.6761e-05],
        [-1.5344e-03,  7.7040e-05],
        [-1.4409e-03,  8.7358e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6819],
        [ 0.6171, -2.6262],
        [-0.7285,  1.4744],
        [-0.8534, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2065, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3176, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5053e-03,  1.9589e-05],
        [-1.2781e-03,  6.1815e-05],
        [-1.5010e-03,  4.6889e-05],
        [-1.5040e-03,  7.9662e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6818],
        [ 0.6173, -2.6262],
        [-0.7285,  1.4744],
        [-0.8534, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0628, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2948, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0002],
        [-0.0016,  0.0002],
        [-0.0017,  0.0002],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6820],
        [ 0.6170, -2.6261],
        [-0.7287,  1.4745],
        [-0.8536, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9772, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2728, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0001],
        [-0.0014,  0.0002],
        [-0.0015,  0.0002],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6173, -2.6261],
        [-0.7284,  1.4745],
        [-0.8535, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3805, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3550, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0001],
        [-0.0015,  0.0001],
        [-0.0014,  0.0001],
        [-0.0015,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6819],
        [ 0.6171, -2.6261],
        [-0.7284,  1.4745],
        [-0.8534, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6554, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0426, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4163, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0015,  0.0003],
        [-0.0013,  0.0002],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6172, -2.6260],
        [-0.7283,  1.4746],
        [-0.8532, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7562, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4283, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3279e-03,  1.9540e-04],
        [-1.3397e-03,  1.4457e-04],
        [-1.1979e-03,  1.4278e-04],
        [-1.0942e-03,  9.7266e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6820],
        [ 0.6173, -2.6261],
        [-0.7282,  1.4745],
        [-0.8530, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4852, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3731, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0017,  0.0002],
        [-0.0014,  0.0002],
        [-0.0015,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6170, -2.6260],
        [-0.7284,  1.4746],
        [-0.8534, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4086, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3601, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1348e-03,  7.8141e-05],
        [-1.1993e-03,  1.8094e-04],
        [-1.1496e-03,  1.8208e-04],
        [-1.1700e-03,  1.8942e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6819],
        [ 0.6175, -2.6260],
        [-0.7281,  1.4746],
        [-0.8530, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0857, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2966, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010,  0.0002],
        [-0.0010,  0.0001],
        [-0.0011,  0.0001],
        [-0.0012,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6820],
        [ 0.6177, -2.6261],
        [-0.7281,  1.4745],
        [-0.8530, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2915, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3404, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0002],
        [-0.0014,  0.0002],
        [-0.0015,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6821],
        [ 0.6173, -2.6260],
        [-0.7284,  1.4747],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3549, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3458, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0020,  0.0004],
        [-0.0017,  0.0003],
        [-0.0017,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6821],
        [ 0.6167, -2.6258],
        [-0.7287,  1.4747],
        [-0.8535, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2309, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0332, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3127, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0015,  0.0002],
        [-0.0015,  0.0002],
        [-0.0017,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6820],
        [ 0.6172, -2.6260],
        [-0.7284,  1.4747],
        [-0.8535, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9213, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2626, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0014,  0.0003],
        [-0.0013,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6820],
        [ 0.6173, -2.6259],
        [-0.7282,  1.4747],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5161, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3893, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0002],
        [-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0018,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6821],
        [ 0.6171, -2.6259],
        [-0.7285,  1.4747],
        [-0.8536, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7550, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4339, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0015,  0.0002],
        [-0.0013,  0.0002],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6173, -2.6260],
        [-0.7282,  1.4747],
        [-0.8533, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6406, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4040, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0016,  0.0002],
        [-0.0015,  0.0003],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6172, -2.6259],
        [-0.7284,  1.4748],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5406, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3838, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0013,  0.0003],
        [-0.0015,  0.0003],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6822],
        [ 0.6174, -2.6259],
        [-0.7284,  1.4748],
        [-0.8534, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5494, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3835, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0014,  0.0002],
        [-0.0015,  0.0003],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6821],
        [ 0.6174, -2.6260],
        [-0.7283,  1.4748],
        [-0.8531, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.6023, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3984, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0002],
        [-0.0016,  0.0002],
        [-0.0017,  0.0002],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6820],
        [ 0.6172, -2.6259],
        [-0.7285,  1.4747],
        [-0.8534, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3586, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3521, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0018,  0.0003],
        [-0.0017,  0.0003],
        [-0.0014,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6821],
        [ 0.6170, -2.6258],
        [-0.7286,  1.4748],
        [-0.8532, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1384, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3047, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0013,  0.0003],
        [-0.0013,  0.0004],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6822],
        [ 0.6175, -2.6258],
        [-0.7281,  1.4749],
        [-0.8531, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2445, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3185, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0004],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6822],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4749],
        [-0.8535, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1342, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2987, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0015,  0.0003],
        [-0.0015,  0.0002],
        [-0.0014,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6821],
        [ 0.6173, -2.6258],
        [-0.7283,  1.4747],
        [-0.8532, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4347, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3605, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0017,  0.0004],
        [-0.0014,  0.0003],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6823],
        [ 0.6171, -2.6257],
        [-0.7282,  1.4748],
        [-0.8535, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1144, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0435, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3100, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0015,  0.0004],
        [-0.0016,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6824],
        [ 0.6173, -2.6257],
        [-0.7284,  1.4749],
        [-0.8536, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4627, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3687, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0014,  0.0003],
        [-0.0015,  0.0003],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6823],
        [ 0.6174, -2.6257],
        [-0.7284,  1.4748],
        [-0.8534, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1478, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3044, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0001],
        [-0.0011,  0.0002],
        [-0.0014,  0.0003],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6821],
        [ 0.6177, -2.6258],
        [-0.7282,  1.4748],
        [-0.8531, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.8552, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4487, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0015,  0.0003],
        [-0.0013,  0.0003],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6823],
        [ 0.6173, -2.6257],
        [-0.7281,  1.4748],
        [-0.8534, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2010, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3240, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0016,  0.0004],
        [-0.0015,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6824],
        [ 0.6173, -2.6256],
        [-0.7283,  1.4749],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1431, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3086, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0016,  0.0004],
        [-0.0017,  0.0004],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6824],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8535, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3399, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3487, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0018,  0.0003],
        [-0.0018,  0.0003],
        [-0.0020,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6824],
        [ 0.6170, -2.6257],
        [-0.7287,  1.4748],
        [-0.8539, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9703, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2665, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0013,  0.0002],
        [-0.0017,  0.0003],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6823],
        [ 0.6175, -2.6258],
        [-0.7286,  1.4748],
        [-0.8535, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1189, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0420, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3078, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0013,  0.0003],
        [-0.0013,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6823],
        [ 0.6176, -2.6257],
        [-0.7281,  1.4748],
        [-0.8531, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5253, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0323, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3697, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0002],
        [-0.0013,  0.0001],
        [-0.0014,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6823],
        [ 0.6176, -2.6259],
        [-0.7283,  1.4747],
        [-0.8532, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7285, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4181, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0013,  0.0002],
        [-0.0012,  0.0003],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6823],
        [ 0.6176, -2.6259],
        [-0.7280,  1.4747],
        [-0.8531, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1623, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3113, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0015,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6824],
        [ 0.6174, -2.6256],
        [-0.7284,  1.4749],
        [-0.8534, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.0313, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4769, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0018,  0.0004],
        [-0.0019,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6824],
        [ 0.6171, -2.6257],
        [-0.7288,  1.4749],
        [-0.8535, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5350, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3814, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0019,  0.0005],
        [-0.0018,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6825],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4750],
        [-0.8536, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7976, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2343, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0004],
        [-0.0014,  0.0004],
        [-0.0011,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6824],
        [ 0.6175, -2.6257],
        [-0.7279,  1.4748],
        [-0.8532, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4861, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3797, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  35
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  36
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  43
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  35
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  41
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  42
gt_cnt:  38
gt_cnt:  37
gt_cnt:  44
gt_cnt:  41
gt_cnt:  41
gt_cnt:  37
gt_cnt:  35
gt_cnt:  42
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  41
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  40
gt_cnt:  36
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  38
gt_cnt:  41
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  42
gt_cnt:  40
gt_cnt:  35
gt_cnt:  41
gt_cnt:  42
gt_cnt:  42
gt_cnt:  38
gt_cnt:  38
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  40
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  35
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  43
gt_cnt:  35
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  42
gt_cnt:  42
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  39
gt_cnt:  35
gt_cnt:  38
gt_cnt:  34
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  36
gt_cnt:  43
gt_cnt:  41
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  42
gt_cnt:  39
gt_cnt:  35
gt_cnt:  41
gt_cnt:  42
gt_cnt:  42
gt_cnt:  40
gt_cnt:  42
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  35
gt_cnt:  38
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  36
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  42
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  36
gt_cnt:  35
gt_cnt:  39
gt_cnt:  36
gt_cnt:  35
gt_cnt:  42
gt_cnt:  37
gt_cnt:  42
gt_cnt:  40
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  43
gt_cnt:  33
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  36
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  41
gt_cnt:  36
gt_cnt:  44
gt_cnt:  40
gt_cnt:  35
gt_cnt:  44
gt_cnt:  40
gt_cnt:  42
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  35
gt_cnt:  36
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  41
gt_cnt:  38
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  43
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  37
gt_cnt:  43
gt_cnt:  39
gt_cnt:  40
gt_cnt:  35
gt_cnt:  42
gt_cnt:  38
gt_cnt:  37
gt_cnt:  40
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  42
gt_cnt:  41
gt_cnt:  40
gt_cnt:  41
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  41
gt_cnt:  42
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  35
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  37
gt_cnt:  36
gt_cnt:  37
gt_cnt:  39
gt_cnt:  36
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  41
gt_cnt:  36
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  39
gt_cnt:  36
gt_cnt:  44
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  40
gt_cnt:  36
gt_cnt:  37
gt_cnt:  39
gt_cnt:  37
gt_cnt:  44
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  35
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  34
gt_cnt:  37
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
tensor([[-0.0018,  0.0004],
        [-0.0017,  0.0004],
        [-0.0019,  0.0005],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6173, -2.6257],
        [-0.7287,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0027, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2789, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0019,  0.0003],
        [-0.0018,  0.0003],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6825],
        [ 0.6170, -2.6257],
        [-0.7286,  1.4748],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1812, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3052, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0004],
        [-0.0015,  0.0004],
        [-0.0015,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6825],
        [ 0.6174, -2.6257],
        [-0.7283,  1.4748],
        [-0.8532, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2933, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3325, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0003],
        [-0.0013,  0.0003],
        [-0.0012,  0.0004],
        [-0.0010,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6824],
        [ 0.6177, -2.6257],
        [-0.7280,  1.4749],
        [-0.8529, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0523, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0458, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3020, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0015,  0.0004],
        [-0.0016,  0.0003],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6825],
        [ 0.6175, -2.6257],
        [-0.7283,  1.4748],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9984, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2804, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0014,  0.0003],
        [-0.0013,  0.0002],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6823],
        [ 0.6176, -2.6258],
        [-0.7280,  1.4747],
        [-0.8532, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.1377, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5057, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:360, loss: 0.001405, Time: 135.9
Testing...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6172, -2.6256],
        [-0.7285,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4033, device='cuda:0'), 'loss_center': tensor(0.0363, device='cuda:0')}
loss: tensor(0.1533, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266,
         0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266,
         0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266,
         0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266,
         0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266, 0.5266,
         0.5266, 0.5266, 0.5266, 0.5266, 0.5266]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6173, -2.6257],
        [-0.7284,  1.4749],
        [-0.8536, -2.7483]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4072, device='cuda:0'), 'loss_center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.1579, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3879, device='cuda:0'), 'loss_center': tensor(0.0378, device='cuda:0')}
loss: tensor(0.1531, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401,
         0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401,
         0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401,
         0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401,
         0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401, 0.5401,
         0.5401, 0.5401, 0.5401, 0.5401, 0.5401]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3816, device='cuda:0'), 'loss_center': tensor(0.0381, device='cuda:0')}
loss: tensor(0.1526, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571,
         0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571,
         0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571,
         0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571,
         0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571, 0.5571,
         0.5571, 0.5571, 0.5571, 0.5571, 0.5571]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3949, device='cuda:0'), 'loss_center': tensor(0.0329, device='cuda:0')}
loss: tensor(0.1448, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533,
         0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533,
         0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533,
         0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533,
         0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533,
         0.5533, 0.5533, 0.5533, 0.5533, 0.5533]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3949, device='cuda:0'), 'loss_center': tensor(0.0337, device='cuda:0')}
loss: tensor(0.1463, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533,
         0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533,
         0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533,
         0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533,
         0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533, 0.5533,
         0.5533, 0.5533, 0.5533, 0.5533, 0.5533]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6172, -2.6256],
        [-0.7285,  1.4750],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4136, device='cuda:0'), 'loss_center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.1596, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4749],
        [-0.8536, -2.7482]], device='cuda:0')
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4302, device='cuda:0'), 'loss_center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.1629, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238,
         0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238,
         0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238,
         0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238,
         0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238, 0.5238,
         0.5238, 0.5238, 0.5238, 0.5238, 0.5238]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4008, device='cuda:0'), 'loss_center': tensor(0.0415, device='cuda:0')}
loss: tensor(0.1631, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300,
         0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300,
         0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300,
         0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300,
         0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300, 0.5300,
         0.5300, 0.5300, 0.5300, 0.5300, 0.5300]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4749],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3951, device='cuda:0'), 'loss_center': tensor(0.0392, device='cuda:0')}
loss: tensor(0.1575, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390,
         0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390,
         0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390,
         0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390,
         0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390, 0.5390,
         0.5390, 0.5390, 0.5390, 0.5390, 0.5390]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4136, device='cuda:0'), 'loss_center': tensor(0.0419, device='cuda:0')}
loss: tensor(0.1665, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144,
         0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144,
         0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144,
         0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144,
         0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144, 0.5144,
         0.5144, 0.5144, 0.5144, 0.5144, 0.5144]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4750],
        [-0.8538, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4065, device='cuda:0'), 'loss_center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.1579, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324,
         0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324,
         0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324,
         0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324,
         0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324, 0.5324,
         0.5324, 0.5324, 0.5324, 0.5324, 0.5324]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4750],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4004, device='cuda:0'), 'loss_center': tensor(0.0386, device='cuda:0')}
loss: tensor(0.1572, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206,
         0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206,
         0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206,
         0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206,
         0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206, 0.5206,
         0.5206, 0.5206, 0.5206, 0.5206, 0.5206]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4749],
        [-0.8536, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4052, device='cuda:0'), 'loss_center': tensor(0.0374, device='cuda:0')}
loss: tensor(0.1559, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149,
         0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149,
         0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149,
         0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149,
         0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149, 0.5149,
         0.5149, 0.5149, 0.5149, 0.5149, 0.5149]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4301, device='cuda:0'), 'loss_center': tensor(0.0378, device='cuda:0')}
loss: tensor(0.1615, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913,
         0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913,
         0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913,
         0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913,
         0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913, 0.4913,
         0.4913, 0.4913, 0.4913, 0.4913, 0.4913]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4002, device='cuda:0'), 'loss_center': tensor(0.0362, device='cuda:0')}
loss: tensor(0.1525, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119,
         0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119,
         0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119,
         0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119,
         0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119, 0.5119,
         0.5119, 0.5119, 0.5119, 0.5119, 0.5119]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3857, device='cuda:0'), 'loss_center': tensor(0.0343, device='cuda:0')}
loss: tensor(0.1457, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448,
         0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448,
         0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448,
         0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448,
         0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448, 0.5448,
         0.5448, 0.5448, 0.5448, 0.5448, 0.5448]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3854, device='cuda:0'), 'loss_center': tensor(0.0409, device='cuda:0')}
loss: tensor(0.1589, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456,
         0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456,
         0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456,
         0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456,
         0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456, 0.5456,
         0.5456, 0.5456, 0.5456, 0.5456, 0.5456]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4027, device='cuda:0'), 'loss_center': tensor(0.0360, device='cuda:0')}
loss: tensor(0.1526, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273,
         0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273,
         0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273,
         0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273,
         0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273, 0.5273,
         0.5273, 0.5273, 0.5273, 0.5273, 0.5273]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4749],
        [-0.8536, -2.7482]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3923, device='cuda:0'), 'loss_center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.1550, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219,
         0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219,
         0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219,
         0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219,
         0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219, 0.5219,
         0.5219, 0.5219, 0.5219, 0.5219, 0.5219]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3933, device='cuda:0'), 'loss_center': tensor(0.0337, device='cuda:0')}
loss: tensor(0.1461, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307,
         0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307,
         0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307,
         0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307,
         0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307, 0.5307,
         0.5307, 0.5307, 0.5307, 0.5307, 0.5307]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6171, -2.6257],
        [-0.7286,  1.4749],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3944, device='cuda:0'), 'loss_center': tensor(0.0333, device='cuda:0')}
loss: tensor(0.1454, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546,
         0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546,
         0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546,
         0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546,
         0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546, 0.5546,
         0.5546, 0.5546, 0.5546, 0.5546, 0.5546]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0004],
        [-0.0019,  0.0004],
        [-0.0019,  0.0004],
        [-0.0019,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4749],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4066, device='cuda:0'), 'loss_center': tensor(0.0314, device='cuda:0')}
loss: tensor(0.1441, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437,
         0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437,
         0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437,
         0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437,
         0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437, 0.5437,
         0.5437, 0.5437, 0.5437, 0.5437, 0.5437]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4749],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4427, device='cuda:0'), 'loss_center': tensor(0.0370, device='cuda:0')}
loss: tensor(0.1625, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121,
         0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121,
         0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121,
         0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121,
         0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121,
         0.5121, 0.5121, 0.5121, 0.5121, 0.5121]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4384, device='cuda:0'), 'loss_center': tensor(0.0399, device='cuda:0')}
loss: tensor(0.1675, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075,
         0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075,
         0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075,
         0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075,
         0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075, 0.5075,
         0.5075, 0.5075, 0.5075, 0.5075, 0.5075]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4320, device='cuda:0'), 'loss_center': tensor(0.0351, device='cuda:0')}
loss: tensor(0.1566, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132,
         0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132,
         0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132,
         0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132,
         0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132,
         0.5132, 0.5132, 0.5132, 0.5132, 0.5132]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4053, device='cuda:0'), 'loss_center': tensor(0.0398, device='cuda:0')}
loss: tensor(0.1607, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341,
         0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341,
         0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341,
         0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341,
         0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341, 0.5341,
         0.5341, 0.5341, 0.5341, 0.5341, 0.5341]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4749],
        [-0.8536, -2.7482]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4091, device='cuda:0'), 'loss_center': tensor(0.0381, device='cuda:0')}
loss: tensor(0.1581, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289,
         0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289,
         0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289,
         0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289,
         0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289, 0.5289,
         0.5289, 0.5289, 0.5289, 0.5289, 0.5289]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4049, device='cuda:0'), 'loss_center': tensor(0.0434, device='cuda:0')}
loss: tensor(0.1678, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347,
         0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347,
         0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347,
         0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347,
         0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347, 0.5347,
         0.5347, 0.5347, 0.5347, 0.5347, 0.5347]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4261, device='cuda:0'), 'loss_center': tensor(0.0452, device='cuda:0')}
loss: tensor(0.1755, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190,
         0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190,
         0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190,
         0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190,
         0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190, 0.5190,
         0.5190, 0.5190, 0.5190, 0.5190, 0.5190]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4438, device='cuda:0'), 'loss_center': tensor(0.0343, device='cuda:0')}
loss: tensor(0.1574, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198,
         0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198,
         0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198,
         0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198,
         0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198, 0.5198,
         0.5198, 0.5198, 0.5198, 0.5198, 0.5198]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4043, device='cuda:0'), 'loss_center': tensor(0.0370, device='cuda:0')}
loss: tensor(0.1549, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477,
         0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477,
         0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477,
         0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477,
         0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477, 0.5477,
         0.5477, 0.5477, 0.5477, 0.5477, 0.5477]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6171, -2.6256],
        [-0.7286,  1.4749],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3983, device='cuda:0'), 'loss_center': tensor(0.0394, device='cuda:0')}
loss: tensor(0.1584, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0004],
        [-0.0019,  0.0004],
        [-0.0019,  0.0004],
        [-0.0019,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6171, -2.6256],
        [-0.7287,  1.4749],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3966, device='cuda:0'), 'loss_center': tensor(0.0388, device='cuda:0')}
loss: tensor(0.1570, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492,
         0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492,
         0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492,
         0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492,
         0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492, 0.5492,
         0.5492, 0.5492, 0.5492, 0.5492, 0.5492]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6172, -2.6256],
        [-0.7285,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4058, device='cuda:0'), 'loss_center': tensor(0.0420, device='cuda:0')}
loss: tensor(0.1653, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450, 0.5450,
         0.5450, 0.5450, 0.5450, 0.5450, 0.5450]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4027, device='cuda:0'), 'loss_center': tensor(0.0449, device='cuda:0')}
loss: tensor(0.1704, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507,
         0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507,
         0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507,
         0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507,
         0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507,
         0.5507, 0.5507, 0.5507, 0.5507, 0.5507]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0')
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4286, device='cuda:0'), 'loss_center': tensor(0.0360, device='cuda:0')}
loss: tensor(0.1578, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354,
         0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354,
         0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354,
         0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354,
         0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354,
         0.5354, 0.5354, 0.5354, 0.5354, 0.5354]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6173, -2.6256],
        [-0.7285,  1.4749],
        [-0.8536, -2.7482]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.4136, device='cuda:0'), 'loss_center': tensor(0.0380, device='cuda:0')}
loss: tensor(0.1588, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333, 0.5333,
         0.5333, 0.5333, 0.5333, 0.5333, 0.5333]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6172, -2.6256],
        [-0.7286,  1.4749],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3834, device='cuda:0'), 'loss_center': tensor(0.0397, device='cuda:0')}
loss: tensor(0.1561, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509,
         0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509,
         0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509,
         0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509,
         0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509, 0.5509,
         0.5509, 0.5509, 0.5509, 0.5509, 0.5509]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6827],
        [ 0.6171, -2.6256],
        [-0.7287,  1.4750],
        [-0.8538, -2.7482]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.3817, device='cuda:0'), 'loss_center': tensor(0.0420, device='cuda:0')}
loss: tensor(0.1604, device='cuda:0', dtype=torch.float64)
top10 scores:  gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  37
gt_cnt:  36
gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  36
gt_cnt:  37
gt_cnt:  36
gt_cnt:  34
gt_cnt:  39
gt_cnt:  36
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  36
gt_cnt:  37
gt_cnt:  34
gt_cnt:  36
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  35
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  40
tensor([[0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399,
         0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399,
         0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399,
         0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399,
         0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399, 0.5399,
         0.5399, 0.5399, 0.5399, 0.5399, 0.5399]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
moda: 0.0%, modp: 36.0%, prec: 6.5%, recall: 8.7%
Test, loss: 0.157388, Time: 15.743
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0014,  0.0004],
        [-0.0015,  0.0004],
        [-0.0014,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6825],
        [ 0.6175, -2.6257],
        [-0.7282,  1.4749],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1640, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3111, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6825],
        [ 0.6176, -2.6258],
        [-0.7282,  1.4748],
        [-0.8534, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1812, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3120, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0015,  0.0004],
        [-0.0017,  0.0004],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6825],
        [ 0.6174, -2.6257],
        [-0.7284,  1.4749],
        [-0.8535, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3700, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3475, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6174, -2.6257],
        [-0.7284,  1.4749],
        [-0.8535, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6765, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0423, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2199, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6825],
        [ 0.6175, -2.6258],
        [-0.7283,  1.4748],
        [-0.8535, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4728, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3616, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0002],
        [-0.0015,  0.0001],
        [-0.0012,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6825],
        [ 0.6176, -2.6259],
        [-0.7280,  1.4747],
        [-0.8532, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2967, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3357, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0004],
        [-0.0013,  0.0003],
        [-0.0012,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6827],
        [ 0.6177, -2.6258],
        [-0.7279,  1.4748],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8403, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0425, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2530, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0014,  0.0003],
        [-0.0012,  0.0002],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6826],
        [ 0.6177, -2.6258],
        [-0.7280,  1.4747],
        [-0.8534, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1998, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3150, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0016,  0.0003],
        [-0.0018,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6828],
        [ 0.6175, -2.6258],
        [-0.7285,  1.4749],
        [-0.8537, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2239, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3119, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0014,  0.0004],
        [-0.0016,  0.0005],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6828],
        [ 0.6177, -2.6258],
        [-0.7283,  1.4750],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0533, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2843, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0002],
        [-0.0020,  0.0004],
        [-0.0017,  0.0002],
        [-0.0019,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6171, -2.6257],
        [-0.7284,  1.4747],
        [-0.8538, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0610, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0440, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3003, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0018,  0.0003],
        [-0.0019,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6826],
        [ 0.6173, -2.6258],
        [-0.7286,  1.4748],
        [-0.8538, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6104, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1989, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3302e-03,  9.5150e-05],
        [-1.2478e-03,  8.4528e-05],
        [-1.1271e-03,  9.5192e-05],
        [-1.5564e-03,  2.3260e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6824],
        [ 0.6179, -2.6260],
        [-0.7278,  1.4746],
        [-0.8535, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0981, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2980, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0018,  0.0004],
        [-0.0017,  0.0003],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4748],
        [-0.8538, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8552, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2441, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0015,  0.0002],
        [-0.0014,  0.0002],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6826],
        [ 0.6176, -2.6259],
        [-0.7281,  1.4747],
        [-0.8534, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9877, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2693, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0004],
        [-0.0017,  0.0004],
        [-0.0015,  0.0003],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6174, -2.6257],
        [-0.7282,  1.4748],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9938, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2708, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0005],
        [-0.0015,  0.0003],
        [-0.0013,  0.0004],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6828],
        [ 0.6176, -2.6258],
        [-0.7281,  1.4748],
        [-0.8534, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8554, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2470, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0019,  0.0004],
        [-0.0018,  0.0003],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6172, -2.6258],
        [-0.7285,  1.4748],
        [-0.8538, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8708, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2535, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0018,  0.0004],
        [-0.0016,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6827],
        [ 0.6174, -2.6257],
        [-0.7284,  1.4748],
        [-0.8537, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.4314, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3580, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0016,  0.0004],
        [-0.0015,  0.0003],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6827],
        [ 0.6176, -2.6258],
        [-0.7282,  1.4747],
        [-0.8534, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2558, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3215, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0017,  0.0004],
        [-0.0019,  0.0005],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6174, -2.6258],
        [-0.7286,  1.4750],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3891, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3558, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0013,  0.0003],
        [-0.0014,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6827],
        [ 0.6179, -2.6259],
        [-0.7281,  1.4746],
        [-0.8534, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7559, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4325, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020,  0.0005],
        [-0.0019,  0.0005],
        [-0.0022,  0.0005],
        [-0.0019,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6829],
        [ 0.6173, -2.6257],
        [-0.7290,  1.4750],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9031, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0330, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2467, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0018,  0.0004],
        [-0.0015,  0.0003],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6827],
        [ 0.6174, -2.6258],
        [-0.7282,  1.4748],
        [-0.8534, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9882, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2670, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0019,  0.0004],
        [-0.0022,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6828],
        [ 0.6176, -2.6258],
        [-0.7287,  1.4749],
        [-0.8542, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3549, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3422, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0005],
        [-0.0017,  0.0004],
        [-0.0019,  0.0005],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6829],
        [ 0.6176, -2.6258],
        [-0.7287,  1.4750],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0339, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0322, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2712, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0015,  0.0004],
        [-0.0014,  0.0003],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6828],
        [ 0.6178, -2.6258],
        [-0.7283,  1.4748],
        [-0.8537, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9161, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2579, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0017,  0.0004],
        [-0.0021,  0.0005],
        [-0.0021,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6829],
        [ 0.6175, -2.6258],
        [-0.7290,  1.4750],
        [-0.8541, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9324, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2648, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0015,  0.0002],
        [-0.0015,  0.0002],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6177, -2.6260],
        [-0.7284,  1.4747],
        [-0.8533, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3082, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3441, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6175, -2.6258],
        [-0.7286,  1.4749],
        [-0.8537, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2570, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3319, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6826],
        [ 0.6179, -2.6260],
        [-0.7283,  1.4748],
        [-0.8535, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8719, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2550, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0020,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6173, -2.6257],
        [-0.7288,  1.4750],
        [-0.8540, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9706, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2735, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0018,  0.0004],
        [-0.0019,  0.0004],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6828],
        [ 0.6175, -2.6258],
        [-0.7288,  1.4749],
        [-0.8536, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0770, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0438, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3030, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0017,  0.0003],
        [-0.0020,  0.0005],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6176, -2.6259],
        [-0.7289,  1.4751],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7467, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2205, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0019,  0.0004],
        [-0.0018,  0.0003],
        [-0.0018,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6828],
        [ 0.6174, -2.6258],
        [-0.7287,  1.4749],
        [-0.8539, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2704, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3363, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0019,  0.0005],
        [-0.0021,  0.0006],
        [-0.0019,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6174, -2.6258],
        [-0.7291,  1.4751],
        [-0.8540, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.3024, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3314, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0017,  0.0003],
        [-0.0019,  0.0004],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6176, -2.6259],
        [-0.7289,  1.4751],
        [-0.8539, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1877, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3138, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022,  0.0006],
        [-0.0021,  0.0005],
        [-0.0022,  0.0005],
        [-0.0023,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6830],
        [ 0.6172, -2.6258],
        [-0.7292,  1.4751],
        [-0.8544, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8409, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2378, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0017,  0.0003],
        [-0.0015,  0.0003],
        [-0.0018,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6176, -2.6259],
        [-0.7285,  1.4749],
        [-0.8540, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.7462, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4242, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0016,  0.0003],
        [-0.0019,  0.0004],
        [-0.0021,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6828],
        [ 0.6178, -2.6259],
        [-0.7288,  1.4751],
        [-0.8543, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8565, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0476, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2665, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0015,  0.0003],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6828],
        [ 0.6177, -2.6260],
        [-0.7285,  1.4749],
        [-0.8538, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9732, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2732, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020,  0.0005],
        [-0.0020,  0.0005],
        [-0.0019,  0.0005],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6830],
        [ 0.6174, -2.6257],
        [-0.7289,  1.4752],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2037, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0327, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3061, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0017,  0.0003],
        [-0.0018,  0.0003],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6828],
        [ 0.6176, -2.6259],
        [-0.7288,  1.4750],
        [-0.8539, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6458, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2111, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0018,  0.0004],
        [-0.0018,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6828],
        [ 0.6178, -2.6259],
        [-0.7288,  1.4751],
        [-0.8541, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1243, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3004, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0019,  0.0004],
        [-0.0017,  0.0004],
        [-0.0019,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6175, -2.6258],
        [-0.7287,  1.4751],
        [-0.8541, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7586, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2250, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6829],
        [ 0.6177, -2.6258],
        [-0.7287,  1.4752],
        [-0.8540, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8174, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0326, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2286, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0005],
        [-0.0017,  0.0004],
        [-0.0017,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6830],
        [ 0.6175, -2.6258],
        [-0.7288,  1.4752],
        [-0.8540, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9668, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2694, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0017,  0.0005],
        [-0.0017,  0.0004],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6828],
        [ 0.6177, -2.6257],
        [-0.7288,  1.4752],
        [-0.8538, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9010, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2556, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0015,  0.0004],
        [-0.0018,  0.0004],
        [-0.0016,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6830],
        [ 0.6178, -2.6258],
        [-0.7289,  1.4753],
        [-0.8539, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2213, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3243, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020,  0.0006],
        [-0.0019,  0.0004],
        [-0.0018,  0.0004],
        [-0.0020,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6832],
        [ 0.6175, -2.6258],
        [-0.7289,  1.4753],
        [-0.8543, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8955, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2564, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6831],
        [ 0.6175, -2.6257],
        [-0.7290,  1.4754],
        [-0.8542, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9060, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2603, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0013,  0.0001],
        [-0.0012,  0.0002],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6828],
        [ 0.6181, -2.6260],
        [-0.7283,  1.4751],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2760, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3357, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0018,  0.0003],
        [-0.0017,  0.0004],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6831],
        [ 0.6176, -2.6258],
        [-0.7289,  1.4753],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8469, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0330, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2354, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0002],
        [-0.0016,  0.0003],
        [-0.0014,  0.0002],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6828],
        [ 0.6178, -2.6259],
        [-0.7285,  1.4752],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.5784, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3985, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0004],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6178, -2.6259],
        [-0.7288,  1.4753],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0767, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2858, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0015,  0.0002],
        [-0.0014,  0.0002],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6830],
        [ 0.6179, -2.6259],
        [-0.7286,  1.4752],
        [-0.8541, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6502, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2051, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0014,  0.0003],
        [-0.0013,  0.0002],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6828],
        [ 0.6179, -2.6259],
        [-0.7285,  1.4752],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8489, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2529, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0019,  0.0005],
        [-0.0022,  0.0005],
        [-0.0019,  0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6830],
        [ 0.6175, -2.6257],
        [-0.7293,  1.4755],
        [-0.8543, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8055, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2367, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0015,  0.0003],
        [-0.0020,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6830],
        [ 0.6179, -2.6258],
        [-0.7291,  1.4755],
        [-0.8541, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9145, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2533, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0016,  0.0004],
        [-0.0017,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6829],
        [ 0.6178, -2.6258],
        [-0.7288,  1.4754],
        [-0.8542, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6508, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2046, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0015,  0.0003],
        [-0.0016,  0.0004],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6830],
        [ 0.6178, -2.6259],
        [-0.7287,  1.4754],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0021, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2828, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0018,  0.0004],
        [-0.0017,  0.0003],
        [-0.0017,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6176, -2.6258],
        [-0.7288,  1.4754],
        [-0.8541, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8122, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0421, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2466, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0023,  0.0005],
        [-0.0018,  0.0003],
        [-0.0022,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6171, -2.6256],
        [-0.7289,  1.4754],
        [-0.8546, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1149, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2985, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0017,  0.0003],
        [-0.0016,  0.0003],
        [-0.0015,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6829],
        [ 0.6177, -2.6259],
        [-0.7288,  1.4754],
        [-0.8538, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7928, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2392, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0013,  0.0001],
        [-0.0013,  0.0002],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6829],
        [ 0.6181, -2.6261],
        [-0.7284,  1.4753],
        [-0.8538, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9502, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2626, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0002],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6829],
        [ 0.6178, -2.6259],
        [-0.7289,  1.4753],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9237, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2605, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0015,  0.0003],
        [-0.0016,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6829],
        [ 0.6179, -2.6259],
        [-0.7287,  1.4753],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5150, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0426, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1881, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0002],
        [-0.0018,  0.0002],
        [-0.0017,  0.0002],
        [-0.0016,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6828],
        [ 0.6176, -2.6260],
        [-0.7288,  1.4753],
        [-0.8539, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8922, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0344, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2472, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0002],
        [-0.0018,  0.0002],
        [-0.0016,  0.0002],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6828],
        [ 0.6176, -2.6260],
        [-0.7287,  1.4753],
        [-0.8540, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.2563, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3370, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0020,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6830],
        [ 0.6174, -2.6259],
        [-0.7287,  1.4755],
        [-0.8541, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1854, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0318, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3008, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6829],
        [ 0.6178, -2.6259],
        [-0.7288,  1.4754],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8656, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2492, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0001],
        [-0.0019,  0.0002],
        [-0.0019,  0.0002],
        [-0.0017,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6828],
        [ 0.6176, -2.6260],
        [-0.7290,  1.4754],
        [-0.8540, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5643, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1846, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0002],
        [-0.0016,  0.0003],
        [-0.0019,  0.0003],
        [-0.0019,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6828],
        [ 0.6179, -2.6259],
        [-0.7290,  1.4754],
        [-0.8542, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7986, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2296, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0002],
        [-0.0019,  0.0001],
        [-0.0020,  0.0003],
        [-0.0018,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6829],
        [ 0.6176, -2.6261],
        [-0.7291,  1.4755],
        [-0.8541, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8665, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2426, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0019,  0.0003],
        [-0.0017,  0.0002],
        [-0.0020,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6830],
        [ 0.6176, -2.6258],
        [-0.7288,  1.4754],
        [-0.8543, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.5678, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1857, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020,  0.0003],
        [-0.0018,  0.0003],
        [-0.0016,  0.0002],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6830],
        [ 0.6177, -2.6259],
        [-0.7287,  1.4754],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8513, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2518, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0018,  0.0003],
        [-0.0019,  0.0003],
        [-0.0019,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6830],
        [ 0.6177, -2.6259],
        [-0.7290,  1.4755],
        [-0.8542, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.9290, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2551, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020,  0.0003],
        [-0.0020,  0.0002],
        [-0.0019,  0.0003],
        [-0.0018,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6829],
        [ 0.6175, -2.6259],
        [-0.7290,  1.4755],
        [-0.8541, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.0407, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2889, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0003],
        [-0.0020,  0.0004],
        [-0.0018,  0.0002],
        [-0.0019,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6829],
        [ 0.6175, -2.6257],
        [-0.7289,  1.4754],
        [-0.8542, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1101, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2941, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021,  0.0004],
        [-0.0020,  0.0004],
        [-0.0019,  0.0004],
        [-0.0020,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6830],
        [ 0.6175, -2.6258],
        [-0.7290,  1.4756],
        [-0.8542, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8804, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2486, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020,  0.0001],
        [-0.0018,  0.0001],
        [-0.0021,  0.0002],
        [-0.0021,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6177, -2.6260],
        [-0.7292,  1.4754],
        [-0.8543, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6090, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1955, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0017,  0.0002],
        [-0.0020,  0.0002],
        [-0.0017,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6178, -2.6259],
        [-0.7292,  1.4754],
        [-0.8540, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7517, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0311, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2125, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0001],
        [-0.0015,  0.0002],
        [-0.0014,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6827],
        [ 0.6180, -2.6260],
        [-0.7285,  1.4754],
        [-0.8537, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7149, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2239, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6182e-03,  1.8937e-04],
        [-1.4652e-03,  4.7075e-05],
        [-1.2796e-03, -7.6242e-06],
        [-1.6155e-03, -2.3743e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6828],
        [ 0.6180, -2.6261],
        [-0.7284,  1.4752],
        [-0.8539, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7433, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2271, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0001],
        [-0.0019,  0.0002],
        [-0.0018,  0.0002],
        [-0.0020,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6176, -2.6259],
        [-0.7290,  1.4755],
        [-0.8542, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.6637, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2122, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5689e-03,  1.7350e-05],
        [-1.7256e-03,  1.3337e-04],
        [-1.6516e-03,  5.8560e-05],
        [-1.8597e-03,  1.4641e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  43
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  43
gt_cnt:  35
gt_cnt:  38
gt_cnt:  41
gt_cnt:  35
gt_cnt:  43
gt_cnt:  38
gt_cnt:  39
gt_cnt:  34
gt_cnt:  41
gt_cnt:  35
gt_cnt:  38
gt_cnt:  40
gt_cnt:  43
gt_cnt:  37
gt_cnt:  39
gt_cnt:  42
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  36
gt_cnt:  41
gt_cnt:  41
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  36
gt_cnt:  42
gt_cnt:  36
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  36
gt_cnt:  38
gt_cnt:  42
gt_cnt:  43
gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  37
gt_cnt:  36
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  36
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  39
gt_cnt:  38
gt_cnt:  40
gt_cnt:  42
gt_cnt:  37
tensor([[ 2.3100,  0.6826],
        [ 0.6178, -2.6260],
        [-0.7288,  1.4753],
        [-0.8541, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.8653, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2468, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0001],
        [-0.0016,  0.0001],
        [-0.0018,  0.0001],
        [-0.0019,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6180, -2.6260],
        [-0.7289,  1.4754],
        [-0.8541, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.1787, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0328, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3013, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027,  0.0004],
        [-0.0022,  0.0003],
        [-0.0023,  0.0003],
        [-0.0022,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6829],
        [ 0.6173, -2.6259],
        [-0.7295,  1.4756],
        [-0.8545, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7074, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2164, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2666e-03,  8.6531e-05],
        [-2.1892e-03,  1.2014e-04],
        [-1.9885e-03,  8.5772e-05],
        [-1.7427e-03,  8.1112e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6826],
        [ 0.6174, -2.6260],
        [-0.7292,  1.4754],
        [-0.8540, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(0.7437, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2228, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
