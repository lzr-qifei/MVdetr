logs/multiviewx/aug_deform_trans_w_dec_lr0.0005_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-02_16-07-53
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 10, 'lr': 0.0005, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX'}
rpts:  torch.Size([60000, 6, 4, 2])
Training...
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(8.6632e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(212.1009, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0001, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(200.2415, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(5.9358e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(212.6169, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(3.9581e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(209.8036, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0003, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(212.3691, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(5.1035e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(210.8990, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(9.3505e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(206.3712, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(8.7359e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(205.0878, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0001, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(202.8191, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(5.8168e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(211.7441, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0002, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(206.0272, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(6.5816e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(207.3285, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(9.6164e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(214.2802, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0002, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(209.6426, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0002, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(211.5968, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0002, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(208.4089, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0001, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(209.7735, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0001, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(213.6156, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(8.6468e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(211.4631, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(9.8096e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(210.7650, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(3.5649e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(209.7431, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(8.2744e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(206.8576, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0002, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(205.6136, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0003, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(202.8547, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(6.5578e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(219.8941, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0001, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(209.7691, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0002, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(205.4017, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0001, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(197.2987, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(7.7269e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(211.5656, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(8.3728e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(208.2691, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(3.7376e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(203.7691, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0001, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(205.0015, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(8.7228e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(207.3788, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0001, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(207.7899, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(4.0628e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(211.4162, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(5.3279e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(203.9928, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0003, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(217.2797, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(9.9773e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(210.9382, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0001, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(201.4051, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(7.1858e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(209.6963, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0001, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(212.5656, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(3.6045e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(213.0358, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(6.0895e-05, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(210.8129, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 100, 128])
before repeat:  torch.Size([1, 100, 2])
ref pts dec:  torch.Size([1, 100, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
torch.Size([1, 1, 8, 100, 4, 2])
input_flatten:  torch.Size([1, 10000, 128])
o:  torch.Size([1, 100, 8, 1, 4, 2])
cost torch.Size([1, 100, 100])
sizes:  100
outlabel_shape:  torch.Size([100, 1])
tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], dtype=torch.float64)
idx:  (tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0]), tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
        36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
        54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
        90, 91, 92, 93, 94, 95, 96, 97, 98, 99]))
tgt_pts_shape:  torch.Size([100, 2])
cuda:0 cpu cpu cuda:0
cuda:0 cuda:0 cuda:0 cuda:0
{'loss_ce': tensor(0.0002, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(207.2661, device='cuda:0', grad_fn=<DivBackward0>)}
rpts:  torch.Size([1, 60000, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
input_flatten:  torch.Size([1, 60000, 128])
o:  torch.Size([1, 60000, 8, 6, 4, 2])
enc src shape:  torch.Size([1, 60000, 128])
torch.Size([1, 60000, 6, 4, 2])
