logs/multiviewx/aug_deform_trans_w_dec_lr0.0001_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-05_12-38-04
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 100, 'lr': 0.0001, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX'}
rpts:  torch.Size([60000, 6, 4, 2])
pos_emb size:  [ 80 125]
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6729],
        [ 0.6167, -2.6265],
        [-0.7281,  1.4702],
        [-0.8537, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.8348, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2469, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.8608, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.3458e-05, -4.2123e-06],
        [-5.0049e-05, -1.1863e-05],
        [-4.8890e-05, -7.8860e-06],
        [-5.7003e-05, -8.6889e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6729],
        [ 0.6167, -2.6265],
        [-0.7280,  1.4703],
        [-0.8537, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(8.3492, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(2.1493, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.3831e-05, -3.6242e-05],
        [-4.9374e-05, -4.5983e-05],
        [-4.8914e-05, -3.6354e-05],
        [-5.4877e-05, -4.7575e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6728],
        [ 0.6168, -2.6265],
        [-0.7279,  1.4702],
        [-0.8537, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.9352, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(2.0617, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.8449e-05, -7.0880e-05],
        [-4.6560e-05, -8.1989e-05],
        [-4.6819e-05, -7.9470e-05],
        [-4.0467e-05, -8.3687e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6728],
        [ 0.6167, -2.6265],
        [-0.7278,  1.4701],
        [-0.8536, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.1582, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2569, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.9454, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.0431e-05, -6.5532e-05],
        [-4.9371e-05, -8.2908e-05],
        [-3.8579e-05, -7.4337e-05],
        [-5.6303e-05, -7.9660e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6728],
        [ 0.6167, -2.6265],
        [-0.7278,  1.4701],
        [-0.8536, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.2879, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.9434, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.9063e-05, -1.1865e-04],
        [-8.2381e-05, -1.3453e-04],
        [-7.2829e-05, -1.2283e-04],
        [-7.9508e-05, -1.3575e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6167, -2.6266],
        [-0.7278,  1.4700],
        [-0.8536, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.4333, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2470, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.9806, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.4408e-05, -1.4323e-04],
        [-6.0021e-05, -1.6226e-04],
        [-5.1657e-05, -1.2599e-04],
        [-4.5200e-05, -1.3789e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6168, -2.6266],
        [-0.7278,  1.4701],
        [-0.8535, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.8862, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.8499, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2945e-05, -1.7650e-04],
        [-5.3772e-05, -1.6399e-04],
        [-4.0681e-05, -1.8130e-04],
        [-5.5095e-05, -1.6192e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6727],
        [ 0.6168, -2.6266],
        [-0.7278,  1.4700],
        [-0.8535, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.3685, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2425, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.7587, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4147e-05, -1.5168e-04],
        [-2.4934e-05, -1.6424e-04],
        [-1.9671e-05, -1.5880e-04],
        [-2.3649e-05, -1.6024e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4701],
        [-0.8534, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.2189, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.7274, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9609e-05, -1.6309e-04],
        [-8.7097e-06, -1.4409e-04],
        [-9.8954e-06, -1.6040e-04],
        [-2.6606e-05, -1.5936e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4701],
        [-0.8534, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.1784, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2566, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.9488, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1506e-05, -1.7982e-04],
        [-9.2193e-06, -1.9380e-04],
        [-2.3527e-05, -2.1627e-04],
        [-2.5946e-05, -1.9460e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6726],
        [ 0.6169, -2.6267],
        [-0.7278,  1.4701],
        [-0.8534, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.9411, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6698, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.0140e-05, -2.1078e-04],
        [-3.0482e-05, -2.1209e-04],
        [-2.5752e-05, -2.4440e-04],
        [-4.1568e-05, -2.2431e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6725],
        [ 0.6169, -2.6267],
        [-0.7278,  1.4701],
        [-0.8534, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.6901, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.8159, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 2.4603e-05, -2.1149e-04],
        [ 1.3128e-05, -2.0294e-04],
        [ 3.0468e-05, -2.0183e-04],
        [ 1.3428e-05, -2.0426e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6725],
        [ 0.6170, -2.6267],
        [-0.7277,  1.4701],
        [-0.8533, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.5551, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2494, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(2.0099, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.9664e-05, -2.6455e-04],
        [ 2.2293e-05, -2.4388e-04],
        [ 1.2775e-05, -2.5469e-04],
        [ 7.9973e-07, -2.6437e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6724],
        [ 0.6170, -2.6267],
        [-0.7278,  1.4701],
        [-0.8534, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(9.4243, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2487, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(2.3823, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 3.9742e-05, -2.9239e-04],
        [ 6.3873e-05, -2.9452e-04],
        [ 5.2316e-05, -3.2152e-04],
        [ 4.3485e-05, -3.1859e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6724],
        [ 0.6171, -2.6268],
        [-0.7277,  1.4700],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.8978, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2417, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(2.0629, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 3.1632e-05, -2.7593e-04],
        [ 2.1234e-05, -2.9325e-04],
        [ 4.0425e-05, -2.9634e-04],
        [ 3.4081e-05, -2.7526e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6724],
        [ 0.6170, -2.6268],
        [-0.7278,  1.4701],
        [-0.8534, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.9863, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2475, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6923, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.4284e-05, -3.2788e-04],
        [ 7.2895e-05, -3.6035e-04],
        [ 4.4741e-05, -3.0033e-04],
        [ 8.8095e-05, -3.3764e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6724],
        [ 0.6171, -2.6269],
        [-0.7278,  1.4701],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.5568, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.9780, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.8939e-05, -2.7959e-04],
        [ 4.3215e-05, -3.2926e-04],
        [ 4.2641e-05, -3.1274e-04],
        [ 8.4511e-05, -2.9674e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6724],
        [ 0.6170, -2.6269],
        [-0.7278,  1.4701],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.4491, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2589, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(2.0076, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.7282e-05, -3.0531e-04],
        [ 3.2649e-05, -2.7844e-04],
        [ 7.4972e-05, -2.7786e-04],
        [ 5.9534e-05, -2.9330e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6724],
        [ 0.6170, -2.6268],
        [-0.7278,  1.4702],
        [-0.8535, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.0787, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2332, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.8822, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0050e-04, -2.9968e-04],
        [ 1.2022e-04, -3.6385e-04],
        [ 1.1139e-04, -3.1067e-04],
        [ 8.8526e-05, -3.1156e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6724],
        [ 0.6171, -2.6269],
        [-0.7277,  1.4701],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1544, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2425, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.7159, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0003],
        [ 0.0001, -0.0003],
        [ 0.0001, -0.0003],
        [ 0.0001, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6725],
        [ 0.6171, -2.6268],
        [-0.7277,  1.4702],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1131, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.7062, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.7767e-05, -3.2148e-04],
        [ 1.1646e-04, -3.1576e-04],
        [ 6.4169e-05, -3.2989e-04],
        [ 8.0326e-05, -3.1122e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6724],
        [ 0.6172, -2.6269],
        [-0.7278,  1.4702],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1123, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2309, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6842, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.3148e-04, -3.4668e-04],
        [ 8.9981e-05, -3.3269e-04],
        [ 1.3769e-04, -4.0794e-04],
        [ 1.3618e-04, -3.5251e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6724],
        [ 0.6172, -2.6269],
        [-0.7278,  1.4701],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.9308, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2326, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.8513, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0577e-04, -2.7776e-04],
        [ 1.4346e-04, -3.3324e-04],
        [ 1.1913e-04, -2.7746e-04],
        [ 8.1192e-05, -2.7590e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6725],
        [ 0.6173, -2.6269],
        [-0.7278,  1.4703],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.6749, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.8054, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0003],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0003],
        [ 0.0001, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6725],
        [ 0.6173, -2.6268],
        [-0.7278,  1.4702],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2611, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2456, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5434, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0003],
        [ 0.0001, -0.0003],
        [ 0.0001, -0.0003],
        [ 0.0001, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6725],
        [ 0.6173, -2.6269],
        [-0.7278,  1.4703],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7438, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6161, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0002, -0.0003],
        [ 0.0001, -0.0003],
        [ 0.0002, -0.0003],
        [ 0.0002, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6725],
        [ 0.6174, -2.6268],
        [-0.7278,  1.4703],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.2742, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2242, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.7032, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0003],
        [ 0.0001, -0.0003],
        [ 0.0002, -0.0003],
        [ 0.0001, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6726],
        [ 0.6174, -2.6268],
        [-0.7278,  1.4703],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.5981, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2461, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.8117, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0002, -0.0003],
        [ 0.0002, -0.0004],
        [ 0.0002, -0.0004],
        [ 0.0002, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6726],
        [ 0.6176, -2.6269],
        [-0.7277,  1.4703],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4779, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5697, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0002, -0.0004],
        [ 0.0002, -0.0004],
        [ 0.0002, -0.0004],
        [ 0.0002, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6726],
        [ 0.6176, -2.6269],
        [-0.7277,  1.4703],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0042, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2496, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5000, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0002, -0.0004],
        [ 0.0002, -0.0004],
        [ 0.0002, -0.0004],
        [ 0.0002, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6725],
        [ 0.6176, -2.6269],
        [-0.7277,  1.4703],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7630, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2289, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6105, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0003, -0.0005],
        [ 0.0003, -0.0004],
        [ 0.0003, -0.0004],
        [ 0.0003, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6725],
        [ 0.6177, -2.6269],
        [-0.7276,  1.4702],
        [-0.8533, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4142, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2525, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5878, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0003, -0.0004],
        [ 0.0003, -0.0004],
        [ 0.0002, -0.0004],
        [ 0.0003, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6726],
        [ 0.6178, -2.6269],
        [-0.7277,  1.4703],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.4008, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2518, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.7838, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0003, -0.0004],
        [ 0.0003, -0.0005],
        [ 0.0003, -0.0005],
        [ 0.0003, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6726],
        [ 0.6179, -2.6270],
        [-0.7276,  1.4702],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7107, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2426, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6273, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0002, -0.0003],
        [ 0.0002, -0.0003],
        [ 0.0002, -0.0003],
        [ 0.0002, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6727],
        [ 0.6178, -2.6269],
        [-0.7277,  1.4704],
        [-0.8534, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0582, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2496, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5109, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0003, -0.0004],
        [ 0.0003, -0.0004],
        [ 0.0003, -0.0004],
        [ 0.0003, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6725],
        [ 0.6179, -2.6270],
        [-0.7275,  1.4703],
        [-0.8534, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.0627, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2307, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6738, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0002, -0.0003],
        [ 0.0002, -0.0003],
        [ 0.0003, -0.0004],
        [ 0.0003, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6727],
        [ 0.6179, -2.6269],
        [-0.7276,  1.4703],
        [-0.8534, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1615, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2322, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4968, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0003, -0.0005],
        [ 0.0003, -0.0005],
        [ 0.0003, -0.0005],
        [ 0.0003, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6725],
        [ 0.6180, -2.6271],
        [-0.7275,  1.4702],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7529, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2599, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6703, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0004, -0.0004],
        [ 0.0004, -0.0005],
        [ 0.0004, -0.0004],
        [ 0.0004, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6726],
        [ 0.6181, -2.6271],
        [-0.7274,  1.4703],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1647, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2602, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.7533, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0003, -0.0004],
        [ 0.0003, -0.0005],
        [ 0.0003, -0.0004],
        [ 0.0003, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6726],
        [ 0.6180, -2.6271],
        [-0.7275,  1.4703],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7848, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2231, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4031, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0003, -0.0005],
        [ 0.0003, -0.0005],
        [ 0.0004, -0.0005],
        [ 0.0004, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6725],
        [ 0.6181, -2.6271],
        [-0.7274,  1.4702],
        [-0.8533, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4987, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5773, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0004, -0.0006],
        [ 0.0004, -0.0006],
        [ 0.0004, -0.0006],
        [ 0.0003, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6725],
        [ 0.6182, -2.6272],
        [-0.7274,  1.4702],
        [-0.8533, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5283, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5838, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0004, -0.0005],
        [ 0.0004, -0.0005],
        [ 0.0004, -0.0005],
        [ 0.0004, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6726],
        [ 0.6181, -2.6271],
        [-0.7274,  1.4703],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2568, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3194, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0005, -0.0005],
        [ 0.0005, -0.0005],
        [ 0.0005, -0.0005],
        [ 0.0005, -0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6726],
        [ 0.6183, -2.6272],
        [-0.7273,  1.4702],
        [-0.8531, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2863, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2518, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5610, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0004, -0.0005],
        [ 0.0003, -0.0004],
        [ 0.0003, -0.0004],
        [ 0.0003, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6726],
        [ 0.6181, -2.6271],
        [-0.7275,  1.4703],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1530, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2283, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2871, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0004, -0.0004],
        [ 0.0004, -0.0005],
        [ 0.0004, -0.0005],
        [ 0.0004, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6727],
        [ 0.6182, -2.6272],
        [-0.7274,  1.4703],
        [-0.8531, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2710, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2583, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5708, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0005, -0.0005],
        [ 0.0004, -0.0005],
        [ 0.0004, -0.0005],
        [ 0.0005, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6727],
        [ 0.6183, -2.6272],
        [-0.7273,  1.4702],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.6153, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2435, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6101, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0005, -0.0006],
        [ 0.0005, -0.0006],
        [ 0.0005, -0.0006],
        [ 0.0005, -0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6726],
        [ 0.6183, -2.6274],
        [-0.7273,  1.4701],
        [-0.8530, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3946, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2482, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3754, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0005, -0.0006],
        [ 0.0004, -0.0005],
        [ 0.0004, -0.0006],
        [ 0.0004, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6727],
        [ 0.6183, -2.6272],
        [-0.7273,  1.4702],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3095, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2425, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5470, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0005, -0.0005],
        [ 0.0005, -0.0006],
        [ 0.0004, -0.0005],
        [ 0.0005, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6728],
        [ 0.6184, -2.6273],
        [-0.7273,  1.4702],
        [-0.8529, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4346, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5645, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0007, -0.0007],
        [ 0.0006, -0.0006],
        [ 0.0005, -0.0006],
        [ 0.0005, -0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6726],
        [ 0.6185, -2.6274],
        [-0.7272,  1.4702],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7844, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2482, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4533, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0005, -0.0006],
        [ 0.0005, -0.0005],
        [ 0.0005, -0.0005],
        [ 0.0006, -0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6727],
        [ 0.6184, -2.6273],
        [-0.7272,  1.4703],
        [-0.8527, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2717, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5342, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0005, -0.0005],
        [ 0.0005, -0.0006],
        [ 0.0006, -0.0006],
        [ 0.0005, -0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6728],
        [ 0.6185, -2.6274],
        [-0.7271,  1.4702],
        [-0.8527, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0883, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2477, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5131, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0006, -0.0006],
        [ 0.0006, -0.0006],
        [ 0.0006, -0.0006],
        [ 0.0006, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6727],
        [ 0.6186, -2.6274],
        [-0.7271,  1.4702],
        [-0.8527, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2485, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3257, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0005, -0.0005],
        [ 0.0006, -0.0006],
        [ 0.0005, -0.0005],
        [ 0.0005, -0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6728],
        [ 0.6185, -2.6274],
        [-0.7271,  1.4703],
        [-0.8526, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4080, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2473, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5763, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0006, -0.0006],
        [ 0.0006, -0.0006],
        [ 0.0007, -0.0008],
        [ 0.0006, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6727],
        [ 0.6185, -2.6274],
        [-0.7269,  1.4700],
        [-0.8526, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4154, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2312, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3454, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0006, -0.0006],
        [ 0.0007, -0.0007],
        [ 0.0006, -0.0007],
        [ 0.0006, -0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6727],
        [ 0.6186, -2.6275],
        [-0.7270,  1.4701],
        [-0.8525, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.0550, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6867, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0007, -0.0007],
        [ 0.0007, -0.0007],
        [ 0.0007, -0.0007],
        [ 0.0007, -0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6727],
        [ 0.6187, -2.6275],
        [-0.7269,  1.4701],
        [-0.8524, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7732, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2531, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6608, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0007, -0.0007],
        [ 0.0007, -0.0006],
        [ 0.0006, -0.0006],
        [ 0.0007, -0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6728],
        [ 0.6187, -2.6274],
        [-0.7270,  1.4702],
        [-0.8524, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.9980, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4761, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0006, -0.0007],
        [ 0.0006, -0.0007],
        [ 0.0006, -0.0007],
        [ 0.0006, -0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6728],
        [ 0.6186, -2.6275],
        [-0.7269,  1.4701],
        [-0.8525, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4046, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2565, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5939, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0007, -0.0007],
        [ 0.0007, -0.0007],
        [ 0.0007, -0.0007],
        [ 0.0007, -0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6729],
        [ 0.6187, -2.6275],
        [-0.7268,  1.4701],
        [-0.8523, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2237, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2306, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3060, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0007, -0.0007],
        [ 0.0007, -0.0007],
        [ 0.0007, -0.0007],
        [ 0.0007, -0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6729],
        [ 0.6187, -2.6275],
        [-0.7268,  1.4702],
        [-0.8524, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1478, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5029, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0006, -0.0005],
        [ 0.0005, -0.0005],
        [ 0.0005, -0.0005],
        [ 0.0006, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6730],
        [ 0.6186, -2.6273],
        [-0.7269,  1.4704],
        [-0.8525, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9987, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2645, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3288, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0006, -0.0006],
        [ 0.0006, -0.0006],
        [ 0.0006, -0.0006],
        [ 0.0006, -0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6730],
        [ 0.6187, -2.6275],
        [-0.7268,  1.4702],
        [-0.8524, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2314, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2249, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2961, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0007, -0.0007],
        [ 0.0007, -0.0007],
        [ 0.0007, -0.0007],
        [ 0.0007, -0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6730],
        [ 0.6188, -2.6275],
        [-0.7267,  1.4702],
        [-0.8523, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3968, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3530, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0007, -0.0006],
        [ 0.0007, -0.0007],
        [ 0.0007, -0.0006],
        [ 0.0007, -0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6731],
        [ 0.6188, -2.6275],
        [-0.7267,  1.4703],
        [-0.8524, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
gt_cnt:  39
gt_cnt:  40
gt_cnt:  35
gt_cnt:  42
gt_cnt:  38
gt_cnt:  37
gt_cnt:  40
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  42
gt_cnt:  41
gt_cnt:  40
gt_cnt:  41
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  35
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  41
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  42
gt_cnt:  40
gt_cnt:  35
gt_cnt:  41
gt_cnt:  42
gt_cnt:  42
gt_cnt:  38
gt_cnt:  35
gt_cnt:  38
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  36
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  42
gt_cnt:  39
gt_cnt:  41
{'loss_ce': tensor(4.4875, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2260, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3495, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0008, -0.0007],
        [ 0.0007, -0.0006],
        [ 0.0008, -0.0007],
        [ 0.0007, -0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6187, -2.6275],
        [-0.7266,  1.4703],
        [-0.8523, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3290, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2513, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5684, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0008, -0.0007],
        [ 0.0008, -0.0007],
        [ 0.0007, -0.0006],
        [ 0.0007, -0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6731],
        [ 0.6188, -2.6275],
        [-0.7267,  1.4704],
        [-0.8523, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.9959, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2256, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4504, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0008, -0.0007],
        [ 0.0008, -0.0007],
        [ 0.0009, -0.0008],
        [ 0.0009, -0.0009]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6731],
        [ 0.6187, -2.6276],
        [-0.7264,  1.4702],
        [-0.8521, -2.7502]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9908, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2700, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0007, -0.0006],
        [ 0.0008, -0.0006],
        [ 0.0008, -0.0006],
        [ 0.0007, -0.0006]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6733],
        [ 0.6187, -2.6275],
        [-0.7265,  1.4704],
        [-0.8523, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3503, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2282, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3265, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0010, -0.0008],
        [ 0.0010, -0.0008],
        [ 0.0011, -0.0009],
        [ 0.0009, -0.0008]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6731],
        [ 0.6189, -2.6277],
        [-0.7262,  1.4702],
        [-0.8522, -2.7502]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5679, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3820, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0009, -0.0008],
        [ 0.0009, -0.0007],
        [ 0.0008, -0.0007],
        [ 0.0008, -0.0007]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6732],
        [ 0.6188, -2.6276],
        [-0.7265,  1.4704],
        [-0.8522, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3538, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2221, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5149, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
