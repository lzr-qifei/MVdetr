logs/multiviewx/aug_deform_trans_w_dec_lr0.0005_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-04_15-15-35
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 10, 'lr': 0.0005, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX'}
rpts:  torch.Size([60000, 6, 4, 2])
pos_emb size:  [ 80 125]
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 1])
pos_c_cls:  torch.Size([200, 1])
tgt_ids:  tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
cost_class shape:  torch.Size([200, 1])
cost_pts shape:  torch.Size([200, 41])
cost torch.Size([200, 41])
indices:  [(array([  6,   9,  18,  42,  44,  48,  49,  51,  55,  56,  61,  62,  68,
        73,  76,  80,  88,  93, 103, 104, 106, 107, 111, 117, 118, 123,
       126, 139, 143, 153, 154, 155, 157, 162, 165, 172, 174, 187, 191,
       196, 199]), array([30, 14, 38,  1,  5,  3,  2, 29, 37, 11, 36, 15, 33,  9, 35, 20, 17,
       26, 19, 27, 28,  6, 24,  0, 39, 18, 34, 16,  8, 13, 12, 10, 40,  4,
       31, 25, 22, 32, 23, 21,  7]))]
outlabel_shape:  torch.Size([200, 1])
src_logit shape:  torch.Size([200, 1])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([41, 2])
{'loss_ce': tensor(4.7907, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0007, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 1])
pos_c_cls:  torch.Size([200, 1])
tgt_ids:  tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
cost_class shape:  torch.Size([200, 1])
cost_pts shape:  torch.Size([200, 39])
cost torch.Size([200, 39])
indices:  [(array([  2,   8,  14,  15,  26,  32,  35,  42,  48,  50,  57,  62,  70,
        80,  81,  83,  87,  88,  89,  97, 101, 114, 116, 120, 122, 123,
       129, 130, 131, 138, 139, 150, 154, 173, 176, 177, 178, 180, 193]), array([30,  4,  2, 13, 28, 10,  3, 31, 26,  1, 15,  8, 32, 19, 37, 27,  5,
       29, 38, 34, 35, 21, 23,  0, 25,  6, 36, 20, 14, 17, 16,  9, 12, 11,
       24, 22, 18,  7, 33]))]
outlabel_shape:  torch.Size([200, 1])
src_logit shape:  torch.Size([200, 1])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([39, 2])
{'loss_ce': tensor(4.9409, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0007, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 1])
pos_c_cls:  torch.Size([200, 1])
tgt_ids:  tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
cost_class shape:  torch.Size([200, 1])
cost_pts shape:  torch.Size([200, 37])
cost torch.Size([200, 37])
indices:  [(array([  7,  17,  20,  23,  30,  36,  44,  47,  49,  50,  55,  57,  66,
        72,  77,  80,  96,  97, 101, 104, 106, 108, 109, 116, 120, 125,
       126, 133, 144, 146, 151, 154, 178, 186, 189, 198, 199]), array([ 4, 33, 11, 32, 17, 21, 22, 14,  3,  1, 36,  2, 35,  7, 16, 30, 19,
       15, 31, 23, 24, 28,  9, 27, 18,  0, 26, 12, 34, 13, 25,  8,  5, 10,
       29, 20,  6]))]
outlabel_shape:  torch.Size([200, 1])
src_logit shape:  torch.Size([200, 1])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([37, 2])
{'loss_ce': tensor(5.3959, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0008, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 1])
pos_c_cls:  torch.Size([200, 1])
tgt_ids:  tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
cost_class shape:  torch.Size([200, 1])
cost_pts shape:  torch.Size([200, 38])
cost torch.Size([200, 38])
indices:  [(array([  2,   8,  10,  13,  14,  18,  45,  48,  64,  69,  81,  83,  86,
        87,  96, 103, 106, 107, 115, 122, 123, 125, 126, 130, 135, 142,
       144, 150, 164, 165, 167, 171, 182, 183, 186, 187, 191, 198]), array([28,  3,  7, 25, 23, 29, 34, 13, 17, 36, 35, 24, 10,  6,  4, 15, 22,
       37, 27, 16,  5, 20, 26,  2, 11, 33,  1,  8, 31, 12, 19, 32,  0, 14,
        9, 30, 21, 18]))]
outlabel_shape:  torch.Size([200, 1])
src_logit shape:  torch.Size([200, 1])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([38, 2])
{'loss_ce': tensor(5.4071, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0007, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 1])
pos_c_cls:  torch.Size([200, 1])
tgt_ids:  tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
cost_class shape:  torch.Size([200, 1])
cost_pts shape:  torch.Size([200, 39])
cost torch.Size([200, 39])
indices:  [(array([  8,  10,  13,  17,  32,  36,  41,  48,  51,  53,  56,  72,  79,
        80,  83,  86,  87,  90,  91,  99, 102, 103, 105, 106, 108, 110,
       113, 121, 123, 126, 143, 149, 165, 170, 173, 176, 177, 179, 193]), array([30, 17, 29, 36, 11, 38, 32, 18, 15, 27,  4,  6, 14, 22, 26,  9,  7,
       16, 33, 12,  1, 25, 19, 28,  3, 10, 23, 31,  2, 37,  8, 35, 34, 21,
        5, 13, 20, 24,  0]))]
outlabel_shape:  torch.Size([200, 1])
src_logit shape:  torch.Size([200, 1])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([39, 2])
{'loss_ce': tensor(4.9018, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0007, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 1])
pos_c_cls:  torch.Size([200, 1])
tgt_ids:  tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
cost_class shape:  torch.Size([200, 1])
cost_pts shape:  torch.Size([200, 39])
cost torch.Size([200, 39])
indices:  [(array([  7,   8,  10,  18,  23,  26,  28,  32,  47,  48,  50,  56,  58,
        75,  94, 101, 103, 104, 106, 107, 111, 113, 117, 122, 129, 138,
       147, 148, 151, 154, 164, 167, 169, 173, 174, 175, 183, 193, 196]), array([34, 12, 35,  4,  5, 29,  8,  9, 13, 26, 28,  2, 23, 37, 20, 33, 25,
       16, 18, 38, 17,  1,  0, 24, 36, 30, 11,  6,  3, 15, 32, 22, 31,  7,
       19, 10, 14, 27, 21]))]
outlabel_shape:  torch.Size([200, 1])
src_logit shape:  torch.Size([200, 1])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([39, 2])
{'loss_ce': tensor(4.5761, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0008, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 1])
pos_c_cls:  torch.Size([200, 1])
tgt_ids:  tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
cost_class shape:  torch.Size([200, 1])
cost_pts shape:  torch.Size([200, 41])
cost torch.Size([200, 41])
indices:  [(array([ 17,  29,  44,  47,  56,  62,  70,  77,  79,  81,  82,  83,  90,
        94, 111, 117, 118, 122, 123, 126, 127, 133, 134, 138, 139, 141,
       143, 151, 152, 154, 157, 160, 161, 165, 172, 176, 178, 179, 187,
       193, 199]), array([34, 16, 23,  2, 11, 18, 17, 26, 10, 38,  1, 27, 20,  9, 21, 15, 35,
       19,  7, 30, 36, 14, 12, 33, 24,  8,  5, 29,  6, 40, 39, 37,  3, 32,
       22, 25, 28, 13, 31,  0,  4]))]
outlabel_shape:  torch.Size([200, 1])
src_logit shape:  torch.Size([200, 1])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([41, 2])
{'loss_ce': tensor(4.4106, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0007, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 1])
pos_c_cls:  gt_cnt:  41
gt_cnt:  39
gt_cnt:  38
gt_cnt:  35
gt_cnt:  39
gt_cnt:  39
torch.Size([200, 1])
tgt_ids:  tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
cost_class shape:  torch.Size([200, 1])
cost_pts shape:  torch.Size([200, 35])
cost torch.Size([200, 35])
indices:  [(array([  8,  18,  47,  50,  52,  53,  57,  59,  61,  62,  66,  72,  83,
        87,  88,  94,  96,  99, 103, 105, 109, 111, 123, 125, 126, 139,
       143, 151, 161, 165, 167, 173, 178, 191, 196]), array([ 4, 33, 28, 11, 20, 23,  3, 30, 31,  0, 10,  5, 12,  7, 27, 21, 18,
        6, 22, 16,  8, 15, 14, 25, 29, 17, 32, 13,  2, 26,  1,  9, 24, 34,
       19]))]
outlabel_shape:  torch.Size([200, 1])
src_logit shape:  torch.Size([200, 1])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([35, 2])
{'loss_ce': tensor(6.2202, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0007, device='cuda:0', grad_fn=<DivBackward0>)}
