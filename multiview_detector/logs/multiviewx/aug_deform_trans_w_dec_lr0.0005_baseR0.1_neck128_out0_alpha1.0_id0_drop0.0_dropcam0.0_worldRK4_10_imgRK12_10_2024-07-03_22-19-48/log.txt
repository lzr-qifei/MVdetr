logs/multiviewx/aug_deform_trans_w_dec_lr0.0005_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-03_22-19-48
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 10, 'lr': 0.0005, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX'}
rpts:  torch.Size([60000, 6, 4, 2])
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 40])
cost_pts shape:  torch.Size([200, 40])
cost torch.Size([200, 40])
sizes:  40
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([40, 2])
{'loss_ce': tensor(5.8282, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0006, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 40])
cost_pts shape:  torch.Size([200, 40])
cost torch.Size([200, 40])
sizes:  40
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([40, 2])
{'loss_ce': tensor(5.7292, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0007, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 41])
cost_pts shape:  torch.Size([200, 41])
cost torch.Size([200, 41])
sizes:  41
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([41, 2])
{'loss_ce': tensor(5.7780, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0007, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 38])
cost_pts shape:  torch.Size([200, 38])
cost torch.Size([200, 38])
sizes:  38
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([38, 2])
{'loss_ce': tensor(6.0636, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0006, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 41])
cost_pts shape:  torch.Size([200, 41])
cost torch.Size([200, 41])
sizes:  41
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([41, 2])
{'loss_ce': tensor(5.3523, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0008, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 40])
cost_pts shape:  torch.Size([200, 40])
cost torch.Size([200, 40])
sizes:  40
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([40, 2])
{'loss_ce': tensor(5.4655, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0007, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 35])
cost_pts shape:  torch.Size([200, 35])
cost torch.Size([200, 35])
sizes:  35
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([35, 2])
{'loss_ce': tensor(6.1102, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0009, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 40])
cost_pts shape:  torch.Size([200, 40])
cost torch.Size([200, 40])
sizes:  40
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([40, 2])
{'loss_ce': tensor(5.7464, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0008, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 42])
cost_pts shape:  torch.Size([200, 42])
cost torch.Size([200, 42])
sizes:  42
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([42, 2])
{'loss_ce': tensor(5.6531, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0007, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 42])
cost_pts shape:  torch.Size([200, 42])
cost torch.Size([200, 42])
sizes:  42
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([42, 2])
{'loss_ce': tensor(5.7057, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0007, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 40])
cost_pts shape:  torch.Size([200, 40])
cost torch.Size([200, 40])
sizes:  40
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([40, 2])
{'loss_ce': tensor(5.3066, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0008, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 37])
cost_pts shape:  torch.Size([200, 37])
cost torch.Size([200, 37])
sizes:  37
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([37, 2])
{'loss_ce': tensor(6.5899, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0008, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 40])
cost_pts shape:  torch.Size([200, 40])
cost torch.Size([200, 40])
sizes:  40
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([40, 2])
{'loss_ce': tensor(5.7278, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0007, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 39])
cost_pts shape:  torch.Size([200, 39])
cost torch.Size([200, 39])
sizes:  39
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([39, 2])
{'loss_ce': tensor(5.8860, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0007, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 36])
cost_pts shape:  torch.Size([200, 36])
cost torch.Size([200, 36])
sizes:  36
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([36, 2])
{'loss_ce': tensor(6.3484, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0009, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 37])
cost_pts shape:  torch.Size([200, 37])
cost torch.Size([200, 37])
sizes:  37
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([37, 2])
{'loss_ce': tensor(6.0131, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0008, device='cuda:0', grad_fn=<DivBackward0>)}
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 200, 128])
ref pts dec:  torch.Size([1, 200, 2])
out_prob shape:  torch.Size([200, 2])
pos_c_cls:  torch.Size([200, 2])
cost_class shape:  torch.Size([200, 41])
cost_pts shape:  torch.Size([200, 41])
cost torch.Size([200, 41])
sizes:  41
outlabel_shape:  torch.Size([200, 2])
src_logit shape:  torch.Size([200, 2])
tgt_cls shape:  torch.Size([200])
tgt_pts_shape:  torch.Size([41, 2])
{'loss_ce': tensor(5.5048, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0007, device='cuda:0', grad_fn=<DivBackward0>)}
