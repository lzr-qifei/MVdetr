logs/multiviewx/aug_deform_trans_w_dec_lr0.0001_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-05_12-48-02
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 100, 'lr': 0.0001, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX'}
rpts:  torch.Size([60000, 6, 4, 2])
pos_emb size:  [ 80 125]
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6729],
        [ 0.6167, -2.6265],
        [-0.7281,  1.4702],
        [-0.8537, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.8407, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4412, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.4039e-05, -6.1168e-05],
        [-6.0328e-05, -6.1745e-05],
        [-5.9067e-05, -5.9251e-05],
        [-6.6518e-05, -6.6349e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6728],
        [ 0.6167, -2.6265],
        [-0.7280,  1.4702],
        [-0.8538, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(8.3756, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.7543, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.1979e-05, -1.0213e-04],
        [-3.8520e-05, -1.2726e-04],
        [-3.9337e-05, -1.1376e-04],
        [-3.8948e-05, -1.2573e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6728],
        [ 0.6168, -2.6265],
        [-0.7279,  1.4701],
        [-0.8537, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.9347, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6680, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.8143e-06, -1.6753e-04],
        [-1.5798e-05, -1.5558e-04],
        [-1.0777e-05, -1.4998e-04],
        [-1.2007e-05, -1.6540e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6168, -2.6265],
        [-0.7278,  1.4700],
        [-0.8536, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.1447, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5028, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 9.4116e-06, -1.4677e-04],
        [ 1.5523e-05, -1.6635e-04],
        [ 2.1761e-05, -1.6001e-04],
        [ 1.5166e-05, -1.6490e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6168, -2.6266],
        [-0.7278,  1.4700],
        [-0.8535, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.2939, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5343, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.4471e-05, -1.8973e-04],
        [ 5.3589e-05, -2.0516e-04],
        [ 5.5845e-05, -1.9717e-04],
        [ 5.6643e-05, -2.2670e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6168, -2.6266],
        [-0.7278,  1.4699],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.4460, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5563, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.3421e-05, -1.8714e-04],
        [ 6.6247e-05, -2.2684e-04],
        [ 5.3023e-05, -1.7198e-04],
        [ 5.1126e-05, -1.8326e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.8892, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4505, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 8.5057e-05, -2.2091e-04],
        [ 8.5325e-05, -2.1610e-04],
        [ 8.8169e-05, -2.3339e-04],
        [ 9.1738e-05, -2.0289e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4699],
        [-0.8533, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.3645, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3565, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.5683e-05, -1.8805e-04],
        [ 7.4119e-05, -1.9926e-04],
        [ 7.8956e-05, -1.8727e-04],
        [ 7.6794e-05, -2.0081e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.2427, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3220, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.9351e-05, -1.6650e-04],
        [ 7.0137e-05, -1.5864e-04],
        [ 7.5611e-05, -1.7701e-04],
        [ 7.7941e-05, -1.6438e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.1852, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5119, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.5678e-05, -1.8494e-04],
        [ 7.5152e-05, -1.8124e-04],
        [ 7.6989e-05, -2.0308e-04],
        [ 7.8013e-05, -1.8139e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.9459, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2673, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.9154e-05, -1.9479e-04],
        [ 7.1930e-05, -1.8742e-04],
        [ 8.7354e-05, -2.3199e-04],
        [ 7.4315e-05, -1.9435e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.6713, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4117, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.7587e-05, -1.8103e-04],
        [ 5.7819e-05, -1.8957e-04],
        [ 5.6837e-05, -1.8299e-04],
        [ 5.3425e-05, -1.8070e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.5484, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5822, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0272e-04, -2.1689e-04],
        [ 9.0504e-05, -1.6739e-04],
        [ 9.2910e-05, -2.0475e-04],
        [ 9.7654e-05, -1.8635e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4701],
        [-0.8532, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(9.4165, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.9507, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.8849, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.6529, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0969e-04, -1.8262e-04],
        [ 9.8916e-05, -1.9382e-04],
        [ 1.0190e-04, -1.8427e-04],
        [ 1.0053e-04, -1.8218e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.9898, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2787, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.5705, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5979, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4702],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.4627, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5757, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4225e-04, -1.3875e-04],
        [ 1.3304e-04, -1.0598e-04],
        [ 1.3640e-04, -1.1570e-04],
        [ 1.4026e-04, -9.8975e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6265],
        [-0.7279,  1.4702],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.0923, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5021, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7280,  1.4702],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1366, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3033, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6169, -2.6266],
        [-0.7280,  1.4702],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1179, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3028, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0002, -0.0001],
        [ 0.0002, -0.0001],
        [ 0.0002, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6170, -2.6266],
        [-0.7280,  1.4703],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1250, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3050, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0002, -0.0002],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6170, -2.6266],
        [-0.7280,  1.4702],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.9433, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4689, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.2698e-04, -8.7474e-05],
        [ 1.5125e-04, -1.0342e-04],
        [ 1.4145e-04, -5.3513e-05],
        [ 1.3379e-04, -4.1454e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6729],
        [ 0.6171, -2.6266],
        [-0.7281,  1.4704],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.6936, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4224, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.7121e-04, -7.6519e-05],
        [ 1.6319e-04, -3.7636e-05],
        [ 1.6385e-04, -8.0303e-05],
        [ 1.8657e-04, -7.9574e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6729],
        [ 0.6171, -2.6265],
        [-0.7281,  1.4703],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2442, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1280, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4253e-04, -8.4764e-05],
        [ 1.3644e-04, -8.5386e-05],
        [ 1.4147e-04, -4.7705e-05],
        [ 1.3217e-04, -8.0398e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6729],
        [ 0.6171, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7135, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2174, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4959e-04, -9.0311e-05],
        [ 1.3950e-04, -4.6124e-05],
        [ 1.4506e-04, -7.7328e-05],
        [ 1.4163e-04, -8.6328e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6172, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.2892, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0446, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3470, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5120e-04, -4.1495e-05],
        [ 1.2387e-04, -5.7947e-05],
        [ 1.5280e-04, -4.9054e-05],
        [ 1.6511e-04, -3.1324e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6172, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.6333, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3951, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5767e-04, -7.6340e-05],
        [ 1.7565e-04, -1.0461e-04],
        [ 1.5869e-04, -7.9484e-05],
        [ 1.6978e-04, -5.3512e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6173, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4586, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0422, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1762, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5661e-04, -8.6965e-05],
        [ 1.3761e-04, -7.8148e-05],
        [ 1.2937e-04, -8.2661e-05],
        [ 1.5423e-04, -6.7447e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6173, -2.6265],
        [-0.7282,  1.4704],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0109, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0427, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0876, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5166e-04, -8.9380e-05],
        [ 1.4972e-04, -9.7351e-05],
        [ 1.6177e-04, -6.5934e-05],
        [ 1.5932e-04, -7.6618e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7281,  1.4704],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7500, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2285, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.3432e-04, -1.2746e-04],
        [ 1.4291e-04, -9.6924e-05],
        [ 1.4222e-04, -1.0683e-04],
        [ 1.5005e-04, -1.1198e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7282,  1.4704],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4170, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1513, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0850e-04, -5.3354e-05],
        [ 1.2967e-04, -5.1354e-05],
        [ 1.0258e-04, -2.0635e-05],
        [ 9.7553e-05, -6.4329e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7282,  1.4705],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.4227, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3652, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4840e-04, -2.3954e-05],
        [ 1.3347e-04, -5.7663e-05],
        [ 1.4739e-04, -3.6639e-05],
        [ 1.5517e-04, -4.3652e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7199, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2132, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 9.4265e-05, -1.5861e-05],
        [ 8.4518e-05, -1.4012e-05],
        [ 9.4310e-05, -1.0467e-05],
        [ 1.3742e-04, -8.6925e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7282,  1.4705],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0699, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0848, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 8.1190e-05, -3.8656e-05],
        [ 8.1415e-05, -2.7946e-05],
        [ 9.7755e-05, -5.5835e-06],
        [ 1.1444e-04, -2.5497e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.0488, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2843, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[9.9223e-05, 2.6788e-05],
        [8.9841e-05, 4.8425e-05],
        [1.0075e-04, 1.4957e-05],
        [1.0808e-04, 2.5584e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6733],
        [ 0.6174, -2.6264],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1862, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1190, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.7125e-05, -1.4886e-05],
        [ 6.8238e-05, -1.2657e-06],
        [ 7.6970e-05, -2.4508e-05],
        [ 9.1985e-05,  1.3808e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6732],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4705],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7754, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2298, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.0052e-04, 4.1057e-05],
        [1.1105e-04, 3.9829e-05],
        [7.5950e-05, 9.6236e-06],
        [8.1880e-05, 2.7315e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6733],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4705],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1720, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3086, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.1380e-04, 4.2033e-05],
        [9.0171e-05, 7.3463e-05],
        [5.7866e-05, 4.4007e-05],
        [8.9622e-05, 9.2444e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6733],
        [ 0.6175, -2.6264],
        [-0.7282,  1.4706],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7872, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0299, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.0433e-05, 1.6000e-05],
        [6.2103e-05, 4.7104e-05],
        [5.0459e-05, 5.4883e-05],
        [7.0244e-05, 4.5675e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6733],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5002, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0304, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1609, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.2154e-04, 5.8282e-05],
        [4.8182e-05, 7.1865e-05],
        [5.4360e-05, 6.5899e-05],
        [6.3995e-05, 4.0292e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5371, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0431, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1937, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.3529e-05, 4.5691e-05],
        [1.7587e-05, 4.9081e-05],
        [8.5142e-06, 2.6268e-05],
        [1.8382e-05, 6.4215e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2597, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9311, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.7874e-05, 5.5843e-05],
        [6.3292e-05, 7.4350e-05],
        [5.9554e-05, 5.8761e-05],
        [5.5312e-05, 1.9077e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8534, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2853, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1359, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.6993e-05, 3.7920e-05],
        [1.6763e-05, 1.0598e-05],
        [3.8819e-05, 2.5029e-05],
        [7.0519e-06, 4.7608e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6735],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8534, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1491, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9080, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.6236e-05, 6.0121e-05],
        [4.7326e-05, 4.7086e-05],
        [1.8104e-05, 4.2882e-05],
        [2.4420e-05, 3.6754e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6735],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8534, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2846, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1374, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[8.4766e-05, 9.2112e-05],
        [6.4045e-05, 9.2905e-05],
        [5.0786e-05, 9.2438e-05],
        [7.0457e-05, 1.2289e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6736],
        [ 0.6176, -2.6265],
        [-0.7282,  1.4707],
        [-0.8533, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.6108, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1921, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.4829e-05, 1.2328e-05],
        [2.5640e-05, 4.6419e-05],
        [6.7367e-05, 1.8798e-05],
        [2.2331e-05, 3.4586e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6735],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3850, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0309, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9387, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[8.3754e-05, 1.9556e-05],
        [5.4531e-05, 1.8637e-05],
        [2.4203e-05, 1.1794e-05],
        [5.4960e-05, 1.7143e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6736],
        [ 0.6176, -2.6266],
        [-0.7282,  1.4706],
        [-0.8532, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3355, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1422, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 3.9361e-05,  2.7207e-05],
        [-5.4834e-07,  2.5202e-05],
        [-6.2241e-06,  1.4388e-05],
        [-1.6684e-05,  3.3965e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6736],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4280, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1579, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2394e-05,  2.7898e-05],
        [ 3.8986e-07, -3.2819e-05],
        [ 5.9386e-06,  1.6348e-05],
        [-1.2596e-05,  1.0588e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6736],
        [ 0.6176, -2.6267],
        [-0.7282,  1.4706],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7882, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0274, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.1478e-06,  3.7053e-05],
        [-4.1384e-05,  1.0913e-05],
        [-3.0940e-06,  3.6362e-05],
        [-2.7571e-05,  4.7035e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6736],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2847, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1392, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[6.1535e-05, 4.6592e-05],
        [2.2256e-05, 3.1161e-05],
        [5.1325e-05, 6.7517e-05],
        [4.1383e-05, 4.4480e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.0875, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0859, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.5678e-05, 7.1766e-05],
        [3.2929e-05, 5.1368e-05],
        [2.4586e-05, 5.2798e-05],
        [1.0296e-05, 7.4324e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2500, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0432, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9363, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.1174e-05, 1.9831e-05],
        [1.1249e-05, 2.6761e-05],
        [1.7060e-05, 4.3695e-05],
        [3.2766e-06, 3.7148e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4088, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1516, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.7958e-05, 5.9605e-05],
        [3.9694e-05, 6.2498e-05],
        [5.1305e-05, 6.0175e-05],
        [5.2996e-05, 7.8517e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6738],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4589, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0471, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9860, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.2283e-05, 5.2181e-05],
        [1.0762e-06, 3.2538e-05],
        [1.2639e-05, 6.2873e-05],
        [2.2700e-05, 5.2479e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6738],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8529, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.0606, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2906, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.4377e-05, 7.9579e-05],
        [9.9487e-05, 4.5143e-05],
        [5.8805e-05, 5.2524e-05],
        [9.8563e-05, 1.0519e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6739],
        [ 0.6177, -2.6266],
        [-0.7281,  1.4706],
        [-0.8528, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7940, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0482, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2553, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.9366e-05, 1.0849e-04],
        [1.4735e-05, 1.5315e-04],
        [1.3844e-05, 9.8276e-05],
        [4.1675e-05, 1.4645e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6739],
        [ 0.6176, -2.6265],
        [-0.7281,  1.4707],
        [-0.8529, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.9948, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0741, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 4.9199e-05, -4.1470e-05],
        [ 6.3770e-05,  1.2795e-05],
        [ 4.2735e-05, -3.1729e-05],
        [ 4.1168e-05, -1.2982e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6738],
        [ 0.6177, -2.6267],
        [-0.7281,  1.4706],
        [-0.8529, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.4179, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1563, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 9.7726e-06,  1.7194e-05],
        [ 2.1149e-05, -1.9705e-05],
        [ 2.6919e-05, -2.9058e-05],
        [ 4.2252e-06, -4.4004e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6739],
        [ 0.6176, -2.6267],
        [-0.7281,  1.4706],
        [-0.8529, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2154, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9214, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.2298e-05, 5.8478e-05],
        [5.0594e-05, 3.3986e-05],
        [3.7009e-05, 6.6343e-05],
        [4.8558e-05, 7.7429e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6740],
        [ 0.6177, -2.6267],
        [-0.7280,  1.4707],
        [-0.8528, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1434, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0999, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 2.7809e-05,  1.3719e-05],
        [ 3.1357e-05, -1.3125e-05],
        [ 3.9074e-05,  6.4742e-07],
        [-6.4111e-06,  2.0032e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6740],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4706],
        [-0.8529, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0142, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8788, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.6183e-05, 2.7821e-05],
        [4.2982e-05, 5.2966e-05],
        [4.6102e-05, 3.8796e-05],
        [2.9034e-05, 3.7248e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6740],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2147, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9242, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.1687e-05, 6.6124e-05],
        [9.9525e-06, 7.0007e-05],
        [1.8642e-05, 3.2407e-05],
        [9.9912e-06, 1.4185e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6741],
        [ 0.6176, -2.6266],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3914, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9525, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.3381e-05, -1.0683e-05],
        [ 4.6020e-05,  4.2233e-06],
        [ 4.3877e-05, -9.6126e-06],
        [ 3.1968e-05,  3.7803e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6741],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5087, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9817, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.8901e-05, 1.1409e-04],
        [1.8682e-05, 1.0003e-04],
        [5.1574e-05, 8.8521e-05],
        [6.4068e-06, 7.7113e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6743],
        [ 0.6175, -2.6266],
        [-0.7279,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3646, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1538, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.5014e-05, 4.1209e-05],
        [3.2516e-05, 1.9672e-05],
        [6.8332e-05, 3.6264e-06],
        [3.3258e-05, 3.0224e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6742],
        [ 0.6175, -2.6267],
        [-0.7279,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.9799, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0820, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.8631e-05, -3.2539e-05],
        [-3.4859e-05, -3.8013e-06],
        [-3.9081e-05, -1.2061e-05],
        [-4.1050e-05,  1.2819e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6742],
        [ 0.6174, -2.6267],
        [-0.7280,  1.4708],
        [-0.8529, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9925, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8775, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3701e-05,  2.5426e-05],
        [ 1.4169e-05,  5.1216e-06],
        [-1.9422e-05, -2.3621e-05],
        [ 1.0894e-05,  5.3453e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6743],
        [ 0.6175, -2.6267],
        [-0.7280,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3394, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0445, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9570, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.2783e-05, -8.5008e-06],
        [ 4.2296e-05,  2.0104e-05],
        [ 1.5042e-05, -1.6514e-05],
        [ 1.4805e-05,  1.5422e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6743],
        [ 0.6175, -2.6267],
        [-0.7279,  1.4708],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5581, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9874, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7536e-05,  9.6422e-05],
        [-9.6248e-06,  9.6183e-05],
        [-2.7756e-05,  6.4156e-05],
        [ 2.7107e-05,  5.9148e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7280,  1.4709],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.3580, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1492, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.3392e-06,  5.3142e-05],
        [ 1.5012e-05,  2.6755e-05],
        [ 1.4626e-05,  4.4297e-05],
        [-9.1732e-06,  5.4436e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4709],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7474, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8257, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 2.3051e-05,  5.0611e-05],
        [ 2.2756e-05,  9.1283e-05],
        [ 3.9253e-05,  5.6856e-05],
        [-9.8795e-07,  2.6775e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.9080, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0634, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.9278e-06, -1.4203e-05],
        [ 1.3867e-05,  2.8652e-05],
        [-2.0371e-05,  8.8791e-07],
        [ 3.3625e-05,  2.1738e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6745],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7476, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2332, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[6.3492e-06, 6.4593e-05],
        [8.1979e-06, 4.9892e-05],
        [1.1428e-06, 2.1818e-05],
        [6.8541e-06, 7.9563e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6746],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5004, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9761, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.8099e-05, 7.7246e-05],
        [3.3733e-05, 1.5944e-05],
        [3.5466e-05, 6.1218e-05],
        [2.5088e-05, 5.5677e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6746],
        [ 0.6174, -2.6268],
        [-0.7279,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.6215, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9999, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.4358e-05, 9.3605e-05],
        [2.7505e-05, 9.7370e-05],
        [6.4973e-05, 5.8034e-05],
        [3.2870e-05, 8.7841e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6747],
        [ 0.6174, -2.6267],
        [-0.7278,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5822, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9991, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.6571e-05, 8.4139e-05],
        [4.7573e-05, 7.7901e-05],
        [4.3439e-06, 6.3083e-05],
        [6.2241e-05, 9.3100e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6747],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4711],
        [-0.8527, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7075, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0116, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.8970e-05, -2.7093e-05],
        [-1.2248e-05,  7.1820e-05],
        [ 1.3871e-06, -2.2225e-05],
        [-2.7221e-06, -4.4816e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6747],
        [ 0.6173, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2180, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0286, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1008, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.0914e-05,  2.5693e-05],
        [-7.0144e-05,  3.5778e-05],
        [-5.6184e-05,  6.3677e-05],
        [-2.8898e-05,  5.1364e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6748],
        [ 0.6172, -2.6268],
        [-0.7279,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.6752, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0024, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1971e-05,  1.5737e-06],
        [-2.7615e-05,  4.7749e-05],
        [-5.5429e-05,  1.3009e-05],
        [-2.6673e-05,  4.1265e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6748],
        [ 0.6173, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5987, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9953, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1037e-05, -2.5100e-05],
        [-2.0982e-05,  1.0537e-05],
        [-2.3878e-05, -1.9363e-05],
        [-2.7727e-05,  2.5773e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6748],
        [ 0.6173, -2.6268],
        [-0.7279,  1.4710],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6219, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8036, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.4054e-05,  3.8369e-05],
        [-9.5993e-06, -2.4087e-05],
        [ 8.6639e-06,  4.7064e-05],
        [-2.5740e-06,  1.3957e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6749],
        [ 0.6173, -2.6268],
        [-0.7278,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1578, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9011, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 2.0721e-06,  4.5083e-05],
        [-5.0585e-05,  3.4795e-05],
        [-3.6107e-05,  4.0462e-05],
        [-1.9170e-05,  6.6603e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6749],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.8412, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0403, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.7526e-05,  5.2647e-05],
        [-3.7554e-05,  2.6489e-05],
        [-2.8716e-05,  6.5859e-06],
        [-5.1385e-05,  1.2855e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6750],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3574, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9543, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.8542e-05,  5.2363e-05],
        [-8.6077e-05,  7.0520e-05],
        [-4.1417e-05,  8.6886e-05],
        [-3.6618e-05,  3.4803e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6750],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4712],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1531, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1082, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.5155e-05,  3.6738e-05],
        [-5.3798e-05,  3.8304e-05],
        [-6.8096e-05,  2.0803e-05],
        [-3.6275e-05,  7.0727e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6750],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5997, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1913, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.6005e-05, -3.4068e-05],
        [-1.0326e-05, -1.2322e-05],
        [-1.7573e-05,  2.2304e-05],
        [ 3.0877e-05, -2.0905e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6750],
        [ 0.6172, -2.6268],
        [-0.7278,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7138, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8186, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6446e-05,  1.5068e-06],
        [-2.5727e-05,  4.9403e-05],
        [ 1.8678e-05,  1.6688e-05],
        [-1.0684e-05,  1.5882e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6751],
        [ 0.6172, -2.6267],
        [-0.7277,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1569, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9021, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8497e-05, -1.2956e-05],
        [-5.0903e-05, -1.8036e-05],
        [-7.6761e-05, -2.0285e-05],
        [-3.4410e-05, -3.6753e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6751],
        [ 0.6172, -2.6268],
        [-0.7278,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3474, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9438, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5109e-04,  1.6466e-05],
        [-1.1937e-04,  2.5527e-05],
        [-1.3436e-04,  8.7085e-05],
        [-1.1880e-04,  4.2048e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6752],
        [ 0.6171, -2.6267],
        [-0.7278,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5683, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9881, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.3131e-05, -6.5066e-06],
        [-5.1622e-05,  6.9944e-06],
        [-6.8583e-05, -2.3362e-05],
        [-6.9485e-05,  1.0893e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6752],
        [ 0.6172, -2.6267],
        [-0.7278,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5514, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9923, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.1151e-05, -1.9551e-05],
        [-4.4036e-05,  5.4707e-06],
        [-9.6402e-05, -9.0292e-05],
        [-7.5947e-05, -4.3736e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6752],
        [ 0.6172, -2.6267],
        [-0.7278,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1117, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8958, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2015e-04, -2.5099e-05],
        [-6.7127e-05, -1.3325e-05],
        [-5.8145e-05, -7.8191e-05],
        [-7.1183e-05, -2.7661e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6753],
        [ 0.6171, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.8889, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8597, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.8332e-05, -2.7081e-05],
        [-9.6635e-05, -6.5273e-05],
        [-3.8075e-05, -2.4366e-05],
        [-4.3773e-05, -4.4749e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6753],
        [ 0.6171, -2.6268],
        [-0.7277,  1.4711],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2000, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9067, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2309e-04, -6.0442e-05],
        [-1.2109e-04, -7.6893e-05],
        [-1.7153e-04, -6.8906e-05],
        [-1.0867e-04, -1.4667e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6753],
        [ 0.6170, -2.6268],
        [-0.7278,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7543, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0268, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.2677e-05, -9.8540e-05],
        [-6.7904e-05, -6.5415e-05],
        [-1.0621e-04, -7.7652e-05],
        [-9.4573e-05, -8.7383e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6754],
        [ 0.6171, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2808, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9351, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.2436e-05, -2.2406e-05],
        [-6.2046e-05, -4.7620e-05],
        [-7.2738e-05, -5.5940e-05],
        [-9.5271e-05, -2.7736e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6755],
        [ 0.6171, -2.6267],
        [-0.7276,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1088, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0959, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.3568e-05, -6.6128e-05],
        [-5.9861e-05, -1.0134e-05],
        [-3.7649e-05, -2.7007e-05],
        [-2.3713e-05, -2.2568e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6755],
        [ 0.6171, -2.6267],
        [-0.7276,  1.4712],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2253, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1185, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:100, loss: 0.011185, Time: 38.4
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0105e-04, -1.1058e-04],
        [-1.1400e-04, -4.2176e-05],
        [-1.1837e-04, -5.9723e-05],
        [-1.7107e-04, -2.2624e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6755],
        [ 0.6170, -2.6267],
        [-0.7276,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3946, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9526, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.7498e-05, -9.8790e-05],
        [-9.6110e-05, -1.1513e-04],
        [-7.8738e-05, -3.6358e-05],
        [-8.2281e-05, -1.0227e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6756],
        [ 0.6170, -2.6268],
        [-0.7275,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7851, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0250, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.2792e-05, -7.7087e-07],
        [-1.3521e-04,  2.5055e-05],
        [-8.0435e-05, -2.6539e-05],
        [-6.2904e-05, -1.8037e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6757],
        [ 0.6170, -2.6266],
        [-0.7275,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4662, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7671, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.9013e-05, -9.2660e-05],
        [-5.7421e-05, -3.2633e-05],
        [-5.8999e-05, -6.8883e-05],
        [-8.7869e-05, -7.2602e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6757],
        [ 0.6171, -2.6267],
        [-0.7275,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6441, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7992, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.6322e-05, -1.2209e-04],
        [-8.3571e-05, -8.3184e-05],
        [-2.9240e-05, -5.5551e-05],
        [-4.1866e-05, -8.7904e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6757],
        [ 0.6171, -2.6267],
        [-0.7274,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7409, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8222, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.5471e-05, -1.3542e-04],
        [-3.4381e-05, -1.2375e-04],
        [-3.0137e-05, -1.4257e-04],
        [-2.1588e-05, -1.5234e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6758],
        [ 0.6171, -2.6268],
        [-0.7274,  1.4711],
        [-0.8529, -2.7502]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.5244, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1813, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.1279e-05, -6.1215e-05],
        [-5.8327e-06, -7.0168e-05],
        [-2.7061e-05, -3.6191e-05],
        [-4.8861e-05, -5.1496e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6759],
        [ 0.6172, -2.6267],
        [-0.7274,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7111, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8237, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0175e-04, -1.0231e-04],
        [-8.9941e-05, -1.6002e-04],
        [-1.2718e-04, -1.2714e-04],
        [-1.1112e-04, -1.2896e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6759],
        [ 0.6171, -2.6268],
        [-0.7275,  1.4711],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3932, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7618, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0831e-04, -7.9635e-05],
        [-8.7427e-05, -1.3441e-04],
        [-8.1559e-05, -1.7591e-04],
        [-8.5051e-05, -1.4762e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6760],
        [ 0.6171, -2.6268],
        [-0.7274,  1.4711],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7557, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6319, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6322e-04, -1.2699e-04],
        [-1.5423e-04, -7.0901e-05],
        [-1.2143e-04, -1.2866e-04],
        [-1.4259e-04, -8.9017e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6760],
        [ 0.6171, -2.6268],
        [-0.7274,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.8182, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0459, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.5110e-05,  1.6849e-05],
        [-6.4053e-05, -1.5818e-05],
        [-5.2109e-05, -7.2808e-06],
        [-4.9547e-05, -3.4553e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6762],
        [ 0.6172, -2.6267],
        [-0.7273,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7928, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8322, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.7958e-05, -6.7968e-05],
        [-8.3611e-05, -4.0025e-05],
        [-9.8053e-05, -6.6717e-05],
        [-5.5519e-05, -4.5843e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6761],
        [ 0.6172, -2.6267],
        [-0.7274,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9086, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8540, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.5925e-05, -1.1920e-05],
        [-8.4762e-05, -3.9229e-05],
        [-1.1704e-04, -7.0182e-05],
        [-1.0426e-04, -3.3390e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6762],
        [ 0.6172, -2.6267],
        [-0.7274,  1.4712],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4974, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9780, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.5970e-05, -1.2183e-04],
        [-2.3563e-05, -6.9864e-05],
        [-1.0943e-05, -1.0558e-04],
        [-7.2933e-05, -1.3283e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6762],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4711],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0000, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8747, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3541e-04, -1.1085e-04],
        [-1.2481e-04, -4.9755e-05],
        [-1.0395e-04, -5.5983e-05],
        [-1.1319e-04, -6.7696e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6762],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4712],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.8242, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8350, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.5821e-05, -7.4480e-05],
        [-5.7717e-05, -3.1319e-05],
        [-6.0485e-05, -8.2277e-05],
        [-6.8456e-05, -1.3198e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6763],
        [ 0.6172, -2.6268],
        [-0.7272,  1.4711],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.8187, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8354, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.7198e-05, -8.0584e-05],
        [-3.1257e-05, -9.1283e-05],
        [-2.0275e-05, -1.9325e-05],
        [-5.2701e-05, -5.6414e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6764],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2731, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9229, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0001, -0.0001],
        [-0.0001, -0.0001],
        [-0.0001, -0.0001],
        [-0.0001, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6764],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0437, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8897, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.3696e-05, -6.1213e-05],
        [ 3.1764e-05, -3.5105e-05],
        [-2.7131e-05, -4.8249e-05],
        [-2.3215e-05, -6.8716e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6765],
        [ 0.6174, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0504, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8885, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.5598e-05, -8.9029e-05],
        [-2.5667e-05, -1.5441e-05],
        [-2.1643e-05, -4.9793e-05],
        [-1.3007e-05, -2.8294e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6765],
        [ 0.6173, -2.6268],
        [-0.7271,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5379, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9884, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0257e-04, -7.1925e-05],
        [-1.1042e-04, -8.3027e-05],
        [-1.2547e-04, -6.6049e-05],
        [-9.6077e-05, -2.0085e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6766],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0936, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7006, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.8749e-05, -2.9226e-05],
        [-1.0562e-04, -4.4956e-05],
        [-9.2496e-05, -1.5316e-05],
        [-9.0575e-05, -7.5622e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6767],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.3699, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0434, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9608, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2251e-04, -2.8670e-05],
        [-1.4092e-04, -5.5770e-05],
        [-1.3297e-04, -1.3257e-04],
        [-1.2563e-04, -1.1790e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6767],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4711],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7341, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8346, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6250e-04, -1.0240e-04],
        [-2.1684e-04, -1.3170e-04],
        [-2.1708e-04, -3.3272e-05],
        [-2.1404e-04, -1.0453e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6767],
        [ 0.6172, -2.6269],
        [-0.7273,  1.4712],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7373, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8195, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0211e-04, -6.8977e-05],
        [-1.6918e-04, -1.1782e-04],
        [-9.8981e-05, -8.3068e-05],
        [-1.3569e-04, -1.0177e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6767],
        [ 0.6172, -2.6269],
        [-0.7272,  1.4711],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2849, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0424, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7418, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2838e-04, -5.5342e-05],
        [-1.1534e-04, -2.8596e-06],
        [-1.1877e-04, -5.3238e-05],
        [-1.0967e-04, -9.3416e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6768],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4711],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7592, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0428, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6375, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7032e-04, -7.4810e-05],
        [-1.6309e-04, -1.4520e-04],
        [-1.8660e-04, -5.6172e-05],
        [-1.7636e-04, -9.2424e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6768],
        [ 0.6173, -2.6269],
        [-0.7273,  1.4712],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6116, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8047, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7654e-04, -5.0660e-05],
        [-2.2196e-04, -1.0893e-04],
        [-2.1897e-04, -6.0933e-05],
        [-1.3436e-04, -4.4573e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6769],
        [ 0.6172, -2.6269],
        [-0.7273,  1.4712],
        [-0.8530, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3183, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7405, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2862e-04, -9.8536e-05],
        [-1.3373e-04, -1.1234e-04],
        [-1.3235e-04, -7.7680e-05],
        [-1.4392e-04, -1.1185e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6768],
        [ 0.6173, -2.6269],
        [-0.7272,  1.4711],
        [-0.8530, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1448, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8995, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9933e-04, -9.0021e-05],
        [-2.1279e-04, -6.7586e-05],
        [-2.2394e-04, -7.0282e-05],
        [-2.1628e-04, -9.3908e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6769],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4712],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7212, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6181, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1227e-04, -1.2930e-04],
        [-1.8797e-04, -8.6939e-05],
        [-1.8100e-04, -4.6617e-05],
        [-1.5485e-04, -7.2011e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6769],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4712],
        [-0.8530, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.7423, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0451, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8386, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8065e-04,  1.3471e-05],
        [-2.0119e-04,  3.3107e-05],
        [-1.5498e-04, -3.9501e-05],
        [-1.8686e-04,  1.7094e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6770],
        [ 0.6173, -2.6267],
        [-0.7273,  1.4712],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2959, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7341, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6780e-04, -2.1396e-05],
        [-1.5979e-04,  8.6361e-05],
        [-2.0215e-04,  2.2222e-05],
        [-1.3660e-04,  1.4148e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6770],
        [ 0.6174, -2.6267],
        [-0.7273,  1.4713],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0653, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6889, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1374e-04,  1.8066e-05],
        [-8.3386e-05,  1.3300e-05],
        [-1.5224e-04,  2.0517e-05],
        [-9.0033e-05, -1.9714e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6771],
        [ 0.6175, -2.6267],
        [-0.7273,  1.4713],
        [-0.8529, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5788, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7986, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5568e-04,  5.9892e-06],
        [-1.2262e-04,  5.9768e-06],
        [-1.1902e-04, -3.6245e-05],
        [-1.2523e-04, -1.9191e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6771],
        [ 0.6174, -2.6267],
        [-0.7272,  1.4712],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.5847, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9986, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1247e-04,  2.2923e-05],
        [-2.6063e-04,  4.6364e-05],
        [-2.3714e-04, -4.8198e-05],
        [-3.0404e-04,  4.1284e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6772],
        [ 0.6173, -2.6267],
        [-0.7273,  1.4712],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2845, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7277, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6544e-04, -5.5055e-05],
        [-1.7607e-04, -8.1479e-05],
        [-1.4750e-04, -9.4589e-05],
        [-1.4638e-04, -5.1285e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6771],
        [ 0.6174, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4400, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7598, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9695e-04, -4.0514e-05],
        [-1.8730e-04, -3.5282e-05],
        [-2.0464e-04, -6.8432e-05],
        [-1.4903e-04, -4.2142e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6772],
        [ 0.6174, -2.6268],
        [-0.7273,  1.4712],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1276, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0315, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6885, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.3104e-04, -3.7901e-05],
        [-2.6037e-04, -9.8101e-05],
        [-2.9236e-04, -6.1177e-05],
        [-2.4503e-04, -1.0930e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6772],
        [ 0.6173, -2.6268],
        [-0.7274,  1.4712],
        [-0.8531, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0599, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6837, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2546e-04, -6.2193e-05],
        [-2.3440e-04, -5.3161e-05],
        [-2.4432e-04, -1.0043e-04],
        [-2.3247e-04, -6.3145e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6772],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4712],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9103, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6585, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9820e-04,  1.9216e-05],
        [-2.4445e-04,  1.0457e-05],
        [-1.9611e-04, -5.5729e-05],
        [-2.5733e-04, -1.5280e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6773],
        [ 0.6173, -2.6267],
        [-0.7273,  1.4713],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5894, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8007, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8718e-04, -8.0493e-05],
        [-2.2828e-04, -4.1715e-05],
        [-1.7715e-04, -1.3601e-04],
        [-2.1172e-04, -7.7150e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6772],
        [ 0.6173, -2.6268],
        [-0.7272,  1.4712],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.2466, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9308, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2660e-04, -3.0690e-05],
        [-3.4565e-04, -6.3196e-05],
        [-3.2551e-04,  1.2721e-05],
        [-2.2214e-04, -4.4848e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6773],
        [ 0.6172, -2.6268],
        [-0.7274,  1.4714],
        [-0.8530, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3460, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7411, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5935e-04, -4.0761e-05],
        [-2.6295e-04, -2.7521e-05],
        [-2.8100e-04,  3.0556e-05],
        [-2.8671e-04, -8.9256e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6773],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4714],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5288, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5749, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5583e-04, -8.0016e-05],
        [-2.7631e-04,  5.2780e-05],
        [-2.2983e-04, -6.3317e-05],
        [-1.9376e-04, -3.4828e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6773],
        [ 0.6173, -2.6267],
        [-0.7273,  1.4713],
        [-0.8530, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0520, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8783, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7487e-04,  1.0258e-04],
        [-2.2631e-04,  5.3757e-05],
        [-1.7347e-04,  3.0479e-05],
        [-2.3010e-04,  6.4143e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6775],
        [ 0.6173, -2.6267],
        [-0.7272,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9655, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6744, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9710e-04,  4.6785e-05],
        [-2.5227e-04,  1.0631e-04],
        [-2.9396e-04,  6.4195e-05],
        [-2.2883e-04,  7.1292e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6775],
        [ 0.6173, -2.6266],
        [-0.7273,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0108, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8774, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.2692e-04, -3.4701e-05],
        [-3.7510e-04, -5.7607e-05],
        [-3.3830e-04, -3.5976e-05],
        [-3.4129e-04, -9.1364e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6775],
        [ 0.6171, -2.6268],
        [-0.7274,  1.4713],
        [-0.8531, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.3277, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7337, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.0349e-04, -1.1450e-04],
        [-3.4185e-04, -6.1945e-05],
        [-2.8510e-04, -4.9341e-05],
        [-3.5102e-04, -1.8715e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6774],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4713],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9393, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6648, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9300e-04, -6.9685e-05],
        [-3.0102e-04, -6.9499e-05],
        [-3.1405e-04, -4.1853e-05],
        [-2.5482e-04, -3.8172e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6775],
        [ 0.6172, -2.6268],
        [-0.7274,  1.4713],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  33
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1796, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7074, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2159e-04, -7.0117e-05],
        [-2.6144e-04, -4.2335e-05],
        [-2.4952e-04, -1.0137e-04],
        [-2.3768e-04, -1.0754e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6776],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4713],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9119, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0312, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6448, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.6141e-04,  1.1103e-05],
        [-2.3054e-04,  2.4119e-05],
        [-2.5213e-04,  7.8313e-06],
        [-2.3926e-04, -8.9766e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6777],
        [ 0.6173, -2.6267],
        [-0.7273,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.1571, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9060, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.5198e-04, -5.7341e-05],
        [-2.4949e-04,  2.3596e-06],
        [-3.5835e-04, -3.9952e-05],
        [-3.0938e-04, -2.8636e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6777],
        [ 0.6173, -2.6267],
        [-0.7274,  1.4713],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0578, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0482, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7080, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0003, -0.0001],
        [-0.0003, -0.0001],
        [-0.0003, -0.0002],
        [-0.0003, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6776],
        [ 0.6173, -2.6268],
        [-0.7274,  1.4712],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1920, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7085, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1082e-04, -3.5539e-05],
        [-3.8801e-04, -1.5700e-04],
        [-4.1604e-04, -3.5749e-05],
        [-3.2130e-04, -8.2398e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6777],
        [ 0.6172, -2.6269],
        [-0.7275,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7049, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6145, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0003, -0.0002],
        [-0.0003, -0.0001],
        [-0.0003, -0.0002],
        [-0.0003, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6776],
        [ 0.6173, -2.6268],
        [-0.7274,  1.4713],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4531, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7633, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.0006e-04, -1.0321e-04],
        [-4.0177e-04, -9.1257e-05],
        [-3.8903e-04, -1.6707e-04],
        [-4.2351e-04, -1.0526e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6777],
        [ 0.6173, -2.6268],
        [-0.7274,  1.4713],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.8461, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6493, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.4989e-04, -5.7529e-05],
        [-3.1003e-04, -5.3902e-05],
        [-2.9298e-04, -1.1488e-04],
        [-2.5898e-04, -1.0019e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6778],
        [ 0.6174, -2.6267],
        [-0.7273,  1.4713],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2678, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7371, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.7329e-04, -1.2351e-04],
        [-4.0876e-04, -1.1828e-04],
        [-2.8684e-04, -7.1308e-05],
        [-3.7236e-04, -1.1592e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6778],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4714],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9754, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6741, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.8768e-04, -3.2461e-06],
        [-2.7386e-04, -1.1033e-04],
        [-3.4596e-04, -2.7394e-05],
        [-3.6095e-04, -6.1486e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6780],
        [ 0.6175, -2.6268],
        [-0.7274,  1.4715],
        [-0.8531, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.0992, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9018, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.1914e-04, -7.2034e-05],
        [-3.1498e-04, -5.8762e-05],
        [-2.6521e-04, -5.6514e-05],
        [-3.1306e-04, -2.3148e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6780],
        [ 0.6174, -2.6267],
        [-0.7273,  1.4715],
        [-0.8530, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5455, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7903, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0004, -0.0002],
        [-0.0004, -0.0002],
        [-0.0004, -0.0001],
        [-0.0003, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6779],
        [ 0.6174, -2.6268],
        [-0.7274,  1.4715],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.7319, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6204, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.6230e-04, -1.3470e-04],
        [-2.3183e-04, -5.0024e-05],
        [-3.2615e-04, -6.9357e-05],
        [-3.3300e-04, -2.4269e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6780],
        [ 0.6176, -2.6267],
        [-0.7274,  1.4716],
        [-0.8530, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.6956, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8250, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0004, -0.0002],
        [-0.0003, -0.0002],
        [-0.0004, -0.0002],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6781],
        [ 0.6175, -2.6268],
        [-0.7274,  1.4715],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.9831, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6803, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.9349e-04, -3.6101e-05],
        [-4.9020e-04, -8.1644e-05],
        [-4.7495e-04, -4.4810e-05],
        [-4.6247e-04, -9.2647e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6783],
        [ 0.6174, -2.6267],
        [-0.7275,  1.4717],
        [-0.8532, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.4564, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9634, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0005, -0.0002],
        [-0.0006, -0.0003],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6782],
        [ 0.6173, -2.6268],
        [-0.7277,  1.4715],
        [-0.8532, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(1.9121, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4584, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1772e-04, -8.5380e-05],
        [-4.1915e-04, -8.6053e-05],
        [-4.9170e-04, -6.8988e-05],
        [-4.0098e-04, -7.6432e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6784],
        [ 0.6175, -2.6266],
        [-0.7276,  1.4718],
        [-0.8531, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.5558, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5828, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2338e-04, -1.2058e-04],
        [-4.5987e-04, -1.4562e-04],
        [-3.3193e-04, -8.4266e-05],
        [-4.0403e-04, -1.5295e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6784],
        [ 0.6175, -2.6267],
        [-0.7274,  1.4718],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.5923, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7905, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0001],
        [-0.0006, -0.0002],
        [-0.0005, -0.0001],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6785],
        [ 0.6173, -2.6267],
        [-0.7276,  1.4718],
        [-0.8533, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.9907, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8712, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0001],
        [-0.0006, -0.0002],
        [-0.0006, -0.0002],
        [-0.0005, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6785],
        [ 0.6173, -2.6267],
        [-0.7277,  1.4718],
        [-0.8533, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4785, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5781, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0004, -0.0002],
        [-0.0005, -0.0001],
        [-0.0005, -0.0002],
        [-0.0005, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6786],
        [ 0.6175, -2.6266],
        [-0.7276,  1.4719],
        [-0.8533, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2645, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7276, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0005, -0.0001],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6785],
        [ 0.6174, -2.6266],
        [-0.7276,  1.4719],
        [-0.8533, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1956, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7136, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6787],
        [ 0.6174, -2.6267],
        [-0.7276,  1.4720],
        [-0.8533, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.4074, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0314, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7443, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0003],
        [-0.0005, -0.0002],
        [-0.0005, -0.0001],
        [-0.0005, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6787],
        [ 0.6175, -2.6267],
        [-0.7276,  1.4721],
        [-0.8533, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4029, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5553, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.7108e-04, -1.1629e-04],
        [-5.4548e-04, -1.0339e-04],
        [-5.7542e-04, -9.5620e-05],
        [-4.8365e-04, -8.8475e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6789],
        [ 0.6174, -2.6265],
        [-0.7276,  1.4721],
        [-0.8533, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4488, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5659, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0003],
        [-0.0007, -0.0003],
        [-0.0008, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  35
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  36
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  43
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  35
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  37
gt_cnt:  37
gt_cnt:  35
gt_cnt:  38
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  36
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  42
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  36
gt_cnt:  35
gt_cnt:  39
gt_cnt:  36
gt_cnt:  35
gt_cnt:  42
gt_cnt:  37
gt_cnt:  42
gt_cnt:  40
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  43
gt_cnt:  33
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  36
gt_cnt:  37
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  42
gt_cnt:  40
gt_cnt:  35
gt_cnt:  41
gt_cnt:  42
gt_cnt:  42
gt_cnt:  38
gt_cnt:  38
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  40
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  35
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  43
gt_cnt:  35
gt_cnt:  39
gt_cnt:  40
gt_cnt:  35
gt_cnt:  42
gt_cnt:  38
gt_cnt:  37
gt_cnt:  40
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  42
gt_cnt:  41
gt_cnt:  40
gt_cnt:  41
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  41
gt_cnt:  42
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  35
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  37
gt_cnt:  36
gt_cnt:  37
gt_cnt:  39
tensor([[ 2.3105,  0.6788],
        [ 0.6173, -2.6267],
        [-0.7278,  1.4720],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.2392, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7195, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0006, -0.0002],
        [-0.0006, -0.0002],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6789],
        [ 0.6174, -2.6266],
        [-0.7277,  1.4721],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.1536, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7070, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0004, -0.0001],
        [-0.0005, -0.0002],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6789],
        [ 0.6176, -2.6266],
        [-0.7275,  1.4722],
        [-0.8533, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.3213, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5437, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0003],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6790],
        [ 0.6173, -2.6266],
        [-0.7277,  1.4721],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(2.4265, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5659, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0008, -0.0002],
        [-0.0007, -0.0003],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6791],
        [ 0.6173, -2.6267],
        [-0.7278,  1.4721],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(3.0041, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6765, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
