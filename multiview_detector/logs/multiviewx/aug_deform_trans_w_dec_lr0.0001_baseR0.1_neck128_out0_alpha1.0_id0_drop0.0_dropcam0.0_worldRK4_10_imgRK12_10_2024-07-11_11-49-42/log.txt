logs/multiviewx/aug_deform_trans_w_dec_lr0.0001_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-11_11-49-42
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 100, 'lr': 0.0001, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX', 'two_stage': False}
Training...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
gt_cnt:  42
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  95, 100, 117,
        127, 133, 137, 143, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 20, 33, 39, 36, 12, 24,  0,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(6.6015, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(29.1031, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(42.3061, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,
         86,  90, 106, 121, 126, 158, 159, 166, 178, 179, 195, 200, 203, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 261, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38, 30,  0,
         8, 16, 31, 36, 12, 22,  1, 39, 10, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(6.6050, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(27.3836, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(40.5936, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  49,  51,  60,  70,
         74,  86, 105, 106, 133, 137, 153, 156, 164, 166, 170, 179, 194, 195,
        210, 221, 234, 240, 245, 248, 249, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 40, 26, 39, 38, 13, 21,  0, 30,
        41, 24, 12, 10,  5, 37,  8, 22, 15,  1,  9, 28, 31, 17, 20, 16, 42,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(6.0924, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(24.2504, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(36.4352, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  56,  58,  60,
         62,  74,  83,  86,  91, 127, 133, 137, 149, 156, 164, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17, 21,
        40,  5, 12, 24,  0, 10, 37, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(6.0839, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(26.2902, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(38.4580, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:4, loss: 9.614507, Time: 6.6
Testing...
gt_cnt:  41
gt_cnt:  43
gt_cnt:  42
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 158, 159, 166, 178, 179, 195, 200, 203, 206,
        215, 221, 232, 238, 244, 249, 250, 255, 264, 270, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 16, 31, 36, 12, 22,  1, 39, 10, 23,  3, 32, 15, 17, 28, 40, 18, 29,
         2, 27, 24, 19,  9]))]
{'labels': tensor(6.1036, device='cuda:0'), 'center': tensor(26.5821, device='cuda:0')}
top idx:  tensor([[201,  91,  74,  22, 117,  68,  99, 232, 270, 123, 242, 228,  58,  43,
         204,  50, 241,  73, 178, 261,  42, 225,  32,   0,  12, 134, 190, 198,
         284,  83,  19, 251,  94, 131, 283, 203, 138, 214, 219,  63, 217,  39,
          98,  81, 194, 263, 289,   2, 115, 247]], device='cuda:0')
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([50, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 133, 137, 153, 156, 164, 166, 170, 179,
        194, 195, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 41, 24, 12, 10,  5, 37,  8, 22, 15,  1,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(5.6821, device='cuda:0'), 'center': tensor(24.2829, device='cuda:0')}
top idx:  tensor([[ 74,  68, 232, 270,  91, 251,  99, 201,  22, 117, 228,  58, 241, 204,
         190, 213, 123,  12,  50, 131,  32, 242, 219, 134, 284,  48, 218,  81,
         205,   0, 225,  43,   2, 198, 137, 110,  69, 203,  98, 217, 214, 138,
          94,  41,  73,  83, 281, 141, 288, 283]], device='cuda:0')
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([50, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  50,  56,  58,
         60,  62,  74,  83,  86, 127, 133, 137, 149, 153, 156, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39, 37,  8, 14, 38, 27, 13, 17,
        21,  5, 40, 24,  0, 12, 10, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(5.9013, device='cuda:0'), 'center': tensor(26.0409, device='cuda:0')}
top idx:  tensor([[ 58,  22, 232,  91, 228,  74,  50, 284,  99, 201, 117, 241, 270, 242,
          68,  32, 123, 289,   2, 131, 118, 190, 285, 283,  12, 205, 204, 138,
         198, 178, 214, 281,  94, 251,  42,  81, 247, 134,   0,  69,  48,  39,
          73,  15, 288, 110,  43,  98, 213, 185]], device='cuda:0')
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([50, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  83,  91,  95,
        100, 127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 26, 39, 20, 33, 36, 12, 24,
         0, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(6.0360, device='cuda:0'), 'center': tensor(28.1354, device='cuda:0')}
top idx:  tensor([[ 99,  74, 117,  58,  91, 270,  22, 228,  68, 242, 201,  73, 251, 123,
           0,  32,  50, 232,  98,   2, 213, 190, 214, 204, 284, 138, 198,  43,
         250, 261, 225,  42,  12, 247, 178, 219, 134, 121, 181, 241,  81, 131,
          94, 218, 128,  39, 238, 205,  19,  35]], device='cuda:0')
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([50, 2])
Frame 1: Detected: 4
Frame 1: FP: 46.0, Misses: 37.0
Frame 2: Detected: 2
Frame 2: FP: 48.0, Misses: 41.0
Frame 3: Detected: 7
Frame 3: FP: 43.0, Misses: 35.0
Frame 4: Detected: 3
Frame 4: FP: 47.0, Misses: 38.0
moda: 0.0%, modp: 35.2%, prec: 8.0%, recall: 9.6%
Test, loss: 38.121778, Time: 2.404
Training...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  43
gt_cnt:  41
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 137, 153, 156, 164, 166, 170, 179, 194,
        195, 200, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 24, 12, 10,  5, 37,  8, 22, 15,  1, 41,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(5.8262, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(24.9852, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(36.6376, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  29,  30,  34,  35,  42,  44,  49,  56,  58,
         60,  62,  74,  83,  86, 127, 133, 137, 149, 153, 156, 164, 166, 179,
        210, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18,  2, 11, 33, 35, 34,  6, 39,  8, 14, 38, 27, 13, 17,
        21,  5, 40, 24,  0, 12, 10, 37, 36, 22,  9, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(5.9147, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(25.8390, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(37.6683, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  91,  95, 100,
        127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210, 220,
        223, 231, 237, 240, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 39, 20, 33, 36, 12, 24,  0,
        11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 26, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(6.0229, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(28.2166, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(40.2624, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  50,  51,  70,  72,  74,
         86,  90, 106, 121, 126, 150, 158, 159, 166, 178, 195, 200, 203, 206,
        215, 221, 228, 238, 244, 249, 250, 255, 261, 277, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 20, 26, 37,  5, 13, 21, 38, 30,  0,
         8, 22, 16, 31, 36, 12,  1, 39, 10, 23,  3, 32, 27, 17, 28, 40, 18, 29,
         2, 15, 24, 19,  9]))]
{'labels': tensor(5.9448, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(27.5023, device='cuda:0', grad_fn=<MseLossBackward0>)}
tensor(39.3918, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 2, Batch:4, loss: 9.847950, Time: 2.8
Testing...
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  43
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   8,  15,  19,  30,  34,  35,  42,  44,  49,  50,  51,  70,  72,
         74,  86, 106, 121, 126, 158, 159, 166, 178, 179, 195, 200, 203, 206,
        215, 221, 228, 232, 238, 244, 249, 250, 255, 264, 279, 283, 292]), tensor([25, 14,  7,  4, 11, 33, 35, 34,  6, 38, 20, 26, 37,  5, 13, 21, 30,  0,
         8, 16, 31, 36, 12, 22,  1, 39, 10, 23,  3, 32, 27, 15, 17, 28, 40, 18,
        29,  2, 24, 19,  9]))]
{'labels': tensor(5.4911, device='cuda:0'), 'center': tensor(26.9985, device='cuda:0')}
top idx:  tensor([[ 91, 228, 270,  22,  58,  99, 242,  74, 117, 232,  68, 251, 201, 241,
          32, 123,  42, 219,  50,  43,   0, 134, 190,  81, 138, 213, 198,  12,
         214,  39, 131, 284,  98, 283, 178, 204, 225, 250, 247,  94,   2,  73,
         165, 137,   8,  48, 148, 173,  33, 217]], device='cuda:0')
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([50, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  43
indices:  [(tensor([  0,   6,  25,  27,  29,  30,  34,  35,  42,  44,  48,  49,  51,  60,
         62,  70,  74,  86, 105, 106, 133, 137, 153, 156, 164, 166, 170, 179,
        194, 195, 210, 234, 240, 245, 248, 251, 255, 271, 283, 284, 285, 287,
        297]), tensor([14, 25,  7, 18,  2, 11, 34, 36, 35,  6, 42, 40, 26, 39, 28, 38, 13, 21,
         0, 30, 41, 24, 12, 10,  5, 37,  8, 22, 15,  1,  9, 31, 17, 20, 16,  3,
         4, 29, 19, 27, 32, 23, 33]))]
{'labels': tensor(5.1442, device='cuda:0'), 'center': tensor(24.1732, device='cuda:0')}
top idx:  tensor([[ 91,  99,  74,  68, 201, 117, 232,  50, 270, 241, 228,  22,  58, 284,
         123,   2,  32,  98, 251, 190, 242,  12, 213,  73, 138, 134, 283,   0,
         131,  81,  33, 165, 198, 185, 225,  94,  48, 203,  42, 214,  43,  14,
         205, 110, 139, 181, 194, 121, 178,  95]], device='cuda:0')
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([50, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  42
indices:  [(tensor([  6,   7,  24,  25,  27,  30,  34,  35,  42,  44,  49,  50,  56,  58,
         60,  62,  74,  83,  86,  91, 127, 133, 137, 149, 156, 166, 179, 210,
        213, 215, 220, 224, 234, 247, 251, 255, 256, 261, 271, 284, 285, 296]), tensor([25, 15, 23,  7, 18, 11, 33, 35, 34,  6, 39, 37,  8, 14, 38, 27, 13, 17,
        21, 40,  5, 12, 24,  0, 10, 36, 22,  9,  2, 16,  1, 29, 30, 20,  3,  4,
        41, 32, 28, 26, 31, 19]))]
{'labels': tensor(5.3336, device='cuda:0'), 'center': tensor(26.3728, device='cuda:0')}
top idx:  tensor([[ 91,  58, 232,  68,  22, 228, 117,  50, 284, 242,  32,  99,  74, 270,
         123, 198,   2, 201,  12,  43,  81, 190, 289, 205,  42,   0, 241, 251,
         178,  94, 204,  73, 134, 185, 165, 247, 288,  63,  30,  95, 118, 250,
         131,  14, 121,  33, 138, 285, 139,  15]], device='cuda:0')
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([50, 2])
after merge:  torch.Size([1, 128, 80, 125])
dec_spatial_shapes:  tensor([[ 80, 125]], device='cuda:0')
indices0 shape:  41
indices:  [(tensor([  6,   7,  24,  25,  27,  32,  36,  40,  44,  60,  74,  83,  91,  95,
        100, 127, 133, 137, 149, 155, 158, 165, 179, 181, 184, 195, 197, 210,
        220, 223, 231, 237, 253, 258, 264, 283, 284, 285, 288, 291, 296]), tensor([25, 15, 23,  7, 18,  8, 29,  2,  6, 37, 13, 26, 39, 20, 33, 36, 12, 24,
         0, 11, 38, 14, 34,  5,  4, 35, 32, 21,  1, 16, 10,  3, 28, 27, 31, 22,
        17, 30, 40,  9, 19]))]
{'labels': tensor(5.4833, device='cuda:0'), 'center': tensor(28.0346, device='cuda:0')}
top idx:  tensor([[ 91,  74,  50, 251,  22, 117,  58, 228, 242,  99, 232, 241,  68,  73,
         204, 270,  32,   0, 250, 213, 201, 123, 247, 205, 214, 284, 190,   2,
         283, 198,  81,  43,  12, 121, 238,  42, 134, 165,  98, 289, 225, 218,
          30, 131, 219, 288,  33, 178,  78, 106]], device='cuda:0')
pos shape:  torch.Size([300, 2])
pos_s shape:  torch.Size([50, 2])
Frame 1: Detected: 4
Frame 1: FP: 46.0, Misses: 37.0
Frame 2: Detected: 3
Frame 2: FP: 47.0, Misses: 40.0
Frame 3: Detected: 6
Frame 3: FP: 44.0, Misses: 36.0
Frame 4: Detected: 3
Frame 4: FP: 47.0, Misses: 38.0
moda: 0.0%, modp: 35.7%, prec: 8.0%, recall: 9.6%
Test, loss: 37.120894, Time: 2.332
Training...
