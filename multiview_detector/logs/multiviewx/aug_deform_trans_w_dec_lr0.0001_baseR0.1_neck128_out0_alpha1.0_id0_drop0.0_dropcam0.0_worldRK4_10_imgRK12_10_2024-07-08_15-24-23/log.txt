logs/multiviewx/aug_deform_trans_w_dec_lr0.0001_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-08_15-24-23
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 100, 'lr': 0.0001, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX'}
rpts:  torch.Size([60000, 6, 4, 2])
pos_emb size:  [ 80 125]
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6729],
        [ 0.6167, -2.6265],
        [-0.7281,  1.4702],
        [-0.8537, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.8407, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7572, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.4040e-05, -6.1168e-05],
        [-6.0332e-05, -6.1747e-05],
        [-5.9068e-05, -5.9251e-05],
        [-6.6519e-05, -6.6349e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6728],
        [ 0.6167, -2.6265],
        [-0.7280,  1.4702],
        [-0.8538, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(8.3756, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.9168, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.1977e-05, -1.0213e-04],
        [-3.8516e-05, -1.2726e-04],
        [-3.9335e-05, -1.1376e-04],
        [-3.8946e-05, -1.2573e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6728],
        [ 0.6168, -2.6265],
        [-0.7279,  1.4701],
        [-0.8537, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(7.9348, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8745, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.8120e-06, -1.6754e-04],
        [-1.5797e-05, -1.5559e-04],
        [-1.0778e-05, -1.4998e-04],
        [-1.2008e-05, -1.6541e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6168, -2.6265],
        [-0.7278,  1.4700],
        [-0.8536, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(7.1446, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7883, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 9.4122e-06, -1.4676e-04],
        [ 1.5524e-05, -1.6635e-04],
        [ 2.1761e-05, -1.6001e-04],
        [ 1.5167e-05, -1.6490e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6728],
        [ 0.6168, -2.6266],
        [-0.7278,  1.4700],
        [-0.8535, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(7.2944, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8050, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.4473e-05, -1.8974e-04],
        [ 5.3588e-05, -2.0516e-04],
        [ 5.5847e-05, -1.9719e-04],
        [ 5.6644e-05, -2.2672e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6168, -2.6266],
        [-0.7278,  1.4699],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(7.4459, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8117, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.3414e-05, -1.8716e-04],
        [ 6.6248e-05, -2.2687e-04],
        [ 5.3019e-05, -1.7200e-04],
        [ 5.1127e-05, -1.8328e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8534, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.8894, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7616, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 8.5060e-05, -2.2094e-04],
        [ 8.5336e-05, -2.1613e-04],
        [ 8.8184e-05, -2.3342e-04],
        [ 9.1744e-05, -2.0290e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4699],
        [-0.8533, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.3650, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7201, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.5691e-05, -1.8807e-04],
        [ 7.4117e-05, -1.9929e-04],
        [ 7.8974e-05, -1.8728e-04],
        [ 7.6806e-05, -2.0084e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.2434, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6978, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.9352e-05, -1.6652e-04],
        [ 7.0145e-05, -1.5868e-04],
        [ 7.5622e-05, -1.7706e-04],
        [ 7.7940e-05, -1.6444e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(7.1859, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7934, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.5691e-05, -1.8491e-04],
        [ 7.5177e-05, -1.8124e-04],
        [ 7.6989e-05, -2.0309e-04],
        [ 7.8028e-05, -1.8140e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8533, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.9465, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6727, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.9165e-05, -1.9485e-04],
        [ 7.1931e-05, -1.8745e-04],
        [ 8.7344e-05, -2.3203e-04],
        [ 7.4305e-05, -1.9436e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7278,  1.4700],
        [-0.8532, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.6725, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7447, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 5.7568e-05, -1.8104e-04],
        [ 5.7797e-05, -1.8961e-04],
        [ 5.6825e-05, -1.8301e-04],
        [ 5.3398e-05, -1.8078e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(7.5487, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8274, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0274e-04, -2.1694e-04],
        [ 9.0537e-05, -1.6741e-04],
        [ 9.2945e-05, -2.0485e-04],
        [ 9.7640e-05, -1.8638e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8532, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(9.4157, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0090, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4700],
        [-0.8532, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(7.8856, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8645, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0967e-04, -1.8262e-04],
        [ 9.8939e-05, -1.9386e-04],
        [ 1.0192e-04, -1.8431e-04],
        [ 1.0053e-04, -1.8215e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.9904, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6798, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6726],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4701],
        [-0.8533, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(7.5697, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8407, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7279,  1.4702],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(7.4637, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.8295, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4228e-04, -1.3895e-04],
        [ 1.3302e-04, -1.0616e-04],
        [ 1.3636e-04, -1.1589e-04],
        [ 1.4025e-04, -9.9176e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3111,  0.6727],
        [ 0.6169, -2.6265],
        [-0.7280,  1.4702],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(7.0942, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7930, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0002],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6727],
        [ 0.6169, -2.6266],
        [-0.7280,  1.4702],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.1358, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6895, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6169, -2.6266],
        [-0.7280,  1.4702],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.1215, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6914, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0002, -0.0001],
        [ 0.0002, -0.0001],
        [ 0.0002, -0.0001],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6170, -2.6266],
        [-0.7280,  1.4702],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.1269, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6927, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 0.0001, -0.0001],
        [ 0.0001, -0.0001],
        [ 0.0002, -0.0002],
        [ 0.0001, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6728],
        [ 0.6170, -2.6266],
        [-0.7280,  1.4702],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.9451, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7748, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.2699e-04, -8.7478e-05],
        [ 1.5120e-04, -1.0355e-04],
        [ 1.4150e-04, -5.3464e-05],
        [ 1.3377e-04, -4.1443e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6729],
        [ 0.6170, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.6904, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7527, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.7107e-04, -7.6615e-05],
        [ 1.6313e-04, -3.7601e-05],
        [ 1.6379e-04, -8.0435e-05],
        [ 1.8652e-04, -7.9744e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3110,  0.6729],
        [ 0.6171, -2.6265],
        [-0.7281,  1.4703],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.2458, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6037, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4258e-04, -8.4942e-05],
        [ 1.3646e-04, -8.5432e-05],
        [ 1.4140e-04, -4.7895e-05],
        [ 1.3205e-04, -8.0443e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6729],
        [ 0.6171, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.7148, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6462, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4944e-04, -9.0433e-05],
        [ 1.3933e-04, -4.6266e-05],
        [ 1.4506e-04, -7.7473e-05],
        [ 1.4150e-04, -8.6324e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6729],
        [ 0.6171, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.2880, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0446, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7179, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5112e-04, -4.1467e-05],
        [ 1.2384e-04, -5.7984e-05],
        [ 1.5272e-04, -4.9068e-05],
        [ 1.6502e-04, -3.1410e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6172, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.6319, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7316, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5757e-04, -7.6347e-05],
        [ 1.7557e-04, -1.0462e-04],
        [ 1.5862e-04, -7.9663e-05],
        [ 1.6968e-04, -5.3586e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6172, -2.6265],
        [-0.7281,  1.4704],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.4584, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0422, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6303, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5661e-04, -8.7103e-05],
        [ 1.3756e-04, -7.8173e-05],
        [ 1.2930e-04, -8.2812e-05],
        [ 1.5421e-04, -6.7569e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6730],
        [ 0.6172, -2.6265],
        [-0.7282,  1.4704],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.0105, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0427, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5865, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5157e-04, -8.9560e-05],
        [ 1.4960e-04, -9.7508e-05],
        [ 1.6171e-04, -6.6101e-05],
        [ 1.5935e-04, -7.6718e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7281,  1.4704],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.7494, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6534, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.3431e-04, -1.2755e-04],
        [ 1.4291e-04, -9.6924e-05],
        [ 1.4218e-04, -1.0688e-04],
        [ 1.5013e-04, -1.1204e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7282,  1.4704],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.4166, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6096, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.0844e-04, -5.3477e-05],
        [ 1.2963e-04, -5.1329e-05],
        [ 1.0249e-04, -2.0778e-05],
        [ 9.7500e-05, -6.4375e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6731],
        [ 0.6173, -2.6265],
        [-0.7282,  1.4705],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.4239, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.7231, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.4845e-04, -2.3988e-05],
        [ 1.3340e-04, -5.7616e-05],
        [ 1.4742e-04, -3.6639e-05],
        [ 1.5511e-04, -4.3711e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3109,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.7194, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6411, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 9.4247e-05, -1.5731e-05],
        [ 8.4531e-05, -1.3978e-05],
        [ 9.4255e-05, -1.0564e-05],
        [ 1.3744e-04, -8.7596e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6732],
        [ 0.6173, -2.6265],
        [-0.7282,  1.4705],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.0698, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5778, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 8.1196e-05, -3.8775e-05],
        [ 8.1337e-05, -2.8056e-05],
        [ 9.7571e-05, -5.7670e-06],
        [ 1.1436e-04, -2.5602e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.0486, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6794, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[9.9163e-05, 2.6671e-05],
        [8.9784e-05, 4.8283e-05],
        [1.0084e-04, 1.4951e-05],
        [1.0809e-04, 2.5483e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6733],
        [ 0.6174, -2.6264],
        [-0.7281,  1.4705],
        [-0.8534, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.1863, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6004, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 7.7144e-05, -1.4966e-05],
        [ 6.8163e-05, -1.1817e-06],
        [ 7.6804e-05, -2.4351e-05],
        [ 9.1903e-05,  1.3824e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6732],
        [ 0.6174, -2.6265],
        [-0.7282,  1.4705],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.7746, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6522, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.0028e-04, 4.1025e-05],
        [1.1081e-04, 3.9986e-05],
        [7.5737e-05, 9.8197e-06],
        [8.1606e-05, 2.7349e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6733],
        [ 0.6175, -2.6264],
        [-0.7282,  1.4705],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.1701, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6912, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.1395e-04, 4.1919e-05],
        [9.0136e-05, 7.3460e-05],
        [5.7827e-05, 4.3964e-05],
        [8.9625e-05, 9.2332e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6733],
        [ 0.6175, -2.6264],
        [-0.7282,  1.4706],
        [-0.8535, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.7885, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5513, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.0339e-05, 1.5955e-05],
        [6.2011e-05, 4.6956e-05],
        [5.0407e-05, 5.4870e-05],
        [7.0219e-05, 4.5596e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6733],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.4994, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0304, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6107, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.2143e-04, 5.8072e-05],
        [4.8079e-05, 7.1741e-05],
        [5.4297e-05, 6.5937e-05],
        [6.3878e-05, 4.0367e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.5364, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0431, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6399, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.3445e-05, 4.5778e-05],
        [1.7602e-05, 4.9136e-05],
        [8.4193e-06, 2.6263e-05],
        [1.8382e-05, 6.4202e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8535, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.2591, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5051, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.7832e-05, 5.5789e-05],
        [6.3319e-05, 7.4386e-05],
        [5.9635e-05, 5.8628e-05],
        [5.5453e-05, 1.9022e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6734],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8534, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.2850, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6074, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.6958e-05, 3.7873e-05],
        [1.6832e-05, 1.0560e-05],
        [3.8851e-05, 2.5111e-05],
        [7.1155e-06, 4.7582e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6734],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8534, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.1497, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4932, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.6177e-05, 6.0166e-05],
        [4.7241e-05, 4.6969e-05],
        [1.8079e-05, 4.2626e-05],
        [2.4296e-05, 3.6628e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6735],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4706],
        [-0.8534, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.2800, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6085, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[8.4819e-05, 9.2081e-05],
        [6.4196e-05, 9.2787e-05],
        [5.0926e-05, 9.2349e-05],
        [7.0529e-05, 1.2290e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6736],
        [ 0.6175, -2.6265],
        [-0.7282,  1.4707],
        [-0.8533, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.6106, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6310, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.4678e-05, 1.2371e-05],
        [2.5632e-05, 4.6510e-05],
        [6.7214e-05, 1.8764e-05],
        [2.2196e-05, 3.4596e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6735],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.3830, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0309, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5000, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[8.3666e-05, 1.9574e-05],
        [5.4240e-05, 1.8797e-05],
        [2.4077e-05, 1.1864e-05],
        [5.4716e-05, 1.7334e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6735],
        [ 0.6176, -2.6266],
        [-0.7282,  1.4706],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.3366, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6088, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 3.9294e-05,  2.7323e-05],
        [-4.3107e-07,  2.5144e-05],
        [-6.1309e-06,  1.4441e-05],
        [-1.6550e-05,  3.3967e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6736],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8533, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.4304, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6153, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2649e-05,  2.7924e-05],
        [ 3.1250e-07, -3.2698e-05],
        [ 5.8295e-06,  1.6346e-05],
        [-1.2797e-05,  1.0527e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6736],
        [ 0.6175, -2.6267],
        [-0.7282,  1.4706],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.7891, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5487, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.1445e-06,  3.7035e-05],
        [-4.1622e-05,  1.1024e-05],
        [-3.2561e-06,  3.6289e-05],
        [-2.7574e-05,  4.7226e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6736],
        [ 0.6175, -2.6266],
        [-0.7282,  1.4706],
        [-0.8532, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.2831, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6106, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[6.1504e-05, 4.6659e-05],
        [2.2028e-05, 3.1392e-05],
        [5.1180e-05, 6.7591e-05],
        [4.1286e-05, 4.4531e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.0876, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5771, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.5485e-05, 7.1897e-05],
        [3.2741e-05, 5.1397e-05],
        [2.4341e-05, 5.2889e-05],
        [1.0150e-05, 7.4336e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.2507, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0432, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5114, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.1124e-05, 1.9873e-05],
        [1.1281e-05, 2.6852e-05],
        [1.7148e-05, 4.3768e-05],
        [3.3530e-06, 3.7010e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6737],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.4090, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6107, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.7711e-05, 5.9753e-05],
        [3.9638e-05, 6.2484e-05],
        [5.1315e-05, 6.0402e-05],
        [5.2875e-05, 7.8484e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6738],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.4606, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0471, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5403, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.2343e-05, 5.2232e-05],
        [1.0366e-06, 3.2548e-05],
        [1.2671e-05, 6.2952e-05],
        [2.2688e-05, 5.2541e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6738],
        [ 0.6175, -2.6266],
        [-0.7281,  1.4706],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(6.0630, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6848, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[4.4417e-05, 7.9605e-05],
        [9.9303e-05, 4.5094e-05],
        [5.8744e-05, 5.2520e-05],
        [9.8513e-05, 1.0523e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6738],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8529, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.7925, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0482, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6757, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.9349e-05, 1.0867e-04],
        [1.4746e-05, 1.5336e-04],
        [1.3708e-05, 9.8110e-05],
        [4.1874e-05, 1.4658e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6739],
        [ 0.6176, -2.6265],
        [-0.7281,  1.4707],
        [-0.8529, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.9897, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5741, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 4.9344e-05, -4.1508e-05],
        [ 6.3882e-05,  1.2589e-05],
        [ 4.2784e-05, -3.1907e-05],
        [ 4.1183e-05, -1.3204e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6738],
        [ 0.6176, -2.6266],
        [-0.7281,  1.4706],
        [-0.8529, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.4183, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6146, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 9.5992e-06,  1.7433e-05],
        [ 2.0828e-05, -1.9454e-05],
        [ 2.6783e-05, -2.8854e-05],
        [ 3.9827e-06, -4.3799e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6739],
        [ 0.6176, -2.6267],
        [-0.7281,  1.4706],
        [-0.8529, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.2144, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4998, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[5.2443e-05, 5.8555e-05],
        [5.0697e-05, 3.4034e-05],
        [3.7122e-05, 6.6408e-05],
        [4.8537e-05, 7.7634e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6740],
        [ 0.6176, -2.6266],
        [-0.7280,  1.4707],
        [-0.8528, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.1438, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5855, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 2.7786e-05,  1.3849e-05],
        [ 3.1427e-05, -1.3226e-05],
        [ 3.9097e-05,  5.7560e-07],
        [-6.5400e-06,  2.0036e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6740],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4706],
        [-0.8529, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.0097, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4770, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.6014e-05, 2.7758e-05],
        [4.2880e-05, 5.2969e-05],
        [4.5979e-05, 3.8665e-05],
        [2.8825e-05, 3.7214e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6740],
        [ 0.6176, -2.6266],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.2140, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5027, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.1610e-05, 6.5964e-05],
        [9.8448e-06, 6.9823e-05],
        [1.8636e-05, 3.2273e-05],
        [9.8351e-06, 1.4057e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6741],
        [ 0.6175, -2.6266],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.3925, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5135, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 6.3164e-05, -1.0862e-05],
        [ 4.5673e-05,  3.9871e-06],
        [ 4.3600e-05, -9.7168e-06],
        [ 3.1667e-05,  3.7568e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6741],
        [ 0.6176, -2.6267],
        [-0.7280,  1.4707],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.5091, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5308, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.9151e-05, 1.1403e-04],
        [1.8954e-05, 1.0016e-04],
        [5.1585e-05, 8.8198e-05],
        [6.1515e-06, 7.6787e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6742],
        [ 0.6175, -2.6266],
        [-0.7279,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.3642, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6173, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[1.4563e-05, 4.0546e-05],
        [3.2230e-05, 1.9299e-05],
        [6.8100e-05, 3.2317e-06],
        [3.3146e-05, 2.9918e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6742],
        [ 0.6175, -2.6267],
        [-0.7279,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.9823, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5842, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.8936e-05, -3.2628e-05],
        [-3.5270e-05, -3.8620e-06],
        [-3.9194e-05, -1.1835e-05],
        [-4.1676e-05,  9.4019e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6742],
        [ 0.6174, -2.6267],
        [-0.7280,  1.4708],
        [-0.8529, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.9915, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4781, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4096e-05,  2.5606e-05],
        [ 1.3907e-05,  5.4266e-06],
        [-1.9887e-05, -2.3455e-05],
        [ 1.0718e-05,  5.3577e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6743],
        [ 0.6174, -2.6267],
        [-0.7280,  1.4708],
        [-0.8528, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.3381, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0445, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5229, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.2711e-05, -8.9309e-06],
        [ 4.2031e-05,  1.9427e-05],
        [ 1.4747e-05, -1.7103e-05],
        [ 1.4629e-05,  1.4999e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6743],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4708],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.5596, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5317, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7825e-05,  9.5852e-05],
        [-9.9865e-06,  9.5621e-05],
        [-2.8039e-05,  6.3809e-05],
        [ 2.6784e-05,  5.8830e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6744],
        [ 0.6174, -2.6266],
        [-0.7280,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.3540, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6129, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.0541e-06,  5.2428e-05],
        [ 1.4300e-05,  2.6158e-05],
        [ 1.4050e-05,  4.3802e-05],
        [-9.8009e-06,  5.3708e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6744],
        [ 0.6174, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.7470, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4510, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 2.2975e-05,  5.0136e-05],
        [ 2.2420e-05,  9.0909e-05],
        [ 3.9362e-05,  5.6396e-05],
        [-1.3781e-06,  2.6375e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6745],
        [ 0.6174, -2.6266],
        [-0.7279,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.9117, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5729, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.0608e-06, -1.4242e-05],
        [ 1.3158e-05,  2.7958e-05],
        [-2.0912e-05,  2.1193e-07],
        [ 3.3155e-05,  2.0951e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6744],
        [ 0.6173, -2.6267],
        [-0.7280,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.7464, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6583, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[6.0849e-06, 6.3830e-05],
        [7.6190e-06, 4.8668e-05],
        [7.6127e-07, 2.0773e-05],
        [6.7398e-06, 7.8700e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6746],
        [ 0.6173, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.5019, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5262, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.7072e-05, 7.6116e-05],
        [3.2608e-05, 1.5052e-05],
        [3.4501e-05, 6.0398e-05],
        [2.3815e-05, 5.4693e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6746],
        [ 0.6173, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.6156, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5372, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[3.3809e-05, 9.3141e-05],
        [2.7169e-05, 9.6800e-05],
        [6.4492e-05, 5.7560e-05],
        [3.2201e-05, 8.6986e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6747],
        [ 0.6173, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.5804, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5407, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[2.6614e-05, 8.3592e-05],
        [4.7897e-05, 7.7653e-05],
        [4.3013e-06, 6.2587e-05],
        [6.1774e-05, 9.2143e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6747],
        [ 0.6173, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.7073, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5408, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9170e-05, -2.7336e-05],
        [-1.2587e-05,  7.1152e-05],
        [ 9.4050e-07, -2.3006e-05],
        [-3.3341e-06, -4.9319e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6746],
        [ 0.6173, -2.6267],
        [-0.7279,  1.4710],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.2184, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0286, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5791, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1113e-05,  2.5528e-05],
        [-7.0133e-05,  3.5724e-05],
        [-5.6858e-05,  6.2976e-05],
        [-2.9220e-05,  5.0613e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6747],
        [ 0.6172, -2.6267],
        [-0.7280,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.6770, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0337, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5351, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2170e-05,  1.1452e-06],
        [-2.7380e-05,  4.7300e-05],
        [-5.5313e-05,  1.2395e-05],
        [-2.6514e-05,  4.0811e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6747],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.6000, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5356, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1556e-05, -2.6061e-05],
        [-2.1227e-05,  9.8426e-06],
        [-2.4564e-05, -2.0448e-05],
        [-2.7867e-05,  2.5210e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6747],
        [ 0.6172, -2.6268],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.6192, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4411, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.4133e-05,  3.7647e-05],
        [-1.0024e-05, -2.4616e-05],
        [ 8.6044e-06,  4.6231e-05],
        [-2.6985e-06,  1.3043e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6748],
        [ 0.6172, -2.6268],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.1595, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4855, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 8.9067e-07,  4.4528e-05],
        [-5.0999e-05,  3.4460e-05],
        [-3.6939e-05,  3.9675e-05],
        [-1.9337e-05,  6.6195e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6749],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.8438, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5564, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.8068e-05,  5.0829e-05],
        [-3.7987e-05,  2.5039e-05],
        [-2.8850e-05,  5.2273e-06],
        [-5.1606e-05,  1.1483e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6749],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.3580, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5186, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.9129e-05,  5.1712e-05],
        [-8.6162e-05,  6.9888e-05],
        [-4.1994e-05,  8.6109e-05],
        [-3.6947e-05,  3.4291e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6750],
        [ 0.6171, -2.6267],
        [-0.7279,  1.4712],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.1516, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5927, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.5938e-05,  3.5538e-05],
        [-5.4121e-05,  3.7651e-05],
        [-6.8858e-05,  1.9233e-05],
        [-3.6584e-05,  6.6457e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6750],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.6017, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6315, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[ 1.5516e-05, -3.4549e-05],
        [-1.0969e-05, -1.3083e-05],
        [-1.7776e-05,  2.1769e-05],
        [ 3.0920e-05, -7.5494e-07]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6750],
        [ 0.6172, -2.6268],
        [-0.7278,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.7125, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4471, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6514e-05,  2.0798e-06],
        [-2.6320e-05,  4.9013e-05],
        [ 1.8167e-05,  1.5627e-05],
        [-1.1103e-05,  1.5550e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6750],
        [ 0.6172, -2.6267],
        [-0.7278,  1.4711],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.1547, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4861, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9623e-05, -1.4335e-05],
        [-5.1237e-05, -1.8663e-05],
        [-7.6730e-05, -2.0883e-05],
        [-3.4708e-05, -3.7311e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6751],
        [ 0.6171, -2.6267],
        [-0.7278,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.3428, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5086, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5103e-04,  1.6975e-05],
        [-1.1926e-04,  2.6133e-05],
        [-1.3438e-04,  8.7047e-05],
        [-1.1823e-04,  4.2194e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6751],
        [ 0.6171, -2.6267],
        [-0.7279,  1.4712],
        [-0.8529, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.5645, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5309, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.2916e-05, -6.8395e-06],
        [-5.1241e-05,  6.9476e-06],
        [-6.8392e-05, -2.3697e-05],
        [-6.9422e-05,  1.0584e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6752],
        [ 0.6171, -2.6267],
        [-0.7278,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.5520, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5372, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.1770e-05, -2.0538e-05],
        [-4.4798e-05,  4.5965e-06],
        [-9.7282e-05, -9.1537e-05],
        [-7.6606e-05, -5.1825e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6752],
        [ 0.6171, -2.6267],
        [-0.7278,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.1094, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4844, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2030e-04, -2.6268e-05],
        [-6.7737e-05, -1.5020e-05],
        [-5.8425e-05, -7.8926e-05],
        [-7.1605e-05, -2.9280e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6752],
        [ 0.6171, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.8909, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4710, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.8863e-05, -2.8176e-05],
        [-9.7316e-05, -6.6316e-05],
        [-3.8314e-05, -2.5267e-05],
        [-4.4229e-05, -4.5581e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6753],
        [ 0.6170, -2.6267],
        [-0.7277,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.1964, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4863, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2343e-04, -6.1086e-05],
        [-1.2149e-04, -7.7596e-05],
        [-1.7223e-04, -6.9698e-05],
        [-1.0963e-04, -1.6113e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6753],
        [ 0.6170, -2.6267],
        [-0.7278,  1.4711],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.7601, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5519, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.2687e-05, -9.9060e-05],
        [-6.8216e-05, -6.6001e-05],
        [-1.0622e-04, -7.7983e-05],
        [-9.5060e-05, -8.8103e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6753],
        [ 0.6170, -2.6267],
        [-0.7277,  1.4711],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.2787, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5060, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.2866e-05, -2.1895e-05],
        [-6.2801e-05, -4.7636e-05],
        [-7.3445e-05, -5.5896e-05],
        [-9.5883e-05, -2.0149e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6754],
        [ 0.6170, -2.6267],
        [-0.7277,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.1101, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5851, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.2780e-05, -6.3874e-05],
        [-5.9334e-05, -8.4177e-06],
        [-3.6495e-05, -2.4452e-05],
        [-2.2884e-05, -2.9631e-08]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6755],
        [ 0.6170, -2.6266],
        [-0.7276,  1.4712],
        [-0.8528, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.2269, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5961, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:100, loss: 0.005961, Time: 40.0
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0065e-04, -1.0732e-04],
        [-1.1454e-04, -4.0611e-05],
        [-1.1852e-04, -5.7812e-05],
        [-1.7141e-04, -2.1318e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6755],
        [ 0.6170, -2.6267],
        [-0.7277,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.4032, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5140, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.8858e-05, -9.6673e-05],
        [-9.6658e-05, -1.1194e-04],
        [-7.9745e-05, -3.4696e-05],
        [-8.3424e-05, -9.9906e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6755],
        [ 0.6170, -2.6267],
        [-0.7276,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.7829, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5463, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.2820e-05,  9.5929e-07],
        [-1.3462e-04,  2.8468e-05],
        [-7.9782e-05, -2.4097e-05],
        [-6.2658e-05, -1.5853e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6757],
        [ 0.6169, -2.6266],
        [-0.7276,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.4658, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4204, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.9475e-05, -9.0257e-05],
        [-5.7622e-05, -2.9956e-05],
        [-5.9989e-05, -6.5673e-05],
        [-8.8644e-05, -6.9840e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6757],
        [ 0.6170, -2.6267],
        [-0.7275,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.6455, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4349, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.6947e-05, -1.1767e-04],
        [-8.4033e-05, -7.8759e-05],
        [-2.9520e-05, -5.1446e-05],
        [-4.1858e-05, -8.3832e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6757],
        [ 0.6170, -2.6267],
        [-0.7275,  1.4712],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.7412, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4481, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.6096e-05, -1.3039e-04],
        [-3.4700e-05, -1.1863e-04],
        [-3.0582e-05, -1.3750e-04],
        [-2.1977e-05, -1.4712e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6757],
        [ 0.6171, -2.6268],
        [-0.7275,  1.4711],
        [-0.8529, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(5.5234, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.6287, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.1358e-05, -5.7222e-05],
        [-5.9538e-06, -6.5907e-05],
        [-2.7003e-05, -3.1881e-05],
        [-4.9331e-05, -4.7602e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6759],
        [ 0.6171, -2.6267],
        [-0.7274,  1.4712],
        [-0.8529, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.7085, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4524, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0203e-04, -9.7263e-05],
        [-9.0799e-05, -1.5519e-04],
        [-1.2822e-04, -1.2204e-04],
        [-1.1199e-04, -1.2390e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6759],
        [ 0.6170, -2.6268],
        [-0.7275,  1.4711],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.3866, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4218, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0771e-04, -7.4535e-05],
        [-8.7860e-05, -1.2923e-04],
        [-8.2300e-05, -1.7075e-04],
        [-8.5413e-05, -1.4219e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6759],
        [ 0.6171, -2.6268],
        [-0.7275,  1.4711],
        [-0.8530, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.7561, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3563, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6444e-04, -1.1997e-04],
        [-1.5543e-04, -6.4889e-05],
        [-1.2198e-04, -1.2209e-04],
        [-1.4328e-04, -8.1281e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6759],
        [ 0.6170, -2.6267],
        [-0.7275,  1.4711],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.8196, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5642, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.5278e-05,  2.2571e-05],
        [-6.5358e-05, -1.0837e-05],
        [-5.1624e-05, -6.9136e-07],
        [-4.9948e-05, -2.8485e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6761],
        [ 0.6171, -2.6267],
        [-0.7274,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.7927, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4529, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.9405e-05, -6.1596e-05],
        [-8.4293e-05, -3.4173e-05],
        [-9.8895e-05, -5.9513e-05],
        [-5.6259e-05, -3.9871e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6761],
        [ 0.6171, -2.6267],
        [-0.7274,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.9080, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4631, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.6686e-05, -5.1067e-06],
        [-8.5133e-05, -3.1659e-05],
        [-1.1835e-04, -6.0588e-05],
        [-1.0522e-04, -2.6234e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6762],
        [ 0.6171, -2.6267],
        [-0.7274,  1.4712],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.4980, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5283, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.6165e-05, -1.1471e-04],
        [-2.3905e-05, -6.3867e-05],
        [-1.1513e-05, -9.7904e-05],
        [-7.3947e-05, -1.2457e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6761],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4711],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.0067, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4754, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3614e-04, -1.0417e-04],
        [-1.2498e-04, -4.2185e-05],
        [-1.0424e-04, -4.8806e-05],
        [-1.1333e-04, -6.0308e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6762],
        [ 0.6171, -2.6267],
        [-0.7274,  1.4712],
        [-0.8531, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.8238, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4525, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.6522e-05, -6.6130e-05],
        [-5.9625e-05, -2.6703e-05],
        [-6.2323e-05, -7.5614e-05],
        [-7.0182e-05, -1.2515e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6763],
        [ 0.6172, -2.6267],
        [-0.7273,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.8181, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4534, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.6748e-05, -7.2524e-05],
        [-3.0584e-05, -8.3513e-05],
        [-1.9012e-05, -1.2283e-05],
        [-5.2179e-05, -4.9451e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6763],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.2745, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4957, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2278e-04, -1.3572e-04],
        [-1.0410e-04, -9.2739e-05],
        [-1.1009e-04, -1.2051e-04],
        [-1.0652e-04, -1.6677e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6763],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4711],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.0447, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4854, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.4828e-05, -5.1173e-05],
        [ 3.0651e-05, -2.6957e-05],
        [-2.7642e-05, -3.8473e-05],
        [-2.4107e-05, -5.9862e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6765],
        [ 0.6173, -2.6267],
        [-0.7272,  1.4712],
        [-0.8530, -2.7500]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.0487, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4833, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.5771e-05, -7.8770e-05],
        [-2.6218e-05, -6.0122e-06],
        [-2.1727e-05, -4.0768e-05],
        [-1.4064e-05, -1.9356e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6765],
        [ 0.6173, -2.6267],
        [-0.7272,  1.4712],
        [-0.8530, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.5390, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5347, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0285e-04, -6.2564e-05],
        [-1.1020e-04, -7.3374e-05],
        [-1.2485e-04, -5.5247e-05],
        [-9.7037e-05, -1.8996e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6765],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4712],
        [-0.8531, -2.7501]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.0928, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3911, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.9757e-05, -2.1364e-05],
        [-1.0568e-04, -3.6061e-05],
        [-9.1753e-05, -5.8287e-06],
        [-9.0399e-05, -6.6511e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6766],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4712],
        [-0.8530, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.3650, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0434, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5232, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2297e-04, -1.9427e-05],
        [-1.4084e-04, -4.7647e-05],
        [-1.3358e-04, -1.2384e-04],
        [-1.2543e-04, -3.7515e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6767],
        [ 0.6172, -2.6268],
        [-0.7273,  1.4711],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.7372, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4615, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6273e-04, -9.1975e-05],
        [-2.1743e-04, -1.2139e-04],
        [-2.1804e-04, -2.2349e-05],
        [-2.1468e-04, -9.3540e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6766],
        [ 0.6171, -2.6269],
        [-0.7274,  1.4712],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.7349, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4455, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0385e-04, -5.8602e-05],
        [-1.7086e-04, -1.0710e-04],
        [-1.0043e-04, -7.2078e-05],
        [-1.3740e-04, -9.0446e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3108,  0.6767],
        [ 0.6172, -2.6269],
        [-0.7273,  1.4711],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.2831, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0424, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4131, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2926e-04, -4.3900e-05],
        [-1.1517e-04,  7.2599e-06],
        [-1.1993e-04, -4.3304e-05],
        [-1.1080e-04, -7.9361e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6768],
        [ 0.6173, -2.6267],
        [-0.7273,  1.4712],
        [-0.8530, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.7536, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0428, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3610, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7135e-04, -6.2991e-05],
        [-1.6386e-04, -1.3491e-04],
        [-1.8680e-04, -4.4265e-05],
        [-1.7744e-04, -8.1663e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6768],
        [ 0.6172, -2.6269],
        [-0.7274,  1.4712],
        [-0.8531, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.6118, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4436, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7684e-04, -3.9600e-05],
        [-2.2142e-04, -9.7383e-05],
        [-2.1871e-04, -4.9848e-05],
        [-1.3386e-04, -3.1902e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6768],
        [ 0.6172, -2.6268],
        [-0.7274,  1.4712],
        [-0.8530, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.3228, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4091, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2715e-04, -8.7127e-05],
        [-1.3249e-04, -1.0250e-04],
        [-1.3115e-04, -6.9213e-05],
        [-1.4270e-04, -1.0173e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6768],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4712],
        [-0.8530, -2.7499]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.1474, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4853, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9766e-04, -8.0336e-05],
        [-2.1117e-04, -5.9683e-05],
        [-2.2257e-04, -5.9928e-05],
        [-2.1537e-04, -8.3162e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6769],
        [ 0.6172, -2.6268],
        [-0.7274,  1.4712],
        [-0.8531, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.7167, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3455, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1085e-04, -1.2139e-04],
        [-1.8503e-04, -8.0336e-05],
        [-1.7987e-04, -4.0655e-05],
        [-1.5278e-04, -6.7056e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6768],
        [ 0.6172, -2.6268],
        [-0.7274,  1.4712],
        [-0.8530, -2.7498]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.7430, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0451, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4644, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7850e-04,  1.7424e-05],
        [-1.9981e-04,  3.7008e-05],
        [-1.5342e-04, -3.5830e-05],
        [-1.8481e-04,  2.1464e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6770],
        [ 0.6173, -2.6267],
        [-0.7273,  1.4712],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.2945, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4043, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6509e-04, -1.7032e-05],
        [-1.5672e-04,  9.3051e-05],
        [-1.9936e-04,  2.8068e-05],
        [-1.3360e-04,  2.2759e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6770],
        [ 0.6173, -2.6267],
        [-0.7274,  1.4713],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.0695, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3827, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0950e-04,  1.9528e-05],
        [-7.9696e-05,  1.5221e-05],
        [-1.4883e-04,  2.1917e-05],
        [-8.6761e-05, -1.9370e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6771],
        [ 0.6174, -2.6267],
        [-0.7273,  1.4713],
        [-0.8529, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.5838, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4412, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5274e-04,  6.9579e-06],
        [-1.1994e-04,  7.3667e-06],
        [-1.1548e-04, -3.4093e-05],
        [-1.2163e-04, -1.8051e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6771],
        [ 0.6174, -2.6267],
        [-0.7273,  1.4712],
        [-0.8530, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.5938, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5410, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.0516e-04,  2.3728e-05],
        [-2.5179e-04,  4.9329e-05],
        [-2.3189e-04, -4.7985e-05],
        [-2.9765e-04,  4.2309e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6771],
        [ 0.6172, -2.6267],
        [-0.7274,  1.4712],
        [-0.8531, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.2822, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3990, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6003e-04, -5.5424e-05],
        [-1.7021e-04, -7.9175e-05],
        [-1.4193e-04, -9.5464e-05],
        [-1.4108e-04, -5.1259e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6771],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4712],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.4352, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4153, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9308e-04, -4.1843e-05],
        [-1.8314e-04, -3.7180e-05],
        [-2.0113e-04, -6.9302e-05],
        [-1.4593e-04, -4.1766e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6771],
        [ 0.6173, -2.6268],
        [-0.7274,  1.4712],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.1342, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0315, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3764, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2742e-04, -3.9706e-05],
        [-2.5459e-04, -1.0058e-04],
        [-2.8728e-04, -6.4447e-05],
        [-2.4041e-04, -1.1135e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6772],
        [ 0.6172, -2.6268],
        [-0.7274,  1.4713],
        [-0.8531, -2.7497]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.0591, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3776, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2035e-04, -6.1335e-05],
        [-2.3099e-04, -5.2102e-05],
        [-2.3906e-04, -1.0056e-04],
        [-2.2767e-04, -6.0665e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6772],
        [ 0.6173, -2.6268],
        [-0.7274,  1.4712],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.9141, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3679, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9220e-04,  1.7787e-05],
        [-2.3815e-04,  9.0992e-06],
        [-1.9057e-04, -5.6483e-05],
        [-2.5062e-04, -1.4945e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6773],
        [ 0.6173, -2.6267],
        [-0.7273,  1.4713],
        [-0.8531, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.5904, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4418, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7974e-04, -8.5612e-05],
        [-2.2137e-04, -4.7408e-05],
        [-1.7171e-04, -1.3964e-04],
        [-2.0659e-04, -8.2545e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6772],
        [ 0.6173, -2.6268],
        [-0.7273,  1.4712],
        [-0.8530, -2.7496]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.2359, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5051, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2091e-04, -3.3403e-05],
        [-3.3716e-04, -6.5097e-05],
        [-3.1769e-04,  9.7098e-06],
        [-2.1822e-04, -4.6022e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6772],
        [ 0.6172, -2.6268],
        [-0.7274,  1.4714],
        [-0.8530, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.3436, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4062, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5328e-04, -4.2069e-05],
        [-2.5843e-04, -2.9554e-05],
        [-2.7404e-04,  2.9028e-05],
        [-2.8006e-04, -9.1470e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6773],
        [ 0.6172, -2.6268],
        [-0.7274,  1.4714],
        [-0.8531, -2.7495]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.5359, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3227, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.4714e-04, -7.9472e-05],
        [-2.6787e-04,  4.9257e-05],
        [-2.2152e-04, -6.4106e-05],
        [-1.8508e-04, -3.5466e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6773],
        [ 0.6172, -2.6267],
        [-0.7273,  1.4713],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.0526, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0339, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4731, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.6590e-04,  1.0292e-04],
        [-2.1758e-04,  5.2578e-05],
        [-1.6569e-04,  2.9765e-05],
        [-2.2320e-04,  6.3886e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6775],
        [ 0.6173, -2.6267],
        [-0.7273,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.9687, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3781, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.8946e-04,  4.3050e-05],
        [-2.4508e-04,  1.0434e-04],
        [-2.8630e-04,  6.0677e-05],
        [-2.2165e-04,  6.7407e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6775],
        [ 0.6172, -2.6266],
        [-0.7274,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.0009, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4753, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.1951e-04, -3.6052e-05],
        [-3.6824e-04, -5.8180e-05],
        [-3.3136e-04, -3.9876e-05],
        [-3.3436e-04, -9.3847e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6774],
        [ 0.6171, -2.6268],
        [-0.7275,  1.4714],
        [-0.8531, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.3265, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4008, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9577e-04, -1.1888e-04],
        [-3.3451e-04, -6.5353e-05],
        [-2.7723e-04, -5.4001e-05],
        [-3.4249e-04, -2.3224e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6774],
        [ 0.6172, -2.6268],
        [-0.7274,  1.4713],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.9304, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3699, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.8483e-04, -6.9172e-05],
        [-2.9246e-04, -7.0823e-05],
        [-3.0740e-04, -4.2745e-05],
        [-2.4749e-04, -3.8091e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6775],
        [ 0.6172, -2.6268],
        [-0.7274,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  33
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.1842, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3900, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1677e-04, -6.9667e-05],
        [-2.5547e-04, -4.3882e-05],
        [-2.4471e-04, -1.0509e-04],
        [-2.3191e-04, -1.0691e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6775],
        [ 0.6173, -2.6268],
        [-0.7274,  1.4713],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.9123, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0312, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3536, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5396e-04,  1.0939e-05],
        [-2.2518e-04,  2.2677e-05],
        [-2.4687e-04,  4.5528e-06],
        [-2.3210e-04, -1.0468e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6776],
        [ 0.6173, -2.6267],
        [-0.7274,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.1514, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4897, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.4689e-04, -5.7087e-05],
        [-2.4433e-04,  5.7729e-07],
        [-3.5413e-04, -4.1880e-05],
        [-3.0445e-04, -2.9829e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6776],
        [ 0.6173, -2.6267],
        [-0.7275,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.0594, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0482, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4024, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0003, -0.0001],
        [-0.0003, -0.0001],
        [-0.0003, -0.0002],
        [-0.0003, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6776],
        [ 0.6173, -2.6268],
        [-0.7274,  1.4713],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.2026, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3903, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.0453e-04, -3.8891e-05],
        [-3.8234e-04, -1.5963e-04],
        [-4.0875e-04, -3.8962e-05],
        [-3.1600e-04, -8.7355e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6777],
        [ 0.6172, -2.6268],
        [-0.7275,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.6994, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3435, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0003, -0.0002],
        [-0.0003, -0.0001],
        [-0.0003, -0.0002],
        [-0.0003, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6776],
        [ 0.6173, -2.6268],
        [-0.7275,  1.4713],
        [-0.8530, -2.7494]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.4520, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4179, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.9436e-04, -1.0760e-04],
        [-3.9666e-04, -9.4282e-05],
        [-3.8325e-04, -1.6957e-04],
        [-4.1751e-04, -1.0564e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6777],
        [ 0.6172, -2.6268],
        [-0.7275,  1.4713],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.8490, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3650, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.4674e-04, -6.0545e-05],
        [-3.0661e-04, -5.4110e-05],
        [-2.8976e-04, -1.1450e-04],
        [-2.5486e-04, -1.0004e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3107,  0.6778],
        [ 0.6173, -2.6267],
        [-0.7274,  1.4714],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.2689, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0417, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4104, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.6975e-04, -1.3010e-04],
        [-4.0555e-04, -1.2223e-04],
        [-2.8365e-04, -7.4553e-05],
        [-3.6759e-04, -1.2098e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6777],
        [ 0.6173, -2.6268],
        [-0.7274,  1.4715],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.9745, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3765, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.8191e-04, -9.7987e-06],
        [-2.6962e-04, -1.1483e-04],
        [-3.4059e-04, -3.1982e-05],
        [-3.5578e-04, -6.8270e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6779],
        [ 0.6174, -2.6268],
        [-0.7274,  1.4715],
        [-0.8530, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.1032, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4923, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.1426e-04, -7.2325e-05],
        [-3.1050e-04, -6.2537e-05],
        [-2.6060e-04, -5.8585e-05],
        [-3.0723e-04, -2.4602e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6779],
        [ 0.6174, -2.6267],
        [-0.7274,  1.4715],
        [-0.8530, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.5415, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4354, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0004, -0.0002],
        [-0.0004, -0.0002],
        [-0.0003, -0.0001],
        [-0.0003, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6778],
        [ 0.6173, -2.6268],
        [-0.7275,  1.4715],
        [-0.8530, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.7298, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3470, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.5972e-04, -1.3992e-04],
        [-2.3040e-04, -5.3567e-05],
        [-3.2362e-04, -7.4173e-05],
        [-3.2969e-04, -3.1941e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6780],
        [ 0.6175, -2.6267],
        [-0.7274,  1.4716],
        [-0.8530, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.7006, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4559, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0004, -0.0002],
        [-0.0003, -0.0002],
        [-0.0004, -0.0002],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3106,  0.6780],
        [ 0.6174, -2.6268],
        [-0.7275,  1.4715],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.9857, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3822, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.8891e-04, -4.2345e-05],
        [-4.8477e-04, -8.7555e-05],
        [-4.7115e-04, -5.0389e-05],
        [-4.5907e-04, -9.8033e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6782],
        [ 0.6173, -2.6267],
        [-0.7276,  1.4717],
        [-0.8532, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(4.4523, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.5173, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0005, -0.0002],
        [-0.0006, -0.0003],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6782],
        [ 0.6173, -2.6268],
        [-0.7277,  1.4716],
        [-0.8531, -2.7493]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.9118, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2672, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.1500e-04, -8.7788e-05],
        [-4.1492e-04, -8.6179e-05],
        [-4.8625e-04, -7.1252e-05],
        [-3.9617e-04, -7.8184e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6783],
        [ 0.6174, -2.6266],
        [-0.7276,  1.4718],
        [-0.8531, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.5583, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3274, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-4.2013e-04, -1.1941e-04],
        [-4.5565e-04, -1.5079e-04],
        [-3.2885e-04, -8.8774e-05],
        [-4.0013e-04, -1.5825e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6783],
        [ 0.6174, -2.6267],
        [-0.7275,  1.4718],
        [-0.8531, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.5950, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4316, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0001],
        [-0.0006, -0.0002],
        [-0.0005, -0.0001],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6784],
        [ 0.6173, -2.6267],
        [-0.7277,  1.4719],
        [-0.8533, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.9899, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4720, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0001],
        [-0.0006, -0.0002],
        [-0.0006, -0.0002],
        [-0.0005, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6785],
        [ 0.6173, -2.6267],
        [-0.7277,  1.4719],
        [-0.8532, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.4781, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3301, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0004, -0.0002],
        [-0.0005, -0.0001],
        [-0.0005, -0.0002],
        [-0.0005, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3105,  0.6785],
        [ 0.6174, -2.6266],
        [-0.7277,  1.4719],
        [-0.8532, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.2673, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4014, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0003],
        [-0.0005, -0.0001],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6785],
        [ 0.6174, -2.6266],
        [-0.7277,  1.4719],
        [-0.8532, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.1986, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3943, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6786],
        [ 0.6174, -2.6267],
        [-0.7277,  1.4720],
        [-0.8533, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.4052, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0314, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4033, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0003],
        [-0.0005, -0.0002],
        [-0.0005, -0.0001],
        [-0.0005, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6786],
        [ 0.6174, -2.6266],
        [-0.7276,  1.4721],
        [-0.8532, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.4039, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3151, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.6667e-04, -1.2092e-04],
        [-5.4099e-04, -1.0745e-04],
        [-5.7205e-04, -1.0060e-04],
        [-4.7897e-04, -9.3399e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6788],
        [ 0.6174, -2.6265],
        [-0.7277,  1.4722],
        [-0.8533, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.4454, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3207, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0003],
        [-0.0007, -0.0003],
        [-0.0008, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6787],
        [ 0.6172, -2.6267],
        [-0.7279,  1.4721],
        [-0.8534, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.2445, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3961, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0006, -0.0002],
        [-0.0006, -0.0002],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6788],
        [ 0.6173, -2.6266],
        [-0.7278,  1.4722],
        [-0.8534, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.1514, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3914, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0004, -0.0001],
        [-0.0005, -0.0002],
        [-0.0004, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6788],
        [ 0.6176, -2.6266],
        [-0.7276,  1.4722],
        [-0.8532, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.3222, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3116, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0003],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6789],
        [ 0.6173, -2.6267],
        [-0.7278,  1.4722],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.4262, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3232, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0008, -0.0002],
        [-0.0007, -0.0003],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6790],
        [ 0.6173, -2.6267],
        [-0.7278,  1.4722],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.0036, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3760, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0003],
        [-0.0007, -0.0002],
        [-0.0006, -0.0003],
        [-0.0005, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6790],
        [ 0.6174, -2.6267],
        [-0.7278,  1.4722],
        [-0.8533, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.4140, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3173, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0005, -0.0002],
        [-0.0007, -0.0002],
        [-0.0006, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6791],
        [ 0.6174, -2.6267],
        [-0.7277,  1.4723],
        [-0.8533, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.4323, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4244, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0003],
        [-0.0008, -0.0003],
        [-0.0008, -0.0003],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6790],
        [ 0.6173, -2.6268],
        [-0.7279,  1.4723],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.6640, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0326, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3316, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0003],
        [-0.0008, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6792],
        [ 0.6173, -2.6267],
        [-0.7278,  1.4724],
        [-0.8534, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.5339, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3349, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0002],
        [-0.0007, -0.0002],
        [-0.0005, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6793],
        [ 0.6175, -2.6267],
        [-0.7277,  1.4724],
        [-0.8534, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.1483, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2876, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0003],
        [-0.0007, -0.0004],
        [-0.0007, -0.0004],
        [-0.0007, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6792],
        [ 0.6174, -2.6269],
        [-0.7278,  1.4723],
        [-0.8535, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.8367, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2636, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0003],
        [-0.0006, -0.0003],
        [-0.0007, -0.0002],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6793],
        [ 0.6176, -2.6268],
        [-0.7279,  1.4724],
        [-0.8533, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.4415, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.4255, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0006, -0.0001],
        [-0.0005, -0.0001],
        [-0.0006, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6794],
        [ 0.6176, -2.6267],
        [-0.7277,  1.4725],
        [-0.8533, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.5202, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3266, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0006, -0.0002],
        [-0.0006, -0.0002],
        [-0.0005, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6794],
        [ 0.6176, -2.6267],
        [-0.7278,  1.4725],
        [-0.8533, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.2288, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2939, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0006, -0.0003],
        [-0.0007, -0.0002],
        [-0.0008, -0.0003],
        [-0.0008, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6794],
        [ 0.6175, -2.6268],
        [-0.7280,  1.4724],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.7384, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2408, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0008, -0.0003],
        [-0.0008, -0.0002],
        [-0.0009, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6795],
        [ 0.6175, -2.6268],
        [-0.7280,  1.4725],
        [-0.8536, -2.7492]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.9207, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3699, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0008, -0.0002],
        [-0.0007, -0.0002],
        [-0.0008, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6796],
        [ 0.6176, -2.6268],
        [-0.7280,  1.4726],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.9851, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3769, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0003],
        [-0.0010, -0.0002],
        [-0.0009, -0.0002],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6795],
        [ 0.6174, -2.6267],
        [-0.7282,  1.4726],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.3841, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3134, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0002],
        [-0.0010, -0.0002],
        [-0.0009, -0.0003],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6796],
        [ 0.6174, -2.6268],
        [-0.7282,  1.4725],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.3503, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3178, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0003],
        [-0.0007, -0.0003],
        [-0.0008, -0.0004],
        [-0.0009, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6796],
        [ 0.6177, -2.6268],
        [-0.7282,  1.4724],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.7701, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3460, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002],
        [-0.0007, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6797],
        [ 0.6178, -2.6267],
        [-0.7280,  1.4726],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.6292, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3392, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0010, -0.0002],
        [-0.0009, -0.0002],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6798],
        [ 0.6176, -2.6267],
        [-0.7283,  1.4727],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.7296, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3516, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.1356e-04, -9.7768e-05],
        [-7.8678e-04, -3.8049e-05],
        [-8.8323e-04, -8.3557e-05],
        [-9.3735e-04, -8.9172e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6799],
        [ 0.6178, -2.6266],
        [-0.7283,  1.4728],
        [-0.8536, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.7250, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3478, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0009, -0.0002],
        [-0.0008, -0.0002],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6798],
        [ 0.6177, -2.6267],
        [-0.7282,  1.4727],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.6211, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3411, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0008, -0.0002],
        [-0.0007, -0.0002],
        [-0.0009, -0.0002],
        [-0.0008, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6798],
        [ 0.6179, -2.6267],
        [-0.7283,  1.4727],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.2842, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2979, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:200, loss: 0.001490, Time: 76.7
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0003],
        [-0.0010, -0.0003],
        [-0.0009, -0.0003],
        [-0.0009, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6797],
        [ 0.6176, -2.6268],
        [-0.7283,  1.4726],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.5375, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0432, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3401, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0001],
        [-0.0010, -0.0002],
        [-0.0010, -0.0002],
        [-0.0010, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6799],
        [ 0.6177, -2.6267],
        [-0.7285,  1.4727],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.0106, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2794, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0009, -0.0003],
        [-0.0009, -0.0002],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6799],
        [ 0.6178, -2.6268],
        [-0.7284,  1.4728],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.7519, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3537, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.6664e-04, -8.5461e-05],
        [-5.8301e-04, -2.2863e-04],
        [-7.1265e-04, -7.0024e-05],
        [-5.4082e-04, -1.5340e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6799],
        [ 0.6181, -2.6268],
        [-0.7282,  1.4729],
        [-0.8532, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.3010, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0332, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2964, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0007, -0.0002],
        [-0.0007, -0.0001],
        [-0.0006, -0.0001],
        [-0.0008, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6798],
        [ 0.6180, -2.6267],
        [-0.7281,  1.4728],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.6201, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3365, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0010, -0.0001],
        [-0.0011, -0.0002],
        [-0.0010, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6798],
        [ 0.6177, -2.6267],
        [-0.7286,  1.4728],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.2404, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0315, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2871, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0002],
        [-0.0009, -0.0002],
        [-0.0009, -0.0002],
        [-0.0010, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6798],
        [ 0.6178, -2.6268],
        [-0.7285,  1.4728],
        [-0.8536, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.4496, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3231, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0267e-03, -1.9561e-04],
        [-1.0145e-03, -1.0906e-04],
        [-1.1237e-03, -6.3168e-05],
        [-9.7899e-04, -1.0231e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6798],
        [ 0.6177, -2.6267],
        [-0.7287,  1.4729],
        [-0.8536, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.9174, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0475, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2867, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.7088e-04, -1.5820e-04],
        [-8.6977e-04, -1.2067e-04],
        [-8.7337e-04, -9.7330e-05],
        [-8.7470e-04, -1.1050e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6799],
        [ 0.6178, -2.6267],
        [-0.7285,  1.4729],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.1044, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2854, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.2275e-04, -1.6496e-04],
        [-9.2320e-04, -1.8488e-04],
        [-9.1389e-04, -9.3092e-05],
        [-7.5589e-04, -1.0581e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6798],
        [ 0.6178, -2.6268],
        [-0.7286,  1.4729],
        [-0.8533, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.9159, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0446, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2809, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0642e-03, -8.2825e-05],
        [-1.2425e-03, -9.1997e-05],
        [-1.2203e-03, -4.6163e-05],
        [-1.2047e-03, -8.5538e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6799],
        [ 0.6174, -2.6267],
        [-0.7289,  1.4730],
        [-0.8537, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.4118, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3219, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013, -0.0002],
        [-0.0013, -0.0001],
        [-0.0014, -0.0002],
        [-0.0013, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6797],
        [ 0.6173, -2.6267],
        [-0.7291,  1.4729],
        [-0.8538, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.8596, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0313, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2486, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-6.8496e-04, -7.9333e-05],
        [-7.5122e-04, -3.2145e-05],
        [-7.2623e-04, -3.9321e-05],
        [-5.3737e-04, -5.3282e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6799],
        [ 0.6179, -2.6266],
        [-0.7284,  1.4731],
        [-0.8530, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.5993, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3328, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0761e-03, -1.3187e-04],
        [-1.0939e-03, -1.2103e-04],
        [-1.0080e-03, -9.2298e-05],
        [-1.0361e-03, -8.1855e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6798],
        [ 0.6176, -2.6267],
        [-0.7287,  1.4730],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.6429, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3416, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0099e-03, -1.4708e-04],
        [-8.7182e-04, -1.2702e-04],
        [-1.0213e-03, -1.3055e-04],
        [-7.8642e-04, -8.6825e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6798],
        [ 0.6178, -2.6268],
        [-0.7287,  1.4730],
        [-0.8532, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.4545, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3220, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012, -0.0003],
        [-0.0011, -0.0002],
        [-0.0012, -0.0003],
        [-0.0011, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6797],
        [ 0.6176, -2.6269],
        [-0.7289,  1.4728],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.8083, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0428, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2664, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0001],
        [-0.0009, -0.0001],
        [-0.0010, -0.0001],
        [-0.0010, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6798],
        [ 0.6177, -2.6268],
        [-0.7288,  1.4731],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.7051, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3480, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0011, -0.0002],
        [-0.0012, -0.0002],
        [-0.0011, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6798],
        [ 0.6175, -2.6269],
        [-0.7289,  1.4730],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4886, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2308, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0011, -0.0003],
        [-0.0011, -0.0003],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6797],
        [ 0.6176, -2.6270],
        [-0.7289,  1.4729],
        [-0.8534, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.9667, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2708, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0341e-03, -1.1815e-04],
        [-1.0510e-03, -1.6787e-04],
        [-9.8415e-04, -1.1091e-04],
        [-1.0343e-03, -1.5863e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6799],
        [ 0.6176, -2.6269],
        [-0.7287,  1.4731],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.6698, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3395, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.6246e-04, -8.7702e-05],
        [-1.0052e-03, -1.3981e-04],
        [-9.8314e-04, -1.7397e-04],
        [-9.8654e-04, -2.1824e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6799],
        [ 0.6176, -2.6268],
        [-0.7287,  1.4731],
        [-0.8534, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.3477, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3114, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0003],
        [-0.0009, -0.0003],
        [-0.0008, -0.0003],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6798],
        [ 0.6177, -2.6270],
        [-0.7285,  1.4730],
        [-0.8533, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.9164, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3669, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0890e-03, -6.6568e-05],
        [-1.0501e-03, -2.2914e-05],
        [-1.0996e-03, -9.2868e-05],
        [-1.1004e-03, -4.8893e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6800],
        [ 0.6175, -2.6267],
        [-0.7288,  1.4732],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.4786, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0451, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3381, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0002],
        [-0.0009, -0.0002],
        [-0.0008, -0.0002],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6798],
        [ 0.6177, -2.6269],
        [-0.7285,  1.4731],
        [-0.8533, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.0291, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2740, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-7.6620e-04, -1.2885e-04],
        [-7.6733e-04, -1.9419e-04],
        [-7.9305e-04, -9.7847e-05],
        [-7.5358e-04, -1.2922e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3104,  0.6799],
        [ 0.6178, -2.6269],
        [-0.7285,  1.4733],
        [-0.8531, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.6506, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0473, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3597, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011, -0.0002],
        [-0.0012, -0.0002],
        [-0.0011, -0.0001],
        [-0.0011, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6799],
        [ 0.6173, -2.6269],
        [-0.7288,  1.4732],
        [-0.8535, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.8490, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0322, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2493, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1522e-03,  5.9030e-05],
        [-1.2128e-03, -3.2710e-05],
        [-1.0857e-03,  2.3757e-05],
        [-1.1540e-03,  5.0640e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6801],
        [ 0.6173, -2.6267],
        [-0.7287,  1.4734],
        [-0.8535, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.4610, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3145, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009, -0.0002],
        [-0.0010, -0.0002],
        [-0.0010, -0.0001],
        [-0.0010, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6799],
        [ 0.6176, -2.6269],
        [-0.7287,  1.4733],
        [-0.8533, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.2724, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3066, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0010, -0.0002],
        [-0.0009, -0.0001],
        [-0.0009, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6799],
        [ 0.6175, -2.6269],
        [-0.7285,  1.4733],
        [-0.8533, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.3993, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3111, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.1431e-04, -6.2240e-05],
        [-8.5458e-04,  4.3384e-06],
        [-8.0992e-04, -2.9982e-05],
        [-8.6310e-04, -2.0740e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3103,  0.6800],
        [ 0.6176, -2.6267],
        [-0.7284,  1.4734],
        [-0.8532, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.9422, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2699, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013, -0.0002],
        [-0.0010, -0.0002],
        [-0.0010, -0.0001],
        [-0.0011, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6799],
        [ 0.6174, -2.6269],
        [-0.7286,  1.4733],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.8217, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2615, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1721e-03, -5.9490e-05],
        [-1.1528e-03, -1.3698e-04],
        [-1.2586e-03, -6.2828e-05],
        [-1.2070e-03, -1.0326e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6801],
        [ 0.6173, -2.6269],
        [-0.7289,  1.4734],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.6908, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2528, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0487e-03, -1.3244e-05],
        [-9.9715e-04, -2.5842e-05],
        [-1.0641e-03, -2.9837e-05],
        [-8.6561e-04, -1.1730e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6801],
        [ 0.6174, -2.6267],
        [-0.7287,  1.4734],
        [-0.8531, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.3118, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3067, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1825e-03, -8.8425e-05],
        [-1.0279e-03, -1.3965e-04],
        [-1.2603e-03, -9.4032e-05],
        [-1.0856e-03, -9.9298e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6801],
        [ 0.6174, -2.6269],
        [-0.7288,  1.4734],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.3934, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0438, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3270, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0780e-03, -9.8975e-05],
        [-1.2890e-03, -1.0408e-04],
        [-1.1063e-03, -8.7616e-05],
        [-1.2726e-03, -4.4447e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6801],
        [ 0.6171, -2.6268],
        [-0.7287,  1.4734],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4712, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2221, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.2904e-04, -4.1523e-05],
        [-9.1549e-04, -2.5249e-05],
        [-9.0172e-04, -5.2413e-05],
        [-8.1831e-04, -4.3038e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6801],
        [ 0.6175, -2.6267],
        [-0.7285,  1.4734],
        [-0.8531, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.9753, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2691, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3398e-03, -7.4026e-05],
        [-1.1797e-03, -8.2366e-05],
        [-1.0699e-03,  1.8512e-05],
        [-1.2835e-03, -9.0865e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6801],
        [ 0.6172, -2.6268],
        [-0.7286,  1.4735],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.5536, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0334, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2222, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1613e-03, -3.2841e-05],
        [-1.1578e-03, -3.8717e-05],
        [-9.7537e-04, -7.5580e-05],
        [-1.0054e-03, -5.8630e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6802],
        [ 0.6172, -2.6268],
        [-0.7285,  1.4734],
        [-0.8533, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.6247, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3400, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3169e-03,  3.6192e-05],
        [-1.4972e-03,  1.0408e-04],
        [-1.4389e-03,  8.7647e-05],
        [-1.4019e-03,  4.1827e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6802],
        [ 0.6169, -2.6266],
        [-0.7290,  1.4736],
        [-0.8537, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.1880, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2860, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0133e-03, -6.2609e-05],
        [-1.0372e-03, -1.1200e-04],
        [-1.0925e-03, -2.5258e-05],
        [-9.4470e-04, -1.0975e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6801],
        [ 0.6173, -2.6268],
        [-0.7286,  1.4735],
        [-0.8532, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.2951, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0441, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3177, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0008, -0.0001],
        [-0.0010, -0.0001],
        [-0.0008, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6800],
        [ 0.6175, -2.6269],
        [-0.7285,  1.4733],
        [-0.8531, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.7933, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3532, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0151e-03, -6.7808e-05],
        [-1.0607e-03, -1.0223e-04],
        [-9.1854e-04, -1.5902e-04],
        [-1.0429e-03, -6.2499e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6801],
        [ 0.6172, -2.6268],
        [-0.7284,  1.4733],
        [-0.8533, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.6880, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2436, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1181e-03,  6.2349e-06],
        [-1.1336e-03,  8.2487e-05],
        [-9.3174e-04,  5.5583e-05],
        [-9.6814e-04,  5.8900e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6802],
        [ 0.6171, -2.6267],
        [-0.7284,  1.4735],
        [-0.8532, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.7303, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0456, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3641, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2299e-03,  3.3847e-05],
        [-1.2677e-03,  8.0990e-06],
        [-1.2477e-03,  5.8966e-05],
        [-1.1214e-03, -3.6944e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6802],
        [ 0.6170, -2.6267],
        [-0.7287,  1.4736],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.8734, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2731, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4991e-03, -5.7220e-06],
        [-1.2901e-03, -2.9391e-05],
        [-1.2084e-03, -4.6678e-05],
        [-1.3468e-03, -3.9361e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6802],
        [ 0.6170, -2.6268],
        [-0.7287,  1.4735],
        [-0.8536, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.7057, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2409, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010, -0.0002],
        [-0.0010, -0.0001],
        [-0.0008, -0.0002],
        [-0.0010, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6801],
        [ 0.6173, -2.6269],
        [-0.7283,  1.4734],
        [-0.8533, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.1849, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0323, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2831, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0145e-03, -4.1442e-05],
        [-1.1690e-03,  2.7400e-05],
        [-1.2270e-03, -1.7538e-05],
        [-1.0845e-03, -8.4204e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6802],
        [ 0.6171, -2.6267],
        [-0.7287,  1.4735],
        [-0.8534, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.6181, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2385, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2565e-03, -3.2910e-05],
        [-1.3443e-03, -9.0378e-05],
        [-1.3169e-03, -7.4685e-05],
        [-1.2003e-03, -1.0402e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6803],
        [ 0.6169, -2.6268],
        [-0.7288,  1.4735],
        [-0.8535, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.5290, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2305, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1454e-03, -7.6009e-06],
        [-9.9749e-04, -1.2362e-04],
        [-9.8439e-04, -1.2161e-05],
        [-1.0381e-03, -1.9575e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6803],
        [ 0.6172, -2.6269],
        [-0.7284,  1.4735],
        [-0.8533, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.7549, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2536, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2747e-03, -1.2976e-05],
        [-1.2728e-03, -1.0654e-04],
        [-1.2665e-03, -6.8650e-05],
        [-1.3659e-03, -9.0315e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6804],
        [ 0.6169, -2.6268],
        [-0.7287,  1.4735],
        [-0.8537, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.9000, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2680, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.8159e-04,  7.0917e-05],
        [-9.8048e-04,  5.1588e-06],
        [-1.1662e-03,  6.9334e-05],
        [-9.1030e-04,  8.3079e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6805],
        [ 0.6172, -2.6267],
        [-0.7286,  1.4736],
        [-0.8532, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.9306, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0466, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3863, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-8.8639e-04, -5.1987e-05],
        [-9.9145e-04, -4.0147e-05],
        [-1.0465e-03, -3.1485e-05],
        [-1.0333e-03, -1.3921e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6804],
        [ 0.6172, -2.6268],
        [-0.7285,  1.4736],
        [-0.8533, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.9315, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2604, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.0777e-04,  8.7987e-06],
        [-9.9059e-04,  8.1500e-05],
        [-1.1030e-03, -3.2969e-05],
        [-1.1343e-03,  1.5195e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6805],
        [ 0.6172, -2.6266],
        [-0.7285,  1.4736],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.8506, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2639, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3810e-03, -7.2740e-05],
        [-1.1935e-03, -1.2322e-04],
        [-1.1696e-03, -1.4265e-04],
        [-1.3154e-03, -6.7754e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6805],
        [ 0.6169, -2.6268],
        [-0.7286,  1.4735],
        [-0.8536, -2.7491]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.5665, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0421, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2409, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1920e-03,  9.6439e-05],
        [-1.1743e-03,  1.0045e-04],
        [-1.2193e-03,  1.3720e-04],
        [-1.3828e-03,  1.4492e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6807],
        [ 0.6169, -2.6266],
        [-0.7286,  1.4738],
        [-0.8536, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.7113, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3481, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0231e-03,  9.2917e-05],
        [-1.1238e-03,  3.5071e-05],
        [-1.1368e-03,  8.8750e-05],
        [-1.0374e-03,  7.2629e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6807],
        [ 0.6170, -2.6267],
        [-0.7285,  1.4738],
        [-0.8533, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.1384, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2936, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0001],
        [-0.0012,  0.0001],
        [-0.0010,  0.0001],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6808],
        [ 0.6169, -2.6266],
        [-0.7284,  1.4738],
        [-0.8536, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.5316, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2346, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0001],
        [-0.0012,  0.0002],
        [-0.0012,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6808],
        [ 0.6169, -2.6265],
        [-0.7286,  1.4739],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.3346, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0320, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2975, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0002],
        [-0.0012,  0.0002],
        [-0.0013,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6809],
        [ 0.6169, -2.6265],
        [-0.7287,  1.4740],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.0859, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2874, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1273e-03,  1.2907e-04],
        [-1.0132e-03,  5.7071e-05],
        [-1.1388e-03,  1.1261e-04],
        [-1.2949e-03,  1.9170e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6809],
        [ 0.6171, -2.6266],
        [-0.7286,  1.4739],
        [-0.8535, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.9865, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2676, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1632e-03,  5.9944e-05],
        [-1.2302e-03,  9.8550e-05],
        [-1.0351e-03,  4.7013e-05],
        [-1.1343e-03,  3.7017e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6808],
        [ 0.6168, -2.6266],
        [-0.7285,  1.4738],
        [-0.8533, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.8821, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2669, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0001],
        [-0.0011,  0.0002],
        [-0.0011,  0.0003],
        [-0.0011,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6809],
        [ 0.6170, -2.6265],
        [-0.7286,  1.4741],
        [-0.8533, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.6429, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2374, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-9.8690e-04, -3.3623e-05],
        [-1.0733e-03,  6.1066e-05],
        [-9.7536e-04,  5.1847e-05],
        [-9.9820e-04,  5.5949e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6808],
        [ 0.6170, -2.6266],
        [-0.7284,  1.4739],
        [-0.8532, -2.7490]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.9228, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2705, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0013,  0.0003],
        [-0.0013,  0.0003],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6811],
        [ 0.6167, -2.6264],
        [-0.7288,  1.4742],
        [-0.8535, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2429, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0409, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2060, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0002],
        [-0.0011,  0.0002],
        [-0.0012,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6811],
        [ 0.6169, -2.6265],
        [-0.7287,  1.4741],
        [-0.8533, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.0581, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2734, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0587e-03,  1.2011e-04],
        [-1.1378e-03,  1.3533e-04],
        [-1.1052e-03,  7.9516e-05],
        [-1.1605e-03,  1.2654e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6811],
        [ 0.6169, -2.6265],
        [-0.7286,  1.4740],
        [-0.8533, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.0946, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0296, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2687, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0015,  0.0002],
        [-0.0014,  0.0003],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6812],
        [ 0.6165, -2.6265],
        [-0.7289,  1.4742],
        [-0.8535, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4763, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2232, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3119e-03,  1.9041e-04],
        [-1.1780e-03,  9.4261e-05],
        [-1.2629e-03,  9.3304e-05],
        [-9.6748e-04,  1.1415e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6812],
        [ 0.6168, -2.6266],
        [-0.7287,  1.4741],
        [-0.8531, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.9639, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0460, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2884, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2361e-03,  1.2589e-04],
        [-1.0647e-03,  1.0435e-04],
        [-9.5124e-04,  4.1632e-05],
        [-1.1878e-03,  1.5285e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6812],
        [ 0.6169, -2.6266],
        [-0.7284,  1.4740],
        [-0.8533, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.2711, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0452, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3174, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0001],
        [-0.0010,  0.0002],
        [-0.0011,  0.0001],
        [-0.0010,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6813],
        [ 0.6170, -2.6265],
        [-0.7286,  1.4742],
        [-0.8532, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.3764, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2052, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0014,  0.0003],
        [-0.0015,  0.0003],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6814],
        [ 0.6166, -2.6264],
        [-0.7290,  1.4744],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4174, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2125, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2262e-03,  1.7594e-04],
        [-1.1703e-03,  1.6217e-04],
        [-1.2870e-03,  1.1795e-04],
        [-1.1121e-03,  9.4852e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6814],
        [ 0.6168, -2.6265],
        [-0.7288,  1.4742],
        [-0.8532, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.0679, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2808, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0009,  0.0002],
        [-0.0010,  0.0002],
        [-0.0010,  0.0002],
        [-0.0010,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6815],
        [ 0.6170, -2.6264],
        [-0.7285,  1.4743],
        [-0.8531, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.5269, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2289, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0003],
        [-0.0012,  0.0003],
        [-0.0011,  0.0002],
        [-0.0011,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6816],
        [ 0.6168, -2.6264],
        [-0.7287,  1.4743],
        [-0.8532, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.6188, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2381, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0014,  0.0002],
        [-0.0014,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6816],
        [ 0.6165, -2.6264],
        [-0.7289,  1.4745],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.5568, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2278, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002],
        [-0.0011,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6815],
        [ 0.6166, -2.6265],
        [-0.7289,  1.4743],
        [-0.8532, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.5731, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2310, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0003],
        [-0.0012,  0.0003],
        [-0.0010,  0.0003],
        [-0.0012,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6817],
        [ 0.6168, -2.6264],
        [-0.7285,  1.4745],
        [-0.8534, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4898, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2315, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0013,  0.0003],
        [-0.0016,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6817],
        [ 0.6166, -2.6263],
        [-0.7291,  1.4745],
        [-0.8535, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4964, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0471, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2438, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0003],
        [-0.0011,  0.0002],
        [-0.0013,  0.0002],
        [-0.0010,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6817],
        [ 0.6169, -2.6265],
        [-0.7288,  1.4744],
        [-0.8532, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.6738, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2503, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0017,  0.0004],
        [-0.0015,  0.0004],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6818],
        [ 0.6162, -2.6262],
        [-0.7291,  1.4746],
        [-0.8538, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.6041, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2302, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0016,  0.0004],
        [-0.0017,  0.0004],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6819],
        [ 0.6164, -2.6262],
        [-0.7292,  1.4747],
        [-0.8537, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0403, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1783, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0015,  0.0005],
        [-0.0015,  0.0005],
        [-0.0015,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6819],
        [ 0.6165, -2.6261],
        [-0.7290,  1.4747],
        [-0.8536, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.2233, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2888, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0001],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002],
        [-0.0013,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6816],
        [ 0.6167, -2.6264],
        [-0.7289,  1.4744],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.6406, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2366, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0012,  0.0002],
        [-0.0015,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6818],
        [ 0.6167, -2.6264],
        [-0.7290,  1.4746],
        [-0.8534, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.7500, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2541, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0014,  0.0002],
        [-0.0015,  0.0002],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6817],
        [ 0.6165, -2.6264],
        [-0.7290,  1.4745],
        [-0.8537, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.5393, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0422, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3383, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.0545e-03,  7.5042e-05],
        [-1.1339e-03,  2.4553e-05],
        [-1.0711e-03,  5.9548e-05],
        [-1.3530e-03,  5.1497e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6816],
        [ 0.6168, -2.6265],
        [-0.7286,  1.4743],
        [-0.8534, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(3.1311, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3928, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0014,  0.0004],
        [-0.0013,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6817],
        [ 0.6165, -2.6262],
        [-0.7288,  1.4746],
        [-0.8535, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.8604, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2605, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0015,  0.0004],
        [-0.0014,  0.0002],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6817],
        [ 0.6164, -2.6262],
        [-0.7289,  1.4745],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2862, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2044, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1813e-03,  1.3773e-04],
        [-1.1242e-03,  4.3610e-05],
        [-1.3290e-03,  1.8979e-04],
        [-1.2353e-03,  1.6705e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6816],
        [ 0.6168, -2.6265],
        [-0.7288,  1.4745],
        [-0.8533, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.8303, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2507, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0017,  0.0002],
        [-0.0018,  0.0002],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6817],
        [ 0.6163, -2.6263],
        [-0.7293,  1.4745],
        [-0.8536, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2450, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0314, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1873, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0013,  0.0003],
        [-0.0014,  0.0003],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6818],
        [ 0.6167, -2.6263],
        [-0.7289,  1.4746],
        [-0.8535, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0545, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1735, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0006],
        [-0.0019,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6819],
        [ 0.6162, -2.6261],
        [-0.7293,  1.4749],
        [-0.8538, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.8821, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0322, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2526, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0013,  0.0001],
        [-0.0012,  0.0001],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6817],
        [ 0.6167, -2.6264],
        [-0.7286,  1.4744],
        [-0.8534, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4501, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2210, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2558e-03,  7.7009e-05],
        [-1.1683e-03,  5.2100e-05],
        [-1.3777e-03,  6.1524e-05],
        [-1.1998e-03,  1.1021e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6816],
        [ 0.6169, -2.6265],
        [-0.7288,  1.4744],
        [-0.8531, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.0380, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2896, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0002],
        [-0.0014,  0.0002],
        [-0.0012,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6817],
        [ 0.6166, -2.6264],
        [-0.7287,  1.4745],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.9716, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0461, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2893, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0015,  0.0003],
        [-0.0013,  0.0002],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6818],
        [ 0.6166, -2.6263],
        [-0.7288,  1.4745],
        [-0.8533, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.9830, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2706, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.1365e-03,  1.2508e-04],
        [-1.1472e-03,  1.7275e-04],
        [-1.3370e-03,  8.2375e-05],
        [-1.2849e-03,  1.4780e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6817],
        [ 0.6170, -2.6264],
        [-0.7288,  1.4744],
        [-0.8531, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.8608, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2684, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0015,  0.0002],
        [-0.0017,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6818],
        [ 0.6166, -2.6263],
        [-0.7291,  1.4746],
        [-0.8534, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4022, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0329, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2061, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0001],
        [-0.0013,  0.0002],
        [-0.0015,  0.0002],
        [-0.0015,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6817],
        [ 0.6168, -2.6264],
        [-0.7289,  1.4745],
        [-0.8533, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0877, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0467, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2022, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0014,  0.0002],
        [-0.0017,  0.0003],
        [-0.0018,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6819],
        [ 0.6167, -2.6263],
        [-0.7291,  1.4747],
        [-0.8536, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.6677, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2395, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:300, loss: 0.000798, Time: 111.4
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4612e-03,  9.3286e-05],
        [-1.2015e-03,  9.5512e-05],
        [-1.3596e-03,  7.7902e-05],
        [-1.4223e-03,  3.5486e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6817],
        [ 0.6170, -2.6264],
        [-0.7288,  1.4745],
        [-0.8532, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.7793, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2486, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0002],
        [-0.0018,  0.0002],
        [-0.0016,  0.0003],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6818],
        [ 0.6164, -2.6262],
        [-0.7289,  1.4747],
        [-0.8532, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0813, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1878, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0013,  0.0001],
        [-0.0014,  0.0001],
        [-0.0012,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6818],
        [ 0.6169, -2.6264],
        [-0.7288,  1.4745],
        [-0.8530, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.7236, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2493, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4980e-03,  1.1161e-04],
        [-1.6016e-03,  1.1087e-04],
        [-1.5520e-03,  9.3690e-05],
        [-1.5323e-03,  1.4031e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6818],
        [ 0.6166, -2.6263],
        [-0.7289,  1.4745],
        [-0.8532, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4190, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2128, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0016,  0.0002],
        [-0.0014,  0.0001],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6818],
        [ 0.6167, -2.6263],
        [-0.7287,  1.4746],
        [-0.8530, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.3027, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0313, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1928, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7062e-03,  1.8882e-04],
        [-1.6066e-03,  1.7470e-04],
        [-1.6806e-03,  1.5100e-04],
        [-1.4502e-03,  8.2453e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6818],
        [ 0.6167, -2.6263],
        [-0.7290,  1.4746],
        [-0.8531, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4958, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0455, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2406, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6604e-03,  1.8479e-04],
        [-1.4118e-03, -1.5841e-05],
        [-1.7149e-03,  1.4881e-04],
        [-1.4790e-03,  1.0987e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6818],
        [ 0.6169, -2.6265],
        [-0.7291,  1.4746],
        [-0.8532, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.6880, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2516, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0012,  0.0002],
        [-0.0013,  0.0002],
        [-0.0012,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6171, -2.6262],
        [-0.7286,  1.4746],
        [-0.8528, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2030, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0439, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2081, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.3761e-03,  1.4460e-04],
        [-1.1099e-03,  1.2608e-05],
        [-1.3340e-03,  1.5927e-04],
        [-1.1880e-03,  1.1341e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6818],
        [ 0.6172, -2.6264],
        [-0.7286,  1.4746],
        [-0.8529, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.3214, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2019, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0014,  0.0002],
        [-0.0014,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6819],
        [ 0.6170, -2.6262],
        [-0.7287,  1.4747],
        [-0.8530, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.3047, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2023, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4589e-03,  9.1150e-05],
        [-1.5632e-03,  1.6211e-04],
        [-1.5555e-03,  1.4807e-04],
        [-1.6047e-03,  1.2729e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6818],
        [ 0.6168, -2.6262],
        [-0.7288,  1.4746],
        [-0.8533, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2322, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1938, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.4938e-03,  6.7247e-05],
        [-1.4473e-03,  9.8628e-05],
        [-1.4177e-03,  9.1526e-05],
        [-1.2547e-03,  1.2861e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6818],
        [ 0.6169, -2.6263],
        [-0.7287,  1.4746],
        [-0.8529, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2467, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2036, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0002],
        [-0.0013,  0.0002],
        [-0.0013,  0.0002],
        [-0.0012,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6819],
        [ 0.6171, -2.6262],
        [-0.7285,  1.4747],
        [-0.8528, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.3088, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0425, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.3160, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0003],
        [-0.0019,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6820],
        [ 0.6165, -2.6261],
        [-0.7289,  1.4748],
        [-0.8534, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7842, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0309, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1402, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0015,  0.0002],
        [-0.0015,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6169, -2.6262],
        [-0.7287,  1.4747],
        [-0.8530, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2038, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1967, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0001],
        [-0.0012,  0.0001],
        [-0.0015,  0.0001],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6818],
        [ 0.6171, -2.6262],
        [-0.7287,  1.4747],
        [-0.8531, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0575, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1879, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0003],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6820],
        [ 0.6168, -2.6260],
        [-0.7289,  1.4748],
        [-0.8532, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9763, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1749, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6819],
        [ 0.6170, -2.6261],
        [-0.7286,  1.4748],
        [-0.8531, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.3824, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2172, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0002],
        [-0.0015,  0.0002],
        [-0.0014,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6169, -2.6261],
        [-0.7285,  1.4747],
        [-0.8530, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.6546, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0425, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2504, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0014,  0.0003],
        [-0.0013,  0.0003],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6820],
        [ 0.6169, -2.6259],
        [-0.7285,  1.4748],
        [-0.8528, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.7814, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2554, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0013,  0.0002],
        [-0.0012,  0.0002],
        [-0.0011,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6171, -2.6260],
        [-0.7284,  1.4748],
        [-0.8526, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4825, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2243, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0017,  0.0003],
        [-0.0014,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6819],
        [ 0.6167, -2.6260],
        [-0.7286,  1.4748],
        [-0.8530, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4101, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2193, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0001],
        [-0.0012,  0.0002],
        [-0.0011,  0.0002],
        [-0.0011,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6818],
        [ 0.6173, -2.6260],
        [-0.7283,  1.4749],
        [-0.8527, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0989, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1892, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0010,  0.0002],
        [-0.0010,  0.0002],
        [-0.0011,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3102,  0.6819],
        [ 0.6174, -2.6261],
        [-0.7283,  1.4748],
        [-0.8527, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2841, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2104, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0014,  0.0002],
        [-0.0015,  0.0003],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6820],
        [ 0.6171, -2.6260],
        [-0.7286,  1.4749],
        [-0.8530, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.3494, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2098, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0019,  0.0004],
        [-0.0017,  0.0004],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6821],
        [ 0.6165, -2.6258],
        [-0.7288,  1.4750],
        [-0.8531, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2190, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0332, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1883, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6820],
        [ 0.6170, -2.6260],
        [-0.7286,  1.4750],
        [-0.8532, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9234, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1706, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0014,  0.0003],
        [-0.0012,  0.0003],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6819],
        [ 0.6171, -2.6259],
        [-0.7284,  1.4749],
        [-0.8530, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.5265, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0430, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2386, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6820],
        [ 0.6169, -2.6259],
        [-0.7287,  1.4750],
        [-0.8532, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.7653, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2593, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0014,  0.0002],
        [-0.0013,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6820],
        [ 0.6171, -2.6260],
        [-0.7284,  1.4750],
        [-0.8529, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.6505, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2409, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6820],
        [ 0.6170, -2.6259],
        [-0.7285,  1.4750],
        [-0.8529, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.5392, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2296, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0013,  0.0003],
        [-0.0015,  0.0004],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6822],
        [ 0.6172, -2.6259],
        [-0.7285,  1.4751],
        [-0.8530, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.5521, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2288, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0013,  0.0002],
        [-0.0015,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6821],
        [ 0.6172, -2.6259],
        [-0.7285,  1.4751],
        [-0.8528, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.5980, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2377, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0003],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6820],
        [ 0.6170, -2.6259],
        [-0.7287,  1.4750],
        [-0.8530, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.3607, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2164, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0018,  0.0004],
        [-0.0017,  0.0003],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6820],
        [ 0.6168, -2.6258],
        [-0.7288,  1.4750],
        [-0.8529, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1398, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1909, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0004],
        [-0.0013,  0.0004],
        [-0.0013,  0.0004],
        [-0.0012,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6821],
        [ 0.6173, -2.6258],
        [-0.7283,  1.4751],
        [-0.8527, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2430, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1939, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0016,  0.0004],
        [-0.0017,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6821],
        [ 0.6170, -2.6257],
        [-0.7287,  1.4751],
        [-0.8531, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1307, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1849, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0013,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6821],
        [ 0.6171, -2.6258],
        [-0.7285,  1.4750],
        [-0.8529, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4462, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2181, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0016,  0.0004],
        [-0.0014,  0.0003],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6823],
        [ 0.6170, -2.6257],
        [-0.7284,  1.4750],
        [-0.8531, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1177, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0435, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1988, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0015,  0.0004],
        [-0.0015,  0.0004],
        [-0.0018,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6823],
        [ 0.6171, -2.6257],
        [-0.7286,  1.4751],
        [-0.8533, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4604, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2222, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0014,  0.0004],
        [-0.0015,  0.0004],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6822],
        [ 0.6172, -2.6257],
        [-0.7285,  1.4751],
        [-0.8531, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1444, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1892, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0002],
        [-0.0011,  0.0002],
        [-0.0013,  0.0003],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6820],
        [ 0.6175, -2.6259],
        [-0.7284,  1.4750],
        [-0.8528, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.8598, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2636, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0004],
        [-0.0015,  0.0004],
        [-0.0013,  0.0003],
        [-0.0014,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6822],
        [ 0.6171, -2.6257],
        [-0.7283,  1.4751],
        [-0.8530, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2065, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0418, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2043, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0015,  0.0004],
        [-0.0014,  0.0004],
        [-0.0017,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6824],
        [ 0.6171, -2.6257],
        [-0.7285,  1.4751],
        [-0.8532, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1422, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1941, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0016,  0.0004],
        [-0.0017,  0.0004],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6823],
        [ 0.6170, -2.6257],
        [-0.7287,  1.4751],
        [-0.8531, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.3367, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2143, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0003],
        [-0.0019,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6823],
        [ 0.6168, -2.6257],
        [-0.7289,  1.4751],
        [-0.8535, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9719, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1695, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0013,  0.0002],
        [-0.0017,  0.0003],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6822],
        [ 0.6174, -2.6259],
        [-0.7288,  1.4750],
        [-0.8531, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1186, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0419, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1957, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0012,  0.0003],
        [-0.0013,  0.0003],
        [-0.0012,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6822],
        [ 0.6174, -2.6258],
        [-0.7283,  1.4750],
        [-0.8528, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.5129, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0323, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2159, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0003],
        [-0.0012,  0.0002],
        [-0.0014,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6822],
        [ 0.6174, -2.6259],
        [-0.7284,  1.4750],
        [-0.8529, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.7235, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2447, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0003],
        [-0.0012,  0.0002],
        [-0.0011,  0.0003],
        [-0.0011,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6823],
        [ 0.6174, -2.6259],
        [-0.7282,  1.4750],
        [-0.8527, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1628, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1950, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0004],
        [-0.0014,  0.0004],
        [-0.0015,  0.0004],
        [-0.0015,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6823],
        [ 0.6172, -2.6257],
        [-0.7286,  1.4751],
        [-0.8531, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.0291, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2735, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0019,  0.0005],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6823],
        [ 0.6170, -2.6257],
        [-0.7289,  1.4751],
        [-0.8532, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.5330, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2276, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0016,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6824],
        [ 0.6169, -2.6256],
        [-0.7288,  1.4752],
        [-0.8532, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8002, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1547, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0004],
        [-0.0014,  0.0004],
        [-0.0011,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6823],
        [ 0.6174, -2.6257],
        [-0.7281,  1.4750],
        [-0.8528, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4842, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2309, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0016,  0.0004],
        [-0.0019,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6824],
        [ 0.6171, -2.6257],
        [-0.7289,  1.4752],
        [-0.8533, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9935, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1777, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0018,  0.0004],
        [-0.0017,  0.0003],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6824],
        [ 0.6169, -2.6258],
        [-0.7288,  1.4750],
        [-0.8532, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1868, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0344, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1875, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0004],
        [-0.0015,  0.0004],
        [-0.0014,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6824],
        [ 0.6173, -2.6257],
        [-0.7285,  1.4750],
        [-0.8529, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  42
gt_cnt:  40
gt_cnt:  35
gt_cnt:  41
gt_cnt:  42
gt_cnt:  42
gt_cnt:  38
gt_cnt:  38
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  40
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  35
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  43
gt_cnt:  35
gt_cnt:  43
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  42
gt_cnt:  42
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  39
gt_cnt:  35
gt_cnt:  38
gt_cnt:  34
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  36
gt_cnt:  43
gt_cnt:  41
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  42
gt_cnt:  39
gt_cnt:  35
gt_cnt:  41
gt_cnt:  42
gt_cnt:  42
gt_cnt:  40
gt_cnt:  42
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  35
gt_cnt:  38
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  36
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  42
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  36
gt_cnt:  35
gt_cnt:  39
gt_cnt:  36
gt_cnt:  35
gt_cnt:  42
gt_cnt:  37
gt_cnt:  42
gt_cnt:  40
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  43
gt_cnt:  33
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  36
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  41
gt_cnt:  36
gt_cnt:  44
gt_cnt:  40
gt_cnt:  35
gt_cnt:  44
gt_cnt:  40
gt_cnt:  42
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  35
gt_cnt:  36
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  41
gt_cnt:  38
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  43
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  37
gt_cnt:  43
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  35
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  36
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  43
gt_cnt:  37
gt_cnt:  40
gt_cnt:  41
gt_cnt:  35
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  42
gt_cnt:  41
gt_cnt:  41
gt_cnt:  41
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  42
gt_cnt:  38
gt_cnt:  37
gt_cnt:  44
gt_cnt:  41
gt_cnt:  41
gt_cnt:  37
gt_cnt:  35
gt_cnt:  42
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  41
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  40
gt_cnt:  36
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  38
gt_cnt:  41
gt_cnt:  40
gt_cnt:  40
gt_cnt:  39
gt_cnt:  40
gt_cnt:  35
gt_cnt:  42
gt_cnt:  38
gt_cnt:  37
gt_cnt:  40
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  42
gt_cnt:  41
gt_cnt:  40
gt_cnt:  41
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  41
gt_cnt:  42
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  35
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  37
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  37
gt_cnt:  36
gt_cnt:  37
gt_cnt:  39
gt_cnt:  36
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  41
gt_cnt:  36
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  40
gt_cnt:  38
gt_cnt:  39
gt_cnt:  36
gt_cnt:  44
gt_cnt:  38
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  38
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  40
gt_cnt:  36
gt_cnt:  37
gt_cnt:  39
gt_cnt:  37
gt_cnt:  44
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  35
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  34
gt_cnt:  37
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2926, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2030, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0011,  0.0003],
        [-0.0012,  0.0004],
        [-0.0012,  0.0004],
        [-0.0010,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3101,  0.6823],
        [ 0.6175, -2.6258],
        [-0.7282,  1.4751],
        [-0.8526, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0532, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0457, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1967, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0015,  0.0004],
        [-0.0015,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6824],
        [ 0.6173, -2.6258],
        [-0.7286,  1.4751],
        [-0.8533, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9980, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1805, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0014,  0.0003],
        [-0.0012,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6822],
        [ 0.6174, -2.6259],
        [-0.7282,  1.4749],
        [-0.8528, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(2.1293, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2910, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 1, Batch:360, loss: 0.000808, Time: 133.2
Testing...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6171, -2.6257],
        [-0.7287,  1.4752],
        [-0.8533, -2.7481]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4028, device='cuda:0'), 'center': tensor(0.0363, device='cuda:0')}
loss: tensor(0.1129, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272,
         0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272,
         0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272,
         0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272,
         0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272, 0.5272,
         0.5272, 0.5272, 0.5272, 0.5272, 0.5272]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6825],
        [ 0.6172, -2.6258],
        [-0.7286,  1.4751],
        [-0.8532, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4070, device='cuda:0'), 'center': tensor(0.0382, device='cuda:0')}
loss: tensor(0.1171, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129,
         0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129,
         0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129,
         0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129,
         0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129, 0.5129,
         0.5129, 0.5129, 0.5129, 0.5129, 0.5129]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7480]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.3875, device='cuda:0'), 'center': tensor(0.0377, device='cuda:0')}
loss: tensor(0.1142, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410,
         0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410,
         0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410,
         0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410,
         0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410, 0.5410,
         0.5410, 0.5410, 0.5410, 0.5410, 0.5410]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8533, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.3815, device='cuda:0'), 'center': tensor(0.0381, device='cuda:0')}
loss: tensor(0.1144, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
         0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
         0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
         0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
         0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
         0.5573, 0.5573, 0.5573, 0.5573, 0.5573]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6825],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.3947, device='cuda:0'), 'center': tensor(0.0329, device='cuda:0')}
loss: tensor(0.1052, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537, 0.5537,
         0.5537, 0.5537, 0.5537, 0.5537, 0.5537]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7480]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.3946, device='cuda:0'), 'center': tensor(0.0336, device='cuda:0')}
loss: tensor(0.1067, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541,
         0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541,
         0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541,
         0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541,
         0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541, 0.5541,
         0.5541, 0.5541, 0.5541, 0.5541, 0.5541]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8533, -2.7480]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4139, device='cuda:0'), 'center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.1183, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328,
         0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328,
         0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328,
         0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328,
         0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328,
         0.5328, 0.5328, 0.5328, 0.5328, 0.5328]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3096,  0.6825],
        [ 0.6171, -2.6257],
        [-0.7287,  1.4751],
        [-0.8532, -2.7481]], device='cuda:0')
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4304, device='cuda:0'), 'center': tensor(0.0384, device='cuda:0')}
loss: tensor(0.1199, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236,
         0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236,
         0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236,
         0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236,
         0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236, 0.5236,
         0.5236, 0.5236, 0.5236, 0.5236, 0.5236]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6826],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7480]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4010, device='cuda:0'), 'center': tensor(0.0414, device='cuda:0')}
loss: tensor(0.1230, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297,
         0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297,
         0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297,
         0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297,
         0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297, 0.5297,
         0.5297, 0.5297, 0.5297, 0.5297, 0.5297]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7480]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.3954, device='cuda:0'), 'center': tensor(0.0392, device='cuda:0')}
loss: tensor(0.1179, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384,
         0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384,
         0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384,
         0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384,
         0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384, 0.5384,
         0.5384, 0.5384, 0.5384, 0.5384, 0.5384]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6171, -2.6257],
        [-0.7287,  1.4752],
        [-0.8533, -2.7481]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4143, device='cuda:0'), 'center': tensor(0.0419, device='cuda:0')}
loss: tensor(0.1252, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136,
         0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136,
         0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136,
         0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136,
         0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136, 0.5136,
         0.5136, 0.5136, 0.5136, 0.5136, 0.5136]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6170, -2.6256],
        [-0.7288,  1.4752],
        [-0.8534, -2.7480]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4068, device='cuda:0'), 'center': tensor(0.0383, device='cuda:0')}
loss: tensor(0.1173, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319,
         0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319,
         0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319,
         0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319,
         0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319, 0.5319,
         0.5319, 0.5319, 0.5319, 0.5319, 0.5319]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7480]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4006, device='cuda:0'), 'center': tensor(0.0385, device='cuda:0')}
loss: tensor(0.1171, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205,
         0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205,
         0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205,
         0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205,
         0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205, 0.5205,
         0.5205, 0.5205, 0.5205, 0.5205, 0.5205]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6171, -2.6257],
        [-0.7287,  1.4751],
        [-0.8533, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4067, device='cuda:0'), 'center': tensor(0.0374, device='cuda:0')}
loss: tensor(0.1155, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132,
         0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132,
         0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132,
         0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132,
         0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132, 0.5132,
         0.5132, 0.5132, 0.5132, 0.5132, 0.5132]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7480]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4314, device='cuda:0'), 'center': tensor(0.0378, device='cuda:0')}
loss: tensor(0.1186, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902,
         0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902,
         0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902,
         0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902,
         0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902, 0.4902,
         0.4902, 0.4902, 0.4902, 0.4902, 0.4902]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7480]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4001, device='cuda:0'), 'center': tensor(0.0362, device='cuda:0')}
loss: tensor(0.1124, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120,
         0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120,
         0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120,
         0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120,
         0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120, 0.5120,
         0.5120, 0.5120, 0.5120, 0.5120, 0.5120]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6825],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.3859, device='cuda:0'), 'center': tensor(0.0342, device='cuda:0')}
loss: tensor(0.1071, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444,
         0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444,
         0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444,
         0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444,
         0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444, 0.5444,
         0.5444, 0.5444, 0.5444, 0.5444, 0.5444]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6171, -2.6257],
        [-0.7288,  1.4751],
        [-0.8533, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.3853, device='cuda:0'), 'center': tensor(0.0409, device='cuda:0')}
loss: tensor(0.1203, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457,
         0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457,
         0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457,
         0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457,
         0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457, 0.5457,
         0.5457, 0.5457, 0.5457, 0.5457, 0.5457]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6825],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7481]], device='cuda:0')
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4023, device='cuda:0'), 'center': tensor(0.0360, device='cuda:0')}
loss: tensor(0.1122, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279,
         0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279,
         0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279,
         0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279,
         0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279, 0.5279,
         0.5279, 0.5279, 0.5279, 0.5279, 0.5279]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6171, -2.6257],
        [-0.7287,  1.4751],
        [-0.8533, -2.7481]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.3922, device='cuda:0'), 'center': tensor(0.0382, device='cuda:0')}
loss: tensor(0.1157, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220,
         0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220,
         0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220,
         0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220,
         0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220, 0.5220,
         0.5220, 0.5220, 0.5220, 0.5220, 0.5220]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6171, -2.6257],
        [-0.7287,  1.4751],
        [-0.8533, -2.7481]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.3931, device='cuda:0'), 'center': tensor(0.0337, device='cuda:0')}
loss: tensor(0.1067, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309,
         0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309,
         0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309,
         0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309,
         0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309, 0.5309,
         0.5309, 0.5309, 0.5309, 0.5309, 0.5309]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6825],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.3945, device='cuda:0'), 'center': tensor(0.0333, device='cuda:0')}
loss: tensor(0.1060, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542,
         0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542,
         0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542,
         0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542,
         0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542, 0.5542,
         0.5542, 0.5542, 0.5542, 0.5542, 0.5542]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6825],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4064, device='cuda:0'), 'center': tensor(0.0314, device='cuda:0')}
loss: tensor(0.1034, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439,
         0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439,
         0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439,
         0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439,
         0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439, 0.5439,
         0.5439, 0.5439, 0.5439, 0.5439, 0.5439]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7480]], device='cuda:0')
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4420, device='cuda:0'), 'center': tensor(0.0369, device='cuda:0')}
loss: tensor(0.1180, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127, 0.5127,
         0.5127, 0.5127, 0.5127, 0.5127, 0.5127]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6825],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7480]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4386, device='cuda:0'), 'center': tensor(0.0399, device='cuda:0')}
loss: tensor(0.1236, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073,
         0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073,
         0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073,
         0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073,
         0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073, 0.5073,
         0.5073, 0.5073, 0.5073, 0.5073, 0.5073]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7480]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4332, device='cuda:0'), 'center': tensor(0.0351, device='cuda:0')}
loss: tensor(0.1135, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121,
         0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121,
         0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121,
         0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121,
         0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121, 0.5121,
         0.5121, 0.5121, 0.5121, 0.5121, 0.5121]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7480]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4055, device='cuda:0'), 'center': tensor(0.0398, device='cuda:0')}
loss: tensor(0.1201, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339,
         0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339,
         0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339,
         0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339,
         0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339, 0.5339,
         0.5339, 0.5339, 0.5339, 0.5339, 0.5339]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6171, -2.6257],
        [-0.7287,  1.4752],
        [-0.8533, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4095, device='cuda:0'), 'center': tensor(0.0381, device='cuda:0')}
loss: tensor(0.1172, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284,
         0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284,
         0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284,
         0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284,
         0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284, 0.5284,
         0.5284, 0.5284, 0.5284, 0.5284, 0.5284]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6171, -2.6257],
        [-0.7287,  1.4752],
        [-0.8533, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4057, device='cuda:0'), 'center': tensor(0.0434, device='cuda:0')}
loss: tensor(0.1273, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336,
         0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336,
         0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336,
         0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336,
         0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336, 0.5336,
         0.5336, 0.5336, 0.5336, 0.5336, 0.5336]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8533, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4271, device='cuda:0'), 'center': tensor(0.0451, device='cuda:0')}
loss: tensor(0.1329, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179,
         0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179,
         0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179,
         0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179,
         0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179, 0.5179,
         0.5179, 0.5179, 0.5179, 0.5179, 0.5179]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6825],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4751],
        [-0.8534, -2.7481]], device='cuda:0')
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4444, device='cuda:0'), 'center': tensor(0.0343, device='cuda:0')}
loss: tensor(0.1130, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192,
         0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192,
         0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192,
         0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192,
         0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192, 0.5192,
         0.5192, 0.5192, 0.5192, 0.5192, 0.5192]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4751],
        [-0.8533, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4043, device='cuda:0'), 'center': tensor(0.0370, device='cuda:0')}
loss: tensor(0.1145, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476,
         0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476,
         0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476,
         0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476,
         0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476, 0.5476,
         0.5476, 0.5476, 0.5476, 0.5476, 0.5476]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7480]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.3983, device='cuda:0'), 'center': tensor(0.0393, device='cuda:0')}
loss: tensor(0.1185, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618, 0.5618,
         0.5618, 0.5618, 0.5618, 0.5618, 0.5618]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6825],
        [ 0.6169, -2.6257],
        [-0.7289,  1.4752],
        [-0.8534, -2.7481]], device='cuda:0')
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.3966, device='cuda:0'), 'center': tensor(0.0388, device='cuda:0')}
loss: tensor(0.1173, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494,
         0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494,
         0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494,
         0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494,
         0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494, 0.5494,
         0.5494, 0.5494, 0.5494, 0.5494, 0.5494]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6171, -2.6257],
        [-0.7287,  1.4752],
        [-0.8533, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4061, device='cuda:0'), 'center': tensor(0.0420, device='cuda:0')}
loss: tensor(0.1246, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445,
         0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445,
         0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445,
         0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445,
         0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445, 0.5445,
         0.5445, 0.5445, 0.5445, 0.5445, 0.5445]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6825],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4751],
        [-0.8534, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4028, device='cuda:0'), 'center': tensor(0.0449, device='cuda:0')}
loss: tensor(0.1300, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507,
         0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507,
         0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507,
         0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507,
         0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507, 0.5507,
         0.5507, 0.5507, 0.5507, 0.5507, 0.5507]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6825],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4751],
        [-0.8534, -2.7481]], device='cuda:0')
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4285, device='cuda:0'), 'center': tensor(0.0360, device='cuda:0')}
loss: tensor(0.1149, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354,
         0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354,
         0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354,
         0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354,
         0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354, 0.5354,
         0.5354, 0.5354, 0.5354, 0.5354, 0.5354]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0')
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6171, -2.6257],
        [-0.7287,  1.4752],
        [-0.8533, -2.7481]], device='cuda:0')
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4140, device='cuda:0'), 'center': tensor(0.0380, device='cuda:0')}
loss: tensor(0.1175, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328,
         0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328,
         0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328,
         0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328,
         0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328, 0.5328,
         0.5328, 0.5328, 0.5328, 0.5328, 0.5328]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6170, -2.6257],
        [-0.7288,  1.4752],
        [-0.8534, -2.7480]], device='cuda:0')
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.3834, device='cuda:0'), 'center': tensor(0.0397, device='cuda:0')}
loss: tensor(0.1177, device='cuda:0', dtype=torch.float64)
top10 scores:  tensor([[0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508,
         0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508,
         0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508,
         0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508,
         0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508, 0.5508,
         0.5508, 0.5508, 0.5508, 0.5508, 0.5508]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0005]], device='cuda:0')
after ref add :  tensor([[ 2.3093,  0.6826],
        [ 0.6169, -2.6257],
        [-0.7289,  1.4752],
        [-0.8535, -2.7480]], device='cuda:0')
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.3820, device='cuda:0'), 'center': tensor(0.0420, device='cuda:0')}
loss: tensor(0.1221, device='cuda:0', dtype=torch.float64)
top10 scores:  gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  36
gt_cnt:  37
gt_cnt:  36
gt_cnt:  34
gt_cnt:  39
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  37
gt_cnt:  36
gt_cnt:  39
gt_cnt:  36
gt_cnt:  38
gt_cnt:  39
gt_cnt:  38
gt_cnt:  36
gt_cnt:  37
gt_cnt:  34
gt_cnt:  36
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  40
gt_cnt:  35
gt_cnt:  37
gt_cnt:  36
gt_cnt:  36
gt_cnt:  40
tensor([[0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393,
         0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393,
         0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393,
         0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393,
         0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393, 0.5393,
         0.5393, 0.5393, 0.5393, 0.5393, 0.5393]], device='cuda:0')
labels:  tensor([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
         0, 0]], device='cuda:0')
moda: 0.0%, modp: 35.3%, prec: 7.3%, recall: 9.8%
Test, loss: 0.116744, Time: 15.507
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0014,  0.0004],
        [-0.0014,  0.0004],
        [-0.0013,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6824],
        [ 0.6174, -2.6257],
        [-0.7285,  1.4751],
        [-0.8529, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1701, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1953, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6824],
        [ 0.6174, -2.6259],
        [-0.7284,  1.4750],
        [-0.8530, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1850, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1942, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0015,  0.0004],
        [-0.0016,  0.0004],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6824],
        [ 0.6173, -2.6258],
        [-0.7286,  1.4751],
        [-0.8531, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.3703, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2105, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6825],
        [ 0.6172, -2.6258],
        [-0.7286,  1.4751],
        [-0.8532, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6773, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0423, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1523, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6824],
        [ 0.6174, -2.6259],
        [-0.7285,  1.4750],
        [-0.8532, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4834, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2154, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0014,  0.0002],
        [-0.0012,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6824],
        [ 0.6174, -2.6260],
        [-0.7282,  1.4749],
        [-0.8528, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2969, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2059, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0004],
        [-0.0013,  0.0004],
        [-0.0012,  0.0003],
        [-0.0013,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6176, -2.6258],
        [-0.7282,  1.4751],
        [-0.8529, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8422, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0424, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1690, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0013,  0.0003],
        [-0.0012,  0.0002],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6825],
        [ 0.6175, -2.6259],
        [-0.7282,  1.4750],
        [-0.8530, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1952, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1945, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0015,  0.0003],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6173, -2.6258],
        [-0.7287,  1.4751],
        [-0.8533, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2260, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1897, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0005],
        [-0.0013,  0.0004],
        [-0.0015,  0.0005],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6175, -2.6258],
        [-0.7285,  1.4752],
        [-0.8532, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0390, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1775, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0019,  0.0004],
        [-0.0017,  0.0003],
        [-0.0018,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6170, -2.6258],
        [-0.7287,  1.4750],
        [-0.8535, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0629, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0440, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1943, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0018,  0.0003],
        [-0.0019,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6825],
        [ 0.6171, -2.6259],
        [-0.7289,  1.4751],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6118, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1380, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.2816e-03,  9.9303e-05],
        [-1.2083e-03,  8.7861e-05],
        [-1.0833e-03,  9.4327e-05],
        [-1.5096e-03,  2.2894e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6823],
        [ 0.6177, -2.6261],
        [-0.7281,  1.4748],
        [-0.8532, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0939, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1878, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0003],
        [-0.0018,  0.0004],
        [-0.0017,  0.0004],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6171, -2.6258],
        [-0.7287,  1.4751],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8579, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1588, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0015,  0.0002],
        [-0.0014,  0.0002],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6825],
        [ 0.6174, -2.6259],
        [-0.7284,  1.4749],
        [-0.8531, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9882, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1706, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0017,  0.0004],
        [-0.0015,  0.0003],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6827],
        [ 0.6173, -2.6258],
        [-0.7285,  1.4750],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9886, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1709, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0005],
        [-0.0015,  0.0003],
        [-0.0013,  0.0004],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6174, -2.6259],
        [-0.7283,  1.4751],
        [-0.8531, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8505, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1610, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0019,  0.0003],
        [-0.0018,  0.0003],
        [-0.0018,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6825],
        [ 0.6171, -2.6259],
        [-0.7288,  1.4750],
        [-0.8534, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8734, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1668, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0017,  0.0004],
        [-0.0016,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6172, -2.6258],
        [-0.7286,  1.4751],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4185, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2135, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0003],
        [-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3099,  0.6826],
        [ 0.6174, -2.6259],
        [-0.7285,  1.4750],
        [-0.8531, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2523, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1954, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0018,  0.0005],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6173, -2.6259],
        [-0.7288,  1.4752],
        [-0.8532, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.3833, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2163, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0003],
        [-0.0013,  0.0003],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6826],
        [ 0.6177, -2.6260],
        [-0.7283,  1.4749],
        [-0.8530, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.7432, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2555, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020,  0.0005],
        [-0.0019,  0.0004],
        [-0.0021,  0.0005],
        [-0.0019,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6827],
        [ 0.6171, -2.6258],
        [-0.7292,  1.4752],
        [-0.8535, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9091, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0330, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1569, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0018,  0.0004],
        [-0.0014,  0.0003],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6172, -2.6259],
        [-0.7285,  1.4750],
        [-0.8531, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9846, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1677, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0018,  0.0004],
        [-0.0022,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6174, -2.6259],
        [-0.7289,  1.4751],
        [-0.8538, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.3562, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2067, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0005],
        [-0.0016,  0.0004],
        [-0.0019,  0.0005],
        [-0.0015,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6827],
        [ 0.6174, -2.6259],
        [-0.7290,  1.4752],
        [-0.8532, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0402, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0322, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1684, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0004],
        [-0.0014,  0.0004],
        [-0.0014,  0.0003],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6176, -2.6259],
        [-0.7285,  1.4750],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9136, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1661, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0017,  0.0004],
        [-0.0021,  0.0005],
        [-0.0021,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6174, -2.6258],
        [-0.7292,  1.4752],
        [-0.8537, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9340, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1716, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0015,  0.0002],
        [-0.0015,  0.0002],
        [-0.0012,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6176, -2.6261],
        [-0.7286,  1.4750],
        [-0.8529, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.3092, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2136, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6173, -2.6259],
        [-0.7289,  1.4751],
        [-0.8534, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2577, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2062, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0012,  0.0002],
        [-0.0013,  0.0002],
        [-0.0014,  0.0002],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6825],
        [ 0.6177, -2.6261],
        [-0.7286,  1.4750],
        [-0.8531, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8706, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1676, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0020,  0.0005],
        [-0.0018,  0.0005],
        [-0.0019,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6171, -2.6258],
        [-0.7290,  1.4752],
        [-0.8536, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9671, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1761, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6173, -2.6259],
        [-0.7291,  1.4751],
        [-0.8532, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0753, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0437, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1950, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0016,  0.0003],
        [-0.0019,  0.0005],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6827],
        [ 0.6174, -2.6260],
        [-0.7292,  1.4753],
        [-0.8535, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7482, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1459, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0018,  0.0004],
        [-0.0017,  0.0003],
        [-0.0018,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6172, -2.6259],
        [-0.7290,  1.4751],
        [-0.8536, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2692, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2090, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0005],
        [-0.0018,  0.0005],
        [-0.0020,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6172, -2.6259],
        [-0.7293,  1.4754],
        [-0.8536, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.3044, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2011, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0016,  0.0003],
        [-0.0019,  0.0004],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6827],
        [ 0.6174, -2.6260],
        [-0.7291,  1.4753],
        [-0.8535, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1923, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1954, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021,  0.0005],
        [-0.0020,  0.0004],
        [-0.0021,  0.0005],
        [-0.0022,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6829],
        [ 0.6170, -2.6259],
        [-0.7294,  1.4754],
        [-0.8540, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8456, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1541, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0017,  0.0003],
        [-0.0015,  0.0003],
        [-0.0018,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6174, -2.6260],
        [-0.7287,  1.4752],
        [-0.8536, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.7608, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2510, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0018,  0.0004],
        [-0.0020,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6176, -2.6260],
        [-0.7291,  1.4753],
        [-0.8539, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8600, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0475, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1811, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0015,  0.0002],
        [-0.0015,  0.0002],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6826],
        [ 0.6175, -2.6261],
        [-0.7288,  1.4752],
        [-0.8535, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9704, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1755, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0005],
        [-0.0019,  0.0005],
        [-0.0019,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6828],
        [ 0.6172, -2.6258],
        [-0.7292,  1.4754],
        [-0.8536, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1917, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0326, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1844, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0017,  0.0003],
        [-0.0017,  0.0003],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6174, -2.6260],
        [-0.7290,  1.4752],
        [-0.8535, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6502, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1469, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0015,  0.0002],
        [-0.0017,  0.0004],
        [-0.0018,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6827],
        [ 0.6176, -2.6261],
        [-0.7291,  1.4754],
        [-0.8537, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1294, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1885, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0018,  0.0004],
        [-0.0016,  0.0003],
        [-0.0018,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6828],
        [ 0.6173, -2.6259],
        [-0.7290,  1.4754],
        [-0.8538, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7608, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1492, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0003],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6175, -2.6259],
        [-0.7290,  1.4755],
        [-0.8536, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8120, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0325, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1463, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0004],
        [-0.0018,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6173, -2.6259],
        [-0.7290,  1.4755],
        [-0.8537, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9697, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1730, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0014,  0.0002],
        [-0.0016,  0.0004],
        [-0.0016,  0.0004],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6826],
        [ 0.6175, -2.6258],
        [-0.7290,  1.4755],
        [-0.8534, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8975, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1651, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0015,  0.0003],
        [-0.0017,  0.0004],
        [-0.0016,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6176, -2.6259],
        [-0.7291,  1.4755],
        [-0.8536, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2210, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2020, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020,  0.0006],
        [-0.0018,  0.0004],
        [-0.0017,  0.0004],
        [-0.0019,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6830],
        [ 0.6173, -2.6259],
        [-0.7292,  1.4756],
        [-0.8540, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8909, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1664, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0005],
        [-0.0019,  0.0004],
        [-0.0018,  0.0005],
        [-0.0018,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6829],
        [ 0.6172, -2.6258],
        [-0.7293,  1.4756],
        [-0.8538, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9094, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1699, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0012,  0.0001],
        [-0.0011,  0.0001],
        [-0.0014,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6827],
        [ 0.6179, -2.6262],
        [-0.7286,  1.4753],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2787, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2083, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0005],
        [-0.0017,  0.0003],
        [-0.0017,  0.0004],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6829],
        [ 0.6174, -2.6259],
        [-0.7291,  1.4756],
        [-0.8535, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8561, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0330, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1516, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0015,  0.0002],
        [-0.0015,  0.0003],
        [-0.0013,  0.0002],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6827],
        [ 0.6176, -2.6260],
        [-0.7288,  1.4754],
        [-0.8536, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.5865, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2413, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0003],
        [-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6176, -2.6260],
        [-0.7291,  1.4756],
        [-0.8535, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0867, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1790, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0014,  0.0002],
        [-0.0014,  0.0002],
        [-0.0016,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6828],
        [ 0.6177, -2.6260],
        [-0.7288,  1.4755],
        [-0.8537, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6528, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1402, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0013,  0.0002],
        [-0.0014,  0.0002],
        [-0.0013,  0.0002],
        [-0.0015,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3100,  0.6826],
        [ 0.6177, -2.6260],
        [-0.7287,  1.4755],
        [-0.8535, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8501, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0415, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1681, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0019,  0.0005],
        [-0.0021,  0.0005],
        [-0.0019,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6173, -2.6258],
        [-0.7296,  1.4758],
        [-0.8539, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7934, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1550, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0015,  0.0003],
        [-0.0019,  0.0005],
        [-0.0017,  0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6829],
        [ 0.6177, -2.6260],
        [-0.7293,  1.4758],
        [-0.8537, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9176, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0352, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1621, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0015,  0.0004],
        [-0.0017,  0.0004],
        [-0.0017,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6828],
        [ 0.6176, -2.6259],
        [-0.7291,  1.4757],
        [-0.8538, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6501, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1394, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0004],
        [-0.0015,  0.0003],
        [-0.0015,  0.0003],
        [-0.0014,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6829],
        [ 0.6176, -2.6260],
        [-0.7290,  1.4757],
        [-0.8535, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0130, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1836, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0018,  0.0003],
        [-0.0016,  0.0003],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6173, -2.6259],
        [-0.7291,  1.4757],
        [-0.8537, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8076, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0421, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1650, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0002],
        [-0.0022,  0.0005],
        [-0.0018,  0.0003],
        [-0.0022,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6169, -2.6257],
        [-0.7292,  1.4757],
        [-0.8542, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1157, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1871, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5296e-03,  2.7381e-04],
        [-1.6564e-03,  2.7637e-04],
        [-1.6006e-03,  2.4902e-04],
        [-1.4343e-03,  8.8595e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6828],
        [ 0.6175, -2.6260],
        [-0.7290,  1.4756],
        [-0.8535, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7864, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1591, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5246e-03,  2.4130e-04],
        [-1.2251e-03,  9.0069e-05],
        [-1.2624e-03,  1.9364e-04],
        [-1.3878e-03,  2.5016e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6827],
        [ 0.6179, -2.6262],
        [-0.7287,  1.4756],
        [-0.8534, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9522, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1677, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0002],
        [-0.0015,  0.0003],
        [-0.0017,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6827],
        [ 0.6176, -2.6260],
        [-0.7291,  1.4756],
        [-0.8536, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9260, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1683, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0015,  0.0002],
        [-0.0016,  0.0002],
        [-0.0015,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6828],
        [ 0.6176, -2.6260],
        [-0.7290,  1.4756],
        [-0.8535, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5150, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0425, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1365, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018,  0.0002],
        [-0.0018,  0.0002],
        [-0.0016,  0.0001],
        [-0.0016,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6827],
        [ 0.6174, -2.6261],
        [-0.7290,  1.4756],
        [-0.8536, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9018, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0344, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1589, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0002],
        [-0.0018,  0.0001],
        [-0.0016,  0.0001],
        [-0.0016,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6174, -2.6261],
        [-0.7290,  1.4756],
        [-0.8536, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2546, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0428, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2111, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0020,  0.0003],
        [-0.0015,  0.0003],
        [-0.0017,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6172, -2.6260],
        [-0.7289,  1.4758],
        [-0.8537, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1792, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0318, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1816, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0003],
        [-0.0016,  0.0003],
        [-0.0017,  0.0002],
        [-0.0015,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6828],
        [ 0.6176, -2.6260],
        [-0.7291,  1.4757],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8678, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1627, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0001],
        [-0.0018,  0.0002],
        [-0.0018,  0.0002],
        [-0.0017,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6174, -2.6261],
        [-0.7292,  1.4757],
        [-0.8537, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5617, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1278, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0001],
        [-0.0016,  0.0002],
        [-0.0018,  0.0003],
        [-0.0019,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6826],
        [ 0.6176, -2.6260],
        [-0.7292,  1.4757],
        [-0.8539, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7962, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1495, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6448e-03,  1.9871e-04],
        [-1.8226e-03,  6.0499e-05],
        [-1.9480e-03,  3.0133e-04],
        [-1.7577e-03,  1.6572e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6174, -2.6262],
        [-0.7293,  1.4758],
        [-0.8537, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8680, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1560, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0018,  0.0003],
        [-0.0017,  0.0002],
        [-0.0019,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6174, -2.6259],
        [-0.7290,  1.4757],
        [-0.8539, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5697, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1291, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020,  0.0003],
        [-0.0017,  0.0003],
        [-0.0016,  0.0002],
        [-0.0016,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6828],
        [ 0.6175, -2.6260],
        [-0.7290,  1.4757],
        [-0.8536, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8513, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1666, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0017,  0.0003],
        [-0.0018,  0.0003],
        [-0.0019,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6175, -2.6260],
        [-0.7292,  1.4758],
        [-0.8538, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9368, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1629, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0003],
        [-0.0019,  0.0002],
        [-0.0018,  0.0003],
        [-0.0018,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6828],
        [ 0.6173, -2.6260],
        [-0.7291,  1.4758],
        [-0.8537, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0322, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1838, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017,  0.0003],
        [-0.0020,  0.0004],
        [-0.0018,  0.0002],
        [-0.0018,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6827],
        [ 0.6173, -2.6258],
        [-0.7291,  1.4757],
        [-0.8538, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1161, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1836, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020,  0.0004],
        [-0.0019,  0.0003],
        [-0.0019,  0.0003],
        [-0.0019,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6828],
        [ 0.6173, -2.6259],
        [-0.7292,  1.4759],
        [-0.8539, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8843, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1609, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9939e-03,  7.9775e-05],
        [-1.7584e-03,  9.1578e-05],
        [-2.0556e-03,  1.6196e-04],
        [-2.0090e-03,  1.7098e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6825],
        [ 0.6175, -2.6261],
        [-0.7294,  1.4757],
        [-0.8540, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6111, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1347, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0002],
        [-0.0017,  0.0002],
        [-0.0020,  0.0002],
        [-0.0017,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6827],
        [ 0.6176, -2.6260],
        [-0.7294,  1.4757],
        [-0.8536, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7547, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0310, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1375, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016,  0.0001],
        [-0.0015,  0.0002],
        [-0.0013,  0.0001],
        [-0.0015,  0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6826],
        [ 0.6177, -2.6261],
        [-0.7287,  1.4757],
        [-0.8534, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7091, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1519, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5900e-03,  1.6684e-04],
        [-1.4363e-03,  1.8475e-05],
        [-1.2466e-03, -2.2783e-05],
        [-1.5866e-03, -5.0503e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6826],
        [ 0.6178, -2.6262],
        [-0.7286,  1.4756],
        [-0.8535, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7438, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1528, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019,  0.0001],
        [-0.0019,  0.0002],
        [-0.0018,  0.0002],
        [-0.0019,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6825],
        [ 0.6173, -2.6260],
        [-0.7292,  1.4758],
        [-0.8539, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6606, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1455, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5495e-03, -1.2338e-05],
        [-1.6964e-03,  1.0698e-04],
        [-1.6293e-03,  2.4418e-05],
        [-1.8340e-03,  1.1673e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6824],
        [ 0.6176, -2.6261],
        [-0.7290,  1.4756],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8646, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1601, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7584e-03,  7.9457e-05],
        [-1.5527e-03,  1.2451e-04],
        [-1.7129e-03,  7.9849e-05],
        [-1.8121e-03,  1.8490e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6825],
        [ 0.6177, -2.6261],
        [-0.7291,  1.4757],
        [-0.8537, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1739, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0327, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1828, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026,  0.0003],
        [-0.0022,  0.0003],
        [-0.0022,  0.0002],
        [-0.0022,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6827],
        [ 0.6171, -2.6260],
        [-0.7296,  1.4758],
        [-0.8541, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7045, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1453, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2414e-03,  6.6507e-05],
        [-2.1773e-03,  8.8406e-05],
        [-1.9607e-03,  6.3062e-05],
        [-1.7294e-03,  6.0758e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6825],
        [ 0.6171, -2.6262],
        [-0.7294,  1.4757],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7407, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1480, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8945e-03,  2.7679e-05],
        [-2.0756e-03,  2.8623e-06],
        [-1.8468e-03,  1.9954e-05],
        [-1.9952e-03,  4.5082e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6824],
        [ 0.6172, -2.6263],
        [-0.7293,  1.4757],
        [-0.8539, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5869, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0420, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1426, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020,  0.0003],
        [-0.0018,  0.0003],
        [-0.0018,  0.0003],
        [-0.0019,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6826],
        [ 0.6175, -2.6260],
        [-0.7292,  1.4760],
        [-0.8538, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9742, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1786, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.7573e-03,  6.5358e-05],
        [-1.9402e-03,  9.6994e-05],
        [-1.8776e-03,  9.4767e-05],
        [-1.9736e-03,  1.1625e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6824],
        [ 0.6174, -2.6262],
        [-0.7293,  1.4758],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1509, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0416, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1983, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9335e-03,  6.7207e-05],
        [-1.8099e-03,  6.9712e-05],
        [-1.8295e-03,  9.2679e-05],
        [-1.8948e-03,  6.4135e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6824],
        [ 0.6175, -2.6262],
        [-0.7293,  1.4758],
        [-0.8538, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7979, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0400, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1598, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1494e-03,  1.0426e-04],
        [-2.2929e-03,  1.6803e-04],
        [-2.2935e-03,  4.2671e-05],
        [-2.3076e-03,  4.1709e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6824],
        [ 0.6171, -2.6261],
        [-0.7297,  1.4757],
        [-0.8542, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0201, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1790, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6815e-03,  1.9039e-05],
        [-1.5334e-03,  1.9478e-05],
        [-1.9350e-03,  9.1656e-05],
        [-1.7151e-03,  1.3127e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6823],
        [ 0.6178, -2.6263],
        [-0.7294,  1.4758],
        [-0.8536, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8719, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1571, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.5488e-03,  2.8554e-06],
        [-1.8037e-03,  5.3338e-05],
        [-1.8801e-03,  8.5659e-05],
        [-1.6009e-03, -1.2905e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6823],
        [ 0.6176, -2.6262],
        [-0.7294,  1.4758],
        [-0.8535, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6806, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1460, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.0100e-03,  3.3849e-05],
        [-1.9431e-03, -1.9709e-06],
        [-2.4766e-03,  2.4863e-04],
        [-2.0317e-03,  1.3137e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6823],
        [ 0.6174, -2.6263],
        [-0.7300,  1.4760],
        [-0.8539, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7952, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1575, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2189e-03,  1.1282e-04],
        [-2.2388e-03,  5.3036e-05],
        [-2.0382e-03,  1.0299e-04],
        [-2.0125e-03,  1.7861e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6824],
        [ 0.6172, -2.6263],
        [-0.7295,  1.4758],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6435, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1386, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9405e-03,  4.2081e-05],
        [-1.8766e-03, -6.4046e-06],
        [-1.6203e-03, -2.3108e-05],
        [-1.6458e-03, -9.0546e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6823],
        [ 0.6175, -2.6263],
        [-0.7291,  1.4757],
        [-0.8535, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8260, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1576, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9413e-03,  3.6682e-05],
        [-1.6366e-03, -8.1154e-05],
        [-1.9202e-03, -5.8730e-05],
        [-1.8968e-03,  2.0053e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6823],
        [ 0.6178, -2.6264],
        [-0.7294,  1.4757],
        [-0.8538, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7050, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1401, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 2, Batch:100, loss: 0.001401, Time: 38.8
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.4801e-03,  7.0761e-05],
        [-2.7132e-03,  9.8162e-05],
        [-2.5709e-03,  1.6469e-04],
        [-2.5244e-03,  1.5956e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6823],
        [ 0.6167, -2.6262],
        [-0.7301,  1.4759],
        [-0.8544, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5862, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1278, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.0665e-03,  1.0505e-04],
        [-1.8761e-03,  7.2598e-05],
        [-1.9460e-03,  6.0041e-05],
        [-1.8813e-03,  3.2167e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6824],
        [ 0.6176, -2.6262],
        [-0.7295,  1.4758],
        [-0.8538, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8954, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0343, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1581, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.3613e-03, -6.9944e-05],
        [-2.3593e-03, -4.3664e-05],
        [-2.6109e-03, -1.8783e-05],
        [-2.4647e-03,  1.5625e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6822],
        [ 0.6171, -2.6264],
        [-0.7301,  1.4758],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0790, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0412, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1902, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.0691e-03, -6.1261e-05],
        [-1.9395e-03, -1.1351e-04],
        [-1.9732e-03, -4.4929e-05],
        [-2.0417e-03, -1.3919e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6822],
        [ 0.6175, -2.6264],
        [-0.7295,  1.4757],
        [-0.8539, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0915, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0466, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2023, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.6426e-03,  5.2525e-05],
        [-1.8214e-03, -9.9221e-05],
        [-1.9523e-03,  8.9444e-05],
        [-1.9214e-03,  2.8250e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6823],
        [ 0.6176, -2.6264],
        [-0.7295,  1.4759],
        [-0.8538, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7611, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0382, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1524, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9502e-03, -5.5400e-05],
        [-2.0343e-03, -8.8189e-06],
        [-1.9933e-03, -3.3342e-05],
        [-2.1330e-03, -7.4598e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6822],
        [ 0.6174, -2.6263],
        [-0.7295,  1.4758],
        [-0.8540, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5128, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1261, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.0611e-03, -4.8935e-05],
        [-1.9945e-03,  5.1093e-05],
        [-1.9667e-03, -3.8636e-05],
        [-1.9747e-03, -8.3087e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6822],
        [ 0.6175, -2.6263],
        [-0.7295,  1.4758],
        [-0.8538, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9486, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1714, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1636e-03, -4.4697e-06],
        [-2.2953e-03,  2.8032e-06],
        [-1.9718e-03, -3.9037e-05],
        [-1.8914e-03, -1.2310e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6822],
        [ 0.6172, -2.6263],
        [-0.7295,  1.4758],
        [-0.8537, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7713, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1591, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2510e-03, -9.3583e-05],
        [-2.1621e-03, -6.9374e-05],
        [-2.0968e-03, -1.0140e-04],
        [-2.2251e-03, -6.1564e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6821],
        [ 0.6173, -2.6264],
        [-0.7297,  1.4757],
        [-0.8541, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6346, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1415, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.0629e-03,  1.7802e-05],
        [-2.4623e-03,  1.7460e-04],
        [-2.2677e-03, -4.7305e-05],
        [-2.4708e-03,  6.1315e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6822],
        [ 0.6170, -2.6262],
        [-0.7298,  1.4757],
        [-0.8543, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7264, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1468, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.8960e-03, -6.0494e-05],
        [-1.5841e-03, -1.4418e-04],
        [-1.6871e-03, -1.2648e-04],
        [-2.0433e-03, -1.5717e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6822],
        [ 0.6179, -2.6265],
        [-0.7292,  1.4757],
        [-0.8539, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9192, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0314, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1548, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2620e-03,  6.9576e-05],
        [-2.6456e-03,  1.9609e-05],
        [-2.4938e-03, -7.6389e-05],
        [-2.1239e-03,  6.2129e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6823],
        [ 0.6168, -2.6264],
        [-0.7301,  1.4757],
        [-0.8540, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6814, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1491, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017, -0.0002],
        [-0.0016, -0.0002],
        [-0.0015, -0.0001],
        [-0.0015, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6821],
        [ 0.6179, -2.6266],
        [-0.7291,  1.4757],
        [-0.8534, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7232, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1515, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0020, -0.0002],
        [-0.0022, -0.0001],
        [-0.0021, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6821],
        [ 0.6175, -2.6266],
        [-0.7297,  1.4756],
        [-0.8540, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8746, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0335, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1545, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0003],
        [-0.0021, -0.0002],
        [-0.0024, -0.0003],
        [-0.0020, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6819],
        [ 0.6174, -2.6266],
        [-0.7299,  1.4755],
        [-0.8538, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7433, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1446, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0001],
        [-0.0020, -0.0002],
        [-0.0022, -0.0001],
        [-0.0021, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6821],
        [ 0.6175, -2.6266],
        [-0.7298,  1.4757],
        [-0.8540, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5664, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1389, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018, -0.0001],
        [-0.0019, -0.0003],
        [-0.0017, -0.0001],
        [-0.0019, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6821],
        [ 0.6175, -2.6267],
        [-0.7293,  1.4757],
        [-0.8538, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.4632, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0345, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2153, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0003],
        [-0.0024, -0.0002],
        [-0.0024, -0.0003],
        [-0.0024, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6819],
        [ 0.6170, -2.6267],
        [-0.7300,  1.4755],
        [-0.8542, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6543, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0451, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1556, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2762e-03, -1.3528e-04],
        [-2.2574e-03, -9.8409e-05],
        [-2.4969e-03, -1.0613e-04],
        [-2.4854e-03, -6.2605e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6821],
        [ 0.6172, -2.6265],
        [-0.7301,  1.4757],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5356, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0323, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1182, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.1276e-03, -1.1352e-04],
        [-1.8580e-03, -1.6802e-04],
        [-2.1707e-03, -8.7915e-05],
        [-2.0598e-03, -1.7861e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6821],
        [ 0.6176, -2.6266],
        [-0.7298,  1.4757],
        [-0.8539, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6822, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1464, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0001],
        [-0.0022, -0.0002],
        [-0.0022, -0.0003],
        [-0.0024, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6821],
        [ 0.6173, -2.6267],
        [-0.7298,  1.4755],
        [-0.8542, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7962, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1592, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017, -0.0003],
        [-0.0021, -0.0002],
        [-0.0020, -0.0002],
        [-0.0019, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6820],
        [ 0.6173, -2.6266],
        [-0.7296,  1.4756],
        [-0.8537, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6503, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1448, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0019, -0.0003],
        [-0.0023, -0.0002],
        [-0.0020, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6819],
        [ 0.6175, -2.6267],
        [-0.7299,  1.4756],
        [-0.8538, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7400, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1457, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018, -0.0003],
        [-0.0019, -0.0003],
        [-0.0018, -0.0003],
        [-0.0019, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6819],
        [ 0.6175, -2.6268],
        [-0.7294,  1.4755],
        [-0.8537, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8197, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1586, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019, -0.0003],
        [-0.0022, -0.0003],
        [-0.0021, -0.0003],
        [-0.0019, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6820],
        [ 0.6172, -2.6267],
        [-0.7297,  1.4755],
        [-0.8538, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8193, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1600, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0021, -0.0002],
        [-0.0021, -0.0003],
        [-0.0020, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6820],
        [ 0.6173, -2.6267],
        [-0.7297,  1.4755],
        [-0.8538, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5300, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1213, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0003],
        [-0.0020, -0.0003],
        [-0.0023, -0.0004],
        [-0.0021, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6820],
        [ 0.6174, -2.6267],
        [-0.7299,  1.4755],
        [-0.8539, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7234, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1489, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0019, -0.0003],
        [-0.0020, -0.0003],
        [-0.0022, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6819],
        [ 0.6175, -2.6268],
        [-0.7296,  1.4755],
        [-0.8540, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6729, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1431, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0026, -0.0004],
        [-0.0021, -0.0002],
        [-0.0025, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6819],
        [ 0.6168, -2.6269],
        [-0.7298,  1.4756],
        [-0.8543, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5595, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0349, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1257, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0003],
        [-0.0025, -0.0003],
        [-0.0022, -0.0002],
        [-0.0024, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6820],
        [ 0.6168, -2.6267],
        [-0.7298,  1.4756],
        [-0.8542, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6815, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1460, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0004],
        [-0.0022, -0.0003],
        [-0.0022, -0.0004],
        [-0.0022, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6818],
        [ 0.6172, -2.6268],
        [-0.7298,  1.4755],
        [-0.8540, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6066, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1344, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0004],
        [-0.0018, -0.0004],
        [-0.0018, -0.0002],
        [-0.0020, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6819],
        [ 0.6176, -2.6268],
        [-0.7294,  1.4757],
        [-0.8538, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.3110, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0461, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.2232, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019, -0.0004],
        [-0.0021, -0.0004],
        [-0.0021, -0.0004],
        [-0.0021, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6819],
        [ 0.6173, -2.6269],
        [-0.7297,  1.4755],
        [-0.8539, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8131, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0469, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1751, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0020, -0.0003],
        [-0.0021, -0.0004],
        [-0.0024, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6820],
        [ 0.6174, -2.6268],
        [-0.7296,  1.4755],
        [-0.8541, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7187, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1484, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0004],
        [-0.0021, -0.0003],
        [-0.0021, -0.0004],
        [-0.0020, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6819],
        [ 0.6172, -2.6268],
        [-0.7296,  1.4755],
        [-0.8538, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7277, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1484, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0016, -0.0004],
        [-0.0021, -0.0004],
        [-0.0018, -0.0004],
        [-0.0017, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3098,  0.6819],
        [ 0.6173, -2.6269],
        [-0.7294,  1.4755],
        [-0.8534, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7409, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1482, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0004],
        [-0.0021, -0.0005],
        [-0.0022, -0.0004],
        [-0.0023, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6819],
        [ 0.6172, -2.6269],
        [-0.7298,  1.4755],
        [-0.8540, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7461, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1480, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0004],
        [-0.0024, -0.0005],
        [-0.0024, -0.0004],
        [-0.0022, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6819],
        [ 0.6169, -2.6269],
        [-0.7300,  1.4755],
        [-0.8539, -2.7489]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5756, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1346, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0005],
        [-0.0024, -0.0005],
        [-0.0023, -0.0005],
        [-0.0026, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6818],
        [ 0.6170, -2.6269],
        [-0.7299,  1.4754],
        [-0.8543, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8266, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1580, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0005],
        [-0.0024, -0.0004],
        [-0.0026, -0.0004],
        [-0.0023, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6819],
        [ 0.6169, -2.6268],
        [-0.7302,  1.4756],
        [-0.8540, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7838, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1460, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028, -0.0004],
        [-0.0030, -0.0003],
        [-0.0029, -0.0004],
        [-0.0027, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6819],
        [ 0.6164, -2.6268],
        [-0.7305,  1.4755],
        [-0.8544, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9129, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1612, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0003],
        [-0.0021, -0.0003],
        [-0.0024, -0.0003],
        [-0.0023, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6820],
        [ 0.6173, -2.6267],
        [-0.7300,  1.4757],
        [-0.8540, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2705, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1970, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0004],
        [-0.0021, -0.0005],
        [-0.0022, -0.0004],
        [-0.0021, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6820],
        [ 0.6172, -2.6269],
        [-0.7298,  1.4756],
        [-0.8538, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6442, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1460, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0018, -0.0003],
        [-0.0018, -0.0004],
        [-0.0017, -0.0005],
        [-0.0021, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6820],
        [ 0.6176, -2.6268],
        [-0.7293,  1.4755],
        [-0.8538, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9960, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1708, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019, -0.0005],
        [-0.0019, -0.0003],
        [-0.0022, -0.0006],
        [-0.0023, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3095,  0.6818],
        [ 0.6174, -2.6267],
        [-0.7297,  1.4754],
        [-0.8540, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1354, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1964, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0020, -0.0004],
        [-0.0019, -0.0004],
        [-0.0018, -0.0004],
        [-0.0016, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6819],
        [ 0.6175, -2.6268],
        [-0.7293,  1.4756],
        [-0.8532, -2.7488]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7616, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1427, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0004],
        [-0.0023, -0.0003],
        [-0.0025, -0.0005],
        [-0.0026, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6819],
        [ 0.6171, -2.6267],
        [-0.7300,  1.4755],
        [-0.8543, -2.7487]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7174, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1512, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027, -0.0003],
        [-0.0027, -0.0003],
        [-0.0027, -0.0003],
        [-0.0027, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6820],
        [ 0.6166, -2.6266],
        [-0.7303,  1.4757],
        [-0.8544, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8809, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0354, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1589, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0003],
        [-0.0019, -0.0003],
        [-0.0019, -0.0003],
        [-0.0020, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6820],
        [ 0.6175, -2.6266],
        [-0.7295,  1.4757],
        [-0.8536, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6864, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0341, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1368, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0004],
        [-0.0019, -0.0004],
        [-0.0019, -0.0003],
        [-0.0019, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6819],
        [ 0.6174, -2.6267],
        [-0.7295,  1.4757],
        [-0.8535, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0817, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0424, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1929, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0003],
        [-0.0021, -0.0003],
        [-0.0023, -0.0003],
        [-0.0022, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6820],
        [ 0.6173, -2.6266],
        [-0.7299,  1.4758],
        [-0.8538, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.1062, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1894, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0002],
        [-0.0021, -0.0003],
        [-0.0019, -0.0002],
        [-0.0021, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6821],
        [ 0.6172, -2.6266],
        [-0.7295,  1.4758],
        [-0.8537, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6736, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1476, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0004],
        [-0.0022, -0.0003],
        [-0.0018, -0.0003],
        [-0.0019, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6819],
        [ 0.6172, -2.6266],
        [-0.7294,  1.4757],
        [-0.8536, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6434, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1356, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0004],
        [-0.0023, -0.0002],
        [-0.0023, -0.0003],
        [-0.0027, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6820],
        [ 0.6170, -2.6265],
        [-0.7299,  1.4758],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8322, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0417, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1666, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0004],
        [-0.0022, -0.0004],
        [-0.0023, -0.0005],
        [-0.0023, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6819],
        [ 0.6171, -2.6267],
        [-0.7299,  1.4756],
        [-0.8540, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5631, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1337, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0004],
        [-0.0024, -0.0002],
        [-0.0026, -0.0003],
        [-0.0024, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6820],
        [ 0.6169, -2.6265],
        [-0.7301,  1.4757],
        [-0.8541, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.2030, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0325, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1853, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029, -0.0003],
        [-0.0026, -0.0003],
        [-0.0027, -0.0003],
        [-0.0027, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6820],
        [ 0.6167, -2.6265],
        [-0.7302,  1.4758],
        [-0.8544, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5787, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1349, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0001],
        [-0.0023, -0.0001],
        [-0.0023, -0.0002],
        [-0.0020, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6823],
        [ 0.6171, -2.6264],
        [-0.7299,  1.4759],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6728, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1426, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0004],
        [-0.0023, -0.0005],
        [-0.0020, -0.0004],
        [-0.0020, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6820],
        [ 0.6171, -2.6267],
        [-0.7296,  1.4757],
        [-0.8537, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7553, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1508, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032, -0.0003],
        [-0.0029, -0.0003],
        [-0.0029, -0.0004],
        [-0.0030, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6820],
        [ 0.6165, -2.6266],
        [-0.7305,  1.4757],
        [-0.8546, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6077, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1373, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0003],
        [-0.0025, -0.0004],
        [-0.0027, -0.0003],
        [-0.0023, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6820],
        [ 0.6169, -2.6266],
        [-0.7303,  1.4758],
        [-0.8539, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7796, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1527, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0004],
        [-0.0024, -0.0003],
        [-0.0024, -0.0004],
        [-0.0023, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6820],
        [ 0.6169, -2.6265],
        [-0.7300,  1.4757],
        [-0.8539, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7135, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1516, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0004],
        [-0.0024, -0.0003],
        [-0.0024, -0.0004],
        [-0.0027, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6819],
        [ 0.6170, -2.6265],
        [-0.7300,  1.4757],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4932, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0410, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1312, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0024, -0.0003],
        [-0.0023, -0.0004],
        [-0.0024, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6821],
        [ 0.6170, -2.6265],
        [-0.7299,  1.4757],
        [-0.8541, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5402, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1216, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0004],
        [-0.0021, -0.0004],
        [-0.0026, -0.0004],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6819],
        [ 0.6172, -2.6266],
        [-0.7302,  1.4757],
        [-0.8542, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7762, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1506, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019, -0.0004],
        [-0.0020, -0.0004],
        [-0.0016, -0.0003],
        [-0.0020, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6820],
        [ 0.6173, -2.6266],
        [-0.7293,  1.4758],
        [-0.8536, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8478, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1630, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0004],
        [-0.0021, -0.0004],
        [-0.0019, -0.0005],
        [-0.0021, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6819],
        [ 0.6172, -2.6266],
        [-0.7295,  1.4756],
        [-0.8537, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5909, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1327, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0003],
        [-0.0028, -0.0004],
        [-0.0024, -0.0004],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6820],
        [ 0.6166, -2.6266],
        [-0.7301,  1.4757],
        [-0.8542, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  43
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8916, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0457, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1805, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019, -0.0003],
        [-0.0023, -0.0004],
        [-0.0023, -0.0003],
        [-0.0022, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6820],
        [ 0.6170, -2.6266],
        [-0.7299,  1.4758],
        [-0.8538, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7434, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0302, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1347, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0005],
        [-0.0020, -0.0004],
        [-0.0023, -0.0005],
        [-0.0022, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6818],
        [ 0.6174, -2.6266],
        [-0.7299,  1.4756],
        [-0.8538, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5427, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0338, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1220, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0003],
        [-0.0023, -0.0003],
        [-0.0023, -0.0004],
        [-0.0023, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6821],
        [ 0.6170, -2.6265],
        [-0.7299,  1.4757],
        [-0.8539, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5643, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1353, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0002],
        [-0.0025, -0.0004],
        [-0.0025, -0.0003],
        [-0.0024, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6821],
        [ 0.6169, -2.6266],
        [-0.7301,  1.4758],
        [-0.8540, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6659, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0318, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1302, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027, -0.0003],
        [-0.0024, -0.0004],
        [-0.0025, -0.0003],
        [-0.0024, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6820],
        [ 0.6169, -2.6265],
        [-0.7301,  1.4759],
        [-0.8540, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6940, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1460, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0003],
        [-0.0024, -0.0002],
        [-0.0027, -0.0001],
        [-0.0025, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6820],
        [ 0.6169, -2.6264],
        [-0.7304,  1.4760],
        [-0.8542, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8567, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1651, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0027, -0.0003],
        [-0.0027, -0.0003],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6820],
        [ 0.6166, -2.6265],
        [-0.7304,  1.4758],
        [-0.8542, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7527, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1468, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0003],
        [-0.0020, -0.0003],
        [-0.0021, -0.0003],
        [-0.0022, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6820],
        [ 0.6173, -2.6265],
        [-0.7298,  1.4758],
        [-0.8538, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7583, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1617, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027, -0.0003],
        [-0.0028, -0.0003],
        [-0.0023, -0.0004],
        [-0.0024, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6820],
        [ 0.6166, -2.6264],
        [-0.7300,  1.4758],
        [-0.8540, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5853, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0285, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1156, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0003],
        [-0.0022, -0.0002],
        [-0.0023, -0.0002],
        [-0.0024, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6820],
        [ 0.6171, -2.6264],
        [-0.7300,  1.4759],
        [-0.8540, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9956, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1752, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027, -0.0004],
        [-0.0022, -0.0005],
        [-0.0023, -0.0003],
        [-0.0027, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6819],
        [ 0.6171, -2.6266],
        [-0.7301,  1.4758],
        [-0.8543, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5394, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0403, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1345, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0003],
        [-0.0024, -0.0005],
        [-0.0026, -0.0005],
        [-0.0026, -0.0005]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6820],
        [ 0.6169, -2.6266],
        [-0.7303,  1.4756],
        [-0.8543, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5442, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1321, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0021, -0.0003],
        [-0.0024, -0.0004],
        [-0.0021, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6821],
        [ 0.6172, -2.6264],
        [-0.7301,  1.4758],
        [-0.8538, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4681, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1179, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0004],
        [-0.0027, -0.0003],
        [-0.0027, -0.0003],
        [-0.0022, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6819],
        [ 0.6166, -2.6265],
        [-0.7304,  1.4758],
        [-0.8539, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6453, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1429, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0002],
        [-0.0023, -0.0003],
        [-0.0021, -0.0003],
        [-0.0020, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6821],
        [ 0.6170, -2.6264],
        [-0.7299,  1.4758],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7709, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0355, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1481, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0003],
        [-0.0025, -0.0003],
        [-0.0030, -0.0003],
        [-0.0025, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6821],
        [ 0.6168, -2.6265],
        [-0.7307,  1.4758],
        [-0.8541, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5406, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1259, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0003],
        [-0.0024, -0.0003],
        [-0.0022, -0.0002],
        [-0.0023, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6820],
        [ 0.6169, -2.6265],
        [-0.7300,  1.4759],
        [-0.8540, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7513, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0411, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1573, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031, -0.0003],
        [-0.0027, -0.0003],
        [-0.0026, -0.0003],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6821],
        [ 0.6166, -2.6265],
        [-0.7304,  1.4759],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5470, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1325, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0002],
        [-0.0026, -0.0004],
        [-0.0029, -0.0002],
        [-0.0024, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6821],
        [ 0.6168, -2.6265],
        [-0.7307,  1.4759],
        [-0.8540, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8341, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0394, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1621, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0002],
        [-0.0021, -0.0003],
        [-0.0024, -0.0002],
        [-0.0021, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6821],
        [ 0.6172, -2.6264],
        [-0.7302,  1.4760],
        [-0.8538, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6186, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1405, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019, -0.0002],
        [-0.0019, -0.0003],
        [-0.0021, -0.0002],
        [-0.0020, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6821],
        [ 0.6174, -2.6265],
        [-0.7299,  1.4760],
        [-0.8537, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7248, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0401, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1526, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0005],
        [-0.0021, -0.0004],
        [-0.0020, -0.0005],
        [-0.0020, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6818],
        [ 0.6172, -2.6266],
        [-0.7298,  1.4757],
        [-0.8537, -2.7486]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6086, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0422, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1453, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0003],
        [-0.0023, -0.0005],
        [-0.0021, -0.0004],
        [-0.0025, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6820],
        [ 0.6170, -2.6267],
        [-0.7299,  1.4758],
        [-0.8542, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6609, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0329, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1318, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0002],
        [-0.0022, -0.0002],
        [-0.0023, -0.0003],
        [-0.0024, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6821],
        [ 0.6171, -2.6264],
        [-0.7301,  1.4759],
        [-0.8541, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6012, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1344, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0002],
        [-0.0026, -0.0002],
        [-0.0025, -0.0002],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6820],
        [ 0.6167, -2.6264],
        [-0.7303,  1.4759],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5339, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0396, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1325, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0003],
        [-0.0022, -0.0002],
        [-0.0021, -0.0004],
        [-0.0021, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6820],
        [ 0.6171, -2.6264],
        [-0.7299,  1.4758],
        [-0.8538, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6118, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1345, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017, -0.0001],
        [-0.0019, -0.0002],
        [-0.0021, -0.0002],
        [-0.0018, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3097,  0.6821],
        [ 0.6174, -2.6264],
        [-0.7299,  1.4760],
        [-0.8535, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7489, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1472, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027, -0.0002],
        [-0.0025, -0.0002],
        [-0.0028, -0.0003],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6820],
        [ 0.6168, -2.6264],
        [-0.7306,  1.4759],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9471, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0371, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1689, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0017, -0.0002],
        [-0.0020, -0.0004],
        [-0.0022, -0.0004],
        [-0.0019, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3096,  0.6820],
        [ 0.6172, -2.6266],
        [-0.7300,  1.4758],
        [-0.8536, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6982, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1415, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0003],
        [-0.0024, -0.0003],
        [-0.0029, -0.0002],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6820],
        [ 0.6169, -2.6265],
        [-0.7307,  1.4759],
        [-0.8543, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6199, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0402, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1425, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0003],
        [-0.0026, -0.0003],
        [-0.0024, -0.0003],
        [-0.0025, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6819],
        [ 0.6167, -2.6265],
        [-0.7301,  1.4759],
        [-0.8542, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4637, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1170, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0003],
        [-0.0025, -0.0004],
        [-0.0022, -0.0003],
        [-0.0027, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6819],
        [ 0.6168, -2.6266],
        [-0.7300,  1.4758],
        [-0.8544, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5105, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1245, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
Train Epoch: 2, Batch:200, loss: 0.000623, Time: 74.7
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019, -0.0003],
        [-0.0019, -0.0003],
        [-0.0023, -0.0003],
        [-0.0022, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6819],
        [ 0.6174, -2.6265],
        [-0.7301,  1.4759],
        [-0.8539, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6360, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0374, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1383, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5020e-03, -1.3968e-04],
        [-2.2554e-03, -1.6378e-04],
        [-2.1618e-03, -9.9307e-05],
        [-1.9800e-03, -5.4113e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6821],
        [ 0.6171, -2.6264],
        [-0.7299,  1.4761],
        [-0.8537, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7001, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0360, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1420, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7870e-03, -1.6501e-04],
        [-2.7295e-03, -1.8646e-04],
        [-2.5464e-03, -4.1314e-05],
        [-2.5803e-03, -8.7338e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6820],
        [ 0.6166, -2.6264],
        [-0.7303,  1.4761],
        [-0.8543, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8016, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0313, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1427, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0002],
        [-0.0022, -0.0002],
        [-0.0025, -0.0001],
        [-0.0023, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6820],
        [ 0.6171, -2.6264],
        [-0.7302,  1.4760],
        [-0.8540, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5371, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0406, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1348, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5109e-03, -9.5014e-05],
        [-2.5849e-03, -1.5881e-04],
        [-2.3365e-03, -1.4772e-04],
        [-2.4172e-03, -2.3979e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6821],
        [ 0.6167, -2.6263],
        [-0.7301,  1.4760],
        [-0.8541, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6190, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0350, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1318, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0001],
        [-0.0023, -0.0002],
        [-0.0021, -0.0002],
        [-0.0020, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6821],
        [ 0.6170, -2.6264],
        [-0.7299,  1.4759],
        [-0.8537, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5157, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1313, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0021, -0.0002],
        [-0.0020, -0.0002],
        [-0.0019, -0.0001],
        [-0.0019, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6820],
        [ 0.6173, -2.6264],
        [-0.7297,  1.4760],
        [-0.8537, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6270, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1387, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0002],
        [-0.0022, -0.0003],
        [-0.0020, -0.0003],
        [-0.0021, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6819],
        [ 0.6171, -2.6265],
        [-0.7297,  1.4758],
        [-0.8538, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7050, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1495, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0002],
        [-0.0023, -0.0001],
        [-0.0021, -0.0003],
        [-0.0019, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3091,  0.6820],
        [ 0.6170, -2.6263],
        [-0.7298,  1.4759],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  34
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6866, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1494, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0002],
        [-0.0020, -0.0003],
        [-0.0024, -0.0002],
        [-0.0022, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6819],
        [ 0.6172, -2.6264],
        [-0.7302,  1.4760],
        [-0.8539, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7613, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0462, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1685, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0002],
        [-0.0026, -0.0001],
        [-0.0021, -0.0002],
        [-0.0027, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6820],
        [ 0.6167, -2.6263],
        [-0.7298,  1.4760],
        [-0.8544, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6669, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0431, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1529, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027, -0.0002],
        [-0.0022, -0.0002],
        [-0.0027, -0.0001],
        [-0.0025, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6820],
        [ 0.6171, -2.6263],
        [-0.7304,  1.4760],
        [-0.8542, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8979, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1653, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.6284e-03, -7.0336e-05],
        [-2.9219e-03, -9.0324e-05],
        [-2.9539e-03, -3.8357e-05],
        [-2.7460e-03, -1.5394e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6821],
        [ 0.6163, -2.6263],
        [-0.7307,  1.4761],
        [-0.8544, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5832, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1301, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5877e-03, -1.0305e-04],
        [-2.5017e-03, -1.2011e-04],
        [-2.7186e-03,  2.3955e-05],
        [-2.5583e-03, -4.0029e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6820],
        [ 0.6168, -2.6263],
        [-0.7305,  1.4762],
        [-0.8543, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4895, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0386, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1262, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0019, -0.0002],
        [-0.0019, -0.0002],
        [-0.0019, -0.0002],
        [-0.0020, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3094,  0.6819],
        [ 0.6174, -2.6263],
        [-0.7296,  1.4760],
        [-0.8536, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6320, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0389, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1409, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9889e-03, -1.9306e-04],
        [-2.2460e-03, -9.9797e-05],
        [-2.1656e-03, -2.7518e-04],
        [-2.5506e-03, -2.3285e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6819],
        [ 0.6170, -2.6262],
        [-0.7299,  1.4759],
        [-0.8542, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4985, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0438, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1374, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0021, -0.0002],
        [-0.0024, -0.0002],
        [-0.0023, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6820],
        [ 0.6172, -2.6263],
        [-0.7301,  1.4760],
        [-0.8539, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6238, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1346, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2775e-03, -1.8257e-04],
        [-2.4706e-03, -8.7919e-05],
        [-2.7414e-03, -1.3278e-04],
        [-2.5943e-03, -2.2011e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6819],
        [ 0.6168, -2.6262],
        [-0.7305,  1.4761],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5354, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0317, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1169, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9592e-03, -4.3302e-05],
        [-3.1382e-03, -7.3145e-05],
        [-3.0994e-03,  2.1900e-05],
        [-3.1546e-03,  3.7578e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6821],
        [ 0.6161, -2.6262],
        [-0.7308,  1.4762],
        [-0.8548, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6816, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0363, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1407, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.3198e-03,  7.8958e-06],
        [-2.5821e-03, -2.4385e-05],
        [-2.4501e-03, -1.3356e-04],
        [-2.0773e-03, -4.6145e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6821],
        [ 0.6167, -2.6261],
        [-0.7302,  1.4761],
        [-0.8537, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6111, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1392, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9253e-03, -1.1072e-04],
        [-2.9697e-03,  2.1064e-05],
        [-3.0421e-03, -2.4702e-05],
        [-3.2493e-03, -4.3664e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6820],
        [ 0.6163, -2.6261],
        [-0.7308,  1.4762],
        [-0.8549, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5333, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0473, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1480, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9661e-03, -9.6115e-05],
        [-2.0893e-03, -8.9410e-05],
        [-2.1590e-03, -4.3384e-05],
        [-1.9843e-03, -1.0521e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3093,  0.6820],
        [ 0.6172, -2.6262],
        [-0.7299,  1.4762],
        [-0.8536, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6172, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0391, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1399, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.3859e-03, -4.5073e-05],
        [-2.3014e-03, -4.4868e-07],
        [-2.0840e-03, -1.3764e-04],
        [-2.3029e-03, -3.9242e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6821],
        [ 0.6170, -2.6261],
        [-0.7298,  1.4761],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7912, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1524, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.3321e-03, -2.7005e-05],
        [-2.6117e-03, -9.7441e-05],
        [-2.1532e-03, -9.2521e-05],
        [-2.3616e-03, -9.3298e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6821],
        [ 0.6167, -2.6262],
        [-0.7299,  1.4761],
        [-0.8540, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0639, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1849, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0003],
        [-0.0025, -0.0002],
        [-0.0024, -0.0002],
        [-0.0027, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6818],
        [ 0.6168, -2.6263],
        [-0.7301,  1.4760],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6222, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1396, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0002],
        [-0.0023, -0.0002],
        [-0.0023, -0.0002],
        [-0.0024, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6819],
        [ 0.6170, -2.6263],
        [-0.7300,  1.4760],
        [-0.8540, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6031, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1306, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.2882e-03, -8.3629e-05],
        [-2.9767e-03, -6.4992e-05],
        [-2.6075e-03, -3.8005e-05],
        [-2.7588e-03, -9.4754e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6820],
        [ 0.6163, -2.6262],
        [-0.7303,  1.4762],
        [-0.8544, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7648, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1623, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-1.9806e-03, -6.3189e-05],
        [-2.2778e-03, -2.0286e-04],
        [-2.4162e-03, -1.4257e-04],
        [-2.2688e-03, -1.6811e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3092,  0.6820],
        [ 0.6170, -2.6263],
        [-0.7301,  1.4761],
        [-0.8539, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6411, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1395, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.4174e-03, -5.3185e-05],
        [-2.1786e-03, -7.8432e-05],
        [-2.5588e-03, -6.1713e-05],
        [-2.5400e-03, -6.1848e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6820],
        [ 0.6171, -2.6262],
        [-0.7302,  1.4761],
        [-0.8541, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7285, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0407, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1542, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5652e-03, -6.1994e-05],
        [-2.5560e-03, -1.0586e-04],
        [-2.3610e-03, -8.3534e-05],
        [-2.5943e-03,  3.0024e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6820],
        [ 0.6167, -2.6262],
        [-0.7300,  1.4761],
        [-0.8542, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5727, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1238, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9450e-03, -9.0149e-05],
        [-2.6062e-03, -7.9169e-05],
        [-2.8115e-03, -8.7043e-06],
        [-2.8416e-03, -1.2742e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6820],
        [ 0.6167, -2.6262],
        [-0.7305,  1.4762],
        [-0.8544, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(1.0240, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0336, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1696, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7734e-03, -2.1531e-04],
        [-2.9258e-03, -9.9394e-05],
        [-2.6164e-03, -1.7464e-04],
        [-2.7816e-03, -1.5202e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6819],
        [ 0.6164, -2.6262],
        [-0.7303,  1.4760],
        [-0.8543, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6149, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1346, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.8570e-03, -7.2956e-05],
        [-2.4960e-03, -7.9119e-05],
        [-2.1967e-03, -8.8211e-05],
        [-2.6689e-03, -6.1385e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6820],
        [ 0.6168, -2.6262],
        [-0.7298,  1.4761],
        [-0.8542, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5904, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1365, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0002],
        [-0.0023, -0.0002],
        [-0.0027, -0.0002],
        [-0.0026, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6819],
        [ 0.6170, -2.6263],
        [-0.7304,  1.4760],
        [-0.8542, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6677, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1361, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0001],
        [-0.0024, -0.0002],
        [-0.0028, -0.0001],
        [-0.0023, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6820],
        [ 0.6169, -2.6263],
        [-0.7304,  1.4761],
        [-0.8539, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6442, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1425, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.4306e-03, -1.3748e-04],
        [-2.3396e-03, -9.7675e-05],
        [-2.6812e-03, -1.5257e-04],
        [-2.6364e-03, -1.1599e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6819],
        [ 0.6170, -2.6262],
        [-0.7303,  1.4761],
        [-0.8542, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5042, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1259, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0002],
        [-0.0029, -0.0002],
        [-0.0026, -0.0002],
        [-0.0026, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6819],
        [ 0.6164, -2.6263],
        [-0.7302,  1.4761],
        [-0.8541, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5649, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0328, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1221, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0023, -0.0002],
        [-0.0025, -0.0002],
        [-0.0025, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6819],
        [ 0.6170, -2.6263],
        [-0.7301,  1.4761],
        [-0.8541, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8588, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0427, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1713, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0002],
        [-0.0023, -0.0002],
        [-0.0024, -0.0002],
        [-0.0023, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6819],
        [ 0.6170, -2.6264],
        [-0.7300,  1.4761],
        [-0.8539, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4962, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0297, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1090, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0025, -0.0002],
        [-0.0026, -0.0002],
        [-0.0023, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6819],
        [ 0.6168, -2.6263],
        [-0.7302,  1.4761],
        [-0.8538, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6462, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0414, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1474, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0002],
        [-0.0027, -0.0003],
        [-0.0027, -0.0003],
        [-0.0025, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6819],
        [ 0.6166, -2.6264],
        [-0.7303,  1.4760],
        [-0.8541, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5357, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0449, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1433, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028, -0.0003],
        [-0.0027, -0.0002],
        [-0.0030, -0.0004],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6818],
        [ 0.6166, -2.6264],
        [-0.7305,  1.4759],
        [-0.8542, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9532, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1715, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0003],
        [-0.0027, -0.0003],
        [-0.0028, -0.0003],
        [-0.0029, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6818],
        [ 0.6167, -2.6265],
        [-0.7304,  1.4760],
        [-0.8544, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4697, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0356, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1182, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0002],
        [-0.0024, -0.0001],
        [-0.0025, -0.0001],
        [-0.0029, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6819],
        [ 0.6169, -2.6262],
        [-0.7301,  1.4762],
        [-0.8544, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8372, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0384, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1605, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0021, -0.0003],
        [-0.0022, -0.0003],
        [-0.0021, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6817],
        [ 0.6173, -2.6264],
        [-0.7298,  1.4760],
        [-0.8536, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9241, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0357, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1637, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0002],
        [-0.0025, -0.0002],
        [-0.0025, -0.0001],
        [-0.0028, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6818],
        [ 0.6169, -2.6263],
        [-0.7301,  1.4762],
        [-0.8542, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5958, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1391, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0031, -0.0003],
        [-0.0027, -0.0003],
        [-0.0030, -0.0003],
        [-0.0028, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6817],
        [ 0.6167, -2.6264],
        [-0.7305,  1.4760],
        [-0.8543, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4672, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0351, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1170, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033, -0.0003],
        [-0.0034, -0.0004],
        [-0.0033, -0.0002],
        [-0.0034, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6817],
        [ 0.6160, -2.6265],
        [-0.7308,  1.4761],
        [-0.8549, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5036, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0342, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1187, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0026, -0.0003],
        [-0.0031, -0.0004],
        [-0.0027, -0.0005],
        [-0.0027, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6817],
        [ 0.6163, -2.6265],
        [-0.7302,  1.4758],
        [-0.8542, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6500, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0369, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1387, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0022, -0.0003],
        [-0.0028, -0.0004],
        [-0.0029, -0.0004],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3090,  0.6817],
        [ 0.6166, -2.6265],
        [-0.7304,  1.4759],
        [-0.8541, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5531, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0420, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1393, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032, -0.0004],
        [-0.0037, -0.0004],
        [-0.0031, -0.0003],
        [-0.0032, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6816],
        [ 0.6157, -2.6265],
        [-0.7306,  1.4760],
        [-0.8546, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7630, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1494, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032, -0.0004],
        [-0.0033, -0.0004],
        [-0.0035, -0.0003],
        [-0.0033, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6816],
        [ 0.6161, -2.6265],
        [-0.7309,  1.4760],
        [-0.8547, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4703, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0455, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1381, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029, -0.0003],
        [-0.0026, -0.0002],
        [-0.0026, -0.0003],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6817],
        [ 0.6169, -2.6264],
        [-0.7301,  1.4760],
        [-0.8541, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4649, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0340, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1144, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028, -0.0002],
        [-0.0027, -0.0004],
        [-0.0029, -0.0003],
        [-0.0031, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6817],
        [ 0.6168, -2.6266],
        [-0.7303,  1.4760],
        [-0.8546, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5085, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0367, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1242, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0004],
        [-0.0027, -0.0003],
        [-0.0028, -0.0003],
        [-0.0025, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6816],
        [ 0.6168, -2.6265],
        [-0.7302,  1.4761],
        [-0.8540, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6106, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0377, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1364, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0030, -0.0003],
        [-0.0028, -0.0003],
        [-0.0027, -0.0003],
        [-0.0030, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6816],
        [ 0.6167, -2.6265],
        [-0.7301,  1.4761],
        [-0.8544, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5838, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0372, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1327, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0023, -0.0004],
        [-0.0025, -0.0003],
        [-0.0024, -0.0004],
        [-0.0027, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3089,  0.6816],
        [ 0.6170, -2.6265],
        [-0.7298,  1.4760],
        [-0.8541, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4895, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0347, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1183, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028, -0.0003],
        [-0.0027, -0.0003],
        [-0.0031, -0.0004],
        [-0.0029, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6816],
        [ 0.6168, -2.6264],
        [-0.7306,  1.4759],
        [-0.8544, -2.7485]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5372, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0452, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1442, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0027, -0.0004],
        [-0.0025, -0.0004],
        [-0.0026, -0.0004],
        [-0.0030, -0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6815],
        [ 0.6170, -2.6265],
        [-0.7300,  1.4760],
        [-0.8544, -2.7484]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8816, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0390, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1662, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028, -0.0003],
        [-0.0022, -0.0002],
        [-0.0025, -0.0003],
        [-0.0027, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6815],
        [ 0.6173, -2.6264],
        [-0.7299,  1.4760],
        [-0.8541, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7336, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0381, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1496, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033, -0.0002],
        [-0.0029, -0.0002],
        [-0.0031, -0.0003],
        [-0.0031, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6816],
        [ 0.6166, -2.6264],
        [-0.7305,  1.4761],
        [-0.8545, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7655, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1574, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0025, -0.0002],
        [-0.0027, -0.0003],
        [-0.0030, -0.0003],
        [-0.0026, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6816],
        [ 0.6169, -2.6265],
        [-0.7304,  1.4760],
        [-0.8541, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7045, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1520, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033, -0.0001],
        [-0.0032, -0.0002],
        [-0.0029, -0.0001],
        [-0.0029, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6817],
        [ 0.6164, -2.6264],
        [-0.7302,  1.4763],
        [-0.8544, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5507, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0455, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1460, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028, -0.0003],
        [-0.0024, -0.0002],
        [-0.0027, -0.0003],
        [-0.0026, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6815],
        [ 0.6171, -2.6264],
        [-0.7301,  1.4761],
        [-0.8540, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5940, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0364, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1323, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7501e-03, -6.8095e-05],
        [-2.5040e-03, -1.2988e-04],
        [-3.1624e-03, -9.4411e-05],
        [-2.7169e-03, -1.5567e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6817],
        [ 0.6170, -2.6263],
        [-0.7305,  1.4763],
        [-0.8542, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5827, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0318, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1218, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0028, -0.0002],
        [-0.0028, -0.0002],
        [-0.0032, -0.0002],
        [-0.0029, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6816],
        [ 0.6167, -2.6264],
        [-0.7306,  1.4761],
        [-0.8544, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7216, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1461, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032, -0.0002],
        [-0.0026, -0.0002],
        [-0.0031, -0.0002],
        [-0.0031, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6816],
        [ 0.6169, -2.6264],
        [-0.7304,  1.4762],
        [-0.8545, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5244, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0314, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1152, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.6120e-03, -2.4053e-04],
        [-2.9304e-03, -1.3966e-04],
        [-2.5379e-03, -1.0880e-04],
        [-2.7387e-03, -9.3778e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6815],
        [ 0.6166, -2.6264],
        [-0.7299,  1.4763],
        [-0.8542, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5498, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0362, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1275, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0030, -0.0003],
        [-0.0032, -0.0003],
        [-0.0033, -0.0002],
        [-0.0033, -0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6815],
        [ 0.6163, -2.6265],
        [-0.7306,  1.4762],
        [-0.8548, -2.7483]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4871, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0375, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1237, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0030, -0.0002],
        [-0.0029, -0.0002],
        [-0.0031, -0.0001],
        [-0.0034, -0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6815],
        [ 0.6166, -2.6264],
        [-0.7304,  1.4763],
        [-0.8548, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.9603, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1706, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5200e-03, -2.0544e-04],
        [-2.6112e-03, -6.4794e-05],
        [-2.7115e-03, -8.5830e-05],
        [-2.4554e-03, -1.5983e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3087,  0.6815],
        [ 0.6169, -2.6263],
        [-0.7300,  1.4763],
        [-0.8539, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.8104, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1668, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.1277e-03, -1.1648e-04],
        [-2.7688e-03, -1.3721e-04],
        [-3.3252e-03, -1.3821e-04],
        [-3.2998e-03, -9.8844e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6816],
        [ 0.6168, -2.6264],
        [-0.7306,  1.4763],
        [-0.8548, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5749, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0387, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1350, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.1479e-03, -9.1217e-05],
        [-3.0100e-03, -1.1525e-04],
        [-3.1273e-03, -6.1900e-05],
        [-3.4235e-03, -5.8178e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6816],
        [ 0.6165, -2.6263],
        [-0.7304,  1.4764],
        [-0.8549, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4609, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0408, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1276, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.1222e-03, -4.3690e-05],
        [-2.6422e-03, -7.3547e-05],
        [-3.0986e-03, -6.1348e-05],
        [-3.1749e-03, -4.6826e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6816],
        [ 0.6169, -2.6263],
        [-0.7304,  1.4764],
        [-0.8547, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6766, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0368, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1413, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.4699e-03,  3.2293e-06],
        [-3.0280e-03, -6.8288e-05],
        [-2.7533e-03, -4.4484e-05],
        [-2.9621e-03, -2.2787e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6817],
        [ 0.6165, -2.6263],
        [-0.7300,  1.4764],
        [-0.8545, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4559, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1152, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.0862e-03, -3.4374e-05],
        [-3.0399e-03, -1.5856e-05],
        [-3.1880e-03, -6.7579e-05],
        [-2.7471e-03, -4.7947e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6816],
        [ 0.6165, -2.6262],
        [-0.7305,  1.4764],
        [-0.8543, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4830, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1230, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9576e-03, -1.2053e-04],
        [-2.8596e-03, -1.1501e-04],
        [-3.0451e-03, -2.6140e-05],
        [-2.9395e-03, -1.2225e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6815],
        [ 0.6167, -2.6263],
        [-0.7303,  1.4764],
        [-0.8544, -2.7482]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  44
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4973, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0429, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1356, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0024, -0.0001],
        [-0.0022, -0.0002],
        [-0.0023, -0.0002],
        [-0.0026, -0.0001]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3088,  0.6815],
        [ 0.6173, -2.6264],
        [-0.7295,  1.4763],
        [-0.8541, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.7408, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0358, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1456, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7718e-03, -6.1974e-05],
        [-2.5962e-03, -1.2633e-04],
        [-2.6544e-03, -1.1768e-04],
        [-2.6114e-03, -2.8766e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3084,  0.6815],
        [ 0.6169, -2.6264],
        [-0.7299,  1.4763],
        [-0.8541, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4696, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0348, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1165, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.7221e-03,  2.0069e-05],
        [-3.1221e-03, -1.7082e-06],
        [-3.3673e-03,  2.2337e-04],
        [-3.3267e-03,  1.6085e-04]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3085,  0.6816],
        [ 0.6164, -2.6262],
        [-0.7306,  1.4767],
        [-0.8548, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4017, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1187, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.9886e-03, -7.2801e-05],
        [-3.2531e-03, -2.0743e-05],
        [-2.8737e-03,  3.0153e-06],
        [-2.7923e-03, -2.7442e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6815],
        [ 0.6163, -2.6263],
        [-0.7301,  1.4765],
        [-0.8543, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5915, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1331, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.5577e-03, -9.0896e-05],
        [-2.6933e-03, -1.9347e-04],
        [-2.6664e-03, -1.2523e-04],
        [-2.8306e-03, -5.8656e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3086,  0.6815],
        [ 0.6168, -2.6264],
        [-0.7299,  1.4763],
        [-0.8543, -2.7481]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6008, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0344, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1288, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.8625e-03, -7.5339e-05],
        [-2.9653e-03,  2.8778e-05],
        [-2.7759e-03,  1.3383e-06],
        [-2.6976e-03,  8.0725e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6815],
        [ 0.6166, -2.6262],
        [-0.7300,  1.4765],
        [-0.8542, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6287, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0443, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1514, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.2524e-03,  3.5425e-05],
        [-3.0290e-03,  8.4283e-05],
        [-3.0834e-03,  3.4643e-05],
        [-3.2183e-03,  4.4549e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6815],
        [ 0.6165, -2.6262],
        [-0.7303,  1.4765],
        [-0.8547, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5186, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1265, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.8761e-03, -6.4889e-05],
        [-2.9303e-03,  4.1051e-05],
        [-2.9430e-03, -4.0325e-05],
        [-2.5327e-03,  3.3230e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6814],
        [ 0.6166, -2.6262],
        [-0.7302,  1.4764],
        [-0.8541, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4954, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0378, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1252, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-2.8370e-03,  1.1125e-04],
        [-2.5614e-03,  1.5455e-04],
        [-2.9006e-03,  1.3984e-04],
        [-2.6621e-03,  4.9343e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6816],
        [ 0.6169, -2.6261],
        [-0.7302,  1.4766],
        [-0.8542, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6528, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0440, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1534, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0035,  0.0003],
        [-0.0030,  0.0002],
        [-0.0034,  0.0001],
        [-0.0033,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3077,  0.6818],
        [ 0.6165, -2.6261],
        [-0.7307,  1.4766],
        [-0.8548, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5149, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0392, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1298, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.0825e-03,  1.7656e-04],
        [-2.4250e-03, -3.1613e-05],
        [-2.4503e-03,  9.2783e-05],
        [-2.4375e-03,  8.8776e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3081,  0.6816],
        [ 0.6171, -2.6263],
        [-0.7297,  1.4766],
        [-0.8540, -2.7480]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  36
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6678, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1476, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0002],
        [-0.0033,  0.0002],
        [-0.0033,  0.0002],
        [-0.0033,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6816],
        [ 0.6162, -2.6261],
        [-0.7306,  1.4766],
        [-0.8548, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5895, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0380, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1350, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029,  0.0002],
        [-0.0033,  0.0003],
        [-0.0032,  0.0003],
        [-0.0032,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3083,  0.6816],
        [ 0.6162, -2.6260],
        [-0.7304,  1.4767],
        [-0.8548, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5105, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1296, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0002],
        [-0.0030,  0.0003],
        [-0.0028,  0.0002],
        [-0.0028,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6816],
        [ 0.6165, -2.6260],
        [-0.7300,  1.4767],
        [-0.8543, -2.7479]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.4901, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0398, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1285, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0003],
        [-0.0035,  0.0004],
        [-0.0033,  0.0003],
        [-0.0033,  0.0002]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3080,  0.6816],
        [ 0.6159, -2.6259],
        [-0.7306,  1.4767],
        [-0.8549, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5351, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0393, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1322, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0029,  0.0002],
        [-0.0032,  0.0002],
        [-0.0030,  0.0002],
        [-0.0031,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3082,  0.6816],
        [ 0.6162, -2.6261],
        [-0.7303,  1.4767],
        [-0.8546, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.6691, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0379, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1428, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0036,  0.0004],
        [-0.0038,  0.0003],
        [-0.0034,  0.0003],
        [-0.0039,  0.0004]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3076,  0.6817],
        [ 0.6157, -2.6260],
        [-0.7307,  1.4768],
        [-0.8554, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5282, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1318, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0033,  0.0004],
        [-0.0031,  0.0003],
        [-0.0031,  0.0003],
        [-0.0033,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3078,  0.6817],
        [ 0.6163, -2.6261],
        [-0.7303,  1.4767],
        [-0.8549, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
gt_cnt:  42
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  37
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  36
gt_cnt:  37
gt_cnt:  35
gt_cnt:  41
gt_cnt:  36
gt_cnt:  39
gt_cnt:  37
gt_cnt:  41
gt_cnt:  39
gt_cnt:  38
gt_cnt:  43
gt_cnt:  39
gt_cnt:  41
gt_cnt:  37
gt_cnt:  37
gt_cnt:  38
gt_cnt:  35
gt_cnt:  40
gt_cnt:  35
gt_cnt:  43
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  38
gt_cnt:  38
gt_cnt:  38
gt_cnt:  35
gt_cnt:  36
gt_cnt:  35
gt_cnt:  35
gt_cnt:  36
gt_cnt:  41
gt_cnt:  38
gt_cnt:  35
gt_cnt:  41
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  42
gt_cnt:  37
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  40
gt_cnt:  36
gt_cnt:  39
gt_cnt:  41
gt_cnt:  40
gt_cnt:  41
gt_cnt:  41
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  37
gt_cnt:  36
gt_cnt:  42
gt_cnt:  36
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
gt_cnt:  36
gt_cnt:  38
gt_cnt:  42
gt_cnt:  43
gt_cnt:  38
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  38
gt_cnt:  40
gt_cnt:  44
gt_cnt:  38
gt_cnt:  40
gt_cnt:  42
gt_cnt:  40
gt_cnt:  40
gt_cnt:  40
gt_cnt:  42
gt_cnt:  39
gt_cnt:  38
gt_cnt:  41
gt_cnt:  38
gt_cnt:  41
gt_cnt:  39
gt_cnt:  38
gt_cnt:  42
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  39
gt_cnt:  38
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  42
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  41
gt_cnt:  39
gt_cnt:  41
gt_cnt:  35
gt_cnt:  39
gt_cnt:  39
gt_cnt:  44
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
gt_cnt:  35
gt_cnt:  41
gt_cnt:  40
gt_cnt:  41
gt_cnt:  37
gt_cnt:  39
{'labels': tensor(0.6355, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0346, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1328, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-0.0032,  0.0003],
        [-0.0030,  0.0004],
        [-0.0032,  0.0004],
        [-0.0034,  0.0003]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3079,  0.6816],
        [ 0.6164, -2.6259],
        [-0.7305,  1.4769],
        [-0.8549, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  41
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'labels': tensor(0.5771, device='cuda:0', grad_fn=<MulBackward0>), 'center': tensor(0.0365, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(0.1308, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  43
gt_cnt:  40
gt_cnt:  37
gt_cnt:  41
gt_cnt:  43
gt_cnt:  35
gt_cnt:  38
gt_cnt:  41
gt_cnt:  35
gt_cnt:  43
gt_cnt:  38
gt_cnt:  39
gt_cnt:  34
gt_cnt:  41
gt_cnt:  35
gt_cnt:  38
gt_cnt:  40
gt_cnt:  43
gt_cnt:  37
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  35
gt_cnt:  37
gt_cnt:  37
gt_cnt:  35
gt_cnt:  37
gt_cnt:  38
gt_cnt:  39
gt_cnt:  40
gt_cnt:  36
gt_cnt:  40
gt_cnt:  38
gt_cnt:  38
gt_cnt:  38
gt_cnt:  37
gt_cnt:  41
gt_cnt:  39
gt_cnt:  40
gt_cnt:  38
gt_cnt:  42
gt_cnt:  37
gt_cnt:  36
gt_cnt:  37
gt_cnt:  37
gt_cnt:  38
gt_cnt:  36
gt_cnt:  39
gt_cnt:  41
gt_cnt:  38
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  37
gt_cnt:  40
gt_cnt:  36
gt_cnt:  39
gt_cnt:  38
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  37
gt_cnt:  40
gt_cnt:  38
gt_cnt:  40
gt_cnt:  41
gt_cnt:  40
gt_cnt:  39
gt_cnt:  41
gt_cnt:  41
