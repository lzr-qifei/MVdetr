logs/multiviewx/aug_deform_trans_w_dec_lr0.0005_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-04_19-50-44
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 10, 'lr': 0.0005, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX'}
rpts:  torch.Size([60000, 6, 4, 2])
pos_emb size:  [ 80 125]
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.8238, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0361, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.4369, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(8.2244, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0388, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.7224, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.3596, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0399, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5517, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1746, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3089, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.2580, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0370, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3255, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.7231, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0333, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2111, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1468, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3012, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.6455, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2118, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.6933, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0359, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2105, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.7413, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0366, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0215, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  40
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(4.8067, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0385, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.0383, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.2609, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0383, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1287, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.3993, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0353, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3504, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.6011, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0325, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.5852, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.0370, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0376, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2825, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  42
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.1668, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0395, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.1123, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.1397, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0413, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.3106, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
gt_cnt:  39
gt_cnt:  40
gt_cnt:  35
gt_cnt:  42
gt_cnt:  38
gt_cnt:  38
gt_cnt:  38
gt_cnt:  40
gt_cnt:  37
gt_cnt:  37
gt_cnt:  35
gt_cnt:  38
gt_cnt:  39
gt_cnt:  37
gt_cnt:  37
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  39
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.9053, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0405, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2620, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts dec:  torch.Size([1, 300, 2])
indices0 shape:  37
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(5.6611, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.0404, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.2130, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
