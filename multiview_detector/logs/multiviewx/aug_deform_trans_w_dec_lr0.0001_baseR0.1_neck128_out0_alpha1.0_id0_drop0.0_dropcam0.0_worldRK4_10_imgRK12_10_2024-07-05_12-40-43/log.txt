logs/multiviewx/aug_deform_trans_w_dec_lr0.0001_baseR0.1_neck128_out0_alpha1.0_id0_drop0.0_dropcam0.0_worldRK4_10_imgRK12_10_2024-07-05_12-40-43
Settings:
{'reID': False, 'semi_supervised': 0, 'id_ratio': 0, 'cls_thres': 0.6, 'alpha': 1.0, 'use_mse': False, 'arch': 'resnet18', 'dataset': 'multiviewx', 'num_workers': 4, 'batch_size': 1, 'dropout': 0.0, 'dropcam': 0.0, 'epochs': 100, 'lr': 0.0001, 'base_lr_ratio': 0.1, 'weight_decay': 0.0001, 'resume': None, 'visualize': False, 'seed': 2021, 'deterministic': False, 'augmentation': True, 'world_feat': 'deform_trans_w_dec', 'bottleneck_dim': 128, 'outfeat_dim': 0, 'world_reduce': 4, 'world_kernel_size': 10, 'img_reduce': 12, 'img_kernel_size': 10, 'data': '/root/autodl-tmp/MultiviewX'}
rpts:  torch.Size([60000, 6, 4, 2])
pos_emb size:  [ 80 125]
Training...
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts before dec:  tensor([[[0.9098, 0.6621],
         [0.6495, 0.0675],
         [0.3256, 0.8131],
         [0.2987, 0.0602],
         [0.8851, 0.6143],
         [0.4906, 0.1183],
         [0.8262, 0.8770],
         [0.1918, 0.5798],
         [0.7989, 0.2239],
         [0.9055, 0.1589],
         [0.2308, 0.9834],
         [0.8509, 0.4878],
         [0.3967, 0.2557],
         [0.3409, 0.5541],
         [0.3384, 0.7548],
         [0.0898, 0.4111],
         [0.9301, 0.7930],
         [0.8472, 0.8439],
         [0.7361, 0.4104],
         [0.8414, 0.3285],
         [0.1889, 0.5955],
         [0.4346, 0.1960],
         [0.8033, 0.8425],
         [0.1808, 0.7202],
         [0.8216, 0.4242],
         [0.5911, 0.9296],
         [0.5682, 0.4092],
         [0.2896, 0.0672],
         [0.1580, 0.1578],
         [0.7421, 0.7328],
         [0.8771, 0.3972],
         [0.9429, 0.8408],
         [0.6632, 0.1744],
         [0.9175, 0.5416],
         [0.8495, 0.8354],
         [0.7145, 0.4337],
         [0.2661, 0.4237],
         [0.2734, 0.1467],
         [0.0369, 0.4945],
         [0.8616, 0.5894],
         [0.1150, 0.1354],
         [0.8154, 0.3939],
         [0.5058, 0.5063],
         [0.4277, 0.0917],
         [0.0670, 0.2196],
         [0.8223, 0.8550],
         [0.8468, 0.3356],
         [0.4471, 0.7771],
         [0.4284, 0.7687],
         [0.7541, 0.2700],
         [0.7467, 0.2565],
         [0.4971, 0.7767],
         [0.7404, 0.6857],
         [0.5246, 0.7402],
         [0.0718, 0.5670],
         [0.1252, 0.7550],
         [0.7359, 0.0405],
         [0.4081, 0.7218],
         [0.2289, 0.2163],
         [0.7169, 0.5307],
         [0.4147, 0.1197],
         [0.4608, 0.4761],
         [0.2506, 0.8703],
         [0.3432, 0.4751],
         [0.9086, 0.4969],
         [0.7075, 0.0234],
         [0.3899, 0.3088],
         [0.0402, 0.7313],
         [0.5928, 0.3534],
         [0.3186, 0.3118],
         [0.9203, 0.2464],
         [0.8788, 0.8599],
         [0.2135, 0.7519],
         [0.1179, 0.8403],
         [0.5113, 0.1891],
         [0.5792, 0.3305],
         [0.8252, 0.6165],
         [0.5131, 0.7837],
         [0.2646, 0.5938],
         [0.5486, 0.1916],
         [0.7619, 0.6459],
         [0.5215, 0.4000],
         [0.6438, 0.5039],
         [0.6287, 0.7652],
         [0.9656, 0.6371],
         [0.5856, 0.1501],
         [0.0806, 0.8341],
         [0.1227, 0.5074],
         [0.8654, 0.3126],
         [0.2417, 0.5268],
         [0.9366, 0.4692],
         [0.7875, 0.8813],
         [0.3796, 0.4783],
         [0.0854, 0.1546],
         [0.2050, 0.3082],
         [0.6175, 0.2005],
         [0.1915, 0.4070],
         [0.7198, 0.5783],
         [0.8621, 0.7147],
         [0.1910, 0.6298],
         [0.3781, 0.3293],
         [0.4276, 0.3913],
         [0.6440, 0.5429],
         [0.4566, 0.8967],
         [0.6523, 0.8146],
         [0.8198, 0.5594],
         [0.8047, 0.9193],
         [0.1889, 0.6583],
         [0.5849, 0.5361],
         [0.3549, 0.1884],
         [0.2922, 0.1331],
         [0.7113, 0.7094],
         [0.2600, 0.1741],
         [0.3828, 0.5140],
         [0.3164, 0.5342],
         [0.8976, 0.2177],
         [0.4117, 0.5013],
         [0.2457, 0.8623],
         [0.5648, 0.4269],
         [0.4408, 0.1284],
         [0.4370, 0.5819],
         [0.5912, 0.3647],
         [0.7048, 0.8169],
         [0.2769, 0.8684],
         [0.3186, 0.1930],
         [0.4128, 0.6320],
         [0.6397, 0.2931],
         [0.2959, 0.3683],
         [0.1003, 0.7399],
         [0.8519, 0.7271],
         [0.6313, 0.6349],
         [0.6063, 0.2120],
         [0.3704, 0.4207],
         [0.4934, 0.2293],
         [0.1214, 0.8169],
         [0.1022, 0.7034],
         [0.6578, 0.5843],
         [0.9098, 0.9036],
         [0.8976, 0.4099],
         [0.6237, 0.6790],
         [0.7375, 0.7312],
         [0.0847, 0.7833],
         [0.1934, 0.4925],
         [0.1887, 0.8313],
         [0.6461, 0.3903],
         [0.8816, 0.5202],
         [0.8278, 0.0290],
         [0.3828, 0.2727],
         [0.2204, 0.5436],
         [0.2180, 0.6721],
         [0.2234, 0.1961],
         [0.3469, 0.8137],
         [0.0730, 0.4368],
         [0.3598, 0.2965],
         [0.1487, 0.8702],
         [0.4012, 0.1199],
         [0.8678, 0.8675],
         [0.2215, 0.4448],
         [0.6483, 0.9701],
         [0.8642, 0.6549],
         [0.8428, 0.5993],
         [0.6602, 0.1232],
         [0.6752, 0.4871],
         [0.5166, 0.4589],
         [0.8100, 0.8875],
         [0.4437, 0.3348],
         [0.1162, 0.0437],
         [0.3932, 0.5568],
         [0.6929, 0.9312],
         [0.4252, 0.9252],
         [0.4003, 0.5718],
         [0.6076, 0.3985],
         [0.4241, 0.5614],
         [0.1262, 0.4005],
         [0.4377, 0.6101],
         [0.1755, 0.6122],
         [0.2159, 0.2386],
         [0.7786, 0.7673],
         [0.3509, 0.9231],
         [0.1827, 0.2598],
         [0.0538, 0.4163],
         [0.5477, 0.4938],
         [0.3529, 0.6035],
         [0.8285, 0.4828],
         [0.5042, 0.0755],
         [0.9528, 0.8211],
         [0.6673, 0.0691],
         [0.8187, 0.2944],
         [0.5575, 0.4351],
         [0.8702, 0.3544],
         [0.7893, 0.7802],
         [0.2780, 0.3707],
         [0.9443, 0.7902],
         [0.2569, 0.6800],
         [0.7833, 0.4768],
         [0.8547, 0.6309],
         [0.8919, 0.9359],
         [0.6533, 0.9648],
         [0.6428, 0.6386],
         [0.0715, 0.3781],
         [0.2257, 0.2595],
         [0.9111, 0.1581],
         [0.4898, 0.4226],
         [0.8147, 0.0736],
         [0.1372, 0.0475],
         [0.8459, 0.0834],
         [0.4781, 0.7645],
         [0.2310, 0.5448],
         [0.0860, 0.8426],
         [0.3443, 0.2546],
         [0.3238, 0.7039],
         [0.8530, 0.6352],
         [0.6870, 0.9147],
         [0.4272, 0.2231],
         [0.4512, 0.5571],
         [0.6314, 0.3154],
         [0.1189, 0.2875],
         [0.5618, 0.1486],
         [0.1485, 0.6176],
         [0.6039, 0.7620],
         [0.3841, 0.7930],
         [0.1840, 0.2428],
         [0.7242, 0.3317],
         [0.0962, 0.6506],
         [0.0496, 0.1706],
         [0.5008, 0.6791],
         [0.6286, 0.5093],
         [0.3888, 0.4635],
         [0.4709, 0.3190],
         [0.4706, 0.1890],
         [0.5678, 0.7110],
         [0.9559, 0.8931],
         [0.8306, 0.8821],
         [0.5072, 0.6269],
         [0.5607, 0.9402],
         [0.4379, 0.4217],
         [0.3106, 0.2479],
         [0.6694, 0.9465],
         [0.5207, 0.9571],
         [0.7338, 0.7455],
         [0.1801, 0.6515],
         [0.0840, 0.5634],
         [0.1401, 0.3897],
         [0.7981, 0.5777],
         [0.7284, 0.2547],
         [0.4097, 0.5329],
         [0.8525, 0.0685],
         [0.4637, 0.6770],
         [0.1162, 0.0657],
         [0.3000, 0.0873],
         [0.6075, 0.2154],
         [0.7933, 0.4543],
         [0.2273, 0.3384],
         [0.2106, 0.4849],
         [0.1824, 0.8756],
         [0.4646, 0.4830],
         [0.9418, 0.8489],
         [0.8153, 0.2395],
         [0.4132, 0.8012],
         [0.4716, 0.4744],
         [0.2944, 0.1157],
         [0.1828, 0.4504],
         [0.3157, 0.1270],
         [0.5833, 0.7969],
         [0.4449, 0.3081],
         [0.8546, 0.8788],
         [0.1659, 0.7316],
         [0.2236, 0.9569],
         [0.8981, 0.5508],
         [0.2099, 0.6408],
         [0.0485, 0.6702],
         [0.2885, 0.7914],
         [0.6131, 0.2221],
         [0.5319, 0.5766],
         [0.2436, 0.8618],
         [0.2705, 0.5476],
         [0.2432, 0.7516],
         [0.4340, 0.6703],
         [0.1759, 0.7186],
         [0.4603, 0.0907],
         [0.3698, 0.3156],
         [0.8156, 0.2464],
         [0.2936, 0.2904],
         [0.1491, 0.2353],
         [0.2384, 0.4756],
         [0.3455, 0.5877],
         [0.6147, 0.7999],
         [0.7057, 0.7439],
         [0.9083, 0.7831],
         [0.8335, 0.1341],
         [0.1690, 0.5131],
         [0.1201, 0.6212],
         [0.2415, 0.4257],
         [0.4635, 0.1062],
         [0.3983, 0.1791],
         [0.6256, 0.1474],
         [0.3612, 0.5226],
         [0.4236, 0.1175],
         [0.1532, 0.2491],
         [0.1284, 0.2149]]], device='cuda:0', grad_fn=<SliceBackward0>)
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[0., 0.],
        [0., 0.],
        [0., 0.],
        [0., 0.]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6729],
        [ 0.6167, -2.6265],
        [-0.7281,  1.4702],
        [-0.8537, -2.7477]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  39
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(6.8349, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2469, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(1.8608, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts before dec:  tensor([[[0.9098, 0.6621],
         [0.6495, 0.0675],
         [0.3256, 0.8131],
         [0.2987, 0.0602],
         [0.8851, 0.6143],
         [0.4906, 0.1183],
         [0.8263, 0.8770],
         [0.1918, 0.5798],
         [0.7989, 0.2239],
         [0.9055, 0.1588],
         [0.2308, 0.9834],
         [0.8509, 0.4878],
         [0.3967, 0.2558],
         [0.3409, 0.5541],
         [0.3384, 0.7548],
         [0.0898, 0.4110],
         [0.9301, 0.7930],
         [0.8473, 0.8439],
         [0.7361, 0.4104],
         [0.8413, 0.3285],
         [0.1889, 0.5955],
         [0.4346, 0.1960],
         [0.8033, 0.8425],
         [0.1808, 0.7202],
         [0.8216, 0.4242],
         [0.5911, 0.9296],
         [0.5682, 0.4092],
         [0.2896, 0.0672],
         [0.1580, 0.1578],
         [0.7421, 0.7328],
         [0.8771, 0.3972],
         [0.9429, 0.8408],
         [0.6632, 0.1744],
         [0.9175, 0.5415],
         [0.8494, 0.8354],
         [0.7145, 0.4336],
         [0.2661, 0.4237],
         [0.2734, 0.1466],
         [0.0369, 0.4945],
         [0.8616, 0.5894],
         [0.1150, 0.1354],
         [0.8154, 0.3939],
         [0.5058, 0.5063],
         [0.4277, 0.0917],
         [0.0670, 0.2196],
         [0.8223, 0.8550],
         [0.8468, 0.3355],
         [0.4471, 0.7771],
         [0.4285, 0.7687],
         [0.7541, 0.2700],
         [0.7467, 0.2565],
         [0.4971, 0.7767],
         [0.7403, 0.6857],
         [0.5247, 0.7402],
         [0.0718, 0.5670],
         [0.1252, 0.7549],
         [0.7359, 0.0405],
         [0.4082, 0.7218],
         [0.2289, 0.2163],
         [0.7169, 0.5307],
         [0.4147, 0.1197],
         [0.4608, 0.4761],
         [0.2506, 0.8703],
         [0.3432, 0.4751],
         [0.9086, 0.4969],
         [0.7075, 0.0234],
         [0.3898, 0.3088],
         [0.0402, 0.7313],
         [0.5927, 0.3534],
         [0.3185, 0.3118],
         [0.9203, 0.2464],
         [0.8788, 0.8599],
         [0.2135, 0.7519],
         [0.1179, 0.8403],
         [0.5112, 0.1891],
         [0.5792, 0.3306],
         [0.8252, 0.6165],
         [0.5131, 0.7837],
         [0.2646, 0.5938],
         [0.5486, 0.1916],
         [0.7619, 0.6459],
         [0.5215, 0.4000],
         [0.6438, 0.5039],
         [0.6288, 0.7652],
         [0.9656, 0.6371],
         [0.5856, 0.1500],
         [0.0806, 0.8341],
         [0.1227, 0.5074],
         [0.8654, 0.3126],
         [0.2416, 0.5268],
         [0.9366, 0.4692],
         [0.7875, 0.8812],
         [0.3796, 0.4782],
         [0.0854, 0.1546],
         [0.2050, 0.3082],
         [0.6175, 0.2005],
         [0.1915, 0.4070],
         [0.7199, 0.5783],
         [0.8621, 0.7146],
         [0.1910, 0.6298],
         [0.3780, 0.3293],
         [0.4276, 0.3913],
         [0.6440, 0.5429],
         [0.4566, 0.8967],
         [0.6523, 0.8146],
         [0.8198, 0.5594],
         [0.8047, 0.9193],
         [0.1889, 0.6583],
         [0.5849, 0.5361],
         [0.3549, 0.1884],
         [0.2922, 0.1331],
         [0.7113, 0.7094],
         [0.2600, 0.1741],
         [0.3828, 0.5140],
         [0.3164, 0.5342],
         [0.8976, 0.2177],
         [0.4117, 0.5013],
         [0.2458, 0.8623],
         [0.5648, 0.4269],
         [0.4408, 0.1284],
         [0.4370, 0.5819],
         [0.5913, 0.3647],
         [0.7048, 0.8169],
         [0.2769, 0.8684],
         [0.3186, 0.1930],
         [0.4128, 0.6320],
         [0.6398, 0.2931],
         [0.2959, 0.3683],
         [0.1003, 0.7398],
         [0.8519, 0.7271],
         [0.6313, 0.6349],
         [0.6063, 0.2120],
         [0.3705, 0.4207],
         [0.4934, 0.2293],
         [0.1214, 0.8169],
         [0.1022, 0.7034],
         [0.6578, 0.5843],
         [0.9098, 0.9036],
         [0.8976, 0.4098],
         [0.6238, 0.6790],
         [0.7375, 0.7312],
         [0.0847, 0.7833],
         [0.1934, 0.4924],
         [0.1887, 0.8313],
         [0.6461, 0.3903],
         [0.8816, 0.5202],
         [0.8278, 0.0290],
         [0.3827, 0.2727],
         [0.2204, 0.5436],
         [0.2179, 0.6721],
         [0.2234, 0.1961],
         [0.3469, 0.8137],
         [0.0730, 0.4368],
         [0.3598, 0.2966],
         [0.1487, 0.8702],
         [0.4011, 0.1199],
         [0.8678, 0.8675],
         [0.2215, 0.4448],
         [0.6484, 0.9701],
         [0.8642, 0.6549],
         [0.8428, 0.5993],
         [0.6602, 0.1232],
         [0.6752, 0.4871],
         [0.5166, 0.4589],
         [0.8100, 0.8875],
         [0.4437, 0.3348],
         [0.1162, 0.0437],
         [0.3932, 0.5568],
         [0.6929, 0.9312],
         [0.4252, 0.9252],
         [0.4003, 0.5718],
         [0.6076, 0.3985],
         [0.4241, 0.5613],
         [0.1262, 0.4005],
         [0.4377, 0.6100],
         [0.1755, 0.6122],
         [0.2159, 0.2386],
         [0.7786, 0.7673],
         [0.3509, 0.9231],
         [0.1827, 0.2598],
         [0.0538, 0.4163],
         [0.5477, 0.4938],
         [0.3529, 0.6035],
         [0.8285, 0.4828],
         [0.5042, 0.0755],
         [0.9528, 0.8211],
         [0.6673, 0.0691],
         [0.8187, 0.2944],
         [0.5575, 0.4351],
         [0.8702, 0.3544],
         [0.7893, 0.7802],
         [0.2779, 0.3707],
         [0.9443, 0.7902],
         [0.2569, 0.6800],
         [0.7833, 0.4768],
         [0.8547, 0.6309],
         [0.8919, 0.9359],
         [0.6533, 0.9648],
         [0.6428, 0.6387],
         [0.0715, 0.3781],
         [0.2257, 0.2595],
         [0.9111, 0.1581],
         [0.4897, 0.4225],
         [0.8147, 0.0736],
         [0.1372, 0.0475],
         [0.8458, 0.0834],
         [0.4780, 0.7645],
         [0.2310, 0.5448],
         [0.0860, 0.8426],
         [0.3442, 0.2546],
         [0.3238, 0.7039],
         [0.8531, 0.6352],
         [0.6870, 0.9147],
         [0.4272, 0.2231],
         [0.4512, 0.5571],
         [0.6314, 0.3154],
         [0.1189, 0.2875],
         [0.5619, 0.1486],
         [0.1485, 0.6176],
         [0.6039, 0.7620],
         [0.3841, 0.7930],
         [0.1840, 0.2428],
         [0.7242, 0.3317],
         [0.0962, 0.6506],
         [0.0496, 0.1706],
         [0.5008, 0.6791],
         [0.6286, 0.5093],
         [0.3888, 0.4635],
         [0.4709, 0.3190],
         [0.4706, 0.1890],
         [0.5678, 0.7109],
         [0.9559, 0.8931],
         [0.8306, 0.8821],
         [0.5072, 0.6269],
         [0.5607, 0.9402],
         [0.4379, 0.4217],
         [0.3106, 0.2479],
         [0.6694, 0.9465],
         [0.5207, 0.9571],
         [0.7338, 0.7455],
         [0.1801, 0.6515],
         [0.0840, 0.5635],
         [0.1401, 0.3898],
         [0.7981, 0.5777],
         [0.7284, 0.2547],
         [0.4098, 0.5329],
         [0.8525, 0.0685],
         [0.4637, 0.6770],
         [0.1162, 0.0657],
         [0.3000, 0.0873],
         [0.6076, 0.2154],
         [0.7933, 0.4543],
         [0.2273, 0.3384],
         [0.2106, 0.4849],
         [0.1824, 0.8756],
         [0.4646, 0.4830],
         [0.9418, 0.8489],
         [0.8153, 0.2394],
         [0.4132, 0.8012],
         [0.4716, 0.4745],
         [0.2944, 0.1157],
         [0.1828, 0.4504],
         [0.3157, 0.1270],
         [0.5834, 0.7969],
         [0.4449, 0.3082],
         [0.8546, 0.8787],
         [0.1659, 0.7316],
         [0.2236, 0.9569],
         [0.8981, 0.5508],
         [0.2099, 0.6408],
         [0.0485, 0.6702],
         [0.2885, 0.7914],
         [0.6131, 0.2221],
         [0.5320, 0.5766],
         [0.2436, 0.8619],
         [0.2705, 0.5476],
         [0.2432, 0.7516],
         [0.4340, 0.6703],
         [0.1759, 0.7186],
         [0.4603, 0.0907],
         [0.3698, 0.3156],
         [0.8156, 0.2464],
         [0.2936, 0.2904],
         [0.1491, 0.2353],
         [0.2384, 0.4756],
         [0.3455, 0.5877],
         [0.6147, 0.7999],
         [0.7057, 0.7438],
         [0.9083, 0.7831],
         [0.8335, 0.1341],
         [0.1690, 0.5131],
         [0.1201, 0.6212],
         [0.2415, 0.4257],
         [0.4635, 0.1062],
         [0.3983, 0.1791],
         [0.6256, 0.1474],
         [0.3611, 0.5226],
         [0.4235, 0.1175],
         [0.1532, 0.2490],
         [0.1283, 0.2149]]], device='cuda:0', grad_fn=<SliceBackward0>)
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-5.3459e-05, -4.2116e-06],
        [-5.0049e-05, -1.1863e-05],
        [-4.8890e-05, -7.8868e-06],
        [-5.7001e-05, -8.6879e-06]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3113,  0.6729],
        [ 0.6167, -2.6265],
        [-0.7280,  1.4703],
        [-0.8537, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  35
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(8.3494, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2397, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(2.1493, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts before dec:  tensor([[[0.9098, 0.6621],
         [0.6495, 0.0675],
         [0.3257, 0.8131],
         [0.2987, 0.0602],
         [0.8851, 0.6143],
         [0.4906, 0.1183],
         [0.8263, 0.8770],
         [0.1918, 0.5798],
         [0.7989, 0.2239],
         [0.9055, 0.1588],
         [0.2308, 0.9834],
         [0.8509, 0.4879],
         [0.3967, 0.2558],
         [0.3409, 0.5541],
         [0.3384, 0.7548],
         [0.0898, 0.4110],
         [0.9301, 0.7930],
         [0.8473, 0.8439],
         [0.7361, 0.4104],
         [0.8414, 0.3285],
         [0.1889, 0.5955],
         [0.4345, 0.1960],
         [0.8033, 0.8425],
         [0.1808, 0.7202],
         [0.8216, 0.4242],
         [0.5911, 0.9296],
         [0.5682, 0.4092],
         [0.2896, 0.0672],
         [0.1580, 0.1578],
         [0.7421, 0.7329],
         [0.8771, 0.3971],
         [0.9429, 0.8408],
         [0.6632, 0.1744],
         [0.9175, 0.5415],
         [0.8494, 0.8354],
         [0.7145, 0.4336],
         [0.2661, 0.4237],
         [0.2734, 0.1466],
         [0.0369, 0.4945],
         [0.8616, 0.5894],
         [0.1150, 0.1354],
         [0.8154, 0.3939],
         [0.5059, 0.5063],
         [0.4277, 0.0917],
         [0.0670, 0.2195],
         [0.8223, 0.8550],
         [0.8468, 0.3355],
         [0.4471, 0.7771],
         [0.4285, 0.7687],
         [0.7541, 0.2700],
         [0.7467, 0.2565],
         [0.4971, 0.7767],
         [0.7403, 0.6857],
         [0.5247, 0.7402],
         [0.0718, 0.5670],
         [0.1252, 0.7549],
         [0.7359, 0.0405],
         [0.4081, 0.7218],
         [0.2289, 0.2163],
         [0.7168, 0.5307],
         [0.4147, 0.1197],
         [0.4608, 0.4761],
         [0.2506, 0.8703],
         [0.3432, 0.4751],
         [0.9086, 0.4969],
         [0.7074, 0.0234],
         [0.3898, 0.3088],
         [0.0402, 0.7313],
         [0.5927, 0.3534],
         [0.3185, 0.3118],
         [0.9203, 0.2464],
         [0.8788, 0.8599],
         [0.2135, 0.7519],
         [0.1179, 0.8403],
         [0.5112, 0.1891],
         [0.5792, 0.3306],
         [0.8252, 0.6165],
         [0.5130, 0.7838],
         [0.2646, 0.5938],
         [0.5486, 0.1916],
         [0.7619, 0.6458],
         [0.5215, 0.4001],
         [0.6438, 0.5038],
         [0.6288, 0.7652],
         [0.9656, 0.6371],
         [0.5855, 0.1500],
         [0.0806, 0.8341],
         [0.1227, 0.5074],
         [0.8654, 0.3126],
         [0.2416, 0.5267],
         [0.9366, 0.4692],
         [0.7875, 0.8812],
         [0.3796, 0.4782],
         [0.0854, 0.1546],
         [0.2050, 0.3082],
         [0.6175, 0.2005],
         [0.1915, 0.4070],
         [0.7199, 0.5783],
         [0.8622, 0.7147],
         [0.1910, 0.6298],
         [0.3780, 0.3294],
         [0.4276, 0.3913],
         [0.6440, 0.5429],
         [0.4566, 0.8967],
         [0.6523, 0.8146],
         [0.8198, 0.5594],
         [0.8047, 0.9193],
         [0.1889, 0.6583],
         [0.5849, 0.5361],
         [0.3549, 0.1884],
         [0.2922, 0.1331],
         [0.7112, 0.7094],
         [0.2600, 0.1741],
         [0.3828, 0.5140],
         [0.3164, 0.5342],
         [0.8976, 0.2177],
         [0.4117, 0.5013],
         [0.2457, 0.8623],
         [0.5648, 0.4269],
         [0.4408, 0.1284],
         [0.4370, 0.5819],
         [0.5913, 0.3647],
         [0.7048, 0.8169],
         [0.2769, 0.8684],
         [0.3186, 0.1930],
         [0.4128, 0.6320],
         [0.6398, 0.2931],
         [0.2959, 0.3683],
         [0.1003, 0.7398],
         [0.8519, 0.7271],
         [0.6314, 0.6349],
         [0.6063, 0.2120],
         [0.3705, 0.4207],
         [0.4934, 0.2293],
         [0.1214, 0.8169],
         [0.1022, 0.7034],
         [0.6578, 0.5843],
         [0.9098, 0.9036],
         [0.8976, 0.4098],
         [0.6238, 0.6790],
         [0.7375, 0.7312],
         [0.0847, 0.7833],
         [0.1934, 0.4925],
         [0.1887, 0.8313],
         [0.6461, 0.3903],
         [0.8816, 0.5202],
         [0.8278, 0.0290],
         [0.3828, 0.2727],
         [0.2204, 0.5436],
         [0.2179, 0.6721],
         [0.2234, 0.1962],
         [0.3469, 0.8137],
         [0.0730, 0.4368],
         [0.3598, 0.2966],
         [0.1487, 0.8702],
         [0.4011, 0.1199],
         [0.8678, 0.8676],
         [0.2215, 0.4448],
         [0.6484, 0.9701],
         [0.8642, 0.6549],
         [0.8428, 0.5993],
         [0.6602, 0.1232],
         [0.6752, 0.4871],
         [0.5166, 0.4589],
         [0.8100, 0.8875],
         [0.4437, 0.3348],
         [0.1162, 0.0437],
         [0.3932, 0.5567],
         [0.6929, 0.9312],
         [0.4252, 0.9252],
         [0.4003, 0.5718],
         [0.6076, 0.3985],
         [0.4241, 0.5613],
         [0.1262, 0.4005],
         [0.4378, 0.6100],
         [0.1755, 0.6122],
         [0.2159, 0.2386],
         [0.7786, 0.7673],
         [0.3509, 0.9231],
         [0.1827, 0.2598],
         [0.0538, 0.4163],
         [0.5478, 0.4938],
         [0.3528, 0.6035],
         [0.8285, 0.4827],
         [0.5042, 0.0755],
         [0.9528, 0.8211],
         [0.6673, 0.0691],
         [0.8186, 0.2944],
         [0.5575, 0.4351],
         [0.8702, 0.3544],
         [0.7893, 0.7802],
         [0.2779, 0.3707],
         [0.9443, 0.7902],
         [0.2569, 0.6801],
         [0.7833, 0.4768],
         [0.8547, 0.6309],
         [0.8919, 0.9359],
         [0.6533, 0.9648],
         [0.6428, 0.6387],
         [0.0715, 0.3780],
         [0.2257, 0.2595],
         [0.9111, 0.1581],
         [0.4897, 0.4225],
         [0.8147, 0.0736],
         [0.1372, 0.0475],
         [0.8458, 0.0834],
         [0.4781, 0.7645],
         [0.2310, 0.5448],
         [0.0860, 0.8426],
         [0.3442, 0.2546],
         [0.3238, 0.7039],
         [0.8531, 0.6352],
         [0.6870, 0.9147],
         [0.4272, 0.2230],
         [0.4513, 0.5571],
         [0.6314, 0.3154],
         [0.1189, 0.2875],
         [0.5619, 0.1486],
         [0.1485, 0.6176],
         [0.6039, 0.7620],
         [0.3841, 0.7930],
         [0.1840, 0.2429],
         [0.7242, 0.3317],
         [0.0962, 0.6506],
         [0.0496, 0.1706],
         [0.5009, 0.6791],
         [0.6286, 0.5093],
         [0.3888, 0.4635],
         [0.4709, 0.3189],
         [0.4706, 0.1890],
         [0.5678, 0.7109],
         [0.9559, 0.8932],
         [0.8306, 0.8821],
         [0.5072, 0.6269],
         [0.5607, 0.9402],
         [0.4379, 0.4217],
         [0.3106, 0.2479],
         [0.6694, 0.9465],
         [0.5207, 0.9571],
         [0.7337, 0.7455],
         [0.1801, 0.6515],
         [0.0840, 0.5635],
         [0.1401, 0.3898],
         [0.7981, 0.5777],
         [0.7284, 0.2547],
         [0.4098, 0.5329],
         [0.8525, 0.0685],
         [0.4637, 0.6770],
         [0.1162, 0.0657],
         [0.3000, 0.0873],
         [0.6076, 0.2154],
         [0.7933, 0.4543],
         [0.2273, 0.3384],
         [0.2106, 0.4848],
         [0.1824, 0.8756],
         [0.4646, 0.4830],
         [0.9418, 0.8489],
         [0.8153, 0.2394],
         [0.4132, 0.8012],
         [0.4716, 0.4745],
         [0.2944, 0.1158],
         [0.1828, 0.4503],
         [0.3157, 0.1270],
         [0.5834, 0.7969],
         [0.4449, 0.3082],
         [0.8546, 0.8787],
         [0.1659, 0.7316],
         [0.2236, 0.9569],
         [0.8981, 0.5508],
         [0.2099, 0.6408],
         [0.0485, 0.6702],
         [0.2885, 0.7914],
         [0.6131, 0.2221],
         [0.5320, 0.5766],
         [0.2436, 0.8619],
         [0.2705, 0.5475],
         [0.2432, 0.7516],
         [0.4341, 0.6703],
         [0.1759, 0.7186],
         [0.4603, 0.0906],
         [0.3698, 0.3156],
         [0.8156, 0.2464],
         [0.2936, 0.2904],
         [0.1491, 0.2352],
         [0.2384, 0.4756],
         [0.3455, 0.5877],
         [0.6148, 0.7999],
         [0.7057, 0.7438],
         [0.9083, 0.7831],
         [0.8335, 0.1340],
         [0.1690, 0.5132],
         [0.1201, 0.6212],
         [0.2415, 0.4257],
         [0.4636, 0.1062],
         [0.3983, 0.1791],
         [0.6256, 0.1474],
         [0.3611, 0.5226],
         [0.4235, 0.1175],
         [0.1532, 0.2490],
         [0.1283, 0.2149]]], device='cuda:0', grad_fn=<SliceBackward0>)
ref pts dec:  torch.Size([1, 300, 2])
hs shape:  torch.Size([1, 300, 128])
before ref add :  tensor([[-3.3833e-05, -3.6243e-05],
        [-4.9378e-05, -4.5986e-05],
        [-4.8918e-05, -3.6356e-05],
        [-5.4881e-05, -4.7577e-05]], device='cuda:0', grad_fn=<SliceBackward0>)
after ref add :  tensor([[ 2.3112,  0.6728],
        [ 0.6168, -2.6265],
        [-0.7279,  1.4702],
        [-0.8537, -2.7478]], device='cuda:0', grad_fn=<SliceBackward0>)
indices0 shape:  38
outlabel_shape:  torch.Size([300, 1])
src_logit shape:  torch.Size([300, 1])
tgt_cls shape:  torch.Size([300])
{'loss_ce': tensor(7.9354, device='cuda:0', grad_fn=<MulBackward0>), 'loss_center': tensor(0.2373, device='cuda:0', grad_fn=<DivBackward0>)}
tensor(2.0617, device='cuda:0', dtype=torch.float64, grad_fn=<AddBackward0>)
after merge:  torch.Size([1, 128, 80, 125])
query shape:  torch.Size([1, 300, 128])
ref pts before dec:  tensor([[[0.9098, 0.6621],
         [0.6495, 0.0675],
         [0.3257, 0.8131],
         [0.2987, 0.0602],
         [0.8851, 0.6143],
         [0.4906, 0.1183],
         [0.8263, 0.8770],
         [0.1918, 0.5797],
         [0.7989, 0.2239],
         [0.9055, 0.1588],
         [0.2308, 0.9834],
         [0.8509, 0.4879],
         [0.3967, 0.2558],
         [0.3409, 0.5541],
         [0.3384, 0.7547],
         [0.0898, 0.4110],
         [0.9301, 0.7930],
         [0.8473, 0.8439],
         [0.7361, 0.4104],
         [0.8414, 0.3285],
         [0.1889, 0.5955],
         [0.4345, 0.1960],
         [0.8033, 0.8425],
         [0.1808, 0.7202],
         [0.8216, 0.4242],
         [0.5911, 0.9296],
         [0.5682, 0.4092],
         [0.2896, 0.0672],
         [0.1580, 0.1578],
         [0.7421, 0.7329],
         [0.8771, 0.3971],
         [0.9429, 0.8408],
         [0.6632, 0.1744],
         [0.9175, 0.5415],
         [0.8494, 0.8354],
         [0.7145, 0.4336],
         [0.2662, 0.4237],
         [0.2734, 0.1466],
         [0.0369, 0.4945],
         [0.8616, 0.5894],
         [0.1150, 0.1354],
         [0.8154, 0.3939],
         [0.5059, 0.5063],
         [0.4277, 0.0917],
         [0.0670, 0.2195],
         [0.8223, 0.8550],
         [0.8468, 0.3355],
         [0.4471, 0.7771],
         [0.4285, 0.7687],
         [0.7541, 0.2700],
         [0.7467, 0.2565],
         [0.4971, 0.7767],
         [0.7403, 0.6857],
         [0.5247, 0.7402],
         [0.0718, 0.5670],
         [0.1252, 0.7549],
         [0.7359, 0.0405],
         [0.4081, 0.7218],
         [0.2289, 0.2163],
         [0.7168, 0.5307],
         [0.4147, 0.1197],
         [0.4608, 0.4761],
         [0.2506, 0.8703],
         [0.3432, 0.4751],
         [0.9086, 0.4969],
         [0.7074, 0.0234],
         [0.3898, 0.3088],
         [0.0402, 0.7313],
         [0.5927, 0.3534],
         [0.3185, 0.3118],
         [0.9203, 0.2464],
         [0.8787, 0.8599],
         [0.2135, 0.7519],
         [0.1179, 0.8403],
         [0.5112, 0.1891],
         [0.5792, 0.3306],
         [0.8252, 0.6165],
         [0.5130, 0.7838],
         [0.2646, 0.5938],
         [0.5486, 0.1916],
         [0.7618, 0.6458],
         [0.5215, 0.4000],
         [0.6438, 0.5038],
         [0.6288, 0.7652],
         [0.9656, 0.6372],
         [0.5855, 0.1500],
         [0.0806, 0.8341],
         [0.1227, 0.5074],
         [0.8654, 0.3126],
         [0.2416, 0.5267],
         [0.9366, 0.4692],
         [0.7875, 0.8812],
         [0.3796, 0.4782],
         [0.0854, 0.1547],
         [0.2050, 0.3082],
         [0.6175, 0.2005],
         [0.1915, 0.4070],
         [0.7199, 0.5783],
         [0.8622, 0.7147],
         [0.1910, 0.6298],
         [0.3780, 0.3294],
         [0.4276, 0.3913],
         [0.6440, 0.5429],
         [0.4566, 0.8967],
         [0.6523, 0.8146],
         [0.8198, 0.5594],
         [0.8047, 0.9193],
         [0.1889, 0.6583],
         [0.5849, 0.5361],
         [0.3549, 0.1884],
         [0.2922, 0.1331],
         [0.7112, 0.7094],
         [0.2600, 0.1741],
         [0.3828, 0.5140],
         [0.3164, 0.5342],
         [0.8976, 0.2177],
         [0.4117, 0.5013],
         [0.2457, 0.8623],
         [0.5648, 0.4269],
         [0.4408, 0.1284],
         [0.4370, 0.5818],
         [0.5913, 0.3647],
         [0.7048, 0.8169],
         [0.2769, 0.8684],
         [0.3186, 0.1930],
         [0.4128, 0.6320],
         [0.6398, 0.2930],
         [0.2959, 0.3683],
         [0.1003, 0.7398],
         [0.8519, 0.7271],
         [0.6314, 0.6349],
         [0.6063, 0.2120],
         [0.3705, 0.4207],
         [0.4934, 0.2293],
         [0.1214, 0.8169],
         [0.1022, 0.7034],
         [0.6578, 0.5844],
         [0.9098, 0.9036],
         [0.8976, 0.4098],
         [0.6238, 0.6790],
         [0.7374, 0.7311],
         [0.0847, 0.7833],
         [0.1934, 0.4925],
         [0.1887, 0.8313],
         [0.6461, 0.3903],
         [0.8816, 0.5202],
         [0.8279, 0.0290],
         [0.3828, 0.2727],
         [0.2204, 0.5435],
         [0.2179, 0.6721],
         [0.2234, 0.1962],
         [0.3469, 0.8137],
         [0.0730, 0.4368],
         [0.3598, 0.2966],
         [0.1487, 0.8702],
         [0.4011, 0.1199],
         [0.8678, 0.8676],
         [0.2215, 0.4448],
         [0.6484, 0.9701],
         [0.8642, 0.6549],
         [0.8428, 0.5993],
         [0.6602, 0.1232],
         [0.6752, 0.4871],
         [0.5166, 0.4590],
         [0.8100, 0.8875],
         [0.4437, 0.3348],
         [0.1162, 0.0437],
         [0.3932, 0.5567],
         [0.6928, 0.9312],
         [0.4252, 0.9252],
         [0.4003, 0.5718],
         [0.6076, 0.3985],
         [0.4241, 0.5613],
         [0.1262, 0.4005],
         [0.4378, 0.6100],
         [0.1755, 0.6122],
         [0.2159, 0.2386],
         [0.7786, 0.7673],
         [0.3509, 0.9231],
         [0.1827, 0.2598],
         [0.0538, 0.4163],
         [0.5478, 0.4938],
         [0.3528, 0.6036],
         [0.8285, 0.4827],
         [0.5042, 0.0755],
         [0.9528, 0.8211],
         [0.6673, 0.0691],
         [0.8186, 0.2943],
         [0.5575, 0.4351],
         [0.8702, 0.3543],
         [0.7893, 0.7802],
         [0.2779, 0.3707],
         [0.9443, 0.7902],
         [0.2569, 0.6801],
         [0.7833, 0.4769],
         [0.8547, 0.6309],
         [0.8919, 0.9359],
         [0.6534, 0.9648],
         [0.6428, 0.6387],
         [0.0715, 0.3780],
         [0.2257, 0.2595],
         [0.9111, 0.1581],
         [0.4897, 0.4225],
         [0.8147, 0.0736],
         [0.1372, 0.0475],
         [0.8458, 0.0834],
         [0.4781, 0.7645],
         [0.2309, 0.5448],
         [0.0860, 0.8426],
         [0.3442, 0.2546],
         [0.3238, 0.7039],
         [0.8531, 0.6352],
         [0.6870, 0.9147],
         [0.4272, 0.2231],
         [0.4513, 0.5571],
         [0.6314, 0.3154],
         [0.1189, 0.2875],
         [0.5619, 0.1486],
         [0.1485, 0.6176],
         [0.6039, 0.7620],
         [0.3841, 0.7930],
         [0.1840, 0.2429],
         [0.7242, 0.3317],
         [0.0962, 0.6506],
         [0.0496, 0.1706],
         [0.5009, 0.6792],
         [0.6286, 0.5093],
         [0.3888, 0.4635],
         [0.4709, 0.3189],
         [0.4706, 0.1890],
         [0.5678, 0.7109],
         [0.9559, 0.8932],
         [0.8306, 0.8822],
         [0.5073, 0.6269],
         [0.5607, 0.9402],
         [0.4379, 0.4217],
         [0.3106, 0.2479],
         [0.6694, 0.9465],
         [0.5208, 0.9571],
         [0.7337, 0.7455],
         [0.1801, 0.6515],
         [0.0840, 0.5635],
         [0.1401, 0.3898],
         [0.7981, 0.5777],
         [0.7284, 0.2547],
         [0.4098, 0.5330],
         [0.8525, 0.0685],
         [0.4637, 0.6770],
         [0.1162, 0.0657],
         [0.3000, 0.0873],
         [0.6076, 0.2153],
         [0.7933, 0.4544],
         [0.2273, 0.3384],
         [0.2106, 0.4848],
         [0.1824, 0.8756],
         [0.4646, 0.4830],
         [0.9418, 0.8489],
         [0.8153, 0.2394],
         [0.4132, 0.8012],
         [0.4716, 0.4745],
         [0.2944, 0.1158],
         [0.1828, 0.4503],
         [0.3157, 0.1270],
         [0.5834, 0.7969],
         [0.4449, 0.3082],
         [0.8546, 0.8787],
         [0.1659, 0.7317],
         [0.2236, 0.9569],
         [0.8981, 0.5508],
         [0.2100, 0.6408],
         [0.0485, 0.6702],
         [0.2885, 0.7914],
         [0.6131, 0.2222],
         [0.5320, 0.5766],
         [0.2436, 0.8619],
         [0.2705, 0.5475],
         [0.2432, 0.7516],
         [0.4341, 0.6703],
         [0.1759, 0.7186],
         [0.4603, 0.0906],
         [0.3698, 0.3156],
         [0.8156, 0.2464],
         [0.2936, 0.2904],
         [0.1491, 0.2352],
         [0.2384, 0.4756],
         [0.3455, 0.5877],
         [0.6148, 0.7999],
         [0.7057, 0.7438],
         [0.9083, 0.7831],
         [0.8335, 0.1340],
         [0.1690, 0.5132],
         [0.1201, 0.6212],
         [0.2415, 0.4257],
         [0.4636, 0.1062],
         [0.3983, 0.1791],
         [0.6256, 0.1474],
         [0.3611, 0.5226],
         [0.4235, 0.1175],
         [0.1532, 0.2490],
         [0.1283, 0.2149]]], device='cuda:0', grad_fn=<SliceBackward0>)
ref pts dec:  torch.Size([1, 300, 2])
gt_cnt:  39
gt_cnt:  40
gt_cnt:  39
gt_cnt:  39
gt_cnt:  39
gt_cnt:  35
gt_cnt:  38
gt_cnt:  38
gt_cnt:  38
hs shape:  torch.Size([1, 300, 128])
